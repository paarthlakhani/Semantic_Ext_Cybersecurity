On IN O
February NNP O
11 CD O
, , O
FireEye NNP O
identified VBD O
a DT B-Entity
zero-day NN I-Entity
exploit VB I-Entity
( FW I-Entity
CVE-2014-0322 FW I-Entity
) FW I-Entity
being VBG B-Action
served VBD I-Action
up RP I-Action
from IN B-Modifier
the DT B-Entity
U.S. NNP I-Entity
Veterans NNP I-Entity
of IN I-Entity
Foreign NNP I-Entity
Wars NNP I-Entity
' POS I-Entity
website NN I-Entity
( NN I-Entity
vfw FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
org FW I-Entity
) FW I-Entity
. . O

We PRP O
believe VBP O
the DT O
attack NN O
is VBZ O
a DT O
strategic JJ O
Web NN O
compromise NN O
targeting VBG O
American JJ O
military JJ O
personnel NNS O
amid IN O
a DT O
paralyzing VBG O
snowstorm NN O
at IN O
the DT O
U.S. NNP O
Capitol NNP O
in IN O
the DT O
days NNS O
leading VBG O
up RP O
to TO O
the DT O
Presidents NNP O
Day NNP O
holiday NN O
weekend NN O
. . O

Based VBN O
on IN O
infrastructure NN O
overlaps VBZ O
and CC O
tradecraft NN O
similarities NNS O
, , O
we PRP O
believe VBP O
the DT O
actors NNS O
behind IN O
this DT O
campaign NN O
are VBP O
associated VBN O
with IN O
two CD O
previously RB O
identified VBN O
campaigns NNS O
( NNP O
Operation NNP O
DeputyDog NNP O
and CC O
Operation NNP O
Ephemeral NNP O
Hydra NNP O
) NNP O
. . O

This DT O
blog NN O
post NN O
examines VBZ O
the DT O
vulnerability NN O
and CC O
associated VBN O
attacks NNS O
, , O
which WDT O
we PRP O
have VBP O
dubbed VBN O
'' '' O
Operation NNP O
SnowMan NNP O
. . O

'' '' O
After IN O
compromising VBG O
the DT O
VFW NNP O
website NN O
, , O
the DT O
attackers NNS O
added VBD O
an DT O
iframe NN O
into IN O
the DT O
beginning NN O
of IN O
the DT O
website's NNP O
HTML NNP O
code VBP O
that IN O
loads NNS O
the DT O
attacker NN O
's POS O
page NN O
in IN O
the DT O
background NN O
. . O

The DT O
attacker NN O
's POS O
HTML/JavaScript JJ O
page NN O
runs VBZ O
a DT O
Flash NNP O
object NN O
, , O
which WDT O
orchestrates VBZ O
the DT O
remainder NN O
of IN O
the DT O
exploit VBP O
. . O

The DT O
exploit VBP O
includes VBZ O
calling VBG O
back RB O
to TO O
the DT O
IE NN O
10 CD O
vulnerability NN O
trigger NN O
, , O
which WDT O
is VBZ O
embedded VBN O
in IN O
the DT O
JavaScript NNP O
. . O

Specifically RB O
, , O
visitors NNS B-Entity
to TO I-Entity
the DT I-Entity
VFW NNP I-Entity
website NN I-Entity
were VBD B-Action
silently RB I-Action
redirected VBN I-Action
through IN B-Modifier
an DT B-Entity
iframe NN I-Entity
to TO B-Modifier
the DT B-Entity
exploit VB I-Entity
at IN I-Entity
www. FW I-Entity
[ FW I-Entity
REDACTED FW I-Entity
] FW I-Entity
.com/Data/img/img.html NN I-Entity
. . O

The DT O
exploit VBP O
targets NNS O
IE NN O
10 CD O
with IN O
Adobe NNP O
Flash NNP O
. . O

It PRP B-Entity
aborts VBZ B-Action
exploitation NN B-Entity
if IN B-Modifier
the DT B-Entity
user NN I-Entity
is VBZ I-Entity
browsing VBG I-Entity
with IN I-Entity
a DT I-Entity
different JJ I-Entity
version NN I-Entity
of IN I-Entity
IE NN I-Entity
or CC I-Entity
has VBZ I-Entity
installed VBN I-Entity
Microsoft NNP I-Entity
's POS I-Entity
Experience NN I-Entity
Mitigation NNP I-Entity
Toolkit NNP I-Entity
( NNP I-Entity
EMET NNP I-Entity
) NNP I-Entity
. . O

So RB O
installing VBG O
EMET NNP O
or CC O
updating VBG O
to TO O
IE NN O
11 CD O
prevents VBZ O
this DT O
exploit VBP O
from IN O
functioning VBG O
. . O

The DT O
vulnerability NN O
is VBZ O
a DT O
previously RB O
unknown JJ O
use-after-free JJ O
bug NN O
in IN O
Microsoft NNP O
Internet NNP O
Explorer NNP O
10 CD O
. . O

The DT O
vulnerability NN O
allows VBZ O
the DT B-Entity
attacker NN I-Entity
to TO O
modify VB B-Action
one CD B-Entity
byte NN I-Entity
of IN I-Entity
memory NN I-Entity
at IN B-Modifier
an DT B-Entity
arbitrary JJ I-Entity
address NN I-Entity
. . O

The DT O
attacker NN O
uses VBZ O
the DT O
vulnerability NN O
to TO O
do VB O
the DT O
following NN O
: : O
The DT B-Entity
attacker NN I-Entity
uses VBZ B-Action
the DT B-Entity
Microsoft.XMLDOM FW I-Entity
ActiveX FW I-Entity
control NN I-Entity
to TO B-Modifier
load VB B-Entity
a DT I-Entity
one-line JJ I-Entity
XML NN I-Entity
string NN I-Entity
containing VBG I-Entity
a DT I-Entity
file NN I-Entity
path NN I-Entity
to TO I-Entity
the DT I-Entity
EMET NNP I-Entity
DLL NNP I-Entity
. . O

Then RB O
the DT O
exploit VBP O
code NN O
parses VBZ O
the DT O
error NN O
resulting VBG O
from IN O
the DT O
XML NN O
load NN O
order NN O
to TO O
determine VB O
whether IN O
the DT O
load NN O
failed VBD O
because IN O
the DT O
EMET NNP O
DLL NNP O
is VBZ O
not RB O
present JJ O
. . O

The DT O
exploit VBP O
proceeds NNS O
only RB O
if IN O
this DT O
check NN O
determines VBZ O
that IN O
the DT O
EMET NNP O
DLL NNP O
is VBZ O
not RB O
present JJ O
. . O

Because IN O
the DT O
vulnerability NN O
allows VBZ O
attackers NNS B-Entity
to TO O
modify VB B-Action
memory NN B-Entity
to TO B-Modifier
an DT B-Entity
arbitrary JJ I-Entity
address NN I-Entity
, , O
the DT B-Entity
attacker NN I-Entity
can MD O
use VB B-Action
it PRP B-Entity
to TO B-Modifier
bypass VB B-Entity
ASLR NNP I-Entity
. . O

For IN O
example NN O
, , O
the DT O
attacker NN O
corrupts VBZ O
a DT O
Flash NNP O
Vector NNP O
object NN O
and CC O
then RB O
accesses VBZ O
the DT O
corrupted JJ O
object NN O
from IN O
within IN O
Flash NNP O
to TO O
access VB O
memory NN O
. . O

We PRP O
have VBP O
discussed VBN O
this DT O
technique NN O
and CC O
other JJ O
ASLR NN O
bypass NN O
approaches NNS O
in IN O
our PRP$ O
blog NN O
. . O

One CD O
minor JJ O
difference NN O
between IN O
the DT O
previous JJ O
approaches NNS O
and CC O
this DT O
attack NN O
is VBZ O
the DT O
heap NN O
spray NN O
address NN O
, , O
which WDT O
was VBD O
changed VBN O
to TO O
0x1a1b2000 NN O
in IN O
this DT O
exploit VBP O
. . O

Once RB B-Modifier
the DT B-Entity
attacker NN I-Entity
's POS I-Entity
code NN I-Entity
has VBZ I-Entity
full JJ I-Entity
memory NN I-Entity
access NN I-Entity
through IN I-Entity
the DT I-Entity
corrupted VBN I-Entity
Flash NNP I-Entity
Vector NNP I-Entity
object NN I-Entity
, , O
the DT B-Entity
code NN I-Entity
searches NNS B-Action
through IN B-Modifier
loaded JJ B-Entity
libraries NNS I-Entity
gadgets NNS I-Entity
by IN B-Modifier
machine NN B-Entity
code NN I-Entity
. . O

The DT B-Entity
attacker NN I-Entity
then RB O
overwrites VBZ B-Action
the DT B-Entity
vftable JJ I-Entity
pointer NN I-Entity
of IN I-Entity
a DT I-Entity
flash.Media.Sound NN I-Entity
( FW I-Entity
) FW I-Entity
object NN I-Entity
in IN B-Modifier
memory NN B-Entity
to TO B-Modifier
point NN B-Entity
to TO I-Entity
the DT I-Entity
pivot JJ I-Entity
and CC O
begin VB B-Action
ROP NNP B-Entity
. . O

After IN O
successful JJ O
exploitation NN O
, , O
the DT O
code NN O
repairs NNS O
the DT O
corrupted JJ O
Flash NNP O
Vector NNP O
and CC O
flash.Media.Sound NNP O
to TO O
continue VB O
execution NN O
. . O

Subsequently NNP O
, , O
the DT B-Entity
malicious JJ I-Entity
Flash NNP I-Entity
code NN I-Entity
downloads NNS B-Action
a DT B-Entity
file NN I-Entity
containing VBG I-Entity
the DT I-Entity
dropped VBN I-Entity
malware NN I-Entity
payload NN I-Entity
. . O

The DT O
beginning NN O
of IN O
the DT O
file NN O
is VBZ O
a DT O
JPG NN O
image NN O
; : O
the DT O
end NN O
of IN O
the DT O
file NN O
( NNP O
offset VBD O
36321 CD O
) NN O
is VBZ O
the DT O
payload NN O
, , O
encoded VBN O
with IN O
an DT O
XOR NN O
key NN O
of IN O
0×95 CD O
. . O

The DT O
attacker NN O
appends VBZ O
the DT O
payload NN O
to TO O
the DT O
shellcode NN O
before IN O
pivoting VBG O
to TO O
code VB O
control NN O
. . O

Then RB O
, , O
when WRB B-Modifier
the DT B-Entity
shellcode NN I-Entity
is VBZ I-Entity
executed VBN I-Entity
, , O
the DT B-Entity
malware NN I-Entity
creates VBZ B-Action
files NNS B-Entity
'' '' I-Entity
sqlrenew.txt NN I-Entity
'' '' I-Entity
and CC I-Entity
'' '' I-Entity
stream.exe NNP I-Entity
'' '' I-Entity
. . O

The DT B-Entity
tail NN I-Entity
of IN I-Entity
the DT I-Entity
image NN I-Entity
file NN I-Entity
is VBZ B-Action
decoded VBN I-Action
, , I-Action
and CC I-Action
written VBN I-Action
to TO B-Modifier
these DT B-Entity
files NNS I-Entity
. . O

'' '' B-Entity
sqlrenew.txt NN I-Entity
'' '' I-Entity
is VBZ B-Action
then RB I-Action
executed VBN I-Action
with IN B-Modifier
the DT B-Entity
LoadLibraryA NNP I-Entity
Windows NNP I-Entity
API NNP I-Entity
call NN I-Entity
. . O

As IN O
documented VBN O
above RB O
, , O
this DT B-Entity
exploit VBP I-Entity
dropped VBN B-Action
an DT B-Entity
XOR NNP I-Entity
( NNP I-Entity
0×95 NNP I-Entity
) NNP I-Entity
payload NN I-Entity
that WDT O
executed VBD B-Action
a DT B-Entity
ZxShell NNP I-Entity
backdoor FW I-Entity
( FW I-Entity
MD5 NN I-Entity
: : I-Entity
8455bbb9a210ce603a1b646b0d951bce FW I-Entity
) FW I-Entity
. . O

The DT O
compile VBP O
date NN O
of IN O
the DT O
payload NN O
was VBD O
2014-02-11 CD O
, , O
and CC O
the DT O
last JJ O
modified JJ O
date NN O
of IN O
the DT O
exploit VBP O
code NN O
was VBD O
also RB O
2014-02-11 CD O
. . O

This DT O
suggests VBZ O
that IN O
this DT O
instantiation NN O
of IN O
the DT O
exploit VBP O
was VBD O
very RB O
recent JJ O
and CC O
was VBD O
deployed VBN O
for IN O
this DT O
specific JJ O
strategic JJ O
Web NN O
compromise NN O
of IN O
the DT O
Veterans NNP O
of IN O
Foreign NNP O
Wars NNP O
website NN O
. . O

A DT O
possible JJ O
objective NN O
in IN O
the DT O
SnowMan NNP O
attack NN O
is VBZ O
targeting VBG O
military JJ O
service NN O
members NNS O
to TO O
steal VB O
military JJ O
intelligence NN O
. . O

In IN O
addition NN O
to TO O
retirees NNS O
, , O
active JJ O
military JJ O
personnel NNS O
use VBP O
the DT O
VFW NNP O
website NN O
. . O

It PRP O
is VBZ O
probably RB O
no DT O
coincidence NN O
that IN O
Monday NNP O
, , O
Feb. NNP O
17 CD O
, , O
is VBZ O
a DT O
U.S. NNP O
holiday NN O
, , O
and CC O
much JJ O
of IN O
the DT O
U.S. NNP O
Capitol NNP O
shut VBD O
down RP O
Thursday NNP O
amid IN O
a DT O
severe JJ O
winter NN O
storm NN O
. . O

The DT B-Entity
ZxShell NNP I-Entity
backdoor NN I-Entity
is VBZ O
a DT O
widely RB O
used VBN O
and CC O
publicly RB O
available JJ O
tool NN O
used VBN B-Action
by IN O
multiple JJ B-Entity
threat NN I-Entity
actors NNS I-Entity
linked VBN I-Entity
to TO I-Entity
cyber VB I-Entity
espionage NN I-Entity
operations NNS I-Entity
. . O

This DT B-Entity
particular JJ I-Entity
variant NN I-Entity
called VBN B-Action
back RB B-Modifier
to TO I-Modifier
a DT B-Entity
command NN I-Entity
and CC I-Entity
control NN I-Entity
server NN I-Entity
located JJ I-Entity
at IN I-Entity
newss FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
effers FW I-Entity
[ FW I-Entity
. . I-Entity
] NN I-Entity
com NN I-Entity
. . O

This DT O
domain NN O
currently RB O
resolves VBZ O
to TO O
118.99.60.142 CD O
. . O

The DT O
domain NN O
info NN O
[ NN O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
also RB O
resolved VBN O
to TO O
this DT O
IP NNP O
address NN O
on IN O
2014-02-12 CD O
. . O

The DT O
info NN O
[ NN O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
domain NN O
overlaps VBZ O
with IN O
icybin FW O
[ FW O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
and CC O
book NN O
[ NN O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
via IN O
the DT O
previous JJ O
resolutions NNS O
to TO O
the DT O
following JJ O
IP NNP O
addresses NNS O
: : O
We PRP O
previously RB O
observed VBD O
Gh0stRat NN B-Entity
samples NNS I-Entity
with IN I-Entity
the DT I-Entity
custom NN I-Entity
packet NN I-Entity
flag NN I-Entity
'' '' I-Entity
HTTPS NNP I-Entity
'' '' I-Entity
calling VBG B-Action
back RB B-Modifier
to TO I-Modifier
book NN B-Entity
[ NN I-Entity
. . I-Entity
] FW I-Entity
flnet FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
org FW I-Entity
and CC I-Entity
icybin FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
flnet FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
org FW I-Entity
. . O

The DT O
threat NN O
actor NN O
responsible JJ O
for IN O
Operation NNP O
DeputyDog NNP O
also RB O
used VBD O
the DT O
'' '' O
HTTPS NNP O
'' '' O
version NN O
of IN O
the DT O
Gh0st NN O
. . O

We PRP O
also RB O
observed VBD O
another DT B-Entity
'' '' I-Entity
HTTPS NNP I-Entity
'' '' I-Entity
Gh0st NN I-Entity
variant NN I-Entity
connecting VBG B-Action
to TO B-Modifier
a DT B-Entity
related JJ I-Entity
command NN I-Entity
and CC I-Entity
control NN I-Entity
server NN I-Entity
at IN I-Entity
me FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
scieron FW I-Entity
[ FW I-Entity
. . I-Entity
] NN I-Entity
com NN I-Entity
. . O

The DT O
me FW O
[ FW O
. . O

] FW O
scieron FW O
[ FW O
. . O

] NN O
com NN O
domain NN O
previously RB O
resolved VBN O
to TO O
58.64.199.22 CD O
. . O

The DT O
book NN O
[ NN O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
domain NN O
also RB O
resolved VBD O
to TO O
another DT O
IP NNP O
in IN O
the DT O
same JJ O
subnet NN O
58.64.199.0/24 NN O
. . O

Specifically RB O
, , O
book NN O
[ NN O
. . O

] FW O
flnet FW O
[ FW O
. . O

] FW O
org FW O
previously RB O
resolved VBN O
to TO O
58.64.199.27 CD O
. . O

Others NNS O
domain NN O
seen VBN O
resolving VBG O
to TO O
this DT O
same JJ O
/24 NN O
subnet NN O
were VBD O
dll FW O
[ FW O
. . O

] FW O
freshdns FW O
[ FW O
. . O

] FW O
org FW O
, , O
ali FW O
[ FW O
. . O

] FW O
blankchair FW O
[ FW O
. . O

] NN O
com NN O
, , O
and CC O
cht FW O
[ FW O
. . O

] FW O
blankchair FW O
[ FW O
. . O

] NN O
com NN O
. . O

The DT O
domain NN O
dll FW O
[ FW O
. . O

] FW O
freshdns FW O
[ FW O
. . O

] FW O
org FW O
resolved VBN O
to TO O
58.64.199.25 CD O
. . O

Both DT O
ali FW O
[ FW O
. . O

] FW O
blankchair FW O
[ FW O
. . O

] NN O
com NN O
and CC O
cht FW O
[ FW O
. . O

] FW O
blankchair FW O
[ FW O
. . O

] NN O
com NN O
resolved VBN O
to TO O
58.64.199.22 CD O
. . O

A DT O
number NN O
of IN O
other JJ O
related JJ O
domains NNS O
resolve VBP O
to TO O
these DT O
IPs NNS O
and CC O
other JJ O
IPs NNS O
also RB O
in IN O
this DT O
/24 CD O
subnet NN O
. . O

For IN O
the DT O
purposes NNS O
of IN O
this DT O
blog NN O
, , O
we PRP O
've VBP O
chosen VBN O
to TO O
focus VB O
on IN O
those DT O
domains NNS O
and CC O
IP NNP O
that WDT O
relate VBP O
to TO O
the DT O
previously RB O
discussed VBN O
DeputyDog NNP O
and CC O
Ephemeral NNP O
Hydra NNP O
campaigns NNS O
. . O

You PRP O
may MD O
recall VB O
that IN O
dll FW B-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
freshdns FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
org FW I-Entity
, , I-Entity
ali FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
blankchair FW I-Entity
[ FW I-Entity
. . I-Entity
] NN I-Entity
com NN I-Entity
and CC I-Entity
cht FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
blankchair FW I-Entity
[ FW I-Entity
. . I-Entity
] NN I-Entity
com NN I-Entity
were VBD B-Action
all DT I-Action
linked VBN I-Action
to TO B-Modifier
both DT B-Entity
Operation NNP I-Entity
DeputyDog NNP I-Entity
and CC I-Entity
Operation NNP I-Entity
Ephemeral NNP I-Entity
Hydra NNP I-Entity
. . O

Figure NNP O
1 CD O
illustrates VBZ O
the DT O
infrastructure NN O
overlaps VBZ O
and CC O
connections NNS O
we PRP O
observed VBD O
between IN O
the DT O
strategic JJ O
Web NN O
compromise NN O
campaign NN O
leveraging VBG O
the DT O
VFW NNP O
's POS O
website NN O
, , O
the DT O
DeputyDog NNP O
, , O
and CC O
the DT O
Ephemeral NNP O
Hydra NNP O
operations NNS O
. . O

Other JJ O
tradecraft NN O
similarities NNS O
between IN O
the DT O
actor NN O
( CD O
s NN O
) NN O
responsible JJ O
for IN O
this DT O
campaign NN O
and CC O
the DT O
actor NN O
( CD O
s NN O
) NN O
responsible JJ O
for IN O
the DT O
DeputyDog/Ephemeral NNP O
Hydra NNP O
campaigns NNS O
include VBP O
: : O
We PRP O
observed VBD O
many JJ O
similarities NNS O
from IN O
the DT O
exploitation NN O
side NN O
as RB O
well RB O
. . O

At IN O
a DT O
high JJ O
level NN O
, , O
this DT O
attack NN O
and CC O
the DT O
CVE- NN O
2013-3163 CD O
attack NN O
both DT O
leveraged VBD O
a DT O
Flash NNP O
file NN O
that WDT O
orchestrated VBD O
the DT O
exploit VBP O
, , O
and CC O
would MD O
call VB O
back RB O
into IN O
IE JJ O
JavaScript NN O
to TO O
trigger VB O
an DT O
IE NN O
flaw NN O
. . O

The DT O
code NN O
within IN O
the DT O
Flash NNP O
files NNS O
from IN O
each DT O
attack NN O
are VBP O
extremely RB O
similar JJ O
. . O

They PRP B-Entity
build VBP B-Action
ROP NN B-Entity
chains NNS I-Entity
and CC O
shellcode VBP O
the DT O
same JJ O
way NN O
, , O
both DT O
choose VBP O
to TO O
corrupt JJ O
a DT O
Flash NNP O
Vector NNP O
object NN O
, , O
have VBP O
some DT O
identical JJ O
functions NNS O
with IN O
common JJ O
typos NNS O
, , O
and CC O
even RB O
share VBP O
the DT O
same JJ O
name NN O
. . O

These DT O
actors NNS O
have VBP O
previously RB O
targeted VBN O
a DT O
number NN O
of IN O
different JJ O
industries NNS O
, , O
including VBG O
: : O
The DT O
proven JJ O
ability NN O
to TO O
successfully RB O
deploy VB B-Action
a DT B-Entity
number NN I-Entity
of IN I-Entity
different JJ I-Entity
private JJ I-Entity
and CC I-Entity
public JJ I-Entity
RATs NNS I-Entity
using VBG B-Modifier
zero-day JJ B-Entity
exploits NNS I-Entity
against IN B-Modifier
high-profile JJ B-Entity
targets NNS I-Entity
likely RB O
indicates VBZ O
that IN O
this DT B-Entity
actor NN I-Entity
( CD I-Entity
s NN I-Entity
) NN I-Entity
will MD O
continue VB O
to TO O
operate VB O
in IN O
the DT O
mid JJ O
to TO O
long-term JJ O
. . O

This DT O
entry NN O
was VBD O
posted VBN O
in IN O
Advanced NNP O
Malware NNP O
, , O
Exploits NNP O
, , O
Targeted JJ O
Attack NN O
, , O
Threat NN O
Research NN O
, , O
Vulnerabilities NNS O
and CC O
tagged VBD O
0day JJ O
, , O
zero-day JJ O
by IN O
Darien NNP O
Kindlund NNP O
, , O
Dan NNP O
Caselden NNP O
, , O
Xiaobo NNP O
Chen NNP O
, , O
Ned NNP O
Moran NNP O
and CC O
Mike NNP O
Scott NNP O
. . O

Bookmark NNP O
the DT O
permalink NN O
. . O

