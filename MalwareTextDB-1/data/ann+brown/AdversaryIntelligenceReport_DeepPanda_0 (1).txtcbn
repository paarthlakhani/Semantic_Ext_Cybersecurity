In IN 0101000 O
late JJ 01111101011 O
December NNP 01111101001 O
2011 CD 011111100110 O
, , 1011100 O
CrowdStrike NNP 11101110101 O
, , 1011100 O
Inc. NNP 1011111111100111 O
received VBD 10100101101101 O
three CD 11111001101 O
binary JJ 001011010100 O
executable JJ 001001111100 O
files NNS 0011011110 O
that WDT 101111110 O
were VBD 101101000 O
suspected VBN 1010010110010 O
of IN 1000 O
having VBG 10111111111100 O
been VBN 10101101 O
involved VBN 101001110110 O
in IN 100110 O
a DT 11001 O
sophisticted JJ X O
attack NN 00101011100 O
against IN 10010110111 O
a DT 11001 O
large JJ 1111000110011 O
Fortune NN 01111101000 O
500 CD 0111111111111 O
company NN 0011000010 O
. . 0110 O

The DT 010000 O
files NNS 0011011110 O
were VBD 101101000 O
analyzed VBN 1010010110100 O
to TO 101100 O
understand VB 101010011101 O
first RB 1111010100 O
if IN 101111111111110 O
they PRP 10111100110 O
were VBD 101101000 O
in IN 100110 O
fact NN 00001101 O
malicious JJ 1111011111000 O
, , 1011100 O
and CC 101110111 O
the DT 11010 O
level NN 000110010 O
of IN 1000 O
sophistication NN 0001110101 O
of IN 1000 O
the DT 11010 O
samples NNS 0011011100 O
. . 0110 O

The DT 010000 O
samples NNS 0011011100 O
were VBD 101101000 O
clearly RB 1010111011011 O
malicious JJ 1111011111000 O
and CC 101110111 O
varied JJ 1010010111000 O
in IN 100110 O
sophistication NN 0001110101 O
. . 0110 O

All DT 0100111110 B-Entity
three CD 11111001101 I-Entity
samples NNS 0011011100 I-Entity
provided VBD 101001100001 B-Verb
remote JJ 11110111111100 B-Entity
access NN 10100011010 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
attacker NN 00101111100 I-Entity
, , 1011100 O
via IN 100101111011 B-Preposition
two CD 11111001100 B-Entity
Command NN 011110110100 I-Entity
and CC 101110111 I-Entity
Control NN 1110001011 I-Entity
( NN 01111000 I-Entity
C2 NN 1111011011000 I-Entity
) NN 011110100 I-Entity
servers NNS 00111010 I-Entity
. . 0110 O

One CD 010011101 B-Entity
sample NN 0010100000 I-Entity
is VBZ 101101010 O
typical JJ 1111000111010 O
of IN 1000 O
what WP 1011111111111001 O
is VBZ 101101010 O
commonly RB 1010111110011 O
referred VBN 10100010100 O
to TO 101100 O
as IN 10111111110 O
a DT 11001 O
'dropper NN X O
' '' 0111101010 O
because IN 1011111111111111 O
its PRP$ 11011101 O
primary JJ 11110101100 O
purpose NN 00011111011 O
is VBZ 101101010 O
to TO 101100 O
write VB 10101011111001 B-Verb
a DT 11001 B-Entity
malicious JJ 1111011111000 I-Entity
component NN 00101000011 I-Entity
to TO 101100 B-Preposition
disk NN 11100111111 B-Entity
and CC 101110111 O
connect VB 101000111101 O
it PRP 101111010 O
to TO 101100 O
the DT 11010 O
targeted VBN 1110000100 O
hosts NNS 001100110010 O
operating VBG 111000111111 O
system NN 001000000 O
. . 0110 O

The DT 010000 O
malicious JJ 1111011111000 O
component NN 00101000011 O
in IN 100110 O
this DT 110110 O
case NN 00001100 O
is VBZ 101101010 O
what WP 1011111111111001 O
is VBZ 101101010 O
commonly RB 1010111110011 O
referred VBN 10100010100 O
to TO 101100 O
as IN 10111111110 O
a DT 11001 O
Remote JJ 1110110101 O
Access NN 0111101101100 O
Tool NNP 011110110000 O
( NNP 01111000 O
RAT NNP 1110010010 O
) NNP 011110100 O
, , 1011100 O
this DT 110110 O
RAT NN 1110010010 O
is VBZ 101101010 O
manifested VBN X O
as IN 10111111110 O
a DT 11001 B-Entity
Dynamic NNP 111100010001 I-Entity
Link NNP 11110011110 I-Entity
Library NNP 011110110000 I-Entity
( FW 01111000 I-Entity
DLL FW 00101101110 I-Entity
) FW 011110100 I-Entity
installed VBN 101001011111101 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
. . 0110 O

The DT 010000 O
second JJ 11110101010 O
sample NN 0010100000 O
analyzed VBN 1010010110100 O
is VBZ 101101010 O
a DT 11001 O
dual JJ X O
use NN 10101011100 O
tool NN 001010001110 O
that WDT 101111110 O
can MD 10110111110 O
function VB 001010110111 O
both DT 11111011010 O
as IN 10111111110 O
a DT 11001 B-Entity
post NN 001010111101 I-Entity
exploitation NN 111000011110 I-Entity
tool NN 001010001110 I-Entity
used VBN 1010011010 O
to TO 101100 O
infect VB 101010011001 B-Verb
other JJ 111110010 B-Entity
systems NNS 00110011000 I-Entity
, , 1011100 O
download VB 10101011111010 B-Verb
additional JJ 111101111110110 B-Entity
tools NNS 0011001111011 I-Entity
, , 1011100 O
remove VB 10101001011 B-Verb
log NN 00100110011 B-Entity
data NNS 001111001 I-Entity
, , 1011100 O
and CC 101110111 O
itself PRP 10111111100010 B-Entity
be VB 10101100 B-Verb
used VBN 1010011010 I-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
backdoor NN 00101101000 I-Entity
. . 0110 O

The DT 010000 B-Entity
third JJ 11110011111 I-Entity
sample NN 0010100000 I-Entity
was VBD 101101011 O
a DT 11001 O
sophisticated JJ 111100010011 O
implant VBP 001011111110 O
that IN 101111110 O
in IN 100110 O
addition NN 0000010 O
to TO 101100 O
having VBG 10111111111100 B-Verb
multiple JJ 111110011101 B-Entity
communication NN 001111010000 I-Entity
capabilities NNS 0011001111001 I-Entity
, , 1011100 O
and CC 101110111 O
the DT 11010 O
ability NN 101000110011 O
to TO 101100 O
act VB 101010111111010 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
relay NN 1111011011011 I-Entity
for IN 10011111 I-Entity
other JJ 111110010 I-Entity
infected JJ 111101111000 I-Entity
hosts NNS 001100110010 I-Entity
, , 1011100 O
utilized VBD 1011111001111 B-Verb
a DT 11001 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
driver NN 00101101111 I-Entity
that WDT 101111110 O
can MD 10110111110 O
hide VB 101010011111 B-Verb
aspects NNS 0001110101 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
tool NN 001010001110 I-Entity
from IN 100101100 B-Preposition
user-mode JJ 0010111000 B-Entity
tools NNS 0011001111011 I-Entity
. . 0110 O

This DT 0100010 B-Entity
third JJ 11110011111 I-Entity
component NN 00101000011 I-Entity
is VBZ 101101010 B-Verb
likely RB 101011101100 I-Verb
used VBN 1010011010 I-Verb
for IN 10011111 B-Preposition
long-term JJ 1111001011011 O
implantation NN X O
and CC 101110111 O
intelligence NN 00100010110 B-Entity
gathering NN 111000111000 I-Entity
. . 0110 O

Some DT 010011100 O
AV NNP 111101111110101 O
engines NNS 001100111001 O
occasionally RB 1010111110011 O
identify VBP 101010011101 O
this DT 110110 O
sample NN 0010100000 O
as IN 10111111110 O
Derusbi NNP 1110111110001 O
Trojan NNP 001011010101 O
. . 0110 O

CrowdStrike NNP 11101110101 O
Intelligence NNP 01111011001110 O
Team NNP 0111101100011 O
has VBZ 1011011010 O
seen VBN 101001110010 O
Trojans NNPS 0011001101001 O
from IN 100101100 O
8 CD 01111111101100 O
different JJ 1111000000 O
builder NN 001011010110 O
variants NNS 00110100111 O
of IN 1000 O
this DT 110110 O
RAT NN 1110010010 O
, , 1011100 O
including VBG 101111111110111 O
64-bit JJ 1111011101110 O
versions NNS 0011010001 O
, , 1011100 O
used VBN 1010011010 O
in IN 100110 O
targeted VBN 1110000100 O
attacks NNS 001101100 O
in IN 100110 O
2011 CD 011111100110 O
against IN 10010110111 O
Defense NNP 1110111110010 O
, , 1011100 O
Energy/Power NNP X O
, , 1011100 O
and CC 101110111 O
Chemical NNP X O
Industries NNPS X O
in IN 100110 O
US NNP 1110110010 O
and CC 101110111 O
Japan NNP 0111111010 O
. . 0110 O

All DT 0100111110 O
of IN 1000 O
these DT 11111000 O
samples NNS 0011011100 O
reflect VBP 101010011101 O
common JJ 1111000111000 O
toolmarks NNS X O
and CC 101110111 O
tradecraft NN 111100100110 O
consistent JJ 10100100110 O
with IN 100100 O
Chinese JJ 111100110101 O
based JJ 10100101010 O
actors NNS 0010101000 O
who WP 10111100100 O
target VBP 111101111010 O
various JJ 111110011100 O
strategic JJ 1111001011011 O
interests NNS 11100101110 O
of IN 1000 O
the DT 11010 O
United NNP 1111111011 O
States NNPS 01111011110 O
including VBG 101111111110111 O
High NNP 0111101101010 O
Tech/Heavy NNP X O
Industry NNP 0011000011 O
, , 1011100 O
Non-Governmental NNP X O
Organizations NNP 01010101 O
( NNP 01111000 O
NGOs NNP X O
) NNP 011110100 O
, , 1011100 O
State/Federal NNP X O
Government NNP 11100101110 O
, , 1011100 O
Defense NNP 1110111110010 O
Industrial NNP 11101110100 O
Base NNP 01111101111 O
( NNP 01111000 O
DIB NNP 0111011010 O
) NNP 011110100 O
, , 1011100 O
and CC 101110111 O
organizations NNS 001100100011 O
with IN 100100 O
vast JJ 1111000110011 O
economic JJ 1111001011110 O
interests NNS 11100101110 O
. . 0110 O

This DT 0100010 O
report NN 001010111100 O
contains VBZ 1011111011111 O
an DT 11000 O
in-depth JJ 111100001011 O
technical JJ 111100100111 O
analysis NN 0001110110 O
of IN 1000 O
the DT 11010 O
samples NNS 0011011100 O
, , 1011100 O
detection/remediation/mitigation NN X O
information NN 001111000 O
, , 1011100 O
attribution NN 111000110010 O
intelligence NN 00100010110 O
, , 1011100 O
and CC 101110111 O
a DT 11001 O
conclusion NN 001011010100 O
aimed VBN 1010011011100 O
at IN 10011110 O
providing VBG 101111111111011 O
the DT 11010 O
reader NN 101000110011 O
with IN 100100 O
a DT 11001 O
synopsis NN X O
of IN 1000 O
the DT 11010 O
report NN 001010111100 O
. . 0110 O

The DT 010000 B-Entity
executable JJ 001001111100 I-Entity
14c04f88dc97aef3e9b516ef208a2bf5 NN X I-Entity
is VBZ 101101010 O
commonly RB 1010111110011 O
referred VBN 10100010100 O
to TO 101100 O
as IN 10111111110 O
a DT 11001 O
'dropper NN X O
' '' 0111101010 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
designed VBN 10100010111 O
with IN 100100 O
the DT 11010 O
purpose NN 00011111011 O
of IN 1000 O
extracting VBG 101111111111010 B-Verb
from IN 100101100 B-Preposition
itself PRP 10111111100010 B-Entity
a DT 11001 B-Entity
malicious JJ 1111011111000 I-Entity
payload NN 001001111000 I-Entity
and CC 101110111 O
to TO 101100 O
initialize VB X B-Verb
and CC 101110111 I-Verb
install VB 10101001000 I-Verb
it PRP 101111010 B-Entity
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
targeted VBN 1110000100 I-Entity
system NN 001000000 I-Entity
. . 0110 O

In IN 0101000 O
this DT 110110 O
case NN 00001100 O
, , 1011100 O
the DT 11010 B-Entity
malicious JJ 1111011111000 I-Entity
payload NN 001001111000 I-Entity
is VBZ 101101010 O
a DT 11001 O
Dynamic-Link NNP X O
Library NNP 011110110000 O
( NNP 01111000 O
DLL NNP 00101101110 O
) NNP 011110100 O
, , 1011100 O
which WDT 101111011 O
enables VBZ 101111100100 B-Verb
an DT 11000 B-Entity
attacker NN 00101111100 I-Entity
to TO 101100 B-Preposition
have VB 101101100 B-Entity
full JJ 1111000110101 I-Entity
control NN 111000100 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
system NN 001000000 I-Entity
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Wednesday NNP X O
May NNP 01111101001 O
4th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
11:04:24 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NN 01111000 O
equivalent JJ 10100001010 O
to TO 101100 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

Note VB 01010101 O
that IN 101111110 O
the DT 11010 O
timestamp NN 01110110111 O
is VBZ 101101010 O
in IN 100110 O
UTC NNP 011111110110 O
, , 1011100 O
however RB 010111 O
the DT 11010 O
relative JJ 101000110011 O
time NN 00011010 O
of IN 1000 O
day NN 001010110100 O
in IN 100110 O
China NNP 01111110110 O
is VBZ 101101010 O
provided VBN 101001100001 O
for IN 10011111 O
the DT 11010 O
benefit NN 101010111111000 O
of IN 1000 O
the DT 11010 O
reader NN 101000110011 O
. . 0110 O

The DT 010000 B-Entity
sample NN 0010100000 I-Entity
first RB 1111010100 O
resolves VBZ 101000111000 B-Verb
several JJ 111110011110 B-Entity
library NN 0010011111110 I-Entity
functions NNS 0011111011011 I-Entity
provided VBN 101001100001 I-Entity
by IN 1001110 I-Entity
Microsoft NNP 1110110111 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
LoadLibrary NNP 1111011011010 I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
and CC 101110111 I-Entity
GetProcAddress NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
Application NN 11110011001 I-Entity
Programming NNP X I-Entity
Interfaces NNPS X I-Entity
( FW 01111000 I-Entity
APIs FW 0111101101101 I-Entity
) FW 011110100 I-Entity
. . 0110 O

The DT 010000 O
imported VBN 10100100010 O
function NN 001010110111 O
names NNS 00111111011 O
are VBP 101101001 O
not RB 1010111100 O
encrypted VBN 10100100000 O
; : 0111100100 O
however RB 010111 O
, , 1011100 O
the DT 11010 O
function NN 001010110111 O
name NN 00111111010 O
is VBZ 101101010 O
minutely RB X O
obfuscated VBN 10100100011 O
by IN 1001110 O
a DT 11001 O
simple JJ 1111000111110 O
single JJ 111100011000 O
character NN 001111111001 O
substitution NN X O
: : 0111010 O
The DT 010000 B-Entity
dropper NN 001011010111 I-Entity
invokes VBZ X B-Verb
the DT 11010 B-Entity
SHGetSpecialFolderPath NN X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
API NN 0111101101101 I-Entity
supplying VBG 101111111111011 O
a DT 11001 O
Constant JJ X O
Special JJ 010001100 O
Item NN X O
ID NN 00111111000 O
List NN 01110111100 O
( FW 01111000 O
CSIDL FW X O
) NN 011110100 O
of IN 1000 O
'CSIDLCOMMONDOCUMENTS NN X O
' '' 0111101010 O
to TO 101100 O
identify VB 101010011101 O
the DT 11010 O
destination NN 111101111010 O
folder NN 0011111111100 O
for IN 10011111 O
the DT 11010 O
malicious JJ 1111011111000 O
DLL NNP 00101101110 O
payload NN 001001111000 O
. . 0110 O

The DT 010000 O
CSIDL NN X O
in IN 100110 O
this DT 110110 O
case NN 00001100 O
pints NNS X O
to TO 101100 O
: : 0111010 O
'' '' 0111101110 O
The DT 010000 O
file NN 00100100 O
system NN 001000000 O
directory NN 0011111111101 O
that WDT 101111110 O
contains VBZ 1011111011111 O
documents NNS 00100101100 O
that WDT 101111110 O
are VBP 101101001 O
common JJ 1111000111000 O
to TO 101100 O
all DT 1111101100 O
users NNS 001100100010 O
. . 0110 O

A DT 010001110 O
typical JJ 1111000111010 O
path NN 000110111 O
is VBZ 101101010 O
C NN 011100111 O
: : 0111010 O
\Documents NNS 011110110100 O
and CC 101110111 O
Settings\All FW 1110001010 O
Users\Documents FW X O
. . 0110 O

'' '' 0111101110 O
The DT 010000 B-Entity
dropper NN 001011010111 I-Entity
attempts VBZ 101000111010 O
to TO 101100 O
write VB 10101011111001 B-Verb
the DT 11010 B-Entity
malicious JJ 1111011111000 I-Entity
payload NN 001001111000 I-Entity
to TO 101100 B-Preposition
one CD 111110100 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
following JJ 111101000 I-Entity
names NNS 00111111011 I-Entity
, , 1011100 O
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
first JJ 1111010100 I-Entity
available JJ 1010011011110 I-Entity
name NN 00111111010 I-Entity
in IN 100110 I-Entity
this DT 110110 I-Entity
set NN 000101110 I-Entity
: : 0111010 O
The DT 010000 B-Entity
dropper NN 001011010111 I-Entity
sets VBZ 1011111001010 B-Verb
the DT 11010 B-Entity
creation NN 0001110101 I-Entity
and CC 101110111 I-Entity
last JJ 0010111000 I-Entity
written JJ 10100110111110 I-Entity
timestamp NN 01110110111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
newly RB 11110111110011 I-Entity
created VBN 1010011011000 I-Entity
file NN 00100100 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
date NN 1010101111011 I-Entity
2007-03-07 CD X I-Entity
00:00:00 CD X I-Entity
; : 0111100100 O
this DT 110110 O
allows VBZ 101111100100 O
the DT 11010 B-Entity
newly RB 11110111110011 I-Entity
created VBN 1010011011000 I-Entity
malicious JJ 1111011111000 I-Entity
DLL NNP 00101101110 I-Entity
to TO 101100 O
blend VB 101010011001 B-Verb
in RP 100110 I-Verb
with IN 100100 B-Preposition
other JJ 111110010 B-Entity
system NN 001000000 I-Entity
files NNS 0011011110 I-Entity
. . 0110 O

This DT 0100010 B-Entity
is VBZ 101101010 O
meant VBN 10100010111 O
to TO 101100 O
prevent VB 101010011010 B-Verb
identification NN 1110001101100 B-Entity
during IN 100101110110 B-Preposition
disk NN 11100111111 B-Entity
forensics NNS 0011110101100 I-Entity
using VBG 100101111110 O
a DT 11001 O
common JJ 1111000111000 O
investigative JJ 111000110011 O
technique NN 001010001101 O
called VBD 10100101000 O
a DT 11001 O
forensic JJ 1111000110110 O
analysis NN 0001110110 O
timeline NN 000101100 O
. . 0110 O

This DT 0100010 O
date NN 1010101111011 O
is VBZ 101101010 O
specified VBN 1111011101001 O
in IN 100110 O
the DT 11010 O
dropper NN 001011010111 O
code NN 001001010 O
and CC 101110111 O
does VBZ 1011011100 O
not RB 1010111100 O
change VB 101010111111011 O
across IN 10010111111101 O
multiple JJ 111110011101 O
infections NNS 001100111010 O
. . 0110 O

The DT 010000 B-Entity
malicious JJ 1111011111000 I-Entity
DLL NNP 00101101110 I-Entity
file NN 00100100 I-Entity
that WDT 101111110 I-Entity
is VBZ 101101010 I-Entity
dropped VBN 101001011111100 I-Entity
is VBZ 101101010 B-Verb
hidden VBN 11110001111110 I-Verb
in IN 100110 B-Preposition
a DT 11001 B-Entity
resource NN 001001111001 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
dropper NN 001011010111 I-Entity
binary JJ 001011010100 I-Entity
. . 0110 O

This DT 0100010 O
is VBZ 101101010 O
a DT 11001 O
relatively RB 1111111101 O
common JJ 1111000111000 O
technique NN 001010001101 O
used VBN 1010011010 O
by IN 1001110 O
malware NN 00101100 O
dropper NN 001011010111 O
files NNS 0011011110 O
to TO 101100 O
optimize VB X O
the DT 11010 O
number NN 00010100 O
of IN 1000 O
files NNS 0011011110 O
required VBN 10100001001 O
to TO 101100 O
infect VB 101010011001 O
a DT 11001 O
machine NN 0010000011 O
. . 0110 O

The DT 010000 O
resource NN 001001111001 O
language NN 11100101011 O
of IN 1000 O
the DT 11010 O
malicious JJ 1111011111000 O
DLL NNP 00101101110 O
is VBZ 101101010 O
set VBN 000101110 O
to TO 101100 O
'' '' 0111101110 O
Chinese NNP 111100110101 O
( NNP 01111000 O
Simplified NNP 0111111111010 O
) NNP 011110100 O
'' '' 0111101110 O
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
a DT 11001 O
compiler NN 0011110111010 O
artifact NN 0010101111110 O
which WDT 101111011 O
indicates VBZ 101111101100 O
the DT 11010 O
language NN 11100101011 O
setting VBG 1010010110000 O
on IN 1001010 O
the DT 11010 O
compiler NN 0011110111010 O
used VBN 1010011010 O
by IN 1001110 O
the DT 11010 O
person NN 001010110000 O
who WP 10111100100 O
built VBD 101001011111100 O
the DT 11010 O
binary JJ 001011010100 O
was VBD 101101011 O
set VBN 000101110 O
to TO 101100 O
'' '' 0111101110 O
Chinese NNP 111100110101 O
( NNP 01111000 O
Simplified NNP 0111111111010 O
) NNP 011110100 O
'' '' 0111101110 O
at IN 10011110 O
the DT 11010 O
time NN 00011010 O
the DT 11010 O
dropper NN 001011010111 O
was VBD 101101011 O
compiled VBN 1010011011010 O
. . 0110 O

The DT 010000 O
'MZ NN X O
' POS 0111101010 O
header NN 001111100011 O
which WDT 101111011 O
denotes VBZ X O
a DT 11001 O
binary JJ 001011010100 O
executable JJ 001001111100 O
file NN 00100100 O
of IN 1000 O
the DT 11010 O
dropped VBN 101001011111100 O
DLL NNP 00101101110 O
is VBZ 101101010 O
initially RB 1010111110100 O
obfuscated VBN 10100100011 O
. . 0110 O

When WRB 0101011101 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
writes VBZ 101111101000 B-Verb
the DT 11010 B-Entity
file NN 00100100 I-Entity
to TO 101100 B-Preposition
disk NN 11100111111 B-Entity
, , 1011100 O
the DT 11010 B-Entity
first JJ 1111010100 I-Entity
byte NN 11100100010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
file NN 00100100 I-Entity
is VBZ 101101010 I-Entity
'Z NN X I-Entity
' '' 0111101010 I-Entity
which WDT 101111011 O
prevents VBZ 1011111011101 B-Verb
the DT 11010 B-Entity
file NN 00100100 I-Entity
from IN 100101100 B-Preposition
executing VBG 101111111111010 O
or CC 101110110 O
being VBG 101011111000 B-Entity
detected VBN 101001100110 I-Entity
as IN 10111111110 I-Entity
an DT 11000 I-Entity
executable JJ 001001111100 I-Entity
by IN 1001110 I-Entity
many JJ 111110011111 I-Entity
defensive JJ 111100100100 I-Entity
tools NNS 0011001111011 I-Entity
. . 0110 O

The DT 010000 B-Entity
dropper NN 001011010111 I-Entity
subsequently RB 10101111111101 O
opens VBZ 101111101001 B-Verb
the DT 11010 B-Entity
dropped VBN 101001011111100 I-Entity
file NN 00100100 I-Entity
and CC 101110111 O
corrects VBZ X B-Verb
the DT 11010 B-Entity
header NN 001111100011 I-Entity
by IN 1001110 B-Preposition
writing VBG 0011001010 B-Entity
the DT 11010 I-Entity
'M VBP X I-Entity
' '' 0111101010 I-Entity
over IN 10010110101 I-Entity
the DT 11010 I-Entity
first JJ 1111010100 I-Entity
byte NN 11100100010 I-Entity
, , 1011100 O
allowing VBG 101111111110101 O
the DT 11010 O
file NN 00100100 O
to TO 101100 O
be VB 10101100 O
executed VBN 1010010111100 O
. . 0110 O

A DT 010001110 O
subroutine NN X O
to TO 101100 O
decompress VB X O
the DT 11010 O
dropped VBN 101001011111100 O
file NN 00100100 O
is VBZ 101101010 O
present JJ 101001011111111 O
as IN 10111111110 O
'dead NN X O
code NN 001001010 O
' POS 0111101010 O
( NN 01111000 O
code NN 001001010 O
that WDT 101111110 O
is VBZ 101101010 O
not RB 1010111100 O
used VBN 1010011010 O
) NN 011110100 O
in IN 100110 O
the DT 11010 O
binary JJ 001011010100 O
. . 0110 O

This DT 0100010 O
subroutine NN X O
will MD 10110111111 O
be VB 10101100 O
invoked VBN 10100101111010 O
on IN 1001010 O
the DT 11010 O
already RB 10101111101111 O
closed VBN 1010010111100 O
file NN 00100100 O
handle VB 101000110000 O
of IN 1000 O
the DT 11010 O
dropped VBN 101001011111100 O
file NN 00100100 O
in IN 100110 O
the DT 11010 O
present JJ 101001011111111 O
code NN 001001010 O
version NN 00011000 O
. . 0110 O

Since IN 010101101 O
the DT 11010 O
dropped VBN 101001011111100 O
resource NN 001001111001 O
is VBZ 101101010 O
not RB 1010111100 O
compressed VBN 10100100011 O
, , 1011100 O
the DT 11010 O
routine NN 0011111110111 O
fails VBZ 001111011011 O
. . 0110 O

This DT 0100010 O
indicates VBZ 101111101100 O
a DT 11001 O
low JJ 111100010111 O
sophistication NN 0001110101 O
modification NN 0001110011 O
to TO 101100 O
the DT 11010 O
original JJ 11110101111 O
dropper NN 001011010111 O
code NN 001001010 O
to TO 101100 O
make VB 101010011000 O
it PRP 101111010 O
work VB 1010101111000 O
with IN 100100 O
an DT 11000 O
uncompressed JJ X O
source NN 00100110111 O
. . 0110 O

The DT 010000 O
final JJ 111101111111100 O
step NN 001010001101 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
performs VBZ 1011111010110 O
is VBZ 101101010 O
to TO 101100 O
load VB 10101001000 B-Verb
the DT 11010 B-Entity
dropped VBN 101001011111100 I-Entity
DLL NNP 00101101110 I-Entity
into IN 10010111100 B-Preposition
its PRP$ 11011101 B-Entity
own JJ 0010001001 I-Entity
process NN 001001111011 I-Entity
space NN 0011110111100 I-Entity
; : 0111100100 O
it PRP 101111010 O
then RB 101011111110 O
resolves VBZ 101000111000 O
the DT 11010 O
export NN 101010111111110 O
'OpenINFOPerformanceData NN X O
' '' 0111101010 O
from IN 100101100 O
the DT 11010 O
DLL NNP 00101101110 O
and CC 101110111 O
invokes VBZ X O
it PRP 101111010 O
with IN 100100 O
the DT 11010 O
dropped VBN 101001011111100 O
DLL NNP 00101101110 O
's POS 10111010 O
filename NN 01110110111 O
as IN 10111111110 O
parameter NN 001111111001 O
. . 0110 O

This DT 0100010 B-Entity
export NN 101010111111110 I-Entity
then RB 101011111110 O
implements VBZ 1011111010110 B-Verb
the DT 11010 B-Entity
actual JJ 111101111111100 I-Entity
install VBP 10101001000 I-Entity
logic NN 000101100 I-Entity
to TO 101100 B-Preposition
maintain VB 10101000010 B-Entity
persistence NN 001100111010 I-Entity
and CC 101110111 O
invoke VB 10101001010 O
the DT 11010 O
main JJ 11110101101 O
routine NN 0011111110111 O
. . 0110 O

The DT 010000 O
dropper NN 001011010111 O
binary JJ 001011010100 O
contains VBZ 1011111011111 O
an DT 11000 O
icon NN 00001110 O
resource NN 001001111001 O
that WDT 101111110 O
resembles VBZ 1011111001011 O
the DT 11010 O
'Google NNP X O
Chrome NNP 00110010011 O
' POS 0111101010 O
browser NN 00100011010 O
icon NN 00001110 O
, , 1011100 O
the DT 11010 O
re- NN 111100101011 O
source NN 00100110111 O
language NN 11100101011 O
is VBZ 101101010 O
set VBN 000101110 O
to TO 101100 O
'' '' 0111101110 O
Chinese NNP 111100110101 O
( NNP 01111000 O
Simplified NNP 0111111111010 O
) NNP 011110100 O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
consistent JJ 10100100110 O
with IN 100100 O
the DT 11010 O
builder NN 001011010110 O
of IN 1000 O
the DT 11010 O
tool NN 001010001110 O
systems NNS 00110011000 O
language NN 11100101011 O
set VBN 000101110 O
to TO 101100 O
Chinese NNP 111100110101 O
. . 0110 O

The DT 010000 B-Entity
use NN 10101011100 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
Chrome NNP 00110010011 I-Entity
icon NN 00001110 I-Entity
may MD 101101111010 O
indicate VB 101010101111 O
a DT 11001 O
possible JJ 10100000110 O
attempt NN 101000110010 O
to TO 101100 O
socially RB 11110011101 B-Verb
engineer VB 11100000001 I-Verb
the DT 11010 B-Entity
intended JJ 10100001010 I-Entity
victim NN 111101111011 I-Entity
into IN 10010111100 B-Preposition
thinking VBG 0011110111001 B-Entity
the DT 11010 I-Entity
dropper NN 001011010111 I-Entity
was VBD 101101011 I-Entity
a DT 11001 I-Entity
legitimate JJ 11110111110010 I-Entity
file NN 00100100 I-Entity
associated VBN 10100100101 I-Entity
with IN 100100 I-Entity
Google NNP 111011111100 I-Entity
. . 0110 O

This DT 0100010 B-Entity
sample NN 0010100000 I-Entity
is VBZ 101101010 B-Verb
a DT 11001 B-Entity
'backdoor NN X I-Entity
' '' 0111101010 I-Entity
which WDT 101111011 O
is VBZ 101101010 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
dropped VBD 101001011111100 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
sample NN 0010100000 I-Entity
file NN 00100100 I-Entity
with IN 100100 O
an DT 11000 O
MD5 NN 01110110000 O
of IN 1000 O
14c04f88dc97aef3e9b516ef208a2bf5 NN X O
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Wednesday NNP X O
May NNP 01111101001 O
4th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
10:48:19 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NN 01111000 O
equivalent JJ 10100001010 O
to TO 101100 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

It PRP 01001010 O
is VBZ 101101010 O
instantiated VBN X O
when WRB 100101110010 O
it PRP 101111010 B-Entity
is VBZ 101101010 B-Verb
mapped VBN 10100010000 I-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
process NN 001001111011 I-Entity
space NN 0011110111100 I-Entity
of IN 1000 I-Entity
its PRP$ 11011101 I-Entity
dropped VBN 101001011111100 I-Entity
file NN 00100100 I-Entity
, , 1011100 O
and CC 101110111 O
its PRP$ 11011101 O
' POS 0111101010 O
export NN 101010111111110 O
named VBD 10100101001 O
'OpenINFOPerformanceData NN X O
' '' 0111101010 O
is VBZ 101101010 O
called VBN 10100101000 O
. . 0110 O

This DT 0100010 O
export NN 101010111111110 O
first RB 1111010100 O
attempts VBZ 101000111010 O
to TO 101100 O
stop VB 101010111111111 O
a DT 11001 O
service NN 001001111110 O
called VBN 10100101000 O
'' '' 0111101110 O
msupdate NN X O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
not RB 1010111100 O
a DT 11001 O
known JJ 1010000110 O
Microsoft NNP 1110110111 O
Windows NNP 1110110100 O
service NN 001001111110 O
despite IN 1011111111100111 O
the DT 11010 O
appearance NN 00011111111 O
. . 0110 O

If IN 0101011100 O
the DT 11010 O
service NN 001001111110 O
is VBZ 101101010 O
present JJ 101001011111111 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
replaces VBZ 1011111010111 B-Verb
its PRP$ 11011101 B-Entity
previous JJ 111100001000 I-Entity
instances NNS 00110100110 I-Entity
or CC 101110110 I-Entity
versions NNS 0011010001 I-Entity
of IN 1000 I-Entity
this DT 110110 I-Entity
backdoor NN 00101101000 I-Entity
. . 0110 O

After IN 01010101 O
attempting VBG 10100010100 O
to TO 101100 O
disable VB 101010011010 O
the DT 11010 O
existing VBG 111101111110101 O
service NN 001001111110 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
tries VBZ 101000111010 O
to TO 101100 O
install VB 10101001000 B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
with IN 100100 I-Entity
that DT 101111110 I-Entity
same JJ 111101001 I-Entity
name NN 00111111010 I-Entity
. . 0110 O

During IN 0101011110 O
installation NN 00100011111 O
, , 1011100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
attempts VBZ 101000111010 O
to TO 101100 O
use VB 10101011100 B-Verb
documented JJ 101001110011 B-Entity
APIs NNS 0111101101101 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
OpenSCManager NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
and CC 101110111 I-Entity
CreateService NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
to TO 101100 B-Preposition
initialize VB X B-Entity
itself PRP 10111111100010 I-Entity
as IN 10111111110 I-Entity
a DT 11001 I-Entity
persistent JJ 111100010000 I-Entity
Windows NNP 1110110100 I-Entity
service NN 001001111110 I-Entity
. . 0110 O

As IN 01010100 O
a DT 11001 O
precaution NN X O
, , 1011100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
writes VBZ 101111101000 B-Verb
settings NNS 0011111110110 B-Entity
directly RB 10101110000 B-Preposition
to TO 101100 I-Preposition
the DT 11010 B-Entity
Windows NNP 1110110100 I-Entity
Registry NNP 01111011001111 I-Entity
to TO 101100 O
accomplish VB 101010011100 O
the DT 11010 O
same JJ 111101001 O
goal NN 00011111011 O
if IN 101111111111110 O
installing VBG 101111111111010 O
the DT 11010 O
service NN 001001111110 O
with IN 100100 O
the DT 11010 O
documented VBN 101001110011 O
APIs NNS 0111101101101 O
fails VBZ 001111011011 O
. . 0110 O

The DT 010000 B-Entity
registry NN 111101110001 I-Entity
change NN 101010111111011 I-Entity
creates VBZ 1011111010110 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
key NN 001111111010 I-Entity
: : 0111010 O
Following VBG 0101011100 O
this DT 110110 O
, , 1011100 O
the DT 11010 B-Entity
subroutine NN X I-Entity
will MD 10110111111 O
set VB 000101110 B-Verb
the DT 11010 B-Entity
value NN 001111111000 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
'ServiceDLL NN X I-Entity
' '' 0111101010 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
module NN 00101101100 I-Entity
handle VB 101000110000 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
DLL NNP 00101101110 I-Entity
. . 0110 O

The DT 010000 B-Entity
next JJ 11110101011 I-Entity
key NN 001111111010 I-Entity
to TO 101100 O
be VB 10101100 B-Verb
changed VBN 10100101111011 I-Verb
is VBZ 101101010 O
: : 0111010 O
HKEYLOCALMACHINE\\SOFTWARE\\Microsoft\\Windows FW X O
NT\\CurrentVersion\\Svchost FW X O
, , 1011100 O
which WDT 101111011 O
will MD 10110111111 O
have VB 101101100 O
the DT 11010 B-Entity
'msupdate NN X I-Entity
' POS 0111101010 I-Entity
key JJ 001111111010 I-Entity
set NN 000101110 B-Verb
to TO 101100 B-Preposition
'msupdate NN X B-Entity
' '' 0111101010 I-Entity
. . 0110 O

The DT 010000 B-Entity
export NN 101010111111110 I-Entity
'CollectW3PerfData NN X I-Entity
' '' 0111101010 I-Entity
is VBZ 101101010 B-Verb
registered VBN 1010011011001 I-Verb
as IN 10111111110 B-Preposition
the DT 11010 B-Entity
main JJ 11110101101 I-Entity
function NN 001010110111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
DLL NNP 00101101110 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 O
installation NN 00100011111 O
of IN 1000 O
the DT 11010 O
new JJ 11110000010 O
service NN 001001111110 O
is VBZ 101101010 O
successful JJ 1111000111010 O
, , 1011100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
then RB 101011111110 O
starts VBZ 101111100000 B-Verb
the DT 11010 B-Entity
new JJ 11110000010 I-Entity
service NN 001001111110 I-Entity
and CC 101110111 O
exits NNS 1010010111001 O
. . 0110 O

If IN 0101011100 O
the DT 11010 O
installation NN 00100011111 O
fails VBZ 001111011011 O
, , 1011100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
spawns VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
new JJ 11110000010 I-Entity
process NN 001001111011 I-Entity
using VBG 100101111110 B-Preposition
rundll32.exe NN 111011111110 B-Entity
, , 1011100 O
this DT 110110 O
executable JJ 001001111100 O
will MD 10110111111 O
instantiate VB X O
the DT 11010 O
DLL NNP 00101101110 O
and CC 101110111 O
can MD 10110111110 O
call VB 10101010101 O
a DT 11001 O
specific JJ 111100001110 O
exported VBN 111101111111010 O
function NN 001010110111 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
case NN 00001100 O
of IN 1000 O
installation NN 00100011111 O
failure NN 111000110011 O
, , 1011100 O
rundll32.exe NN 111011111110 O
calls VBZ 101111100011 O
the DT 11010 O
main JJ 11110101101 O
functions NNS 0011111011011 O
export NN 101010111111110 O
'CollectW3PerfData NN X O
' '' 0111101010 O
. . 0110 O

The DT 010000 O
rundll32.exe NN 111011111110 O
is VBZ 101101010 O
instantiated VBN X O
with IN 100100 O
a DT 11001 O
new JJ 11110000010 O
NULL NNP X O
Security NNP 01111011001111 O
Identifier NNP X O
( FW 01111000 O
SID FW X O
) FW 011110100 O
( FW 01111000 O
S-1-0-0 FW X O
) FW 011110100 O
with IN 100100 O
permissions NNS 0011001111100 B-Entity
set VBN 000101110 B-Verb
to TO 101100 B-Preposition
grant VB 10101000010 B-Entity
all DT 1111101100 I-Entity
access NN 10100011010 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
file NN 00100100 I-Entity
. . 0110 O

This DT 0100010 B-Entity
allows VBZ 101111100100 B-Verb
any DT 11111011111 B-Entity
user NN 0010000110 I-Entity
to TO 101100 B-Preposition
have VB 101101100 B-Entity
complete JJ 1111000110101 I-Entity
control NN 111000100 I-Entity
over IN 10010110101 I-Entity
the DT 11010 I-Entity
machine NN 0010000011 I-Entity
, , 1011100 O
as IN 10111111110 O
rundll32.exe NN 111011111110 O
is VBZ 101101010 O
frequently RB 1010111110011 O
launched VBN 10100101111010 O
by IN 1001110 O
tasks NNS 0011001101001 O
such JJ 101111111010 O
as IN 10111111110 O
changing VBG 101111111111010 O
the DT 11010 O
time NN 00011010 O
, , 1011100 O
wallpaper NN X O
, , 1011100 O
or CC 101110110 O
other JJ 111110010 O
system NN 001000000 O
settings NNS 0011111110110 O
. . 0110 O

This DT 0100010 O
means VBZ 00101001011 O
that IN 101111110 O
after IN 100101110100 O
cleaning VBG X B-Verb
up RP 10111111100111 I-Verb
the DT 11010 B-Entity
components NNS 001111101000 I-Entity
dropped VBN 101001011111100 I-Entity
by IN 1001110 I-Entity
the DT 11010 I-Entity
malware NN 00101100 I-Entity
, , 1011100 O
the DT 11010 B-Entity
system NN 001000000 I-Entity
remains VBZ 101000110110 B-Verb
vulnerable JJ 1111011101110 B-Entity
to TO 101100 I-Entity
local JJ 111101111111110 I-Entity
attacks NNS 001101100 I-Entity
by IN 1001110 O
simply RB 10101111111110 O
overwriting VBG X O
the DT 11010 O
legitimate JJ 11110111110010 O
rundll32.exe NN 111011111110 O
executable JJ 001001111100 O
with IN 100100 O
a DT 11001 O
malicious JJ 1111011111000 O
version NN 00011000 O
and CC 101110111 O
await VB X O
it PRP 101111010 O
's POS 10111010 O
automatic JJ 111101111111011 O
execution NN 00100011110 O
by IN 1001110 O
the DT 11010 O
Operating NNP 0111101100100 O
System NNP 0111101101011 O
. . 0110 O

The DT 010000 O
main JJ 11110101101 O
entry NN 0010101110110 O
point NN 00101001001 O
to TO 101100 O
the DT 11010 O
DLL NNP 00101101110 O
is VBZ 101101010 O
named VBN 10100101001 O
'CollectW3PerfData NN X O
' '' 0111101010 O
, , 1011100 O
as IN 10111111110 O
it PRP 101111010 O
first RB 1111010100 O
creates VBZ 1011111010110 O
and CC 101110111 O
displays VBZ 10010111111100 O
a DT 11001 O
fake JJ 111100001101 O
Window NN X O
with IN 100100 O
class NN 0010011111110 O
'' '' 0111101110 O
NOD32 CD X O
% NN 011100000 O
d NN 0111011010 O
'' '' 0111101110 O
where WRB 101111111110100 O
% NN 011100000 O
d NN 0111011010 O
is VBZ 101101010 O
replaced VBN 101001100010 O
with IN 100100 O
a DT 11001 O
pseudo-random JJ X O
number NN 00010100 O
. . 0110 O

This DT 0100010 O
may MD 101101111010 O
be VB 10101100 O
an DT 11000 O
attempt NN 101000110010 O
to TO 101100 O
fool VB X B-Verb
some DT 11111011110 B-Entity
automated JJ 111100010001 I-Entity
dynamic JJ 111100010001 I-Entity
analysis NN 0001110110 I-Entity
or CC 101110110 I-Entity
anti-malware JJ X I-Entity
software NN 001100111011 I-Entity
into IN 10010111100 B-Preposition
believing VBG X B-Entity
this DT 110110 I-Entity
is VBZ 101101010 I-Entity
the DT 11010 I-Entity
legitimate JJ 11110111110010 I-Entity
ESET NN 11101110101 I-Entity
AV NN 111101111110101 I-Entity
software NN 001100111011 I-Entity
. . 0110 O

The DT 010000 O
window NN 0011111111001 O
is VBZ 101101010 O
however RB 010111 O
not RB 1010111100 O
visible JJ 10100110111111 O
and CC 101110111 O
implements VBZ 1011111010110 O
no DT 11111011101 O
specific JJ 111100001110 O
functionality NN 00011111001 O
. . 0110 O

After IN 01010101 O
creating VBG 101111111111011 O
this DT 110110 O
window NN 0011111111001 O
, , 1011100 O
the DT 11010 B-Entity
routine NN 0011111110111 I-Entity
starts VBZ 101111100000 O
the DT 11010 O
main JJ 11110101101 O
thread NN 00101101101 O
that WDT 101111110 O
eventually RB 10101111111110 O
initiates VBZ 101111101000 B-Verb
calling VBG 11101110111 B-Entity
out RP 1011111110010 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
Command NN 011110110100 I-Entity
and CC 101110111 I-Entity
Control NN 1110001011 I-Entity
( NN 01111000 I-Entity
C2 NN 1111011011000 I-Entity
) NN 011110100 I-Entity
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
accomplish VB 101010011100 O
this DT 110110 O
task NN 001111100001 O
, , 1011100 O
the DT 11010 O
newly RB 11110111110011 O
created VBN 1010011011000 O
thread NN 00101101101 O
initializes NNS 101111101000 O
networking VBG 11100000001 O
APIs NNS 0111101101101 O
using VBG 100101111110 O
WSAStartup NN X O
( FW 01111000 O
) FW 011110100 O
and CC 101110111 O
resolves VBZ 101000111000 O
some DT 11111011110 O
other JJ 111110010 O
APIs NNS 0111101101101 O
dynamically RB 10101111111110 O
using VBG 100101111110 O
LoadLibrary NNP 1111011011010 O
( NNP 01111000 O
) NNP 011110100 O
and CC 101110111 O
GetProcAddress NNP X O
( NNP 01111000 O
) NNP 011110100 O
. . 0110 O

Once RB 0101011101 O
the DT 11010 O
proper JJ 111100001100 O
API NNP 0111101101101 O
's POS 10111010 O
have VBP 101101100 O
been VBN 10101101 O
resolved VBN 10100010000 O
, , 1011100 O
the DT 11010 O
sample NN 0010100000 O
then RB 101011111110 O
assigns VBZ X O
a DT 11001 O
NULL NNP X O
SID NNP X O
to TO 101100 O
the DT 11010 O
rundll32.exe NN 111011111110 O
executable JJ 001001111100 O
and CC 101110111 O
sets VBZ 1011111001010 O
the DT 11010 O
current JJ 111101111111111 O
process NN 001001111011 O
' '' 0111101010 O
Window NNP X O
Station NNP X O
to TO 101100 O
'' '' 0111101110 O
winsta0 NN X O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
enables VBZ 101111100100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
to TO 101100 O
access VB 10100011010 B-Verb
the DT 11010 B-Entity
real JJ 111100001100 I-Entity
user NN 0010000110 I-Entity
's POS 10111010 I-Entity
desktop NN 111000110010 I-Entity
if IN 101111111111110 B-Preposition
started VBN 10100101110111 B-Entity
as IN 10111111110 I-Entity
service NN 001001111110 I-Entity
. . 0110 O

The DT 010000 B-Entity
communication NN 001111010000 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
is VBZ 101101010 B-Verb
handled VBN 101001100010 I-Verb
by IN 1001110 B-Preposition
a DT 11001 B-Entity
while NN 1011111111100111 I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
loop NN 0011110111111 I-Entity
, , 1011100 O
with IN 100100 O
each DT 1111101010 O
successive JJ X O
connection NN 001111010001 O
attempt NN 101000110010 O
causing VBG 10111111111100 O
the DT 11010 O
loop NN 0011110111111 O
to TO 101100 O
invoke VB 10101001010 O
the DT 11010 O
Windows NNP 1110110100 O
Sleep NNP 01110111100 O
( NNP 01111000 O
) NNP 011110100 O
API NNP 0111101101101 O
for IN 10011111 O
a DT 11001 O
time NN 00011010 O
interval NN 001010001100 O
of IN 1000 O
2 CD 0111111110100 O
seconds NNS 0011010100 O
, , 1011100 O
exponentially RB X O
increasing VBG 1111111010 O
in IN 100110 O
length NN 00011111111 O
up IN 10111111100111 O
to TO 101100 O
1024 CD 011111111100 O
seconds NNS 0011010100 O
( CD 01111000 O
17 CD 01111111101101 O
minutes NNS 0011010100 O
) NN 011110100 O
and CC 101110111 O
then RB 101011111110 O
restarting VBG X O
back RB 101000110111 O
to TO 101100 O
2 CD 0111111110100 O
seconds NNS 0011010100 O
. . 0110 O

The DT 010000 O
C2 NN 1111011011000 O
location NN 001111100001 O
in IN 100110 O
this DT 110110 O
sample NN 0010100000 O
is VBZ 101101010 O
statically RB X O
defined VBN 101001100110 O
as IN 10111111110 O
1.9.5.38:443 NNP X O
( NNP 01111000 O
Malaysia NNP 010111 O
: : 0111010 O
Tmnet NNP X O
, , 1011100 O
Telekom NNP X O
Malaysia NNP 010111 O
Bhd NNP X O
) NNP 011110100 O
. . 0110 O

While IN 010101101 O
ther NN X O
is VBZ 101101010 O
'dead JJ X O
code NN 001001010 O
' '' 0111101010 O
that WDT 101111110 O
will MD 10110111111 O
download VB 10101011111010 O
the DT 11010 O
C2 NN 1111011011000 O
location NN 001111100001 O
from IN 100101100 O
an DT 11000 O
HTTP NN 111101101010 O
URL NN 001111100100 O
that WDT 101111110 O
could MD 101101111000 O
be VB 10101100 O
defined VBN 101001100110 O
in IN 100110 O
the DT 11010 O
binary JJ 001011010100 O
, , 1011100 O
using VBG 100101111110 O
the DT 11010 O
User-Agent JJ 001111100111 O
string NN 001001110110 O
'' '' 0111101110 O
Google NNP 111011111100 O
'' '' 0111101110 O
, , 1011100 O
this DT 110110 O
code NN 001001010 O
is VBZ 101101010 O
not RB 1010111100 O
activated VBN 10100101111011 O
due JJ 10100010100 O
to TO 101100 O
the DT 11010 O
format NN 001111100111 O
of IN 1000 O
the DT 11010 O
stat- NN X O
ically RB X O
defined VBN 101001100110 O
C2 NN 1111011011000 O
location NN 001111100001 O
using VBG 100101111110 O
an DT 11000 O
IP NNP 1111011000 O
address NN 00111000 O
. . 0110 O

Thus RB 010110 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
will MD 10110111111 O
only RB 10101110010 O
attempt VB 101000110010 O
to TO 101100 O
connect VB 101000111101 B-Verb
directly RB 10101110000 O
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
raw JJ 111101111111110 I-Entity
socket NN 001001111001 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
located JJ 101001110101 I-Entity
at IN 10011110 I-Entity
1.9.5.38:443 CD X I-Entity
. . 0110 O

This DT 0100010 O
indicates VBZ 101111101100 O
the DT 11010 O
use NN 10101011100 O
of IN 1000 O
a DT 11001 O
'boiler NN X O
plate NN X O
code NN 001001010 O
' '' 0111101010 O
or CC 101110110 O
a DT 11001 O
builder NN 001011010110 O
software NN 001100111011 O
package NN 0011111111010 O
that WDT 101111110 O
automates VBZ X O
the DT 11010 O
creation NN 0001110101 O
of IN 1000 O
the DT 11010 O
malicious JJ 1111011111000 O
sample NN 0010100000 O
. . 0110 O

The DT 010000 B-Entity
malicious JJ 1111011111000 I-Entity
sample NN 0010100000 I-Entity
sends VBZ 101111101000 B-Verb
an DT 11000 B-Entity
initial JJ 111101111111101 I-Entity
beacon NN 00101001000 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
that WDT 101111110 O
includes VBZ 1011111011101 O
the DT 11010 O
following JJ 111101000 O
information NN 001111000 O
: : 0111010 O
The DT 010000 B-Entity
beacon NN 00101001000 I-Entity
is VBZ 101101010 B-Verb
encrypted VBN 10100100000 I-Verb
using VBG 100101111110 B-Preposition
an DT 11000 B-Entity
XOR/ADD NN X I-Entity
loop NN 0011110111111 I-Entity
using VBG 100101111110 I-Entity
the DT 11010 I-Entity
statically RB X I-Entity
defined VBN 101001100110 I-Entity
key JJ 001111111010 I-Entity
0x1C NN X I-Entity
and CC 101110111 O
sent VBN 10100110111011 B-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

The DT 010000 O
following VBG 111101000 O
python NN X O
function NN 001010110111 O
can MD 10110111110 O
be VB 10101100 O
used VBN 1010011010 O
to TO 101100 O
decode VB 10101001010 O
the DT 11010 O
beacon NN 00101001000 O
stings VBZ X O
: : 0111010 O
After IN 01010101 O
sending VBG 101111111111011 B-Verb
the DT 11010 B-Entity
initial JJ 111101111111101 I-Entity
beacon NN 00101001000 I-Entity
, , 1011100 O
the DT 11010 B-Entity
routine JJ 0011111110111 I-Entity
loops NNS X O
receiving VBG 11111011011 B-Verb
incoming JJ 11110110100 B-Entity
commands NNS 001111101100 I-Entity
and CC 101110111 O
executes VBZ 101111101001 B-Verb
them PRP 1011111110000 B-Entity
in IN 100110 O
sequence NN 000110011 O
. . 0110 O

When WRB 0101011101 O
a DT 11001 O
connection NN 001111010001 O
can MD 10110111110 O
successfully RB 1010111110110 O
be VB 10101100 O
established VBN 1110011010 O
to TO 101100 O
the DT 11010 O
C2 NN 1111011011000 O
server NN 00111011 O
, , 1011100 O
the DT 11010 O
sleep NN 1111000111011 O
timer NN X O
is VBZ 101101010 O
reset JJ X O
to TO 101100 O
two CD 11111001100 O
seconds NNS 0011010100 O
for IN 10011111 O
the DT 11010 O
next JJ 11110101011 O
attempt NN 101000110010 O
. . 0110 O

The DT 010000 O
network NN 001000010 O
protocol NN 0011110111110 O
used VBN 1010011010 O
by IN 1001110 O
this DT 110110 O
sample NN 0010100000 O
resembles VBZ 1011111001011 O
a DT 11001 O
'Type-Length-Value NN X O
' POS 0111101010 O
layout NN 0011110111111 O
in IN 100110 O
both DT 11111011010 O
directions NNS X O
. . 0110 O

Each DT 0100011011 O
16 CD 0111111111101 O
byte NN 11100100010 O
request NN 001111010100 O
header NN 001111100011 O
consists VBZ 00010010 O
of IN 1000 O
: : 0111010 O
Zero NNP X O
or CC 101110110 O
more JJR 1111111110 O
of IN 1000 O
specified JJ 1111011101001 O
bytes NNS 11100101111 O
of IN 1000 O
additional JJ 111101111110110 O
payload NN 001001111000 O
then RB 101011111110 O
follows VBZ 01110110001 O
the DT 11010 O
header NN 001111100011 O
. . 0110 O

This DT 0100010 B-Entity
inbound JJ 111100001000 I-Entity
payload NN 001001111000 I-Entity
is VBZ 101101010 B-Verb
received VBN 10100101101101 I-Verb
unconditionally RB X O
and CC 101110111 O
regardless RB 00010010 O
of IN 1000 O
command NN 0010011100 O
type NN 000110011 O
into IN 10010111100 O
a DT 11001 O
fixed-size NN X O
stack VB 001001111001 O
buffer NN 0010011111111 O
of IN 1000 O
408 CD X O
bytes NNS 11100101111 O
size NN 00011111010 O
. . 0110 O

Providing VBG X O
additional JJ 111101111110110 O
payload NN 001001111000 O
of IN 1000 O
any DT 11111011111 O
larger JJR 1111000110010 O
size NN 00011111010 O
will MD 10110111111 O
result VB 000101100 O
in IN 100110 O
a DT 11001 O
trivial JJ X O
exploitable JJ X O
stack VBP 001001111001 O
buffer NN 0010011111111 O
overflow NN X O
that WDT 101111110 O
allows VBZ 101111100100 O
arbitrary JJ 111101111110100 O
code NN 001001010 O
execution NN 00100011110 O
due JJ 10100010100 O
to TO 101100 O
the DT 11010 O
absence NN 0001111011 O
of IN 1000 O
any DT 11111011111 O
security NN 11100011010 O
features NNS 0011111011010 O
. . 0110 O

However RB 010110 O
, , 1011100 O
exploitation NN 111000011110 O
of IN 1000 O
this DT 110110 O
vulnerability NN 001010110101 O
is VBZ 101101010 O
unnecessary JJ X O
due JJ 10100010100 O
to TO 101100 O
the DT 11010 O
already RB 10101111101111 O
available JJ 1010011011110 O
unauthenticated JJ X O
command NN 0010011100 O
execution NN 00100011110 O
capabilities NNS 0011001111001 O
of IN 1000 O
this DT 110110 O
backdoor NN 00101101000 O
. . 0110 O

Certain JJ X O
commands NNS 001111101100 O
initiate VBP 10101000010 O
a DT 11001 O
second JJ 11110101010 O
connection NN 001111010001 O
to TO 101100 O
the DT 11010 O
C2 NN 1111011011000 O
in IN 100110 O
a DT 11001 O
separate JJ 111100000110 O
thread NN 00101101101 O
using VBG 100101111110 O
the DT 11010 O
same JJ 111101001 O
network NN 001000010 O
protocol NN 0011110111110 O
but CC 10111111111000 O
providing VBG 101111111111011 O
a DT 11001 O
different JJ 1111000000 O
request NN 001111010100 O
command NN 0010011100 O
identifier NN 00111111000 O
than IN 011110111110 O
for IN 10011111 O
the DT 11010 O
initial JJ 111101111111101 O
beacon NN 00101001000 O
. . 0110 O

The DT 010000 B-Entity
primary JJ 11110101100 I-Entity
aim NN 101000111110 I-Entity
of IN 1000 I-Entity
this DT 110110 I-Entity
backdoor NN 00101101000 I-Entity
is VBZ 101101010 B-Verb
remote JJ 11110111111100 B-Entity
desktop NN 111000110010 I-Entity
control NN 111000100 I-Entity
functionality NN 00011111001 I-Entity
comparable JJ X I-Entity
to TO 101100 I-Entity
VNC NNP X I-Entity
or CC 101110110 I-Entity
Remote NNP 1110110101 I-Entity
Desktop NNP 0111101101100 I-Entity
over IN 10010110101 I-Entity
a DT 11001 I-Entity
custom NN 11110001111111 I-Entity
protocol NN 0011110111110 I-Entity
. . 0110 O

It PRP 01001010 O
allows VBZ 101111100100 O
the DT 11010 B-Entity
adversary NN 001011111110 I-Entity
to TO 101100 O
view VB 0001011111 B-Verb
the DT 11010 B-Entity
main JJ 11110101101 I-Entity
desktop NN 111000110010 I-Entity
graphically RB X B-Entity
and CC 101110111 O
control VBP 111000100 B-Verb
the DT 11010 B-Entity
keyboard NN 11100000111 I-Entity
and CC 101110111 O
mouse NN 11110111111000 B-Entity
. . 0110 O

This DT 0100010 B-Entity
remote JJ 11110111111100 I-Entity
control NN 111000100 I-Entity
functionality NN 00011111001 I-Entity
is VBZ 101101010 B-Verb
implemented VBN 10100101111011 I-Verb
as IN 10111111110 B-Preposition
separate JJ 111100000110 B-Entity
messages NNS 00110111111 I-Entity
for IN 10011111 I-Entity
mouse NN 11110111111000 I-Entity
clicks NNS 001111011010 I-Entity
, , 1011100 I-Entity
pressed VBN X I-Entity
keys NNS 0011111110111 I-Entity
, , 1011100 I-Entity
etc FW 01110111001 I-Entity
. . 0110 I-Entity

using VBG 100101111110 B-Preposition
command NN 0010011100 B-Entity
identifiers NNS 00111111000 I-Entity
0x20000002 CD X I-Entity
to TO 101100 I-Entity
0x20000019 CD X I-Entity
. . 0110 O

The DT 010000 B-Entity
command NN 0010011100 I-Entity
0x22000001 NN X I-Entity
initiates VBZ 101111101000 B-Verb
continuous JJ 111100001111 B-Entity
transmission NN 0001110001 I-Entity
of IN 1000 I-Entity
screen NN 00100011010 I-Entity
captures VBZ 001111010101 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

The DT 010000 B-Entity
screen NN 00100011010 I-Entity
captures VBZ 001111010101 I-Entity
are VBP 101101001 B-Verb
created VBN 1010011011000 I-Verb
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
series NN 00010101 I-Entity
of IN 1000 I-Entity
Microsoft NNP 1110110111 I-Entity
Windows NNP 1110110100 I-Entity
Graphic NNP X I-Entity
Device NNP 0111011111101 I-Entity
Interface NNP 0111101100011 I-Entity
( NNP 01111000 I-Entity
GDI NNP X I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
calls VBZ 101111100011 I-Entity
culminating VBG X I-Entity
in IN 100110 I-Entity
a DT 11001 I-Entity
call NN 10101010101 I-Entity
to TO 101100 I-Entity
GetDIBits NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

Command NN 011110110100 O
0x20000001 NN X O
exits NNS 1010010111001 O
the DT 11010 O
backdoor NN 00101101000 O
and CC 101110111 O
0x20000000 NN X B-Entity
is VBZ 101101010 O
issued VBN 1010011000110 O
to TO 101100 O
completely RB 1010111110110 O
remove VB 10101001011 B-Verb
the DT 11010 B-Entity
backdoor NN 00101101000 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
system NN 001000000 I-Entity
. . 0110 O

When WRB 0101011101 O
command NN 0010011100 O
0x23000004 NN X O
is VBZ 101101010 O
received VBN 10100101101101 O
, , 1011100 O
a DT 11001 B-Entity
temporary JJ 11110111110101 I-Entity
new JJ 11110000010 I-Entity
user NN 0010000110 I-Entity
'' '' 0111101110 I-Entity
DomainUser NN X I-Entity
'' '' 0111101110 I-Entity
with IN 100100 I-Entity
password NN 11100100110 I-Entity
'' '' 0111101110 I-Entity
Dom4 NN X I-Entity
! . 01110111111110 I-Entity
nU- FW X I-Entity
serP4ss FW X I-Entity
'' '' 0111101110 I-Entity
is VBZ 101101010 B-Verb
created VBN 1010011011000 I-Verb
and CC 101110111 O
added VBN 10100001001 B-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
local JJ 111101111111110 I-Entity
Administrators NNPS X I-Entity
group NN 00101010110 I-Entity
. . 0110 O

The DT 010000 B-Entity
backdoor NN 00101101000 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
started VBN 10100101110111 I-Verb
under IN 10010111111110 B-Preposition
that DT 101111110 B-Entity
account NN 0011110111001 I-Entity
and CC 101110111 O
the DT 11010 B-Entity
user NN 0010000110 I-Entity
is VBZ 101101010 B-Verb
deleted VBN 10100101111010 I-Verb
. . 0110 O

It PRP 01001010 O
would MD 1011011110011 O
appear VB 101000111111 O
this DT 110110 B-Entity
technique NN 001010001101 I-Entity
is VBZ 101101010 O
meant VBN 10100010111 O
to TO 101100 O
obfuscate VB 101010011111 B-Verb
the DT 11010 B-Entity
activities NNS 001100011101 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
malicious JJ 1111011111000 I-Entity
sample NN 0010100000 I-Entity
by IN 1001110 B-Preposition
masking VBG X B-Entity
the DT 11010 I-Entity
process NN 001001111011 I-Entity
creator NN 00001110 I-Entity
's POS 10111010 I-Entity
user NN 0010000110 I-Entity
name NN 00111111010 I-Entity
to TO 101100 I-Entity
appear VB 101000111111 I-Entity
to TO 101100 I-Entity
be VB 10101100 I-Entity
a DT 11001 I-Entity
generic JJ 11110001111111 I-Entity
domain NN 0010011010 I-Entity
user NN 0010000110 I-Entity
. . 0110 O

Note VB 01010101 O
that IN 101111110 O
such PDT 101111111010 O
an DT 11000 O
account NN 0011110111001 O
does VBZ 1011011100 O
not RB 1010111100 O
normally RB 1010111011111 O
exist VB 1010010111000 O
in IN 100110 O
an DT 11000 O
Active JJ 1110110010 O
Directory NNP 0111111111110 O
environment NN 001100011111 O
. . 0110 O

Additionally RB 010110 O
, , 1011100 O
the DT 11010 O
primary JJ 11110101100 O
C2 NN 1111011011000 O
connection NN 001111010001 O
allows VBZ 101111100100 O
for IN 10011111 O
requests NNS 001111010101 O
to TO 101100 O
start VB 101010111111000 O
additional JJ 111101111110110 O
connections NNS 0011110100101 O
to TO 101100 O
the DT 11010 O
C2 NN 1111011011000 O
imple- NN X O
menting VBG X O
the DT 11010 O
following JJ 111101000 O
functionality NN 00011111001 O
: : 0111010 O
This DT 0100010 O
sample NN 0010100000 O
is VBZ 101101010 O
typical JJ 1111000111010 O
of IN 1000 O
a DT 11001 O
post NN 001010111101 O
exploitation NN 111000011110 O
tool NN 001010001110 O
; : 0111100100 O
it PRP 101111010 O
is VBZ 101101010 O
written VBN 10100110111110 O
in IN 100110 O
.NET NN 01111001010 O

2.0 CD 0111111110101 O
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Thursday NNP 01111101010 O
May NNP 01111101001 O
26th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
10:21:44 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

The DT 010000 O
backdoor JJ 00101101000 O
functionality NN 00011111001 O
can MD 10110111110 O
be VB 10101100 O
instantiated VBN X O
either CC 1010111011100 O
directly RB 10101110000 O
from IN 100101100 O
the DT 11010 O
command NN 0010011100 O
line NN 01111001011 O
or CC 101110110 O
through IN 100101111010 O
commands NNS 001111101100 B-Entity
issued VBN 1010011000110 B-Verb
over IN 10010110101 B-Preposition
a DT 11001 B-Entity
network NN 001000010 I-Entity
based JJ 10100101010 I-Entity
protocol NN 0011110111110 I-Entity
via IN 100101111011 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

If IN 0101011100 O
no DT 11111011101 O
arguments NNS 0011111011100 O
are VBP 101101001 O
given VBN 101000001111 O
, , 1011100 O
a DT 11001 B-Entity
connection NN 001111010001 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
is VBZ 101101010 B-Verb
initiated VBN 1010011000111 I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
stati- NN X I-Entity
cally RB X I-Entity
defined VBN 101001100110 I-Entity
IP NNP 1111011000 I-Entity
address NN 00111000 I-Entity
. . 0110 O

The DT 010000 B-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
options NNS 0011111011011 I-Entity
support VBP 101010111111111 B-Verb
post NN 001010111101 O
exploitation NN 111000011110 O
capabilities NNS 0011001111001 O
such JJ 101111111010 O
as IN 10111111110 O
changing VBG 101111111111010 B-Entity
file NN 00100100 I-Entity
timestamps NNS 000110110 I-Entity
, , 1011100 O
forensic JJ 1111000110110 B-Entity
mitigation NN 1110001101111 I-Entity
, , 1011100 O
privilege NN 111000110010 B-Entity
escalation NN 111000110011 I-Entity
, , 1011100 O
launching VBG 00100011111 B-Entity
the DT 11010 I-Entity
executable JJ 001001111100 I-Entity
, , 1011100 O
and CC 101110111 O
specifying VBG X B-Entity
a DT 11001 I-Entity
specific JJ 111100001110 I-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

One CD 010011101 O
interesting JJ 10100000101 O
command NN 0010011100 O
line NN 01111001011 O
option NN 001010111110 O
allows VBZ 101111100100 O
the DT 11010 B-Entity
backdoor NN 00101101000 I-Entity
to TO 101100 O
filter NN 1111011101111 B-Verb
the DT 11010 B-Entity
contents NNS 0001111010 I-Entity
of IN 1000 I-Entity
specified JJ 1111011101001 I-Entity
files NNS 0011011110 I-Entity
to TO 101100 O
remove VB 10101001011 B-Verb
content NN 001111100110 B-Entity
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
regular JJ 111100001101 I-Entity
expression NN X I-Entity
( NN 01111000 I-Entity
regex NN 1111011101101 I-Entity
) NN 011110100 I-Entity
. . 0110 O

This DT 0100010 B-Entity
command NN 0010011100 I-Entity
then RB 101011111110 O
modifies VBZ 10010111111100 B-Verb
the DT 11010 B-Entity
creation NN 0001110101 I-Entity
, , 1011100 I-Entity
modification NN 0001110011 I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
last JJ 0010111000 I-Entity
access NN 10100011010 I-Entity
timestamps NNS 000110110 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
modified VBN 1010010110010 I-Entity
file NN 00100100 I-Entity
to TO 101100 B-Preposition
conceal VB 101010011111 B-Entity
the DT 11010 I-Entity
content NN 001111100110 I-Entity
modifications NNS 0011110100100 I-Entity
. . 0110 O

A DT 010001110 O
detailed JJ 1111000110100 O
listing NN 0011111111111 O
of IN 1000 O
command NN 0010011100 O
line NN 01111001011 O
arguments NNS 0011111011100 O
can MD 10110111110 O
be VB 10101100 O
viewed VBN 111000111100 O
in IN 100110 O
Appendix NN 01111101110 O
A NN 010001110 O
. . 0110 O

This DT 0100010 B-Entity
activity NN 00110001011 I-Entity
is VBZ 101101010 B-Verb
generally RB 10101111111101 I-Verb
associated VBN 10100100101 I-Verb
with IN 100100 B-Preposition
log NN 00100110011 B-Entity
cleaning NN X I-Entity
to TO 101100 I-Entity
com- FW 11100000100 I-Entity
plicate FW X I-Entity
a DT 11001 I-Entity
forensic JJ 1111000110110 I-Entity
investigation NN 00100010100 I-Entity
. . 0110 O

The DT 010000 O
sample NN 0010100000 O
contains VBZ 1011111011111 O
an DT 11000 O
embedded JJ 1111011101000 O
IP NNP 1111011000 O
address NN 00111000 O
for IN 10011111 O
C2 NN 1111011011000 O
that WDT 101111110 O
is VBZ 101101010 O
stored VBN 1010011101111 O
in IN 100110 O
an DT 11000 O
encrypted JJ 10100100000 O
format NN 001111100111 O
as IN 10111111110 O
a DT 11001 O
string NN 001001110110 O
re- NN 111100101011 O
source NN 00100110111 O
: : 0111010 O
The DT 010000 O
first JJ 1111010100 O
two CD 11111001100 O
bytes NNS 11100101111 O
of IN 1000 O
this DT 110110 O
string NN 001001110110 O
represent VBP 101010110110 O
the DT 11010 O
base NN 11100101100 O
16 CD 0111111111101 O
length NN 00011111111 O
of IN 1000 O
the DT 11010 O
encrypted JJ 10100100000 O
string NN 001001110110 O
, , 1011100 O
in IN 100110 O
this DT 110110 O
case NN 00001100 O
, , 1011100 O
'' '' 0111101110 O
0x14 NN X O
'' '' 0111101110 O
. . 0110 O

Following VBG 0101011100 O
this DT 110110 O
is VBZ 101101010 O
a DT 11001 O
base64 NN 1111011100100 O
encoded VBN 10100100001 O
string NN 001001110110 O
of IN 1000 O
the DT 11010 O
specified VBN 1111011101001 O
length NN 00011111111 O
. . 0110 O

Once RB 0101011101 O
this DT 110110 O
string NN 001001110110 O
has VBZ 1011011010 O
been VBN 10101101 O
decoded VBN 10100101101100 O
using VBG 100101111110 O
base64 NN 1111011100100 O
, , 1011100 O
the DT 11010 O
result NN 000101100 O
is VBZ 101101010 O
then RB 101011111110 O
XOR NNP 1111011100101 O
'd NNP 10100100001 O
with IN 100100 O
the DT 11010 O
fixed JJ 1111011101011 O
value NN 001111111000 O
of IN 1000 O
0xAA NN X O
yielding VBG X O
the DT 11010 O
decoded VBN 10100101101100 O
IP NNP 1111011000 O
address NN 00111000 O
202.86.190.3:80 NNP X O
( NNP 01111000 O
Hong NNP 01111101110 O
Kong NNP 011111111001 O
: : 0111010 O
TeleOne NNP X O
( NNP 01111000 O
HK NNP X O
) NNP 011110100 O
Limited NNP X O
) NNP 011110100 O
. . 0110 O

There EX 01001011 O
are VBP 101101001 O
three CD 11111001101 O
components NNS 001111101000 O
to TO 101100 O
the DT 11010 O
protocol NN 0011110111110 O
: : 0111010 O
Authentication NN X B-Entity
is VBZ 101101010 B-Verb
accomplished VBN 10100110111010 I-Verb
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
32 CD 011111111100 I-Entity
byte NN 11100100010 I-Entity
packet NN 11100100011 I-Entity
, , 1011100 O
this DT 110110 O
packet NN 11100100011 O
consists VBZ 00010010 O
of IN 1000 O
: : 0111010 O
An DT 0100011111 B-Entity
example NN 000010 I-Entity
authentication NN 001010110010 I-Entity
packet NN 11100100011 I-Entity
sent VBN 10100110111011 B-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
is VBZ 101101010 O
located JJ 101001110101 O
in IN 100110 O
Appendix NNP 01111101110 O
E. NNP 011111111000 O
After IN 01010101 O
sending VBG 101111111111011 B-Verb
the DT 11010 B-Entity
initial JJ 111101111111101 I-Entity
authentication NN 001010110010 I-Entity
packet NN 11100100011 I-Entity
, , 1011100 O
the DT 11010 B-Entity
sample NN 0010100000 I-Entity
verifies VBZ 101111101010 B-Verb
that IN 101111110 B-Preposition
the DT 11010 B-Entity
first JJ 1111010100 I-Entity
four CD 0111111111011 I-Entity
bytes NNS 11100101111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
response NN 00101001100 I-Entity
is VBZ 101101010 I-Entity
equal JJ 10100001000 I-Entity
to TO 101100 I-Entity
a DT 11001 I-Entity
statically RB X I-Entity
defined VBN 101001100110 I-Entity
value NN 001111111000 I-Entity
, , 1011100 O
in IN 100110 O
this DT 110110 O
sample NN 0010100000 O
the DT 11010 O
value NN 001111111000 O
is VBZ 101101010 O
: : 0111010 O
0x16030100 NN X O
. . 0110 O

In IN 0101000 O
addition NN 0000010 O
, , 1011100 O
an DT 11000 B-Entity
8 CD 01111111101100 I-Entity
byte NN 11100100010 I-Entity
key NN 001111111010 I-Entity
is VBZ 101101010 B-Verb
sent VBN 10100110111011 I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
client NN 00100001110 I-Entity
which WDT 101111011 O
is VBZ 101101010 O
then RB 101011111110 O
RC4 NN 1111011100101 O
encrypted VBD 10100100000 O
using VBG 100101111110 O
the DT 11010 O
random JJ 1111000111101 O
number NN 00010100 O
generated VBN 101001100010 O
in IN 100110 O
step NN 001010001101 O
2 CD 0111111110100 O
from IN 100101100 O
above RB 011110101101 O
as IN 10111111110 O
the DT 11010 O
password NN 11100100110 O
. . 0110 O

This DT 0100010 O
value NN 001111111000 O
is VBZ 101101010 O
then RB 101011111110 O
transformed VBN X O
using VBG 100101111110 O
a DT 11001 O
simple JJ 1111000111110 O
algorithm NN 0011111111000 O
in IN 100110 O
Appendix NN 01111101110 O
F NN 011111111000 O
into IN 10010111100 O
a DT 11001 O
32 CD 011111111100 O
byte NN 11100100010 O
array NN 0001111110 O
. . 0110 O

The DT 010000 O
first JJ 1111010100 O
16 CD 0111111111101 O
bytes NNS 11100101111 O
of IN 1000 O
this DT 110110 O
array NN 0001111110 O
are VBP 101101001 O
then RB 101011111110 O
used VBN 1010011010 O
as IN 10111111110 O
the DT 11010 O
KEY NNP X O
and CC 101110111 O
the DT 11010 O
second JJ 11110101010 O
16 CD 0111111111101 O
bytes NNS 11100101111 O
are VBP 101101001 O
used VBN 1010011010 O
as IN 10111111110 O
the DT 11010 O
IV NNP X O
for IN 10011111 O
setting VBG 1010010110000 O
up RP 10111111100111 O
AES NN 1111011100101 B-Entity
encryption NN 1111011100111 I-Entity
which WDT 101111011 O
is VBZ 101101010 O
then RB 101011111110 O
used VBN 1010011010 O
to TO 101100 O
encrypt VB 101010011101 B-Verb
and CC 101110111 I-Verb
decrypt VB 10101001010 I-Verb
any DT 11111011111 B-Entity
further JJ 11110111111001 I-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

Beacon NNP X O
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
typical JJ 1111000111010 O
of IN 1000 O
this DT 110110 O
type NN 000110011 O
of IN 1000 O
malicious JJ 1111011111000 O
sample NN 0010100000 O
, , 1011100 O
it PRP 101111010 O
allows VBZ 101111100100 O
the DT 11010 O
operator NN 001011111111 O
to TO 101100 O
separate VB 111100000110 O
various JJ 111110011100 O
infected JJ 111101111000 O
hosts NNS 001100110010 O
in IN 100110 O
a DT 11001 O
targeted VBN 1110000100 O
campaign NN 0010101010 O
. . 0110 O

The DT 010000 O
beacon NN 00101001000 O
for IN 10011111 O
this DT 110110 O
sample NN 0010100000 O
is VBZ 101101010 O
formatted VBN 10100101111011 O
as IN 10111111110 O
XML NN 01111011011110 O
and CC 101110111 O
consists VBZ 00010010 O
of IN 1000 O
: : 0111010 O
An DT 0100011111 O
example NN 000010 O
of IN 1000 O
an DT 11000 O
unencrypted JJ X O
beacon NN 00101001000 O
: : 0111010 O
Command NN 011110110100 B-Entity
handling NN 0001110001 I-Entity
loop NN 0011110111111 I-Entity
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
a DT 11001 O
loop NN 0011110111111 O
structure NN 001111100010 O
that WDT 101111110 O
will MD 10110111111 O
process VB 001001111011 B-Verb
and CC 101110111 I-Verb
execute VB 10101001011 I-Verb
commands NNS 001111101100 B-Entity
sent VBN 10100110111011 I-Entity
by IN 1001110 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

The DT 010000 B-Entity
malware NN 00101100 I-Entity
sends VBZ 101111101000 B-Verb
and CC 101110111 O
receives VBZ 101111101001 B-Verb
a DT 11001 B-Entity
heartbeat/keepalive JJ X I-Entity
packet NN 11100100011 I-Entity
every DT 1111101011 B-Preposition
2 CD 0111111110100 B-Entity
minutes NNS 0011010100 I-Entity
. . 0110 O

The DT 010000 O
command NN 0010011100 O
format NN 001111100111 O
is VBZ 101101010 O
derived VBN 10101110001 O
from IN 100101100 O
a DT 11001 O
structure NN 001111100010 O
consisting VBG 00010010 O
of IN 1000 O
: : 0111010 O
These DT 010011110 O
fields NNS 001111100011 O
are VBP 101101001 O
received VBN 10100101101101 O
as IN 10111111110 O
a DT 11001 O
sequence NN 000110011 O
of IN 1000 O
serialized FW X O
.NET FW 01111001010 O

objects NNS 0011111011110 O
in IN 100110 O
the DT 11010 O
order NN 0000011 O
specified VBN 1111011101001 O
. . 0110 O

A DT 010001110 O
detailed JJ 1111000110100 O
description NN 0001011110 O
of IN 1000 O
the DT 11010 O
possible JJ 10100000110 O
values NNS 0011111011110 O
for IN 10011111 O
commands NNS 001111101100 O
is VBZ 101101010 O
in IN 100110 O
Appendix NNP 01111101110 O
D. NNP 011111111001 O
It PRP 01001010 O
is VBZ 101101010 O
important JJ 10100000100 O
to TO 101100 O
note VB 1010101001 O
that IN 101111110 O
the DT 11010 O
order NN 0000011 O
in IN 100110 O
which WDT 101111011 O
the DT 11010 O
application NN 0010011111011 O
defines VBZ 10010111111110 O
them PRP 1011111110000 O
is VBZ 101101010 O
not RB 1010111100 O
the DT 11010 O
same JJ 111101001 O
order NN 0000011 O
as IN 10111111110 O
they PRP 10111100110 O
appear VBP 101000111111 O
to TO 101100 O
be VB 10101100 O
coming VBG 10101110001 O
over IN 10010110101 O
the DT 11010 O
network NN 001000010 O
. . 0110 O

Examples NNS 010011101 O
of IN 1000 O
implemented VBN 10100101111011 O
commands NNS 001111101100 O
include VBP 1010101110110 O
download NN 10101011111010 B-Verb
and CC 101110111 O
upload NN 10101011111001 B-Verb
files NNS 0011011110 B-Entity
, , 1011100 O
installing VBG 101111111111010 B-Verb
new JJ 11110000010 B-Entity
.NET NNP 01111001010 I-Entity
assemblies NNS X I-Entity
, , 1011100 O
calling VBG 11101110111 B-Verb
methods NNS 0011001111000 B-Entity
on IN 1001010 B-Preposition
those DT 111101111110111 B-Entity
assemblies NNS X I-Entity
, , 1011100 O
connecting VBG 10100010000 B-Verb
to TO 101100 B-Preposition
new JJ 11110000010 B-Entity
C2 NN 1111011011000 I-Entity
servers NNS 00111010 I-Entity
and CC 101110111 O
executing VBG 101111111111010 B-Verb
processes NNS 0011001111110 B-Entity
. . 0110 O

This DT 0100010 B-Entity
sample NN 0010100000 I-Entity
is VBZ 101101010 B-Verb
a DT 11001 B-Entity
sophisticated JJ 111100010011 I-Entity
backdoor NN 00101101000 I-Entity
which WDT 101111011 O
implements VBZ 1011111010110 B-Verb
several JJ 111110011110 B-Entity
communications NNS 00111101001110 I-Entity
protocols NNS 001111100101 I-Entity
and CC 101110111 O
was VBD 101101011 O
developed VBN 101001100000 O
in IN 100110 O
C++ NNP 11100000111 O
. . 0110 O

This DT 0100010 O
binary JJ 001011010100 O
is VBZ 101101010 O
compiled VBN 1010011011010 O
with IN 100100 O
the DT 11010 O
/GS NN X O
flag NN 0010011111111 O
using VBG 100101111110 O
Visual JJ 01111011011110 O
Studio NN 11100000111 O
2010 CD 011111100110 O
, , 1011100 O
enabling VBG 10111111111100 O
stack VBP 001001111001 O
buffer NN 0010011111111 O
overflow NN X O
detection NN 0001110010 O
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Sunday NNP 0111111111101 O
October NNP 01111101010 O
30 CD 011111111100 O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
12:43:33 CD X O
P.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
late JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

The DT 010000 O
code NN 001001010 O
contains VBZ 1011111011111 O
several JJ 111110011110 O
Run NNP 0111101101010 O
Time NNP 00111111001 O
Type NN 01110111110111 O
Information NNP 0111101100101 O
( NNP 01111000 O
RTTI NNP X O
) NN 011110100 O
artifacts NNS 001101110111 O
that WDT 101111110 O
indicate VBP 101010101111 O
most JJS 111111100 O
of IN 1000 O
the DT 11010 O
C++ NNP 11100000111 O
class NN 0010011111110 O
names NNS 00111111011 O
were VBD 101101000 O
prefixed VBN X O
with IN 100100 O
the DT 11010 O
string NN 001001110110 O
'' '' 0111101110 O
PCC NN X O
'' '' 0111101110 O
in IN 100110 O
the DT 11010 O
original JJ 11110101111 O
source NN 00100110111 O
code NN 001001010 O
. . 0110 O

Variants NNS X O
of IN 1000 O
this DT 110110 O
Trojan NNP 001011010101 O
are VBP 101101001 O
sometimes RB 101011101001 O
detected VBN 101001100110 O
under IN 10010111111110 O
the DT 11010 O
name NN 00111111010 O
'Derusbi NN X O
' '' 0111101010 O
by IN 1001110 O
Microsoft NNP 1110110111 O
, , 1011100 O
Trend NNP 11101110101 O
, , 1011100 O
Sophos NNP 111011111111 O
and CC 101110111 O
Symantec NNP 11101110101 O
AV NNP 111101111110101 O
engines NNS 001100111001 O
. . 0110 O

This DT 0100010 B-Entity
sample NN 0010100000 I-Entity
is VBZ 101101010 O
a DT 11001 B-Entity
DLL NN 00101101110 I-Entity
which WDT 101111011 O
can MD 10110111110 O
be VB 10101100 B-Verb
registered VBN 1010011011001 I-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
and CC 101110111 O
is VBZ 101101010 O
used VBN 1010011010 O
to TO 101100 O
drop VB 101010110110 B-Verb
a DT 11001 B-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
and CC 101110111 O
provide VB 10101000011 B-Verb
an DT 11000 B-Entity
interactive JJ 111100100110 I-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
shell NN 0011111111011 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

It PRP 01001010 B-Entity
also RB 10101111110 O
is VBZ 101101010 O
able JJ 10100010110 O
to TO 101100 O
bypass VB 10101000100 B-Verb
User NN 0111101100101 B-Entity
Account NNP 11101110100 I-Entity
Control NNP 1110001011 I-Entity
( NNP 01111000 I-Entity
UAC NNP 011111110110 I-Entity
) NNP 011110100 I-Entity
to TO 101100 B-Preposition
install VB 10101001000 B-Entity
itself PRP 10111111100010 I-Entity
by IN 1001110 I-Entity
using VBG 100101111110 I-Entity
the DT 11010 I-Entity
'sysprep.exe NN X I-Entity
' '' 0111101010 I-Entity
Microsoft NNP 1110110111 I-Entity
Windows NNP 1110110100 I-Entity
executable JJ 001001111100 I-Entity
provided VBN 101001100001 I-Entity
by IN 1001110 I-Entity
the DT 11010 I-Entity
targeted VBN 1110000100 I-Entity
system NN 001000000 I-Entity
. . 0110 O

The DT 010000 O
steps NNS 0011111011010 O
it PRP 101111010 O
takes VBZ 10010111111111 O
to TO 101100 O
install VB 10101001000 O
itself PRP 10111111100010 O
onto IN 10010111111111 O
a DT 11001 O
system NN 001000000 O
are VBP 101101001 O
as IN 10111111110 O
follows VBZ 01110110001 O
: : 0111010 O
2 CD 0111111110100 O
. . 0110 O

After IN 01010101 O
it PRP 101111010 B-Entity
copies NNS 101111100010 B-Verb
itself PRP 10111111100010 B-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
modify VB 10101001011 B-Verb
the DT 11010 B-Entity
creation NN 0001110101 I-Entity
time NN 00011010 I-Entity
, , 1011100 I-Entity
last JJ 0010111000 I-Entity
access NN 10100011010 I-Entity
time NN 00011010 I-Entity
and CC 101110111 I-Entity
last JJ 0010111000 I-Entity
modification NN 0001110011 I-Entity
time NN 00011010 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
current JJ 111101111111111 I-Entity
system NN 001000000 I-Entity
time NN 00011010 I-Entity
when WRB 100101110010 I-Entity
the DT 11010 I-Entity
copy NN 0001011111 I-Entity
was VBD 101101011 I-Entity
made VBN 10100101110110 I-Entity
but CC 10111111111000 I-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
year NN 001010110100 I-Entity
changed VBD 10100101111011 I-Entity
to TO 101100 I-Entity
2005 CD 01111110010 I-Entity
. . 0110 O

3 CD 011111111011110 O
. . 0110 O

Adds NNP X B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
name NN 00111111010 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
backdoor NN 00101101000 I-Entity
's POS 10111010 I-Entity
configuration NN 00100110010 I-Entity
under IN 10010111111110 B-Preposition
HKEYLOCAL FW X B-Entity
MACHINE\\SYSTEM\\CurrentControlSet\\Services\\ FW X I-Entity
< JJR 01110111110110 I-Entity
service NN 001001111110 I-Entity
> JJR 011100011 I-Entity
'' '' 0111101110 I-Entity
This DT 0100010 O
defaults NNS X O
to TO 101100 O
'' '' 0111101110 O
wuauserv NN X O
'' '' 0111101110 O
, , 1011100 O
the DT 11010 O
legitimate JJ 11110111110010 O
Windows NNP 1110110100 O
Update NNP 0111111111110 O
service NN 001001111110 O
, , 1011100 O
in IN 100110 O
the DT 11010 O
given VBN 101000001111 O
binary JJ 001011010100 O
's POS 10111010 O
default NN 111101110000 O
configuration NN 00100110010 O
. . 0110 O

4 CD 011111111011111 O
. . 0110 O

Adds NNP X B-Verb
itself PRP 10111111100010 B-Entity
to TO 101100 B-Preposition
list NN 0001011110 B-Entity
of IN 1000 I-Entity
services NNS 001100011011 I-Entity
started VBN 10100101110111 I-Entity
by IN 1001110 I-Entity
'netsvc NN X I-Entity
' '' 0111101010 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
service NN 001001111110 I-Entity
name NN 00111111010 I-Entity
'helpsvc NN X I-Entity
' '' 0111101010 I-Entity
. . 0110 O

5 CD 01111111101110 O
. . 0110 O

If IN 0101011100 O
McAfee NNP 11101110101 O
AV NNP 111101111110101 O
is VBZ 101101010 O
installed VBN 101001011111101 O
, , 1011100 O
creates VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
copy NN 0001011111 I-Entity
of IN 1000 I-Entity
regsvr32.exe NN X I-Entity
named VBN 10100101001 I-Entity
Update.exe NN X I-Entity
and CC 101110111 O
then RB 101011111110 O
schedules NNS X B-Verb
the DT 11010 B-Entity
copy NN 0001011111 I-Entity
to TO 101100 B-Preposition
be VB 10101100 B-Entity
deleted VBN 10100101111010 I-Entity
on IN 1001010 I-Entity
reboot NN 00100011111 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
well RB 101111111011 I-Entity
documented VBN 101001110011 I-Entity
MoveFileExA NN X I-Entity
API NN 0111101101101 I-Entity
. . 0110 O

6 CD 01111111101100 O
. . 0110 O

It PRP 01001010 O
then RB 101011111110 O
calls VBZ 101111100011 O
either CC 1010111011100 O
the DT 11010 O
original JJ 11110101111 O
or CC 101110110 O
copy NN 0001011111 O
of IN 1000 O
regsvr32.exe NN X O
with IN 100100 O
the DT 11010 O
parameters NNS 0011111011101 O
/s FW X O
/u FW X O
and CC 101110111 O
the DT 11010 O
path NN 000110111 O
to TO 101100 O
the DT 11010 O
copy NN 0001011111 O
of IN 1000 O
itself PRP 10111111100010 O
it PRP 101111010 O
made VBD 10100101110110 O
in IN 100110 O
Step NN 1111101011 O
1 CD 0111111110101 O
. . 0110 O

The DT 010000 O
/u NN X O
parameter NN 001111111001 O
means VBZ 00101001011 O
'' '' 0111101110 O
uninstall JJ 10101011111001 O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
calls VBZ 101111100011 O
DllUnregisterServer NNP X O
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
an DT 11000 O
unsophisticated JJ X O
method NN 001010001100 O
of IN 1000 O
DLL NNP 00101101110 O
entry NN 0010101110110 O
point NN 00101001001 O
obfuscation NN 1111011100110 O
. . 0110 O

7 CD 01111111101101 O
. . 0110 O

DllUnregisterServer NNP X O
installs VBZ 101111101000 O
the DT 11010 O
driver NN 00101101111 O
and CC 101110111 O
initiates VBZ 101111101000 O
the DT 11010 O
backdoor JJ 00101101000 O
component NN 00101000011 O
. . 0110 O

The DT 010000 B-Entity
sample NN 0010100000 I-Entity
is VBZ 101101010 O
capable JJ 00010000 O
of IN 1000 O
'dropping VBG X B-Verb
' '' 0111101010 I-Verb
an DT 11000 B-Entity
embedded/encrypted JJ X I-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 O
process NN 001001111011 O
'' '' 0111101110 O
ZhuDongFangYu NN X O
. . 0110 O

exe NN 01110111011 O
'' '' 0111101110 O
is VBZ 101101010 O
running VBG 10100101111101 O
( FW 01111000 O
AntiVirus360 FW X O
program NN 0010011111010 O
from IN 100101100 O
the DT 11010 O
Chinese JJ 111100110101 O
'Quihoo NN X O
360 CD X O
Technology NNP 1110001010 O
Co. NNP 0011000011 O
, , 1011100 O
LTD NNP X O
' POS 0111101010 O
360 CD X O
) CD 011110100 O
, , 1011100 O
or CC 101110110 O
the DT 11010 O
username NN 01110110111 O
of IN 1000 O
the DT 11010 O
DLL NNP 00101101110 O
's POS 10111010 O
host NN 00100001111 O
process NN 001001111011 O
context NN 00011111110 O
is VBZ 101101010 O
not RB 1010111100 O
'SYSTEM NN X O
' '' 0111101010 O
, , 1011100 O
the DT 11010 O
driver NN 00101101111 O
is VBZ 101101010 O
not RB 1010111100 O
written VBN 10100110111110 O
to TO 101100 O
disk NN 11100111111 O
. . 0110 O

Barring VBG X O
the DT 11010 O
two CD 11111001100 O
aforementioned JJ 11110101111 O
conditions NNS 0011001111110 O
, , 1011100 O
the DT 11010 O
sample NN 0010100000 O
decrypts VBZ 101111101000 O
the DT 11010 O
kernel NN 11100000111 O
driver NN 00101101111 O
to TO 101100 O
: : 0111010 O
Following VBG 0101011100 O
the DT 11010 O
decryption NN 1111011100111 O
and CC 101110111 O
writing NN 0011001010 B-Verb
of IN 1000 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
to TO 101100 B-Preposition
disk NN 11100111111 B-Entity
, , 1011100 O
it PRP 101111010 B-Entity
is VBZ 101101010 B-Verb
loaded VBN 10100100010 I-Verb
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
ZwLoadDriver NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
. . 0110 O

The DT 010000 B-Entity
driv- FW X I-Entity
er FW X I-Entity
is VBZ 101101010 B-Verb
encrypted VBN 10100100000 I-Verb
with IN 100100 B-Preposition
a DT 11001 B-Entity
simple JJ 1111000111110 I-Entity
four CD 0111111111011 I-Entity
byte NN 11100100010 I-Entity
XOR NN 1111011100101 I-Entity
key JJ 001111111010 I-Entity
value NN 001111111000 I-Entity
of IN 1000 I-Entity
0x2E885Df3 NN X I-Entity
; : 0111100100 O
after IN 100101110100 O
decryption NN 1111011100111 O
the DT 11010 O
file NN 00100100 O
has VBZ 1011011010 O
the DT 11010 O
MD5 NN 01110110000 O
hash NN 00111111001 O
of IN 1000 O
dae6b9b3b8e39b08b10a51a6457444d8 NN X O
. . 0110 O

The DT 010000 O
malware NN 00101100 O
contains VBZ 1011111011111 O
a DT 11001 O
dynamic JJ 111100010001 O
configuration NN 00100110010 O
stored VBN 1010011101111 O
in IN 100110 O
the DT 11010 O
Registry NNP 01111011001111 O
under IN 10010111111110 O
and CC 101110111 O
loads NNS 101111101000 O
a DT 11001 O
default NN 111101110000 O
configuration NN 00100110010 O
embedded VBD 1111011101000 O
into IN 10010111100 O
the DT 11010 O
binary JJ 001011010100 O
if IN 101111111111110 O
such PDT 101111111010 O
a DT 11001 O
configuration NN 00100110010 O
is VBZ 101101010 O
not RB 1010111100 O
found VBN 10100111110 O
. . 0110 O

The DT 010000 O
way NN 00101001010 O
this DT 110110 O
default NN 111101110000 O
configuration NN 00100110010 O
is VBZ 101101010 O
loaded VBN 10100100010 O
and CC 101110111 O
parsed VBN 1010011101111 O
indicates VBZ 101111101100 O
that IN 101111110 O
this DT 110110 O
malware NN 00101100 O
has VBZ 1011011010 O
been VBN 10101101 O
built VBN 101001011111100 O
with IN 100100 O
a DT 11001 O
'builder NN X O
' '' 0111101010 O
that WDT 101111110 O
takes VBZ 10010111111111 O
a DT 11001 O
template NN 0011111111001 O
sample NN 0010100000 O
and CC 101110111 O
lets VBZ 101111100100 O
an DT 11000 O
unsophisticated JJ X O
user NN 0010000110 O
specify VB 10101001000 O
a DT 11001 O
configuration NN 00100110010 O
without IN 100101110011 O
recompiling VBG X O
any DT 11111011111 O
code NN 001001010 O
. . 0110 O

If IN 0101011100 O
the DT 11010 O
current JJ 111101111111111 O
service NN 001001111110 O
name NN 00111111010 O
matches VBZ 1011111011111 O
a DT 11001 O
set NN 000101110 O
of IN 1000 O
pre-defined JJ X O
service NN 001001111110 O
names NNS 00111111011 O
that WDT 101111110 O
legitimately RB X O
exist VBP 1010010111000 O
in IN 100110 O
Windows NNP 1110110100 O
, , 1011100 O
the DT 11010 B-Entity
backdoor NN 00101101000 I-Entity
then RB 101011111110 O
loads NNS 101111101000 B-Verb
the DT 11010 B-Entity
original JJ 11110101111 I-Entity
service NN 001001111110 I-Entity
's POS 10111010 I-Entity
DLL NNP 00101101110 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
address NN 00111000 I-Entity
space NN 0011110111100 I-Entity
with IN 100100 B-Preposition
LoadLibrary NN 1111011011010 B-Entity
and CC 101110111 O
invokes VBZ X O
the DT 11010 O
ServiceMain NNP 00100101111 O
export NN 101010111111110 O
. . 0110 O

This DT 0100010 O
effectively RB 1010111010110 O
hijacks VBZ X O
the DT 11010 O
original JJ 11110101111 O
service NN 001001111110 O
's POS 10111010 O
entry NN 0010101110110 O
while IN 1011111111100111 O
retaining VBG X O
its PRP$ 11011101 O
functionality NN 00011111001 O
. . 0110 O

While IN 010101101 O
there EX 10111100101 O
is VBZ 101101010 O
code NN 001001010 O
in IN 100110 O
the DT 11010 O
binary JJ 001011010100 O
that WDT 101111110 O
allows VBZ 101111100100 O
downloading VBG 101111111111010 B-Verb
a DT 11001 B-Entity
list NN 0001011110 I-Entity
of IN 1000 I-Entity
C2 NN 1111011011000 I-Entity
servers NNS 00111010 I-Entity
from IN 100101100 B-Preposition
an DT 11000 B-Entity
HTTP NN 111101101010 I-Entity
URL NN 001111100100 I-Entity
, , 1011100 O
the DT 11010 B-Entity
default NN 111101110000 I-Entity
configuration NN 00100110010 I-Entity
present NN 101001011111111 I-Entity
specifies VBZ 10010111111110 B-Verb
202.86.190.3:80 CD X B-Entity
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
C2 NN 1111011011000 I-Entity
to TO 101100 B-Preposition
use VB 10101011100 B-Entity
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
the DT 11010 O
same JJ 111101001 O
Hong NNP 01111101110 O
Kong NNP 011111111001 O
C2 NN 1111011011000 O
server NN 00111011 O
as IN 10111111110 O
the DT 11010 O
one CD 111110100 O
used VBN 1010011010 O
by IN 1001110 O
the DT 11010 O
post NN 001010111101 O
exploitation NN 111000011110 O
.NET NN 01111001010 O

tool NN 001010001110 O
. . 0110 O

The DT 010000 B-Entity
malware NN 00101100 I-Entity
has VBZ 1011011010 B-Verb
three CD 11111001101 B-Entity
distinct JJ 111100000110 I-Entity
C2 NN 1111011011000 I-Entity
protocols NNS 001111100101 I-Entity
two CD 11111001100 O
of IN 1000 O
which WDT 101111011 O
can MD 10110111110 O
be VB 10101100 O
transmitted VBN 10100110111110 O
over IN 10010110101 O
HTTP NN 111101101010 O
proxies NNS 0011001101001 O
and CC 101110111 O
one PRP 111110100 O
can MD 10110111110 O
be VB 10101100 O
bundled VBN 101001011111110 O
in IN 100110 O
two CD 11111001100 O
different JJ 1111000000 O
'dual NN X O
' '' 0111101010 O
modes NNS X O
( RB 01111000 O
see VBP 1010101000 O
3 CD 011111111011110 O
. . 0110 O

) NN 011110100 O
, , 1011100 O
totaling VBG X O
7 CD 01111111101101 O
distinct JJ 111100000110 O
supported VBN 1010011000110 O
C2 NN 1111011011000 O
mechanisms NNS 0011001111000 O
. . 0110 O

The DT 010000 B-Entity
con- NN 0111011111010 I-Entity
figuration NN X I-Entity
contains VBZ 1011111011111 B-Verb
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
protocol NN 0011110111110 I-Entity
to TO 101100 I-Entity
be VB 10101100 I-Entity
used VBN 1010011010 I-Entity
or CC 101110110 O
optionally RB X O
a DT 11001 O
self-configuration NN X O
mode NN 0011110111111 O
in IN 100110 O
which WDT 101111011 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
attempts VBZ 101000111010 B-Verb
the DT 11010 B-Entity
different JJ 1111000000 I-Entity
C2 NN 1111011011000 I-Entity
protocols NNS 001111100101 I-Entity
in IN 100110 B-Preposition
a DT 11001 B-Entity
pre-defined JJ X I-Entity
order NN 0000011 I-Entity
. . 0110 O

In IN 0101000 O
self-configuration NN X O
, , 1011100 O
a DT 11001 O
connection NN 001111010001 O
via IN 100101111011 O
a DT 11001 O
proxy NN 1111011011011 O
is VBZ 101101010 O
attempted VBN 10100010011 O
if IN 101111111111110 O
the DT 11010 O
system NN 001000000 O
wide JJ 111100011000 O
Internet NNP 0010111010 O
Explorer NNP 011111110101 O
settings NNS 0011111110110 O
specify VBP 10101001000 O
such JJ 101111111010 O
a DT 11001 O
proxy NN 1111011011011 O
. . 0110 O

The DT 010000 O
configuration NN 00100110010 O
found VBN 10100111110 O
in IN 100110 O
this DT 110110 O
sample NN 0010100000 O
is VBZ 101101010 O
set VBN 000101110 O
to TO 101100 O
automatic JJ 111101111111011 O
self-configuration NN X O
, , 1011100 O
resulting VBG 1111011101001 O
in IN 100110 O
the DT 11010 O
following JJ 111101000 O
mechanisms NNS 0011001111000 O
being VBG 101011111000 O
tried VBN 101000111011 O
in IN 100110 O
this DT 110110 O
order NN 0000011 O
: : 0111010 O
1 CD 0111111110101 O
. . 0110 O

Proprietary JJ X O
binary JJ 001011010100 O
header NN 001111100011 O
( NN 01111000 O
optionally RB X O
over IN 10010110101 O
an DT 11000 O
HTTP NNP 111101101010 O
Proxy NNP 0111101100100 O
using VBG 100101111110 O
CONNECT NNP X O
mechanism NN 00101001101 O
) NN 011110100 O
; : 0111100100 O
this DT 110110 O
protocol NN 0011110111110 O
consists VBZ 00010010 O
of IN 1000 O
64 CD 11101100111 B-Entity
random JJ 1111000111101 I-Entity
bytes NNS 11100101111 I-Entity
being VBG 101011111000 B-Verb
sent VBN 10100110111011 I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

The DT 010000 O
C2 NN 1111011011000 O
then RB 101011111110 O
responds VBZ 101111100000 O
with IN 100100 O
64 CD 11101100111 O
bytes NNS 11100101111 O
where WRB 101111111110100 O
the DT 11010 O
first JJ 1111010100 O
four CD 0111111111011 O
bytes NNS 11100101111 O
must MD 1011011110110 O
match VB 1010101110100 O
the DT 11010 O
first JJ 1111010100 O
four CD 0111111111011 O
sent VBN 10100110111011 O
bytes NNS 11100101111 O
to TO 101100 O
establish VB 101010011011 O
a DT 11001 O
connection NN 001111010001 O
successfully RB 1010111110110 O
. . 0110 O

The DT 010000 O
remaining VBG 111101111111100 O
bytes NNS 11100101111 O
are VBP 101101001 O
discarded VBN X O
. . 0110 O

Interestingly RB 010110 O
, , 1011100 O
the DT 11010 O
malware NN 00101100 O
stores NNS 101111101001 O
the DT 11010 O
first JJ 1111010100 O
four CD 0111111111011 O
bytes NNS 11100101111 O
rotated VBN X O
right RB 101000110011 O
by IN 1001110 O
seven CD 0111111111011 O
bits NNS 11100101111 O
and CC 101110111 O
compares VBZ X O
that IN 101111110 O
value NN 001111111000 O
to TO 101100 O
the DT 11010 O
seven CD 0111111111011 O
bits NNS 11100101111 O
rotated VBD X O
right JJ 101000110011 O
version NN 00011000 O
of IN 1000 O
the DT 11010 O
server NN 00111011 O
's POS 10111010 O
response NN 00101001100 O
, , 1011100 O
effectively RB 1010111010110 O
neutralizing VBG X O
the DT 11010 O
rotation NN X O
's POS 10111010 O
effect NN 0001110101 O
; : 0111100100 O
the DT 11010 O
purpose NN 00011111011 O
of IN 1000 O
this DT 110110 O
is VBZ 101101010 O
unclear JJ 1010000000 O
. . 0110 O

2 CD 0111111110100 O
. . 0110 O

A DT 010001110 O
long-running JJ 0010011111111 O
HTTP NN 111101101010 O
POST NN 111101101011 O
request NN 001111010100 O
to TO 101100 O
the DT 11010 O
path NN 000110111 O
'' '' 0111101110 O
/forum/login.cgi NN X O
'' '' 0111101110 O
with IN 100100 O
a DT 11001 O
statically RB X O
defined VBN 101001100110 O
HTTP NN 111101101010 O
request NN 001111010100 O
string NN 001001110110 O
including VBG 101111111110111 O
HTTP NN 111101101010 O
headers NNS 001111100101 O
( VBP 01111000 O
optionally RB X O
over IN 10010110101 O
a DT 11001 O
HTTP NNP 111101101010 O
Proxy NNP 0111101100100 O
using VBG 100101111110 O
CONNECT NNP X O
) NNP 011110100 O
. . 0110 O

The DT 010000 O
malware NN 00101100 O
requires VBZ 1011111001111 O
the DT 11010 O
response NN 00101001100 O
to TO 101100 O
start VB 101010111111000 O
with IN 100100 O
'' '' 0111101110 O
HTTP/1.0 NN 111011111110 O
200 CD 0111111111111 O
'' '' 0111101110 O
or CC 101110110 O
'' '' 0111101110 O
HTTP/1.1 NN 0111011111110 O
200 CD 0111111111111 O
'' '' 0111101110 O
and CC 101110111 O
an DT 11000 O
absence NN 0001111011 O
of IN 1000 O
a DT 11001 O
'' '' 0111101110 O
Connection NN 01110110011 O
: : 0111010 O
close JJ 00100011000 O
'' '' 0111101110 O
header NN 001111100011 O
. . 0110 O

This DT 0100010 O
one CD 111110100 O
HTTP NNP 111101101010 O
connection NN 001111010001 O
will MD 10110111111 O
be VB 10101100 O
used VBN 1010011010 O
for IN 10011111 O
bi-directional JJ X O
communications NNS 00111101001110 O
, , 1011100 O
sending VBG 101111111111011 B-Verb
chunks NNS 000000 B-Entity
of IN 1000 I-Entity
POST NN 111101101011 I-Entity
payload NN 001001111000 I-Entity
and CC 101110111 O
receiving VBG 11111011011 B-Verb
chunks NNS 000000 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
response NN 00101001100 I-Entity
, , 1011100 O
interleaved VBN X O
. . 0110 O

3 CD 011111111011110 O
. . 0110 O

Two CD 0100111110 O
long-running JJ 0010011111111 O
HTTP NN 111101101010 O
requests NNS 001111010101 O
to TO 101100 O
the DT 11010 O
same JJ 111101001 O
C2 NN 1111011011000 O
( NN 01111000 O
optionally RB X O
over IN 10010110101 O
an DT 11000 O
HTTP NNP 111101101010 O
Proxy NNP 0111101100100 O
with IN 100100 O
original JJ 11110101111 O
request NN 001111010100 O
verb VBP X O
) CD 011110100 O
, , 1011100 O
one CD 111110100 O
GET VBP 111101101011 O
request NN 001111010100 O
to TO 101100 O
'' '' 0111101110 O
/Photos/Query.cgi VB X O
? . 0111011111010 O
loginid= NN X O
'' '' 0111101110 O
followed VBN 10100110010 O
by IN 1001110 O
a DT 11001 O
random JJ 1111000111101 O
number NN 00010100 O
and CC 101110111 O
one CD 111110100 O
POST NN 111101101011 O
request NN 001111010100 O
to TO 101100 O
'' '' 0111101110 O
/Catelog/login1.cgi NN X O
'' '' 0111101110 O
. . 0110 O

The DT 010000 B-Entity
GET VBP 111101101011 I-Entity
request NN 001111010100 I-Entity
serves VBZ 101010111111010 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
down-stream NN X I-Entity
channel NN 0011110111110 I-Entity
while IN 1011111111100111 O
the DT 11010 B-Entity
POST NN 111101101011 I-Entity
request NN 001111010100 I-Entity
serves VBZ 101010111111010 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
upstream JJ X I-Entity
channel NN 0011110111110 I-Entity
. . 0110 O

This DT 0100010 O
demonstrates VBZ 101111101100 O
an DT 11000 O
attempt NN 101000110010 O
to TO 101100 O
use VB 10101011100 O
the DT 11010 O
most RBS 111111100 O
efficient JJ 111100010011 O
communication NN 001111010000 O
channel NN 0011110111110 O
first RB 1111010100 O
, , 1011100 O
falling VBG 10100101111101 O
back RB 101000110111 O
to TO 101100 O
more RBR 1111111110 O
legitimate JJ 11110111110010 O
appearing VBG 101001110001 O
channels NNS 0011110111110 O
as IN 10111111110 O
required VBN 10100001001 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
appear VB 101000111111 O
Request NNP 001111010100 O
For IN 01010010 O
Comment NN 11101111010 O
( NN 01111000 O
RFC NN X O
) NN 011110100 O
compliant JJ X O
with IN 100100 O
the DT 11010 O
HTTP NN 111101101010 O
protocol NN 0011110111110 O
. . 0110 O

Additionally RB 010110 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
contains VBZ 1011111011111 B-Verb
a DT 11001 B-Entity
custom NN 11110001111111 I-Entity
DNS NN 1111011011111 I-Entity
client NN 00100001110 I-Entity
implementation NN 00011111000 I-Entity
that WDT 101111110 O
will MD 10110111111 O
use VB 10101011100 B-Verb
the DT 11010 B-Entity
system NN 001000000 I-Entity
's POS 10111010 I-Entity
configured VBN 10100001000 I-Entity
DNS NN 1111011011111 I-Entity
server NN 00111011 I-Entity
to TO 101100 O
tunnel NN 00011111011 B-Verb
C2 NN 1111011011000 B-Entity
traffic NN 0011110100110 I-Entity
over IN 10010110101 B-Preposition
legitimate JJ 11110111110010 B-Entity
DNS NNS 1111011011111 I-Entity
. . 0110 O

Since IN 010101101 O
this DT 110110 O
C2 NN 1111011011000 O
mechanism NN 00101001101 O
is VBZ 101101010 O
not RB 1010111100 O
attempted VBN 10100010011 O
in IN 100110 O
self-configuration NN X O
and CC 101110111 O
was VBD 101101011 O
not RB 1010111100 O
configured VBN 10100001000 O
for IN 10011111 O
this DT 110110 O
binary JJ 001011010100 O
, , 1011100 O
analysis NN 0001110110 O
was VBD 101101011 O
left VBN 1010011000110 O
out RP 1011111110010 O
due JJ 10100010100 O
to TO 101100 O
time NN 00011010 O
constraints NNS X O
. . 0110 O

After IN 01010101 O
establishing VBG 101111111111011 O
any DT 11111011111 O
of IN 1000 O
the DT 11010 O
aforementioned JJ 11110101111 O
channels NNS 0011110111110 O
for IN 10011111 O
arbitrary JJ 111101111110100 O
binary JJ 001011010100 O
data NNS 001111001 O
exchange NN 00101001000 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
will MD 10110111111 O
start VB 101010111111000 O
sending VBG 101111111111011 B-Verb
and CC 101110111 O
receiving VBG 11111011011 B-Verb
compressed VBN 10100100011 B-Entity
binary JJ 001011010100 I-Entity
blobs NNS X I-Entity
via IN 100101111011 B-Preposition
the DT 11010 B-Entity
channel NN 0011110111110 I-Entity
of IN 1000 I-Entity
choice NN 00011111110 I-Entity
. . 0110 O

The DT 010000 O
C2 NN 1111011011000 O
's POS 10111010 O
binary JJ 001011010100 O
data NN 001111001 O
blobs NNS X O
are VBP 101101001 O
compressed VBN 10100100011 O
. . 0110 O

No DT 0111101101010 O
further JJ 11110111111001 O
encryption NN 1111011100111 O
of IN 1000 O
the DT 11010 O
data NN 001111001 O
takes VBZ 10010111111111 O
place NN 00100011101 O
. . 0110 O

All DT 0100111110 O
C2 NN 1111011011000 O
transport NN 0011110100101 O
implementations NNS 001100011110 O
contain VBP 1010101110111 O
code NN 001001010 O
for IN 10011111 O
accepting VBG X O
and CC 101110111 O
handling VBG 0001110001 O
server-side JJ 10100101101111 O
connections NNS 0011110100101 O
of IN 1000 O
the DT 11010 O
respective JJ 1111011101101 O
protocols NNS 001111100101 O
. . 0110 O

However RB 010110 O
, , 1011100 O
this DT 110110 O
code NN 001001010 O
does VBZ 1011011100 O
not RB 1010111100 O
appear VB 101000111111 O
to TO 101100 O
be VB 10101100 O
invoked VBN 10100101111010 O
. . 0110 O

It PRP 01001010 O
appears VBZ 101000111001 O
that IN 101111110 O
the DT 11010 O
author NN 00001110 O
of IN 1000 O
this DT 110110 O
code NN 001001010 O
shares VBZ 0011110111011 O
the DT 11010 O
library NN 0010011111110 O
that WDT 101111110 O
implements VBZ 1011111010110 O
these DT 11111000 O
transports NNS X O
for IN 10011111 O
the DT 11010 O
client NN 00100001110 O
with IN 100100 O
the DT 11010 O
C2 NN 1111011011000 O
server NN 00111011 O
. . 0110 O

The DT 010000 B-Entity
main JJ 11110101101 I-Entity
backdoor JJ 00101101000 I-Entity
thread NN 00101101101 I-Entity
then RB 101011111110 O
reads VBZ 101111101000 B-Verb
commands NNS 001111101100 B-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
chosen VBN 10100101101100 I-Entity
C2 NN 1111011011000 I-Entity
protocol NN 0011110111110 I-Entity
and CC 101110111 O
passes VBZ 101111101010 O
them PRP 1011111110000 O
on RP 1001010 O
to TO 101100 O
any DT 11111011111 O
of IN 1000 O
the DT 11010 O
following JJ 111101000 O
registered JJ 1010011011001 O
handler NN 11100100011 O
classes NNS 001111101000 O
based VBN 10100101010 O
upon IN 1011111111111011 O
a DT 11001 O
command NN 0010011100 O
ID NN 00111111000 O
. . 0110 O

The DT 010000 O
handler NN 11100100011 O
class NN 0010011111110 O
is VBZ 101101010 O
responsible JJ 10101011000 O
for IN 10011111 O
parsing VBG 11101110111 O
the DT 11010 O
remainder NN 0001111011 O
of IN 1000 O
the DT 11010 O
command NN 0010011100 O
. . 0110 O

This DT 0100010 B-Entity
handler NN 11100100011 I-Entity
class NN 0010011111110 I-Entity
for IN 10011111 I-Entity
command NN 0010011100 I-Entity
ID NN 00111111000 I-Entity
8 CD 01111111101100 I-Entity
implements VBZ 1011111010110 B-Verb
generic JJ 11110001111111 B-Entity
directory NN 0011111111101 I-Entity
and CC 101110111 I-Entity
file NN 00100100 I-Entity
browsing NN 101000001111 I-Entity
using VBG 100101111110 B-Preposition
FindFirstFileW FW X B-Entity
( FW 01111000 I-Entity
) NN 011110100 I-Entity
and CC 101110111 I-Entity
FindNextFileW NN X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
APIs NNS 0111101101101 I-Entity
, , 1011100 O
as RB 10111111110 O
well RB 101111111011 O
as IN 10111111110 O
reading VBG 111000111011 B-Verb
and CC 101110111 O
writing VBG 0011001010 B-Verb
arbitrary JJ 111101111110100 B-Entity
files NNS 0011011110 I-Entity
via IN 100101111011 B-Preposition
C2 NN 1111011011000 B-Entity
commands NNS 001111101100 I-Entity
, , 1011100 O
thus RB 1010111010111 O
enabling VBG 10111111111100 O
upload NN 10101011111001 B-Verb
and CC 101110111 O
download NN 10101011111010 B-Verb
of IN 1000 O
arbitrary JJ 111101111110100 B-Entity
files NNS 0011011110 I-Entity
. . 0110 O

This DT 0100010 O
is VBZ 101101010 O
typically RB 10101111111101 O
seen VBN 101001110010 O
in IN 100110 O
RATs NNS 1110110001 B-Entity
for IN 10011111 O
searching VBG 101010110011 B-Verb
specific JJ 111100001110 B-Entity
files NNS 0011011110 I-Entity
to TO 101100 O
exfiltrate VB 10101000111 B-Verb
. . 0110 O

Additionally RB 010110 O
, , 1011100 O
this DT 110110 B-Entity
class NN 0010011111110 I-Entity
implements VBZ 1011111010110 O
launching NN 00100011111 B-Verb
of IN 1000 O
specified JJ 1111011101001 B-Entity
executable JJ 001001111100 I-Entity
files NNS 0011011110 I-Entity
via IN 100101111011 B-Preposition
the DT 11010 B-Entity
CreateProcess NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
. . 0110 O

This DT 0100010 B-Entity
handler NN 11100100011 I-Entity
class NN 0010011111110 I-Entity
implements VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
generic JJ 11110001111111 I-Entity
TCP NN 11110110100 I-Entity
proxy NN 1111011011011 I-Entity
. . 0110 O

It PRP 01001010 B-Entity
supports VBZ 10010111111100 O
establishing VBG 101111111111011 B-Verb
TCP NNP 11110110100 B-Entity
connections NNS 0011110100101 I-Entity
to TO 101100 B-Preposition
other JJ 111110010 B-Entity
hosts NNS 001100110010 I-Entity
and CC 101110111 O
also RB 10101111110 O
listening VBG 111100010000 B-Verb
for IN 10011111 B-Preposition
incoming JJ 11110110100 B-Entity
connections NNS 0011110100101 I-Entity
. . 0110 O

The DT 010000 B-Entity
incoming JJ 11110110100 I-Entity
connection NN 001111010001 I-Entity
contents NNS 0001111010 I-Entity
are VBP 101101001 B-Verb
forwarded VBN 10100110111011 I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
and CC 101110111 O
data NNS 001111001 B-Entity
from IN 100101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
is VBZ 101101010 B-Verb
passed VBN 10100110111011 I-Verb
on RP 1001010 B-Preposition
to TO 101100 I-Preposition
connections NNS 0011110100101 B-Entity
. . 0110 O

It PRP 01001010 O
supports VBZ 10010111111100 O
up IN 10111111100111 O
to TO 101100 O
1024 CD 011111111100 O
parallel JJ 000000 O
connections NNS 0011110100101 O
. . 0110 O

The DT 010000 B-Entity
malware NN 00101100 I-Entity
is VBZ 101101010 O
capable JJ 00010000 O
of IN 1000 O
gathering VBG 111000111000 B-Verb
various JJ 111110011100 B-Entity
pieces NNS 0011010000 I-Entity
of IN 1000 I-Entity
information NN 001111000 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
system NN 001000000 I-Entity
, , 1011100 O
triggered VBN 1010010111100 O
by IN 1001110 O
a DT 11001 O
command NN 0010011100 O
ID NN 00111111000 O
10 CD 0111111111010 O
. . 0110 O

The DT 010000 O
capabilities NNS 0011001111001 O
include VBP 1010101110110 O
recovering VBG X B-Verb
authentication NN 001010110010 B-Entity
credentials NNS 00110001000 I-Entity
from IN 100101100 B-Preposition
various JJ 111110011100 B-Entity
system NN 001000000 I-Entity
and CC 101110111 I-Entity
client NN 00100001110 I-Entity
storage NN 0011110111100 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
Mozilla NNP 111011111010 I-Entity
Firefox NNP 0111111010 I-Entity
, , 1011100 I-Entity
Internet NNP 0010111010 I-Entity
Explorer NNP 011111110101 I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
Remote JJ 1110110101 I-Entity
Access NN 0111101101100 I-Entity
Service NNP 0111101100011 I-Entity
( NNP 01111000 I-Entity
RAS NNP X I-Entity
) NNP 011110100 I-Entity
. . 0110 O

This DT 0100010 B-Entity
class NN 0010011111110 I-Entity
also RB 10101111110 O
supports VBZ 10010111111100 O
gathering NN 111000111000 B-Verb
intelligence NN 00100010110 B-Entity
on IN 1001010 I-Entity
the DT 11010 I-Entity
infected JJ 111101111000 I-Entity
system NN 001000000 I-Entity
including VBG 101111111110111 O
identifying VBG 101111111111010 B-Verb
security NN 11100011010 B-Entity
tools NNS 0011001111011 I-Entity
by IN 1001110 B-Preposition
their PRP$ 11011100 B-Entity
process NN 001001111011 I-Entity
name NN 00111111010 I-Entity
, , 1011100 O
proxy NN 1111011011011 B-Entity
accounts NNS 0011110111000 I-Entity
, , 1011100 O
and CC 101110111 O
version NN 00011000 B-Entity
numbers NNS 0011111011111 I-Entity
for IN 10011111 I-Entity
the DT 11010 I-Entity
Operating NNP 0111101100100 I-Entity
System NNP 0111101101011 I-Entity
( NNP 01111000 I-Entity
OS NNP 1111011100110 I-Entity
) NNP 011110100 I-Entity
and CC 101110111 O
Internet NNP 0010111010 B-Entity
Explorer NNP 011111110101 I-Entity
. . 0110 O

This DT 0100010 B-Entity
handler NN 11100100011 I-Entity
class NN 0010011111110 I-Entity
provides VBZ 1011111011100 O
the DT 11010 O
attacker NN 00101111100 O
with IN 100100 O
the DT 11010 O
ability NN 101000110011 O
to TO 101100 O
manage VB 10101001010 B-Verb
system NN 001000000 B-Entity
components NNS 001111101000 I-Entity
including VBG 101111111110111 O
start VB 101010111111000 B-Verb
/ / 0111011111110 O
stop VB 101010111111111 B-Verb
/ / 0111011111110 O
delete VB 10101001011 B-Verb
system NN 001000000 B-Entity
services NNS 001100011011 I-Entity
, , 1011100 O
enumerate VB 10101001001 B-Verb
/ / 0111011111110 O
alter VB 1010101110101 B-Verb
registry NN 111101110001 B-Entity
keys NNS 0011111110111 I-Entity
, , 1011100 O
and CC 101110111 O
manage VB 10101001010 B-Verb
running VBG 10100101111101 B-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

This DT 0100010 B-Entity
class NN 0010011111110 I-Entity
also RB 10101111110 O
provides VBZ 1011111011100 O
the DT 11010 O
ability NN 101000110011 O
for IN 10011111 O
the DT 11010 O
attacker NN 00101111100 O
to TO 101100 O
take VB 10101000001 B-Verb
a DT 11001 B-Entity
screen NN 00100011010 I-Entity
shot NN 000101101 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
users NNS 001100100010 I-Entity
desktop NN 111000110010 I-Entity
. . 0110 O

This DT 0100010 B-Entity
handler NN 11100100011 I-Entity
class NN 0010011111110 I-Entity
uses VBZ 1011111010111 O
the DT 11010 O
command NN 0010011100 O
ID NN 00111111000 O
5 CD 01111111101110 O
and CC 101110111 O
implements VBZ 1011111010110 B-Verb
an DT 11000 B-Entity
interactive JJ 111100100110 I-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
shell NN 0011111111011 I-Entity
accessible JJ 10100101101110 I-Entity
from IN 100101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
server NN 00111011 I-Entity
, , 1011100 O
containing VBG 10010111111111 O
a DT 11001 O
series NN 00010101 O
of IN 1000 O
built-in JJ 1111011101101 O
commands NNS 001111101100 O
. . 0110 O

If IN 0101011100 O
the DT 11010 O
input NN 11100000000 O
is VBZ 101101010 O
not RB 1010111100 O
in IN 100110 O
this DT 110110 O
list NN 0001011110 O
of IN 1000 O
built-in JJ 1111011101101 O
commands NNS 001111101100 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
attempts VBZ 101000111010 O
to TO 101100 O
invoke VB 10101001010 B-Verb
cmd.exe NN 11110110100 B-Entity
in IN 100110 B-Preposition
the DT 11010 B-Entity
background NN 0010111011 I-Entity
, , 1011100 O
launching VBG 00100011111 B-Verb
a DT 11001 B-Entity
command NN 0010011100 I-Entity
or CC 101110110 I-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
utility NN 1110001010 I-Entity
already RB 10101111101111 I-Entity
present JJ 101001011111111 I-Entity
on IN 1001010 I-Entity
the DT 11010 I-Entity
system NN 001000000 I-Entity
. . 0110 O

The DT 010000 B-Entity
standard JJ 11110001111110 I-Entity
output NN 001001110101 I-Entity
channel NN 0011110111110 I-Entity
of IN 1000 I-Entity
that DT 101111110 I-Entity
command NN 0010011100 I-Entity
is VBZ 101101010 B-Verb
provided VBN 101001100001 I-Verb
back RB 101000110111 B-Preposition
to TO 101100 I-Preposition
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
. . 0110 O

The DT 010000 O
supported VBN 1010011000110 O
built-in JJ 1111011101101 O
commands NNS 001111101100 O
are VBP 101101001 O
: : 0111010 O
The DT 010000 O
only JJ 10101110010 O
command NN 0010011100 O
that WDT 101111110 O
is VBZ 101101010 O
implemented VBN 10100101111011 O
directly RB 10101110000 O
in IN 100110 O
the DT 11010 O
main JJ 11110101101 O
backdoor JJ 00101101000 O
thread NN 00101101101 O
as IN 10111111110 O
a DT 11001 O
subprocedure NN X O
call NN 10101010101 O
and CC 101110111 O
not RB 1010111100 O
via IN 100101111011 O
a DT 11001 O
generic JJ 11110001111111 O
command NN 0010011100 O
handler NN 11100100011 O
class NN 0010011111110 O
is VBZ 101101010 O
command NN 0010011100 O
ID NN 00111111000 O
256 CD X O
. . 0110 O

This DT 0100010 O
command NN 0010011100 O
results VBZ 0011111011111 O
in IN 100110 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
deleting VBG 101111111111010 B-Verb
itself PRP 10111111100010 B-Entity
and CC 101110111 O
terminating VBG 11101110111 B-Verb
the DT 11010 B-Entity
backdoor JJ 00101101000 I-Entity
process NN 001001111011 I-Entity
. . 0110 O

This DT 0100010 O
sample NN 0010100000 O
is VBZ 101101010 O
a DT 11001 O
packed JJ 10100100100 O
32-bit JJ 1111011101110 O
kernel NN 11100000111 O
driver NN 00101101111 O
extracted VBN 10101110001 O
by IN 1001110 O
the DT 11010 O
aforementioned JJ 11110101111 O
DLL NN 00101101110 O
with IN 100100 O
an DT 11000 O
MD5 NN 01110110000 O
hash NN 00111111001 O
of IN 1000 O
: : 0111010 O
de7500fc1065a081180841f32f06a537 NN X O
, , 1011100 O
this DT 110110 O
sample NN 0010100000 O
will MD 10110111111 O
only RB 10101110010 O
function VB 001010110111 O
on IN 1001010 O
a DT 11001 O
Windows NNP 1110110100 O
32-bit JJ 1111011101110 O
kernel NN 11100000111 O
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Sunday NNP 0111111111101 O
October NNP 01111101010 O
9 CD 01111111101100 O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
4:50:31 CD X O
P.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
very RB 1111111100 O
early JJ 01111101011 O
morning NN X O
time NN 00011010 O
of IN 1000 O
Monday NNP 0111111111101 O
, , 1011100 O
October NNP 01111101010 O
10 CD 0111111111010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

This DT 0100010 O
section NN 0011111111110 O
describes VBZ 1011111011110 O
how WRB 1011111111111000 O
the DT 11010 O
driver NN 00101101111 O
performs VBZ 1011111010110 O
its PRP$ 11011101 O
initialization NN 00100011111 O
routine NN 0011111110111 O
. . 0110 O

The DT 010000 B-Entity
driver NN 00101101111 I-Entity
begins VBZ 101111100001 O
by IN 1001110 O
opening VBG 10111111111100 B-Verb
a DT 11001 B-Entity
named VBN 10100101001 I-Entity
event NN 0010101111110 I-Entity
in IN 100110 B-Preposition
the DT 11010 B-Entity
BaseNamedObjects NNS X I-Entity
object VBP 11100100011 I-Entity
directory NN 0011111111101 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
name NN 00111111010 I-Entity
{ NNP 0111011111100 I-Entity
8CB2ff21-0166-4cf1-BD8F-E190BC7902DC NNP X I-Entity
} NNP 0111011111100 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
Windows NNP 1110110100 I-Entity
API NNP 0111101101101 I-Entity
ZwOpenEvent NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 O
event NN 0010101111110 O
already RB 10101111101111 O
exists VBZ 1010010111001 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
fails VBZ 001111011011 O
to TO 101100 O
load VB 10101001000 O
, , 1011100 O
presumably RB 1010111011010 O
to TO 101100 O
avoid VB 101010011010 B-Verb
a DT 11001 O
multiple JJ 111110011101 B-Entity
instances NNS 00110100110 I-Entity
of IN 1000 I-Entity
itself PRP 10111111100010 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 O
event NN 0010101111110 O
does VBZ 1011011100 O
not RB 1010111100 O
exist VB 1010010111000 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
then RB 101011111110 O
creates VBZ 1011111010110 B-Verb
it PRP 101111010 B-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
Windows NNP 1110110100 I-Entity
API NNP 0111101101101 I-Entity
ZwCreateEvent NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

The DT 010000 O
Windows NNP 1110110100 O
API NNP 0111101101101 O
for IN 10011111 O
creating VBG 101111111111011 O
events NNS 0011001101001 O
( NNP 01111000 O
ZwCreateEvent NNP X O
( NNP 01111000 O
) NNP 011110100 O
, , 1011100 O
or CC 101110110 O
CreateEvent FW X O
( FW 01111000 O
) NN 011110100 O
in IN 100110 O
user NN 0010000110 O
mode NN 0011110111111 O
) NN 011110100 O
already RB 10101111101111 O
provides VBZ 1011111011100 O
the DT 11010 O
ability NN 101000110011 O
to TO 101100 O
'' '' 0111101110 O
create-or-open JJ X O
'' '' 0111101110 O
an DT 11000 O
event NN 0010101111110 O
, , 1011100 O
so IN 101111111110010 O
the DT 11010 O
use NN 10101011100 O
of IN 1000 O
an DT 11000 O
initial JJ 111101111111101 O
ZwOpenEvent NN X O
is VBZ 101101010 O
superfluous JJ X O
and CC 101110111 O
indicative JJ 00010000 O
of IN 1000 O
relatively RB 1111111101 O
limited JJ 111100010101 O
Windows NNP 1110110100 O
API NNP 0111101101101 O
knowledge NN 0001110100 O
of IN 1000 O
the DT 11010 O
author NN 00001110 O
of IN 1000 O
that DT 101111110 O
part NN 00010001 O
of IN 1000 O
the DT 11010 O
code NN 001001010 O
. . 0110 O

It PRP 01001010 O
is VBZ 101101010 O
interesting JJ 10100000101 O
to TO 101100 O
note VB 1010101001 O
that IN 101111110 O
some DT 11111011110 O
of IN 1000 O
the DT 11010 O
hex NN 1111011100100 O
digits NNS 00011111010 O
in IN 100110 O
the DT 11010 O
object NN 11100100011 O
name NN 00111111010 O
are VBP 101101001 O
mixed JJ X O
case NN 00001100 O
which WDT 101111011 O
is VBZ 101101010 O
potentially RB 101011101001 O
indicative JJ 00010000 O
of IN 1000 O
the DT 11010 O
code NN 001001010 O
being VBG 101011111000 O
re-appropriated JJ X O
from IN 100101100 O
another DT 11111011100 O
source NN 00100110111 O
. . 0110 O

The DT 010000 B-Entity
second JJ 11110101010 I-Entity
component NN 00101000011 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
entry NN 0010101110110 I-Entity
point NN 00101001001 I-Entity
performs VBZ 1011111010110 B-Verb
an DT 11000 B-Entity
anti-debugging JJ X I-Entity
technique NN 001010001101 I-Entity
, , 1011100 O
calling VBG 11101110111 B-Verb
the DT 11010 B-Entity
function NN 001010110111 I-Entity
KdDisableDebugger NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 O
which WDT 101111011 O
allows VBZ 101111100100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
to TO 101100 O
disable VB 101010011010 B-Verb
usage NN 000111100 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
built-in JJ 1111011101101 I-Entity
Windows NNP 1110110100 I-Entity
kernel NN 11100000111 I-Entity
debugging NN 11110111110111 I-Entity
facility NN 0010011111010 I-Entity
that WDT 101111110 I-Entity
is VBZ 101101010 I-Entity
used VBN 1010011010 I-Entity
by IN 1001110 I-Entity
popular JJ 1111000111001 I-Entity
kernel NN 11100000111 I-Entity
debuggers NNS X I-Entity
KD NN X I-Entity
and CC 101110111 I-Entity
WinDbg NNP X I-Entity
. . 0110 O

Tools NNS 0111101101011 O
such JJ 101111111010 O
as IN 10111111110 O
Syser NNP X O
Debugger NNP 00101001100 O
, , 1011100 O
or CC 101110110 O
debugging VBG 11110111110111 O
through IN 100101111010 O
a DT 11001 O
virtual JJ 11110111110101 O
machine NN 0010000011 O
are VBP 101101001 O
unaffected JJ X O
by IN 1001110 O
this DT 110110 O
technique NN 001010001101 O
. . 0110 O

The DT 010000 O
sample NN 0010100000 O
, , 1011100 O
rather RB 011110011101 O
than IN 011110111110 O
importing VBG X O
the DT 11010 O
KdDisableDebugger NNP X O
( NNP 01111000 O
) NNP 011110100 O
API NNP 0111101101101 O
using VBG 100101111110 O
conventional JJ 1111001011000 O
methods NNS 0011001111000 O
, , 1011100 O
looks VBZ 101010110010 O
up RP 10111111100111 O
the DT 11010 O
API NNP 0111101101101 O
through IN 100101111010 O
MmGetSystemRoutineAddress NNP X O
( NNP 01111000 O
) NNP 011110100 O
instead RB 00010010 O
. . 0110 O

All DT 0100111110 O
of IN 1000 O
the DT 11010 O
other JJ 111110010 O
APIs NNS 0111101101101 O
used VBN 1010011010 O
by IN 1001110 O
the DT 11010 O
driver NN 00101101111 O
are VBP 101101001 O
imported VBN 10100100010 O
normally RB 1010111011111 O
, , 1011100 O
so IN 101111111110010 O
this DT 110110 O
is VBZ 101101010 O
not RB 1010111100 O
a DT 11001 O
technique NN 001010001101 O
to TO 101100 O
hide VB 101010011111 O
import NN 1111111010 O
APIs NNS 0111101101101 O
used VBN 1010011010 O
throughout IN 10010111111100 O
the DT 11010 O
driver NN 00101101111 O
. . 0110 O

Searching NN 10101011000 O
Google NNP 111011111100 O
for IN 10011111 O
'' '' 0111101110 O
MmGetSystemRoutineAddress NNP X O
'' '' 0111101110 O
and CC 101110111 O
'' '' 0111101110 O
KdDisableDebugger NNP X O
'' '' 0111101110 O
results VBZ 0011111011111 O
in IN 100110 O
dozens NNS 00010011 O
of IN 1000 O
Chinese JJ 111100110101 O
language NN 11100101011 O
blogs NNS X O
which WDT 101111011 O
explain VBP 10101010100 O
how WRB 1011111111111000 O
to TO 101100 O
use VB 10101011100 O
this DT 110110 O
technique NN 001010001101 O
to TO 101100 O
'' '' 0111101110 O
Disable NNP X O
WinDbg NNP X O
'' '' 0111101110 O
. . 0110 O

The DT 010000 B-Entity
final JJ 111101111111100 I-Entity
step NN 001010001101 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
entry NN 0010101110110 I-Entity
point NN 00101001001 I-Entity
is VBZ 101101010 O
to TO 101100 O
begin VB 101010111111000 O
hooking VBG X B-Verb
the DT 11010 B-Entity
system NN 001000000 I-Entity
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
done VBN 101001100111 O
by IN 1001110 O
two CD 11111001100 O
helper NN X O
functions NNS 0011111011011 O
- : 01111001101 O
one CD 111110100 B-Entity
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
hook NN 1111011101111 B-Verb
the DT 11010 B-Entity
system NN 001000000 I-Entity
call NN 10101010101 I-Entity
table NN 000101101 I-Entity
, , 1011100 O
while IN 1011111111100111 O
the DT 11010 B-Entity
other JJ 111110010 I-Entity
hooks NNS 001111011011 B-Verb
the DT 11010 B-Entity
network NN 001000010 I-Entity
stack VB 001001111001 I-Entity
. . 0110 O

The DT 010000 B-Entity
network NN 001000010 I-Entity
stack VBP 001001111001 I-Entity
hooking VBG X I-Entity
first RB 1111010100 O
queries VBZ 00110001100 B-Verb
the DT 11010 B-Entity
OS NN 1111011100110 I-Entity
version NN 00011000 I-Entity
using VBG 100101111110 B-Preposition
RtlGetVersion NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
or CC 101110110 I-Entity
PsGetVersion NNP X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
. . 0110 O

Checking VBG X O
the DT 11010 O
version NN 00011000 O
is VBZ 101101010 O
necessary JJ 10100001001 O
because IN 1011111111111111 O
Windows NNP 1110110100 O
versions NNS 0011010001 O
beginning VBG 000111100 O
with IN 100100 O
Vista NNP 0111101101100 O
utilize VBP 101010011000 O
a DT 11001 O
redesigned VBN X O
TCP/IP NN X O
net- NN X O
work NN 1010101111000 O
stack VBP 001001111001 O
, , 1011100 O
most JJS 111111100 O
hooking VBG X O
operations NNS 001100011100 O
will MD 10110111111 O
require VB 1010101110100 O
a DT 11001 O
different JJ 1111000000 O
implementation NN 00011111000 O
for IN 10011111 O
these DT 11111000 O
versions NNS 0011010001 O
. . 0110 O

On IN 01010011 O
versions NNS 0011010001 O
prior RB 10100010101 O
to TO 101100 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
, , 1011100 O
the DT 11010 O
TCP/IP NN X O
driver NN 00101101111 O
creates VBZ 1011111010110 O
a DT 11001 O
\Device\Tcp NN X O
device NN 1111011101111 O
object NN 11100100011 O
through IN 100101111010 O
which WDT 101111011 O
most JJS 111111100 O
network NN 001000010 O
requests NNS 001111010101 O
are VBP 101101001 O
piped VBN X O
through IN 100101111010 O
. . 0110 O

On IN 01010011 O
Vista NNP 0111101101100 O
and CC 101110111 O
later RB 11100110011 O
, , 1011100 O
TCP/IP NN X O
has VBZ 1011011010 O
been VBN 10101101 O
split VBN 10100100010 O
up RP 10111111100111 O
into IN 10010111100 O
multiple JJ 111110011101 O
components NNS 001111101000 O
, , 1011100 O
and CC 101110111 O
IP NNP 1111011000 O
connection NN 001111010001 O
enumeration NN 01111011001101 O
, , 1011100 O
which WDT 101111011 O
this DT 110110 O
driver NN 00101101111 O
is VBZ 101101010 O
targeting VBG 111000111010 O
, , 1011100 O
is VBZ 101101010 O
managed VBN 101000111011 O
by IN 1001110 O
\Device\nsiproxy NN X O
instead RB 00010010 O
. . 0110 O

In IN 0101000 O
either DT 1010111011100 O
case NN 00001100 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
obtains VBZ X O
the DT 11010 O
device NN 1111011101111 O
object NN 11100100011 O
by IN 1001110 O
using VBG 100101111110 O
IoGetDeviceObjectPointer NNP X O
( FW 01111000 O
) FW 011110100 O
and CC 101110111 O
hooks VBZ 001111011011 B-Verb
Major JJ 11101110101 B-Entity
Function NN X I-Entity
14 CD 0111111111101 I-Entity
the DT 11010 I-Entity
IRPMJDEVICECONTROL NN X I-Entity
, , 1011100 O
as IN 10111111110 O
this DT 110110 O
is VBZ 101101010 O
the DT 11010 O
function NN 001010110111 O
through IN 100101111010 O
which WDT 101111011 O
all DT 1111101100 O
Input NNP X O
Output NN X O
ConTroLls NNP X O
( NNP 01111000 O
IOCTLs NNP X O
) NNP 011110100 O
are VBP 101101001 O
sent VBN 10100110111011 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
the DT 11010 O
IOCTL NN 111101111111010 O
for IN 10011111 O
querying VBG 1011111111111011 O
active JJ 10100000010 O
IP NNP 1111011000 O
connections NNS 0011110100101 O
. . 0110 O

The DT 010000 O
NSI NNP X O
hook NN 1111011101111 O
, , 1011100 O
targets VBZ 00110010111 O
IOCTL NNP 111101111111010 O
0x12001B NNP X O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
used VBN 1010011010 O
by IN 1001110 O
NsiGetObjectAllParameters NNP X O
( NNP 01111000 O
) NNP 011110100 O
in IN 100110 O
nsi.dll NNP X O
when WRB 100101110010 O
users NNS 001100100010 O
typically RB 10101111111101 O
run VBP 101010111111100 O
commands NNS 001111101100 O
such JJ 101111111010 O
as IN 10111111110 O
netstat.exe NN X O
or CC 101110110 O
use VB 10101011100 O
any DT 11111011111 O
of IN 1000 O
the DT 11010 O
IP NNP 1111011000 O
Helper NNP X O
APIs NNPS 0111101101101 O
in IN 100110 O
iphlpapi.dll NNP X O
. . 0110 O

The DT 010000 O
purpose NN 00011111011 O
of IN 1000 O
the DT 11010 B-Entity
hook NN 1111011101111 I-Entity
is VBZ 101101010 O
to TO 101100 O
scan VB 101010101110 B-Verb
the DT 11010 B-Entity
list NN 0001011110 I-Entity
of IN 1000 I-Entity
active JJ 10100000010 I-Entity
connections NNS 0011110100101 I-Entity
returned VBD 10100101101101 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
user NN 0010000110 I-Entity
, , 1011100 O
and CC 101110111 O
hide VB 101010011111 B-Verb
any DT 11111011111 B-Entity
such JJ 101111111010 I-Entity
connection NN 001111010001 I-Entity
currently RB 1010111011111 I-Entity
bound VBD 10100010111 I-Entity
to TO 101100 I-Entity
a DT 11001 I-Entity
local JJ 111101111111110 I-Entity
TCP NN 11110110100 I-Entity
port NN 11100111110 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
range NN 0001111110 I-Entity
between IN 10010110100 I-Entity
40000 CD X I-Entity
and CC 101110111 I-Entity
45000 CD X I-Entity
. . 0110 O

The DT 010000 B-Entity
hooking VBG X I-Entity
is VBZ 101101010 B-Verb
performed VBN 1010011000111 I-Verb
by IN 1001110 B-Preposition
creating VBG 101111111111011 B-Entity
a DT 11001 I-Entity
new JJ 11110000010 I-Entity
completion NN 1010101111010 I-Entity
routine NN 0011111110111 I-Entity
associated VBN 10100100101 I-Entity
with IN 100100 I-Entity
any DT 11111011111 I-Entity
IRPMJDEVICECONTROL NN X I-Entity
IRP NN X I-Entity
that WDT 101111110 I-Entity
matches VBZ 1011111011111 I-Entity
the DT 11010 I-Entity
IOCTL NNP 111101111111010 I-Entity
, , 1011100 I-Entity
attaching VBG X I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
target NN 111101111010 I-Entity
process NN 001001111011 I-Entity
, , 1011100 I-Entity
performing VBG 101111111111011 I-Entity
several JJ 111110011110 I-Entity
memory NN 00100011100 I-Entity
copies NNS 101111100010 I-Entity
to TO 101100 I-Entity
hide VB 101010011111 I-Entity
the DT 11010 I-Entity
entry NN 0010101110110 I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
detaching VBG X I-Entity
. . 0110 O

This DT 0100010 O
functionality NN 00011111001 O
is VBZ 101101010 O
nearly RB 11111011011 O
identical JJ 10100001000 O
to TO 101100 O
the DT 11010 O
code NN 001001010 O
posted VBN 1010011011011 O
by IN 1001110 O
Edward NNP X O
Sun NNP X O
( FW 01111000 O
aka FW 01110111001 O
cardmagic NN X O
, , 1011100 O
sunmy1 NN X O
@ SYM 011101111100 O
sina.com NNP X O
, , 1011100 O
onlyonejazz NN X O
@ IN 011101111100 O
hotmail.com NN 01111011110 O
, , 1011100 O
cardcian NN X O
@ IN 011101111100 O
mail.ustc.edu.cn NNP X O
, , 1011100 O
QQ NNP 1111011101010 O
# # 011101111111111 O
28025945 CD X O
) CD 011110100 O
from IN 100101100 O
Hefei NNP X O
, , 1011100 O
Anhui NNP X O
province NN 00101001111 O
( NNP 01111000 O
Nanjing NNP X O
Military NNP 0111101100100 O
District NNP X O
) NNP 011110100 O
on IN 1001010 O
July NNP 01111101001 O
8 CD 01111111101100 O
, , 1011100 O
2007 CD 01111110010 O
, , 1011100 O
then RB 101011111110 O
a DT 11001 O
China-based JJ 111100010010 O
researcher NN 001010001111 O
at IN 10011110 O
Trend NNP 11101110101 O
Micro NNP 01111011001110 O
( NNP 01111000 O
now RB 1010111011110 O
working VBG 10100101111100 O
at IN 10011110 O
Kingsoft NNP X O
Chinese NNP 111100110101 O
AV NNP 111101111110101 O
Company NNP 01111101111 O
; : 0111100100 O
LinkedIn NN 111100010111 O
profile NN 0010001000 O
page NN 0011111111001 O
: : 0111010 O
http NN 01110110011 O
: : 0111010 O
//www.linkedin.com/profile/view NN X O
? . 0111011111010 O
id=84082731 FW X O
) FW 011110100 O
at IN 10011110 O
http NN 01110110011 O
: : 0111010 O
//forum.eviloctal.com/viewthread.php NN X O
? . 0111011111010 O
action=printable NNP X O
& CC 01110010 O
tid=29604 NNP X O
( NNP 01111000 O
See NNP 1010101000 O
Appendix NNP 01111101110 O
G NNP 011111111000 O
) NNP 011110100 O
. . 0110 O

CrowdStrike NNP 11101110101 O
has VBZ 1011011010 O
no DT 11111011101 O
information NN 001111000 O
connecting VBG 10100010000 O
Mr. NNP 1010101001 O
Sun NNP X O
to TO 101100 O
this DT 110110 O
intrusion NN 0011110111011 O
activity NN 00110001011 O
, , 1011100 O
his PRP$ 110111110 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
appropriated VBN X O
by IN 1001110 O
the DT 11010 O
actor NN 0010101001 O
to TO 101100 O
add VB 101010011011 O
similar JJ 10100001111 O
functionality NN 00011111001 O
to TO 101100 O
their PRP$ 11011100 O
code NN 001001010 O
. . 0110 O

The DT 010000 B-Entity
TCP NN 11110110100 I-Entity
hook NN 1111011101111 I-Entity
works VBZ 1010010111001 O
almost RB 11111011011 O
identically RB X O
to TO 101100 O
the DT 11010 O
NSI NNP X O
hook NN 1111011101111 O
, , 1011100 O
though IN 1011111111100110 O
instead RB 00010010 O
hooking VBG X B-Verb
IOCTL NNP 111101111111010 B-Entity
0x120003 NNP X I-Entity
( NNP 01111000 I-Entity
IOCTL NNP 111101111111010 I-Entity
TCPQUERYINFORMATIONEX NNP X I-Entity
) NNP 011110100 I-Entity
. . 0110 O

This NNP 0100010 O
IOCTL NNP 111101111111010 O
has VBZ 1011011010 O
the DT 11010 O
exact JJ 11110101111 O
same JJ 111101001 O
functionality NN 00011111001 O
as IN 10111111110 O
the DT 11010 O
NSI NNP X O
specific JJ 111100001110 O
IOCTL NN 111101111111010 O
. . 0110 O

This DT 0100010 O
IOCTL NN 111101111111010 O
was VBD 101101011 O
the DT 11010 O
mechanism NN 00101001101 O
used VBN 1010011010 O
on IN 1001010 O
Windows NNP 1110110100 O
versions NNS 0011010001 O
prior RB 10100010101 O
to TO 101100 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
. . 0110 O

This DT 0100010 B-Entity
hook NN 1111011101111 I-Entity
also RB 10101111110 O
filters VBZ 01111011001101 B-Verb
any DT 11111011111 B-Entity
connections NNS 0011110100101 I-Entity
listening VBG 111100010000 I-Entity
on IN 1001010 I-Entity
TCP NNP 11110110100 I-Entity
ports NNS 1110110001 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
range NN 0001111110 I-Entity
between IN 10010110100 I-Entity
40000 CD X I-Entity
and CC 101110111 I-Entity
45000 CD X I-Entity
. . 0110 O

The DT 010000 O
system NN 001000000 O
call NN 10101010101 O
hooking VBG X O
targets NNS 00110010111 O
three CD 11111001101 O
functions NNS 0011111011011 O
: : 0111010 O
ZwSaveKey NNP X O
( NNP 01111000 O
) NNP 011110100 O
, , 1011100 O
ZwQueryValueKey NNP X O
( NNP 01111000 O
) NNP 011110100 O
, , 1011100 O
and CC 101110111 O
ZwEnumerateValueKey NNP X O
( NNP 01111000 O
) NNP 011110100 O
. . 0110 O

The DT 010000 B-Entity
unpacked JJ 10100100011 I-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
sample NN 0010100000 I-Entity
hooks VBZ 001111011011 B-Verb
these DT 11111000 B-Entity
functions NNS 0011111011011 I-Entity
by IN 1001110 B-Preposition
reading VBG 111000111011 B-Entity
the DT 11010 I-Entity
second JJ 11110101010 I-Entity
DWORD NN 01110111100 I-Entity
at IN 10011110 I-Entity
each DT 1111101010 I-Entity
of IN 1000 I-Entity
these DT 11111000 I-Entity
exported VBN 111101111111010 I-Entity
functions NNS 0011111011011 I-Entity
. . 0110 O

Because IN 01010011 O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
stub NN 001111010100 O
uses VBZ 1011111010111 O
the DT 11010 O
EAX NN X O
register NN 10101001001 O
as IN 10111111110 O
an DT 11000 O
index NN 1111111010 O
for IN 10011111 O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
ID NN 00111111000 O
, , 1011100 O
and CC 101110111 O
a DT 11001 O
'' '' 0111101110 O
mov NN X O
eax NN X O
, , 1011100 O
imm32 NN X O
'' '' 0111101110 O
instruction NN 0011110111100 O
'' '' 0111101110 O
instruction NN 0011110111100 O
is VBZ 101101010 O
used VBN 1010011010 O
, , 1011100 O
this DT 110110 O
second JJ 11110101010 O
DWORD NNP 01110111100 O
will MD 10110111111 O
match VB 1010101110100 O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
ID NN 00111111000 O
. . 0110 O

It PRP 01001010 O
then RB 101011111110 O
adds VBZ 1011111010110 O
this DT 110110 O
index NN 1111111010 O
to TO 101100 O
the DT 11010 O
value NN 001111111000 O
of IN 1000 O
KeServiceDescriptorTable.Base NN X O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
the DT 11010 O
exported VBN 111101111111010 O
kernel NN 11100000111 O
variable JJ 111000110011 O
( NN 01111000 O
on IN 1001010 O
32-bit JJ 1111011101110 O
Windows NNP 1110110100 O
only RB 10101110010 O
) CD 011110100 O
which WDT 101111011 O
directly RB 10101110000 O
points VBZ 001111011000 O
to TO 101100 O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
table NN 000101101 O
. . 0110 O

This DT 0100010 O
is VBZ 101101010 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
simplest JJS X O
ways NNS 0011110101110 O
to TO 101100 O
do VB 10110111011 O
a DT 11001 O
system NN 001000000 O
call NN 10101010101 O
hook NN 1111011101111 O
, , 1011100 O
but CC 10111111111000 O
will MD 10110111111 O
not RB 1010111100 O
work VB 1010101111000 O
on IN 1001010 O
64-bit JJ 1111011101110 O
Windows NNP 1110110100 O
as IN 10111111110 O
this DT 110110 O
variable NN 111000110011 O
is VBZ 101101010 O
not RB 1010111100 O
exported VBN 111101111111010 O
in IN 100110 O
addition NN 0000010 O
to TO 101100 O
the DT 11010 O
protection NN 0001110011 O
provided VBN 101001100001 O
by IN 1001110 O
Microsoft NNP 1110110111 O
PatchGuard NNP X O
. . 0110 O

The DT 010000 B-Entity
system NN 001000000 I-Entity
call NN 10101010101 I-Entity
hook NN 1111011101111 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
performed VBN 1010011000111 I-Verb
by IN 1001110 B-Preposition
first RB 1111010100 B-Entity
allocating VBG X I-Entity
a DT 11001 I-Entity
Memory NN X I-Entity
Descriptor NN X I-Entity
List NN 01110111100 I-Entity
( CD 01111000 I-Entity
MDL NN X I-Entity
) NN 011110100 I-Entity
using VBG 100101111110 I-Entity
the DT 11010 I-Entity
Windows NNP 1110110100 I-Entity
API NNP 0111101101101 I-Entity
IoAllocateMdl NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
associating VBG X I-Entity
the DT 11010 I-Entity
MDL NN X I-Entity
to TO 101100 I-Entity
a DT 11001 I-Entity
non-paged JJ X I-Entity
buffer NN 0010011111111 I-Entity
using VBG 100101111110 I-Entity
MmBuildMdlForNonPagedPool NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

Once RB 0101011101 O
the DT 11010 O
MDL NN X O
is VBZ 101101010 O
associated VBN 10100100101 O
to TO 101100 O
the DT 11010 O
non-paged JJ X O
buffer NN 0010011111111 O
, , 1011100 O
the DT 11010 O
sample NN 0010100000 O
locks VBZ X O
the DT 11010 O
underlying VBG 111101111111100 O
pages NNS 0011111111000 O
using VBG 100101111110 O
the DT 11010 O
Windows NNP 1110110100 O
API NNP 0111101101101 O
MmProbeAndLockPages NNP X O
( NNP 01111000 O
) NNP 011110100 O
. . 0110 O

Instead RB 010110 O
of IN 1000 O
hooking VBG X O
the DT 11010 O
entry NN 0010101110110 O
in IN 100110 O
the DT 11010 O
table NN 000101101 O
directly RB 10101110000 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
easily RB 101011100111 O
detectable JJ X O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
uses VBZ 1011111010111 O
the DT 11010 O
LDASM FW X O
open-source FW 111101111111010 O
disassembly NN 0010111011 O
engine NN 001111011010 O
to TO 101100 O
analyze VB 10101001011 O
the DT 11010 O
function NN 001010110111 O
that WDT 101111110 O
is VBZ 101101010 O
being VBG 101011111000 O
pointed VBN 10100010000 O
to TO 101100 O
by IN 1001110 O
the DT 11010 O
table NN 000101101 O
, , 1011100 O
and CC 101110111 O
applying VBG X B-Verb
a DT 11001 B-Entity
Detours-style JJ X I-Entity
hook NN 1111011101111 I-Entity
directly RB 10101110000 B-Preposition
in IN 100110 I-Preposition
the DT 11010 B-Entity
code NN 001001010 I-Entity
. . 0110 O

It PRP 01001010 O
uses VBZ 1011111010111 O
the DT 11010 O
standard NN 11110001111110 O
'' '' 0111101110 O
mov FW X O
cr0 FW X O
, , 1011100 O
eax NN X O
'' '' 0111101110 O
technique NN 001010001101 O
, , 1011100 O
turning VBG X O
off RP 101111100010 O
the DT 11010 O
Write NNP X O
Protect NNP X O
( NNP 01111000 O
WP NNP X O
) NNP 011110100 O
bit VBD 11100101101 O
as IN 10111111110 O
it PRP 101111010 O
does VBZ 1011011100 O
this DT 110110 O
. . 0110 O

When WRB 0101011101 O
the DT 11010 O
hook NN 1111011101111 O
is VBZ 101101010 O
installed VBN 101001011111101 O
, , 1011100 O
it PRP 101111010 O
writes VBZ 101111101000 O
a DT 11001 O
special JJ 111100001101 O
DWORD NN 01110111100 O
value NN 001111111000 O
, , 1011100 O
'KDTR NN X O
' '' 0111101010 O
, , 1011100 O
which WDT 101111011 O
allows VBZ 101111100100 O
it PRP 101111010 O
to TO 101100 O
prevent VB 101010011010 O
double-hooking JJ X O
or CC 101110110 O
badly-hooking JJ X O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
, , 1011100 O
during IN 100101110110 O
unhooking NN X O
, , 1011100 O
this DT 110110 O
value NN 001111111000 O
is VBZ 101101010 O
also RB 10101111110 O
checked VBN 1010010110100 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
ZwSaveKey NN X O
( FW 01111000 O
) FW 011110100 O
hook NN 1111011101111 O
, , 1011100 O
access NN 10100011010 O
to TO 101100 O
\\REGISTRY\\MACHINE\\SYSTEM NN X O
is VBZ 101101010 O
blocked VBN 101001100110 O
. . 0110 O

RegSaveKey FW X O
( FW 01111000 O
) NN 011110100 O
which WDT 101111011 O
is VBZ 101101010 O
the DT 11010 O
user-mode JJ 0010111000 O
implementation NN 00011111000 O
of IN 1000 O
the DT 11010 O
kernel NN 11100000111 O
ZwSaveKey NNP X O
( NNP 01111000 O
) NNP 011110100 O
API NNP 0111101101101 O
, , 1011100 O
is VBZ 101101010 O
typically RB 10101111111101 O
used VBN 1010011010 O
when WRB 100101110010 O
performing VBG 101111111111011 O
an DT 11000 O
offline JJ 011111110100 O
backup NN 1110001101101 O
of IN 1000 O
a DT 11001 O
particular JJ 111100000111 O
registry NN 111101110001 O
key NN 001111111010 O
. . 0110 O

hook NN 1111011101111 O
is VBZ 101101010 O
the DT 11010 O
ZwQueryValueValue NNP X O
( NNP 01111000 O
) NNP 011110100 O
hook NN 1111011101111 O
, , 1011100 O
which WDT 101111011 O
looks VBZ 101010110010 O
for IN 10011111 O
'' '' 0111101110 O
Parameters NNS X O
'' '' 0111101110 O
key NN 001111111010 O
of IN 1000 O
a DT 11001 O
service NN 001001111110 O
within IN 100101111100 O
the DT 11010 O
registry NN 111101110001 O
at IN 10011110 O
\\REGISTRY\\MACHINE\\SYSTEM\\ControlSet001\\Services\\ NN X O
. . 0110 O

It PRP 01001010 B-Entity
then RB 101011111110 O
checks VBZ 101111101010 B-Verb
for IN 10011111 B-Preposition
the DT 11010 B-Entity
values NNS 0011111011110 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
'' '' 0111101110 I-Entity
ServiceDll NNP X I-Entity
'' '' 0111101110 I-Entity
and CC 101110111 I-Entity
'' '' 0111101110 I-Entity
Security NNP 01111011001111 I-Entity
'' '' 0111101110 I-Entity
keys NNS 0011111110111 I-Entity
, , 1011100 O
in IN 100110 O
the DT 11010 O
latter JJ 11110101110 O
case NN 00001100 O
it PRP 101111010 B-Entity
applies VBZ 101000110001 B-Verb
an DT 11000 B-Entity
XOR NN 1111011100101 I-Entity
on IN 1001010 B-Preposition
the DT 11010 B-Entity
data NNS 001111001 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
value NN 001111111000 I-Entity
127 CD X I-Entity
. . 0110 O

The DT 010000 O
user-mode JJ 0010111000 O
component NN 00101000011 O
of IN 1000 O
this DT 110110 O
malware NN 00101100 O
is VBZ 101101010 O
a DT 11001 O
service NN 001001111110 O
called VBN 10100101000 O
'' '' 0111101110 O
msupdate NN X O
'' '' 0111101110 O
, , 1011100 O
this DT 110110 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 O
attempting VBG 10100010100 O
to TO 101100 O
hide VB 101010011111 B-Verb
the DT 11010 B-Entity
service NN 001001111110 I-Entity
. . 0110 O

The DT 010000 O
user-mode JJ 0010111000 O
service NN 001001111110 O
stores NNS 101111101001 O
configuration NN 00100110010 O
data NNS 001111001 O
in IN 100110 O
the DT 11010 O
'' '' 0111101110 O
Security NNP 01111011001111 O
'' '' 0111101110 O
subkey NN 001111111001 O
of IN 1000 O
the DT 11010 O
RPC NNP 0111101101101 O
registry NN 111101110001 O
key NN 001111111010 O
, , 1011100 O
this DT 110110 O
component NN 00101000011 O
will MD 10110111111 O
obfuscate VB 101010011111 O
the DT 11010 O
user-mode JJ 0010111000 O
configuration NN 00100110010 O
data NNS 001111001 O
. . 0110 O

The DT 010000 O
driver NN 00101101111 O
does VBZ 1011011100 O
not RB 1010111100 O
make VB 101010011000 O
any DT 11111011111 O
efforts NNS 0011001111111 O
to TO 101100 O
hide VB 101010011111 O
its PRP$ 11011101 O
own JJ 0010001001 O
key NN 001111111010 O
, , 1011100 O
nor CC 1011111111111010 O
does VBZ 1011011100 O
it PRP 101111010 O
specifically RB 1010111010110 O
check VB 101010111111101 O
for IN 10011111 O
'' '' 0111101110 O
RPC NNP 0111101101101 O
'' '' 0111101110 O
before IN 100101110101 O
'' '' 0111101110 O
Security NNP 01111011001111 O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
can MD 10110111110 O
lead VB 101000110010 O
to TO 101100 O
random JJ 1111000111101 O
data NNS 001111001 O
being VBG 101011111000 O
obfuscated VBN 10100100011 O
. . 0110 O

The DT 010000 O
final JJ 111101111111100 O
hook NN 1111011101111 O
, , 1011100 O
ZwEnumerateValueKey NNP X O
( NNP 01111000 O
) NNP 011110100 O
, , 1011100 O
is VBZ 101101010 O
similar JJ 10100001111 O
in IN 100110 O
structure NN 001111100010 O
to TO 101100 O
the DT 11010 O
ZwQueryValueHook NNP X O
key NN 001111111010 O
, , 1011100 O
due JJ 10100010100 O
to TO 101100 O
the DT 11010 O
fact NN 00001101 O
that IN 101111110 O
these DT 11111000 O
APIs NNS 0111101101101 O
provide VBP 10101000011 O
almost RB 11111011011 O
identical JJ 10100001000 O
functionality NN 00011111001 O
when WRB 100101110010 O
it PRP 101111010 O
comes VBZ 101111100000 O
to TO 101100 O
reading VBG 111000111011 O
registry NN 111101110001 O
values NNS 0011111011110 O
. . 0110 O

In IN 0101000 B-Preposition
the DT 11010 B-Entity
registry NN 111101110001 I-Entity
hooking VBG X I-Entity
code NN 001001010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
driver NN 00101101111 I-Entity
, , 1011100 O
a DT 11001 B-Entity
call NN 10101010101 I-Entity
is VBZ 101101010 B-Verb
made VBN 10100101110110 I-Verb
to TO 101100 B-Preposition
ObReferenceObjectByHandle NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

This DT 0100010 O
allows VBZ 101111100100 O
the DT 11010 O
driver NN 00101101111 O
to TO 101100 O
receive VB 10101000001 O
the DT 11010 O
'CMKEYOBJECT NN X O
' '' 0111101010 O
which WDT 101111011 O
is VBZ 101101010 O
then RB 101011111110 O
used VBN 1010011010 O
with IN 100100 O
ObQueryNameString NNP X O
( NNP 01111000 O
) NNP 011110100 O
to TO 101100 O
get VB 10101000100 O
the DT 11010 O
key/value JJ X O
path NN 000110111 O
. . 0110 O

However RB 010110 O
, , 1011100 O
no DT 11111011101 O
call NN 10101010101 O
to TO 101100 O
ObDereferenceObject NNP X O
( NNP 01111000 O
) NNP 011110100 O
is VBZ 101101010 O
ever RB 10101111101111 O
made VBN 10100101110110 O
, , 1011100 O
which WDT 101111011 O
means VBZ 00101001011 O
that IN 101111110 O
all DT 1111101100 O
registry NN 111101110001 O
objects NNS 0011111011110 O
being VBG 101011111000 O
sent VBN 10100110111011 O
to TO 101100 O
these DT 11111000 O
APIs NNS 0111101101101 O
are VBP 101101001 O
eventually RB 10101111111110 O
leaked VBN 101001110011 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
registry NN 111101110001 O
hook NN 1111011101111 O
, , 1011100 O
it PRP 101111010 O
was VBD 101101011 O
noticed VBN 1010011111110 O
that IN 101111110 O
'' '' 0111101110 O
CurrentControlSet001 NN X O
'' '' 0111101110 O
was VBD 101101011 O
used VBN 1010011010 O
as IN 10111111110 O
the DT 11010 O
target NN 111101111010 O
, , 1011100 O
if IN 101111111111110 O
the DT 11010 O
target NN 111101111010 O
machine NN 0010000011 O
was VBD 101101011 O
using VBG 100101111110 O
a DT 11001 O
'' '' 0111101110 O
last JJ 0010111000 O
known JJ 1010000110 O
good JJ 1111000110011 O
'' '' 0111101110 O
configuration NN 00100110010 O
, , 1011100 O
or CC 101110110 O
a DT 11001 O
roaming VBG X O
hardware NN 0011110111011 O
profile NN 0010001000 O
, , 1011100 O
the DT 11010 O
registry NN 111101110001 O
hook NN 1111011101111 O
would MD 1011011110011 O
not RB 1010111100 O
function VB 001010110111 O
as IN 10111111110 O
intended VBN 10100001010 O
. . 0110 O

This DT 0100010 O
is VBZ 101101010 O
the DT 11010 O
reason NN 00101001000 O
the DT 11010 O
Microsoft NNP 1110110111 O
implemented VBD 10100101111011 O
a DT 11001 O
symbolic JJ X O
link NN 101000110000 O
to TO 101100 O
\\CurrentControlSet NN X O
which WDT 101111011 O
ensures VBZ 101111101100 O
that IN 101111110 O
regardless RB 00010010 O
of IN 1000 O
the DT 11010 O
machines NNS 001100110010 O
configuration NN 00100110010 O
any DT 11111011111 O
request NN 001111010100 O
will MD 10110111111 O
access VB 10100011010 O
the DT 11010 O
correct JJ 111100110100 O
registry NN 111101110001 O
key NN 001111111010 O
. . 0110 O

This DT 0100010 O
threat NN 1110000110 O
actor NN 0010101001 O
leaves VBZ 1011111001110 O
several JJ 111110011110 O
key JJ 001111111010 O
fingerprints NNS 00100101111 O
which WDT 101111011 O
can MD 10110111110 O
be VB 10101100 O
used VBN 1010011010 O
to TO 101100 O
identify VB 101010011101 O
compromised VBN 111101111001 O
systems NNS 00110011000 O
. . 0110 O

These DT 010011110 O
digital JJ 11110111110110 O
fingerprints NNS 00100101111 O
are VBP 101101001 O
unique JJ 1111011101010 O
to TO 101100 O
this DT 110110 O
adversary NN 001011111110 O
for IN 10011111 O
this DT 110110 O
campaign NN 0010101010 O
. . 0110 O

The DT 010000 O
following VBG 111101000 O
network NN 001000010 O
signatures NNS 0011110101110 O
are VBP 101101001 O
designed VBN 10100010111 O
for IN 10011111 O
the DT 11010 O
popular JJ 1111000111001 O
Open NNP 011110110100 O
Source NNP 01110110011 O
IDS NNP 11110111110110 O
called VBD 10100101000 O
Snort NNP 11101100110 O
. . 0110 O

These DT 010011110 O
signature NN 0011110101101 O
can MD 10110111110 O
be VB 10101100 O
ported VBN X O
to TO 101100 O
other JJ 111110010 O
formats NNS 00110101110 O
upon IN 1011111111111011 O
request NN 001111010100 O
. . 0110 O

The DT 010000 O
following VBG 111101000 O
file NN 00100100 O
system NN 001000000 O
artifacts NNS 001101110111 O
are VBP 101101001 O
indicative JJ 00010000 O
of IN 1000 O
a DT 11001 O
compromised VBN 111101111001 O
host NN 00100001111 O
: : 0111010 O
The DT 010000 O
following VBG 111101000 O
Windows NNP 1110110100 O
Registry NNP 01111011001111 O
artifacts NNS 001101110111 O
are VBP 101101001 O
indicative JJ 00010000 O
of IN 1000 O
a DT 11001 O
compromised VBN 111101111001 O
host NN 00100001111 O
: : 0111010 O
The DT 010000 O
backdoor NN 00101101000 O
may MD 101101111010 O
be VB 10101100 O
detected VBN 101001100110 O
by IN 1001110 O
several JJ 111110011110 O
different JJ 1111000000 O
Anti-Virus NNP 11101110111 O
products NNS 001100111001 O
under IN 10010111111110 O
a DT 11001 O
signature NN 0011110101101 O
with IN 100100 O
the DT 11010 O
name NN 00111111010 O
: : 0111010 O
Attribution NN 0111011111101 O
in IN 100110 O
the DT 11010 O
cyber NN 1111001000 O
domain NN 0010011010 O
is VBZ 101101010 O
always RB 101011100110 O
a DT 11001 O
tricky JJ X O
subject NN 001001110101 O
when WRB 100101110010 O
relying VBG 10100101011 O
solely RB 1010111011011 O
on IN 1001010 O
malicious JJ 1111011111000 O
samples NNS 0011011100 O
. . 0110 O

Compiler NNP X O
artifacts NNS 001101110111 O
and CC 101110111 O
language NN 11100101011 O
settings NNS 0011111110110 O
can MD 10110111110 O
of IN 1000 O
course NN 00011111110 O
be VB 10101100 O
deliberately RB 10101111111101 O
masked VBN X O
or CC 101110110 O
spoofed VBN 101000110001 O
. . 0110 O

CrowdStrike NNP 11101110101 O
uses VBZ 1011111010111 O
a DT 11001 O
unique JJ 1111011101010 O
approach NN 00101000101 O
of IN 1000 O
comprehensive JJ 1111000110111 O
threat NN 1110000110 O
analysis NN 0001110110 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
decipher VB X O
attributable JJ 10100010110 O
components NNS 001111101000 O
. . 0110 O

Based VBN 01001101 O
on IN 1001010 O
the DT 11010 O
corroborating JJ X O
evidence NN 0001110111 O
discovered VBN 1010011111110 O
in IN 100110 O
the DT 11010 O
course NN 00011111110 O
of IN 1000 O
this DT 110110 O
analysis NN 0001110110 O
, , 1011100 O
it PRP 101111010 O
appears VBZ 101000111001 O
there EX 10111100101 O
are VBP 101101001 O
numerous JJ 111100001010 O
indications NNS 0001110111 O
that IN 101111110 O
this DT 110110 O
is VBZ 101101010 O
a DT 11001 O
Chinese-speaking JJ X O
actor NN 0010101001 O
. . 0110 O

ZhuDongFangYu.exe NN X O
is VBZ 101101010 O
a DT 11001 O
component NN 00101000011 O
of IN 1000 O
360 CD X O
360 CD X O
, , 1011100 O
a DT 11001 O
Chinese JJ 111100110101 O
security NN 11100011010 O
product NN 001001111010 O
available JJ 1010011011110 O
from IN 100101100 O
http NN 01110110011 O
: : 0111010 O
//www.360.cn/ NN X O
. . 0110 O

This DT 0100010 O
is VBZ 101101010 O
particularly RB 1010111010111 O
relevant JJ 11100111100 O
in IN 100110 O
this DT 110110 O
case NN 00001100 O
because IN 1011111111111111 O
the DT 11010 B-Entity
backdoor JJ 00101101000 I-Entity
DLL NNP 00101101110 I-Entity
sample NN 0010100000 I-Entity
with IN 100100 I-Entity
an DT 11000 I-Entity
MD5 NN 01110110000 I-Entity
of IN 1000 I-Entity
de7500fc1065a081180841f32f06a537 NN X I-Entity
specifically RB 1010111010110 O
avoids VBZ X B-Verb
installing VBG 101111111111010 B-Entity
the DT 11010 I-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
on IN 1001010 I-Entity
a DT 11001 I-Entity
system NN 001000000 I-Entity
running VBG 10100101111101 I-Entity
this DT 110110 I-Entity
tool NN 001010001110 I-Entity
. . 0110 O

Speculatively RB X O
this DT 110110 O
may MD 101101111010 O
be VB 10101100 O
because IN 1011111111111111 O
this DT 110110 O
security NN 11100011010 O
product NN 001001111010 O
detects VBZ 101111101000 O
this DT 110110 O
rootkit NN 001011010110 O
, , 1011100 O
or CC 101110110 O
the DT 11010 O
author NN 00001110 O
was VBD 101101011 O
attempting VBG 10100010100 O
to TO 101100 O
prevent VB 101010011010 O
accidental JJ X O
infection NN 0010101110111 O
on IN 1001010 O
systems NNS 00110011000 O
running VBG 10100101111101 O
this DT 110110 O
Anti-Virus NNP 11101110111 O
product NN 001001111010 O
. . 0110 O

The DT 010000 O
obfuscation NN 1111011100110 O
of IN 1000 O
the DT 11010 O
KdDisableDebugger NN X O
( FW 01111000 O
) FW 011110100 O
function NN 001010110111 O
call NN 10101010101 O
is VBZ 101101010 O
seen VBN 101001110010 O
on IN 1001010 O
several JJ 111110011110 O
Chinese JJ 111100110101 O
language NN 11100101011 O
forums NNS 1110001101110 O
, , 1011100 O
and CC 101110111 O
can MD 10110111110 O
be VB 10101100 O
seen VBN 101001110010 O
being VBG 101011111000 O
reused VBN 10100101111011 O
in IN 100110 O
several JJ 111110011110 O
code NN 001001010 O
samples NNS 0011011100 O
on IN 1001010 O
those DT 111101111110111 O
forums NNS 1110001101110 O
. . 0110 O

As IN 01010100 O
previously RB 1010111110101 O
mentioned VBN 101001111011 O
there EX 10111100101 O
is VBZ 101101010 O
no DT 11111011101 O
advantage NN 0001110100 O
associated VBN 10100100101 O
with IN 100100 O
using VBG 100101111110 O
this DT 110110 O
call NN 10101010101 O
obfuscation NN 1111011100110 O
, , 1011100 O
and CC 101110111 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
reused VBN 10100101111011 O
for IN 10011111 O
no DT 11111011101 O
apparent JJ 111100001011 O
reason NN 00101001000 O
other JJ 111110010 O
than IN 011110111110 O
the DT 11010 O
attackers NNS 001011110 O
have VBP 101101100 O
copied VBN 1010011011100 O
code NN 001001010 O
directly RB 10101110000 O
from IN 100101100 O
forum NN 00101001111 O
code NN 001001010 O
. . 0110 O

While IN 010101101 O
the DT 11010 B-Entity
various JJ 111110011100 I-Entity
network NN 001000010 I-Entity
hooking VBG X I-Entity
techniques NNS 0011001111010 I-Entity
used VBN 1010011010 B-Verb
in IN 100110 B-Preposition
the DT 11010 B-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
may MD 101101111010 O
appear VB 101000111111 O
novel JJ 111100010011 O
or CC 101110110 O
well RB 101111111011 O
researched VBN X O
, , 1011100 O
upon IN 1011111111111011 O
close JJ 00100011000 O
inspection NN 0011110111100 O
it PRP 101111010 O
is VBZ 101101010 O
actually RB 1111111101 O
a DT 11001 O
line-for-line JJ X O
copy NN 0001011111 O
of IN 1000 O
an DT 11000 O
existing VBG 111101111110101 O
post NN 001010111101 O
from IN 100101100 O
the DT 11010 O
now-offline JJ X O
'rootkit.com NN X O
' '' 0111101010 O
by IN 1001110 O
a DT 11001 O
Chinese JJ 111100110101 O
language NN 11100101011 O
developer NN 001010110000 O
. . 0110 O

This DT 0100010 O
post NN 001010111101 O
is VBZ 101101010 O
currently RB 1010111011111 O
mirrored VBN X O
on IN 1001010 O
dozens NNS 00010011 O
of IN 1000 O
Chinese JJ 111100110101 O
hacking NN 111000011110 O
websites NNS 0011001101100 O
. . 0110 O

Similarly RB 010110 O
the DT 11010 O
system NN 001000000 O
call NN 10101010101 O
hooking VBG X O
is VBZ 101101010 O
less RBR 1111111111 O
impressive JJ X O
after IN 100101110100 O
searching VBG 101010110011 O
for IN 10011111 O
'' '' 0111101110 O
IoAllocateMdl NNP X O
'' '' 0111101110 O
and CC 101110111 O
'' '' 0111101110 O
cr0 NN X O
'' '' 0111101110 O
( FW 01111000 O
bbs.pediy FW X O
. . 0110 O

com/showthread.php NN X O
? . 0111011111010 O
t=77467 NN X O
perform VBP 101010011011 B-Verb
system NN 001000000 B-Entity
call NN 10101010101 I-Entity
hooking VBG X I-Entity
through IN 100101111010 B-Preposition
MDLs NNS X B-Entity
. . 0110 O

The DT 010000 O
ldasm NN X O
inline NN 111100010001 O
hooking VBG X O
is VBZ 101101010 O
also RB 10101111110 O
repeated VBN 1111000111010 O
in IN 100110 O
numerous JJ 111100001010 O
postings NNS 0011001111100 O
to TO 101100 O
Chinese JJ 111100110101 O
forums NNS 1110001101110 O
. . 0110 O

One CD 010011101 O
particular JJ 111100000111 O
website NN 001010110110 O
( FW 01111000 O
http FW 01110110011 O
: : 0111010 O
//read.pudn.com/downloads197/sourcecode/windows/sys- JJ X O
tem/927802/CCRootkit/RootkitSys/HookSSDT.c.htm NN X O
) NN 011110100 O
had VBD 1011011011 O
an DT 11000 O
almost RB 11111011011 O
identical JJ 10100001000 O
ldasm NN X O
loop NN 0011110111111 O
that WDT 101111110 O
tried VBD 101000111011 O
to TO 101100 O
identify VB 101010011101 O
the DT 11010 O
exact JJ 11110101111 O
same JJ 111101001 O
code NN 001001010 O
sequences NNS 00111111000 O
. . 0110 O

Open NNP 011110110100 O
source NN 00100110111 O
research NN 00100010101 O
of IN 1000 O
the DT 11010 O
4 CD 011111111011111 O
innocuous JJ X O
kernel NN 11100000111 O
APIs NNS 0111101101101 O
'' '' 0111101110 O
ZwSaveKey NNP X O
ZwQueryValueKey NNP X O
ZwEnumerateValueKey NNP X O
IoAllocateMdl NNP X O
'' '' 0111101110 O
, , 1011100 O
in IN 100110 O
concert NN X O
leads VBZ 1011111001110 O
directly RB 10101110000 O
to TO 101100 O
a DT 11001 O
Chinese JJ 111100110101 O
website NN 001010110110 O
that WDT 101111110 O
has VBZ 1011011010 O
a DT 11001 B-Entity
cached VBN 111000111100 I-Entity
rootkit NN 001011010110 I-Entity
performing VBG 101111111111011 B-Verb
similar JJ 10100001111 B-Entity
hooks NNS 001111011011 I-Entity
on IN 1001010 B-Preposition
the DT 11010 B-Entity
same JJ 111101001 I-Entity
3 CD 011111111011110 I-Entity
registry NN 111101110001 I-Entity
related JJ 10100001110 I-Entity
APIs NNS 0111101101101 I-Entity
. . 0110 O

While IN 010101101 O
the DT 11010 O
driver NN 00101101111 O
does VBZ 1011011100 O
not RB 1010111100 O
use VB 10101011100 O
pool NN 001111100110 O
tags NNS 00100101111 O
for IN 10011111 O
most JJS 111111100 O
of IN 1000 O
its PRP$ 11011101 O
allocations NNS X O
, , 1011100 O
it PRP 101111010 O
does VBZ 1011011100 O
utilize VB 101010011000 O
them PRP 1011111110000 O
in IN 100110 O
the DT 11010 O
networking NN 11100000001 O
hooking VBG X O
code NN 001001010 O
, , 1011100 O
much RB 111100010100 O
like IN 101111111110110 O
the DT 11010 O
examples NNS 00110100110 O
found VBN 10100111110 O
on IN 1001010 O
the DT 11010 O
Chinese JJ 111100110101 O
language NN 11100101011 O
forums NNS 1110001101110 O
. . 0110 O

This DT 0100010 O
sample NN 0010100000 O
uses VBZ 1011111010111 O
pool NN 001111100110 O
tags NNS 00100101111 O
: : 0111010 O
'tnet NN X O
, , 1011100 O
' '' 0111101010 O
and CC 101110111 O
'KDTR NN X O
' '' 0111101010 O
. . 0110 O

Although IN 010101101 O
the DT 11010 O
meaning NN 101111101101 O
of IN 1000 O
the DT 11010 O
KDTR NN X O
tag NN 001011111110 O
is VBZ 101101010 O
not RB 1010111100 O
obvious JJ 10100000100 O
, , 1011100 O
we PRP 101111000 O
assess VBP 101010011111 O
with IN 100100 O
high JJ 111100010111 O
confidence NN 0011001010 O
that IN 101111110 O
this DT 110110 O
is VBZ 101101010 O
a DT 11001 O
shortened VBN X O
version NN 00011000 O
of IN 1000 O
: : 0111010 O
'' '' 0111101110 O
Kernel NNP 111101110001 O
DeTouR NN X O
'' '' 0111101110 O
, , 1011100 O
which WDT 101111011 O
coincides VBZ X O
with IN 100100 O
the DT 11010 O
matching JJ 10010111111111 O
functionality NN 00011111001 O
of IN 1000 O
the DT 11010 O
detour-style JJ X O
inline NN 111100010001 O
hook NN 1111011101111 O
. . 0110 O

The DT 010000 O
driver NN 00101101111 O
code NN 001001010 O
( CD 01111000 O
MD5 NN 01110110000 O
: : 0111010 O
dae6b9b3b8e39b08b10a51a6457444d8 FW X O
) FW 011110100 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
a DT 11001 O
combination NN 000110010 O
of IN 1000 O
various JJ 111110011100 O
code NN 001001010 O
that WDT 101111110 O
is VBZ 101101010 O
easily RB 101011100111 O
searchable JJ X O
on IN 1001010 O
the DT 11010 O
Internet NN 0010111010 O
, , 1011100 O
and CC 101110111 O
almost RB 11111011011 O
always RB 101011100110 O
attributed VBN 10100010010 O
to TO 101100 O
Chinese JJ 111100110101 O
language NN 11100101011 O
forums NNS 1110001101110 O
and CC 101110111 O
websites NNS 0011001101100 O
. . 0110 O

The DT 010000 O
system NN 001000000 O
call NN 10101010101 O
hooking VBG X O
parts NNS 0011010000 O
of IN 1000 O
the DT 11010 O
code NN 001001010 O
appear VBP 101000111111 O
to TO 101100 O
be VB 10101100 O
identical JJ 10100001000 O
to TO 101100 O
the DT 11010 O
HookSSDT.c NN X O
code NN 001001010 O
authored VBN 101001100000 O
by IN 1001110 O
Steven NNP X O
Lai NNP X O
'embedlinux NN X O
' '' 0111101010 O
and CC 101110111 O
utilized VBN 1011111001111 O
in IN 100110 O
what WP 1011111111111001 O
the DT 11010 O
author NN 00001110 O
titled VBN 10100101001 O
'CC NNP X O
Rootkit NNP X O
' '' 0111101010 O
on IN 1001010 O
on IN 1001010 O
August NNP 01111101001 O
4 CD 011111111011111 O
, , 1011100 O
2008 CD 011111100110 O
who WP 10111100100 O
's VBZ 10111010 O
email NN 11110110011 O
address NN 00111000 O
is VBZ 101101010 O
hqulyc JJ X O
@ IN 011101111100 O
126.com NNP 01111011110 O
. . 0110 O

This DT 0100010 O
user NN 0010000110 O
has VBZ 1011011010 O
a DT 11001 O
QQ NN 1111011101010 O
identity NN 000111100 O
of IN 1000 O
: : 0111010 O
5054-3533 CD X O
, , 1011100 O
QQ NNP 1111011101010 O
is VBZ 101101010 O
a DT 11001 O
popular JJ 1111000111001 O
instant NN 11110110011 O
messaging VBG 1111001011110 O
chat NN X O
client NN 00100001110 O
used VBD 1010011010 O
almost RB 11111011011 O
exclusively RB 1010111010110 O
in IN 100110 O
China NNP 01111110110 O
. . 0110 O

His PRP$ 0100111110 O
real JJ 111100001100 O
name NN 00111111010 O
according VBG 10100010101 O
to TO 101100 O
his PRP$ 110111110 O
QQ NN 1111011101010 O
profile NN 0010001000 O
( FW 01111000 O
http FW 01110110011 O
: : 0111010 O
//user.qzone.qq.com/50543533 FW X O
) FW 011110100 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
Steven NNP X O
Lai NNP X O
. . 0110 O

He PRP 01001010 O
was VBD 101101011 O
is VBZ 101101010 O
28 CD 0111111111101 O
years NNS 0011010101 O
old JJ 111100001010 O
( NN 01111000 O
born VBN 1010011011010 O
September NNP 01111101001 O
5 CD 01111111101110 O
, , 1011100 O
1983 CD X O
) NN 011110100 O
and CC 101110111 O
lives NNS 00110010111 O
in IN 100110 O
Xiamen NNP X O
, , 1011100 O
Fujian NNP X O
province NN 00101001111 O
( NNP 01111000 O
Nanjing NNP X O
Military NNP 0111101100100 O
Region NNP X O
) NNP 011110100 O
. . 0110 O

According VBG 01001100 O
to TO 101100 O
his PRP$ 110111110 O
profile NN 0010001000 O
, , 1011100 O
he PRP 111011100110 O
has VBZ 1011011010 O
worked VBN 1010010111000 O
at IN 10011110 O
Xiamen NNP X O
XOCECO NNP X O
New NNP 1110110110 O
Technic NNP X O
Co. NNP 0011000011 O
, , 1011100 O
Ltd. NNP 010111 O
( CD 01111000 O
http NN 01110110011 O
: : 0111010 O
//www.likego.com/en/about.asp FW X O
) FW 011110100 O
, , 1011100 O
a DT 11001 O
company NN 0011000010 O
that WDT 101111110 O
builds VBZ X O
audio/video NN X O
systems NNS 00110011000 O
for IN 10011111 O
transportation NN 11100101000 O
systems NNS 00110011000 O
. . 0110 O

Mr. NNP 1010101001 O
Lai NNP X O
is VBZ 101101010 O
not RB 1010111100 O
being VBG 101011111000 O
identified VBN 1010011111111 O
as IN 10111111110 O
the DT 11010 O
actor NN 0010101001 O
, , 1011100 O
his PRP$ 110111110 O
code NN 001001010 O
however RB 010111 O
was VBD 101101011 O
used VBN 1010011010 O
by IN 1001110 O
whomever NN X O
built VBD 101001011111100 O
the DT 11010 O
kernel NN 11100000111 O
driver NN 00101101111 O
utilized VBN 1011111001111 O
by IN 1001110 O
the DT 11010 O
backdoor NN 00101101000 O
and CC 101110111 O
for IN 10011111 O
this DT 110110 O
reason NN 00101001000 O
we PRP 101111000 O
are VBP 101101001 O
providing VBG 101111111111011 O
the DT 11010 O
background NN 0010111011 O
on IN 1001010 O
this DT 110110 O
individual NN 001010110011 O
. . 0110 O

The DT 010000 O
samples NNS 0011011100 O
involved VBN 101001110110 O
in IN 100110 O
this DT 110110 O
incident NN 001010111110 O
are VBP 101101001 O
typical JJ 1111000111010 O
of IN 1000 O
attacks NNS 001101100 O
commonly RB 1010111110011 O
associated VBN 10100100101 O
with IN 100100 O
the DT 11010 O
People's NNP X O
Republic NNP 0001111011 O
of IN 1000 O
China NNP 01111110110 O
( FW 01111000 O
PRC FW 1110110000 O
) FW 011110100 O
. . 0110 O

These DT 010011110 O
code NN 001001010 O
samples NNS 0011011100 O
have VBP 101101100 O
a DT 11001 O
variety NN 00010101 O
of IN 1000 O
Tools NNS 0111101101011 O
, , 1011100 O
Techniques NNS 010111 O
, , 1011100 O
and CC 101110111 O
Procedures NNS 1110001011 O
( FW 01111000 O
TTPs FW 0111011010 O
) NN 011110100 O
that WDT 101111110 O
are VBP 101101001 O
used VBN 1010011010 O
to TO 101100 O
track VB 10101000111 O
and CC 101110111 O
identify VB 101010011101 O
specific JJ 111100001110 O
adversary NN 001011111110 O
groups NNS 00110110110 O
. . 0110 O

The DT 010000 O
sophistication NN 0001110101 O
of IN 1000 O
the DT 11010 O
actor NN 0010101001 O
responsible JJ 10101011000 O
this DT 110110 O
incident NN 001010111110 O
is VBZ 101101010 O
difficult JJ 10100001011 O
to TO 101100 O
quantify VB X O
without IN 100101110011 O
visibility NN 00100010111 O
into IN 10010111100 O
the DT 11010 O
activities NNS 001100011101 O
that WDT 101111110 O
transpired VBD X O
on IN 1001010 O
the DT 11010 O
victims NNS 00110010110 O
network NN 001000010 O
. . 0110 O

The DT 010000 O
ability NN 101000110011 O
to TO 101100 O
conduct VB 101010011001 O
Incident NNP 11101110100 O
Response NNP 01111011001110 O
( NNP 01111000 O
IR NNP 11100111101 O
) NNP 011110100 O
including VBG 101111111110111 O
forensics NNS 0011110101100 O
, , 1011100 O
and CC 101110111 O
log NN 00100110011 O
analysis NN 0001110110 O
, , 1011100 O
greatly RB X O
augments VBZ X O
this DT 110110 O
visibility NN 00100010111 O
into IN 10010111100 O
these DT 11111000 O
aspects NNS 0001110101 O
of IN 1000 O
the DT 11010 O
incident NN 001010111110 O
. . 0110 O

Some DT 010011100 O
indications NNS 0001110111 O
as IN 10111111110 O
to TO 101100 O
the DT 11010 O
adversaries NNS 00110110100 O
' POS 0111101010 O
capabilities NNS 0011001111001 O
can MD 10110111110 O
be VB 10101100 O
derived VBN 10101110001 O
from IN 100101100 O
the DT 11010 O
captured VBN 1011111001100 O
samples NNS 0011011100 O
alone RB 001100111010 O
. . 0110 O

The DT 010000 O
dropper NN 001011010111 O
code NN 001001010 O
( CD 01111000 O
MD5 NN 01110110000 O
: : 0111010 O
14c04f88dc97aef3e9b516ef208a2bf5 FW X O
) FW 011110100 O
does VBZ 1011011100 O
not RB 1010111100 O
utilize VB 101010011000 O
any DT 11111011111 O
techniques NNS 0011001111010 O
that WDT 101111110 O
are VBP 101101001 O
unique JJ 1111011101010 O
or CC 101110110 O
unusual JJ 10100000100 O
, , 1011100 O
and CC 101110111 O
is VBZ 101101010 O
consistent JJ 10100100110 O
with IN 100100 O
tools NNS 0011001111011 O
, , 1011100 O
techniques NNS 0011001111010 O
, , 1011100 O
and CC 101110111 O
procedures NNS 1110001011 O
of IN 1000 O
attacks NNS 001101100 O
targeting VBG 111000111010 O
proprietary JJ 111100101011 O
information NN 001111000 O
and CC 101110111 O
generally RB 10101111111101 O
attributed VBN 10100010010 O
to TO 101100 O
the DT 11010 O
PRC NNP 1110110000 O
. . 0110 O

The DT 010000 O
presence NN 0001111010 O
of IN 1000 O
dead JJ X O
code NN 001001010 O
and CC 101110111 O
its PRP$ 11011101 O
replacement NN X O
by IN 1001110 O
a DT 11001 O
more RBR 1111111110 O
simple JJ 1111000111110 O
obfuscation NN 1111011100110 O
method NN 001010001100 O
to TO 101100 O
hide VB 101010011111 O
the DT 11010 O
to-be-dropped JJ X O
dll NN 0010011111110 O
binary JJ 001011010100 O
file NN 00100100 O
indicates VBZ 101111101100 O
code NN 001001010 O
reuse NN 0001011111 O
on IN 1001010 O
the DT 11010 O
attacker NN 00101111100 O
side NN 001001111010 O
. . 0110 O

The DT 010000 O
'dead NN X O
code NN 001001010 O
' '' 0111101010 O
utilizes VBZ 10010111111100 O
a DT 11001 O
more RBR 1111111110 O
sophisticated JJ 111100010011 O
compression NN 1111011100110 O
algorithm NN 0011111111000 O
provided VBN 101001100001 O
by IN 1001110 O
a DT 11001 O
third JJ 11110011111 O
party NN 11100100000 O
which WDT 101111011 O
was VBD 101101011 O
rendered VBN X O
useless JJ 0111101101101 O
for IN 10011111 O
some DT 11111011110 O
reason NN 00101001000 O
. . 0110 O

This DT 0100010 O
may MD 101101111010 O
have VB 101101100 O
been VBN 10101101 O
a DT 11001 O
result NN 000101100 O
of IN 1000 O
the DT 11010 O
attacker NN 00101111100 O
modifying VBG 101111111111011 O
an DT 11000 O
existing VBG 111101111110101 O
tool NN 001010001110 O
, , 1011100 O
or CC 101110110 O
unknowingly RB X O
using VBG 100101111110 O
a DT 11001 O
re-purposed JJ X O
tool NN 001010001110 O
. . 0110 O

The DT 010000 O
dropper NN 001011010111 O
resources NNS 001100011010 O
indicate VBP 101010101111 O
the DT 11010 O
compiler NN 0011110111010 O
used VBN 1010011010 O
to TO 101100 O
build VB 101010110111 O
the DT 11010 O
tool NN 001010001110 O
was VBD 101101011 O
running VBG 10100101111101 O
on IN 1001010 O
a DT 11001 O
system NN 001000000 O
that WDT 101111110 O
utilized VBD 1011111001111 O
the DT 11010 O
Chinese NNPS 111100110101 O
'' '' 0111101110 O
Simple JJ X O
'' '' 0111101110 O
language NN 11100101011 O
pack NN 101010111111111 O
and CC 101110111 O
was VBD 101101011 O
built VBN 101001011111100 O
on IN 1001010 O
Wednesday NNP X O
May NNP 01111101001 O
4th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
11:04:24 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

While IN 010101101 O
this DT 110110 O
can MD 10110111110 O
be VB 10101100 O
deliberately RB 10101111111101 O
spoofed VBN 101000110001 O
as IN 10111111110 O
a DT 11001 O
'false JJ X O
flag NN 0010011111111 O
' '' 0111101010 O
other JJ 111110010 O
indicators NNS 001111101001 O
including VBG 101111111110111 O
the DT 11010 O
C2 NN 1111011011000 O
are VBP 101101001 O
consistent JJ 10100100110 O
with IN 100100 O
this DT 110110 O
having VBG 10111111111100 O
been VBN 10101101 O
the DT 11010 O
work NN 1010101111000 O
of IN 1000 O
a DT 11001 O
Chinese JJ 111100110101 O
speaking NN 11100101011 O
actor NN 0010101001 O
. . 0110 O

The DT 010000 B-Entity
dropped VBD 101001011111100 I-Entity
DLL NNP 00101101110 I-Entity
( NNP 01111000 I-Entity
MD5 NN 01110110000 I-Entity
: : 0111010 I-Entity
47619fca20895abc83807321cbb80a3d FW X I-Entity
) FW 011110100 I-Entity
itself PRP 10111111100010 I-Entity
contains VBZ 1011111011111 B-Verb
functionality NN 00011111001 B-Entity
that WDT 101111110 I-Entity
is VBZ 101101010 I-Entity
typical JJ 1111000111010 I-Entity
of IN 1000 I-Entity
a DT 11001 I-Entity
Remote JJ 1110110101 I-Entity
Access NN 0111101101100 I-Entity
Tool NNP 011110110000 I-Entity
( CD 01111000 I-Entity
RAT NN 1110010010 I-Entity
) NN 011110100 I-Entity
which WDT 101111011 O
are VBP 101101001 O
commonly RB 1010111110011 O
used VBN 1010011010 B-Verb
by IN 1001110 O
PRC NNP 1110110000 B-Entity
based VBN 10100101010 I-Entity
actors NNS 0010101000 I-Entity
in IN 100110 B-Preposition
data NN 001111001 B-Entity
exfiltration NN 1110001101111 I-Entity
attacks NNS 001101100 I-Entity
. . 0110 O

The DT 010000 O
code NN 001001010 O
quality NN 0010001000 O
is VBZ 101101010 O
not RB 1010111100 O
impressive JJ X O
, , 1011100 O
and CC 101110111 O
contains VBZ 1011111011111 O
a DT 11001 O
trivial JJ X O
stack VB 001001111001 O
buffer NN 0010011111111 O
overflow NN X O
vulnerability NN 001010110101 O
. . 0110 O

Despite IN 0101011110 O
the DT 11010 O
buf- FW X O
fer FW X O
overflow NN X O
, , 1011100 O
the DT 11010 O
C2 NN 1111011011000 O
channel NN 0011110111110 O
lacks VBZ X O
any DT 11111011111 O
command NN 0010011100 O
authenication NN X O
or CC 101110110 O
encryption NN 1111011100111 O
, , 1011100 O
apart RB 10101110001 O
from IN 100101100 O
the DT 11010 O
initial JJ 111101111111101 O
beacon NN 00101001000 O
encryption/obfuscation NN X O
using VBG 100101111110 O
a DT 11001 O
statically RB X O
compiled VBN 1010011011010 O
XOR NN 1111011100101 O
key NN 001111111010 O
. . 0110 O

The DT 010000 O
sample NN 0010100000 O
uses VBZ 1011111010111 O
TCP NN 11110110100 O
port NN 11100111110 O
443 CD 011110101110 O
for IN 10011111 O
commu- FW X O
nication FW X O
, , 1011100 O
but CC 10111111111000 O
makes VBZ 1011111001011 O
no DT 11111011101 O
attempt NN 101000110010 O
to TO 101100 O
mimic VB X O
the DT 11010 O
SSL NNP 11110110100 O
protocol NN 0011110111110 O
typically RB 10101111111101 O
used VBN 1010011010 O
on IN 1001010 O
that DT 101111110 O
port JJ 11100111110 O
number NN 00010100 O
, , 1011100 O
which WDT 101111011 O
would MD 1011011110011 O
provide VB 10101000011 O
enhanced VBN 10100100001 O
Operational NNP X O
Security NNP 01111011001111 O
( FW 01111000 O
OPSEC FW X O
) FW 011110100 O
. . 0110 O

This DT 0100010 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Wednes- JJ X O
day NN 001010110100 O
May NNP 01111101001 O
4th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
10:48:19 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

The DT 010000 O
post NN 001010111101 O
exploitation NN 111000011110 O
tool NN 001010001110 O
( CD 01111000 O
MD5 NN 01110110000 O
: : 0111010 O
2dce7fc3f52a692d8a84a0c182519133 FW X O
) FW 011110100 O
is VBZ 101101010 O
a DT 11001 O
dual-use JJ X O
tool NN 001010001110 O
, , 1011100 O
it PRP 101111010 B-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
dropped VBN 101001011111100 I-Verb
and CC 101110111 O
executed VBN 1010010111100 B-Verb
by IN 1001110 O
a DT 11001 B-Entity
client-side NN X I-Entity
exploit VB 001010111010 I-Entity
, , 1011100 O
or CC 101110110 O
the DT 11010 B-Entity
adversary NN 001011111110 I-Entity
can MD 10110111110 O
launch VB 10101001001 B-Verb
it PRP 101111010 B-Entity
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
variety NN 00010101 I-Entity
of IN 1000 I-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
options NNS 0011111011011 I-Entity
. . 0110 O

This DT 0100010 O
tool NN 001010001110 O
is VBZ 101101010 O
built VBN 101001011111100 O
in IN 100110 O
Microsoft NNP 1110110111 O
.NET NNP 01111001010 O

framework NN 001010001111 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
typically RB 10101111111101 O
an DT 11000 O
indication NN 0001110111 O
of IN 1000 O
a DT 11001 O
less RBR 1111111111 O
sophis- JJ X O
ticated JJ X O
attacker NN 00101111100 O
, , 1011100 O
because IN 1011111111111111 O
.NET NN 01111001010 O

is VBZ 101101010 O
easier JJR 10100001011 O
to TO 101100 O
develop VB 101010011100 O
in IN 100110 O
but CC 10111111111000 O
requires VBZ 1011111001111 O
the DT 11010 O
.NET NN 01111001010 O

framework NN 001010001111 O
be VB 10101100 O
present JJ 101001011111111 O
on IN 1001010 O
the DT 11010 O
victim NN 111101111011 O
machine NN 0010000011 O
. . 0110 O

The DT 010000 O
tool NN 001010001110 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Thursday NNP 01111101010 O
May NNP 01111101001 O
26th JJ X O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
10:21:44 CD X O
A.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
early JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

The DT 010000 B-Entity
sample NN 0010100000 I-Entity
utilizes VBZ 10010111111100 B-Verb
the DT 11010 B-Entity
AES NN 1111011100101 I-Entity
cryptographic JJ X I-Entity
algorithm NN 0011111111000 I-Entity
to TO 101100 B-Preposition
protect VB 101010011110 B-Entity
its PRP$ 11011101 I-Entity
C2 NN 1111011011000 I-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

This DT 0100010 B-Entity
DLL NNP 00101101110 I-Entity
is VBZ 101101010 B-Verb
a DT 11001 B-Entity
moderately RB X I-Entity
sophisticated JJ 111100010011 I-Entity
backdoor NN 00101101000 I-Entity
with IN 100100 O
several JJ 111110011110 O
well RB 101111111011 O
designed VBN 10100010111 O
communication NN 001111010000 O
mechanisms NNS 0011001111000 O
not RB 1010111100 O
typically RB 10101111111101 O
seen VBN 101001110010 O
in IN 100110 O
these DT 11111000 O
types NNS 0011010000 O
of IN 1000 O
implants NNS 0011001101101 O
. . 0110 O

The DT 010000 O
code NN 001001010 O
base NN 11100101100 O
for IN 10011111 O
the DT 11010 O
sample NN 0010100000 O
was VBD 101101011 O
developed VBN 101001100000 O
in IN 100110 O
C++ NNP 11100000111 O
. . 0110 O

The DT 010000 O
code NN 001001010 O
appears VBZ 101000111001 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
compiled VBN 1010011011010 O
on IN 1001010 O
Sunday NNP 0111111111101 O
October NNP 01111101010 O
30 CD 011111111100 O
, , 1011100 O
2011 CD 011111100110 O
at IN 10011110 O
12:43:33 CD X O
P.M. NNP X O
UTC NNP 011111110110 O
( NNP 01111000 O
late JJ 01111101011 O
evening NN X O
time NN 00011010 O
in IN 100110 O
China NNP 01111110110 O
) NNP 011110100 O
. . 0110 O

This DT 0100010 B-Entity
sample NN 0010100000 I-Entity
has VBZ 1011011010 B-Verb
multiple JJ 111110011101 B-Entity
communication NN 001111010000 I-Entity
capabilities NNS 0011001111001 I-Entity
available JJ 1010011011110 I-Entity
that WDT 101111110 O
makes VBZ 1011111001011 O
it PRP 101111010 O
far RB 11100110111 O
more RBR 1111111110 O
versatile JJ X O
and CC 101110111 O
stealthy JJ 1010111010100 O
. . 0110 O

It PRP 01001010 B-Entity
implements VBZ 1011111010110 B-Verb
relatively RB 1111111101 B-Entity
well RB 101111111011 I-Entity
thought VBN 10100010111 I-Entity
out RP 1011111110010 I-Entity
protocols NNS 001111100101 I-Entity
including VBG 101111111110111 I-Entity
HTTP NNP 111101101010 I-Entity
and CC 101110111 I-Entity
DNS NNP 1111011011111 I-Entity
. . 0110 O

The DT 010000 B-Entity
tool NN 001010001110 I-Entity
has VBZ 1011011010 O
the DT 11010 O
ability NN 101000110011 O
to TO 101100 O
automatically RB 101011100110 O
down RB 001111011011 O
select VB 101010110111 B-Verb
the DT 11010 B-Entity
most RBS 111111100 I-Entity
effective JJ 10100000011 I-Entity
communication NN 001111010000 I-Entity
channel NN 0011110111110 I-Entity
once IN 1011111001010 B-Preposition
it PRP 101111010 B-Entity
has VBZ 1011011010 I-Entity
been VBN 10101101 I-Entity
instantiated VBN X I-Entity
, , 1011100 O
which WDT 101111011 O
can MD 10110111110 O
help VB 101010111111001 O
avoid VB 101010011010 B-Verb
detection NN 0001110010 B-Entity
from IN 100101100 I-Entity
solutions NNS 001100111001 I-Entity
like IN 101111111110110 I-Entity
DNS NN 1111011011111 I-Entity
blacklisting NN X I-Entity
and CC 101110111 I-Entity
RFC NN X I-Entity
protocol NN 0011110111110 I-Entity
enforcement NN 01111011001101 I-Entity
. . 0110 O

The DT 010000 O
DLL NNP 00101101110 O
itself PRP 10111111100010 O
contains VBZ 1011111011111 O
traces NNS 0001110100 O
of IN 1000 O
the DT 11010 O
original JJ 11110101111 O
C++ NNP 11100000111 O
class NN 0010011111110 O
names NNS 00111111011 O
that WDT 101111110 O
were VBD 101101000 O
utilized VBN 1011111001111 O
in IN 100110 O
the DT 11010 O
source NN 00100110111 O
code NN 001001010 O
, , 1011100 O
which WDT 101111011 O
in IN 100110 O
general JJ 000000 O
were VBD 101101000 O
prefixed VBN X O
with IN 100100 O
'PCC NN X O
' '' 0111101010 O
. . 0110 O

The DT 010000 B-Entity
sample NN 0010100000 I-Entity
supports VBZ 10010111111100 O
the DT 11010 O
ability NN 101000110011 O
to TO 101100 O
act VB 101010111111010 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
generic JJ 11110001111111 I-Entity
proxy NN 1111011011011 I-Entity
, , 1011100 O
this DT 110110 O
may MD 101101111010 O
be VB 10101100 O
intended VBN 10100001010 O
to TO 101100 O
proxy NN 1111011011011 B-Verb
C2 NN 1111011011000 B-Entity
traffic NN 0011110100110 I-Entity
for IN 10011111 B-Preposition
other JJ 111110010 B-Entity
infected JJ 111101111000 I-Entity
machines NNS 001100110010 I-Entity
in IN 100110 B-Preposition
order NN 0000011 I-Preposition
to TO 101100 I-Preposition
minimize VB 101010011010 B-Entity
the DT 11010 I-Entity
number NN 00010100 I-Entity
of IN 1000 I-Entity
systems NNS 00110011000 I-Entity
communicating VBG 10100100111 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
C2 NN 1111011011000 I-Entity
, , 1011100 O
thus RB 1010111010111 O
enhancing VBG X O
OPSEC NNP X O
. . 0110 O

The DT 010000 O
sample NN 0010100000 O
contains VBZ 1011111011111 O
'dead NN X O
code NN 001001010 O
' '' 0111101010 O
which WDT 101111011 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
command NN 0010011100 O
and CC 101110111 O
control NN 111000100 O
server NN 00111011 O
classes NNS 001111101000 O
, , 1011100 O
this DT 110110 O
is VBZ 101101010 O
likely RB 101011101100 O
an DT 11000 O
indicator NN 0001110111 O
that IN 101111110 O
the DT 11010 B-Entity
C2 NN 1111011011000 I-Entity
client NN 00100001110 I-Entity
which WDT 101111011 I-Entity
would MD 1011011110011 I-Entity
communicate VB 10100100111 I-Entity
with IN 100100 I-Entity
this DT 110110 I-Entity
sample NN 0010100000 I-Entity
shares VBZ 0011110111011 B-Verb
the DT 11010 B-Entity
same JJ 111101001 I-Entity
communications NNS 00111101001110 I-Entity
library NN 0010011111110 I-Entity
which WDT 101111011 I-Entity
was VBD 101101011 I-Entity
compiled VBN 1010011011010 I-Entity
into IN 10010111100 I-Entity
this DT 110110 I-Entity
sample NN 0010100000 I-Entity
. . 0110 O

The DT 010000 B-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
component NN 00101000011 I-Entity
dropped VBN 101001011111100 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
Backdoor NNP 01110110001 I-Entity
DLL NNP 00101101110 I-Entity
bears VBZ X O
many JJ 111110011111 O
tool NN 001010001110 O
marks NNS 001111011000 O
associating VBG X O
it PRP 101111010 O
with IN 100100 O
the DT 11010 O
CCRootkit NN X O
package NN 0011111111010 O
publicly RB 1010111110010 O
by IN 1001110 O
Steven NNP X O
Lai NNP X O
( NNP 01111000 O
a/k/a IN X O
embedlinux FW X O
) FW 011110100 O
. . 0110 O

This DT 0100010 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
rootkit NN 001011010110 I-Entity
implements VBZ 1011111010110 B-Verb
several JJ 111110011110 B-Entity
hooking VBG X I-Entity
techniques NNS 0011001111010 I-Entity
that WDT 101111110 O
are VBP 101101001 O
aimed VBN 1010011011100 O
at IN 10011110 O
preventing VBG 10111111111100 B-Verb
a DT 11001 B-Entity
system NN 001000000 I-Entity
administrator NN 1111011011010 I-Entity
from IN 100101100 B-Preposition
detecting VBG 1011111111111000 B-Entity
the DT 11010 I-Entity
backdoor JJ 00101101000 I-Entity
DLL NNP 00101101110 I-Entity
. . 0110 O

The DT 010000 O
implementation NN 00011111000 O
of IN 1000 O
these DT 11111000 O
techniques NNS 0011001111010 O
has VBZ 1011011010 O
some DT 11111011110 O
unique JJ 1111011101010 O
idiosyncrasies NNS X O
that WDT 101111110 O
permit VBP X O
direct JJ 00100011000 O
attribution NN 111000110010 O
to TO 101100 O
the DT 11010 O
source NN 00100110111 O
code NN 001001010 O
Steven NNP X O
Lai NNP X O
posted VBD 1010011011011 O
. . 0110 O

This DT 0100010 B-Entity
driver NN 00101101111 I-Entity
attempts VBZ 101000111010 O
to TO 101100 O
hide VB 101010011111 B-Verb
a DT 11001 B-Entity
wide JJ 111100011000 I-Entity
swath NN X I-Entity
of IN 1000 I-Entity
TCP NN 11110110100 I-Entity
ports NNS 1110110001 I-Entity
( VBP 01111000 I-Entity
40000-45000 CD X I-Entity
) NN 011110100 I-Entity
for IN 10011111 B-Preposition
an DT 11000 B-Entity
unknown JJ 1010000000 I-Entity
reason NN 00101001000 I-Entity
, , 1011100 O
however RB 010111 O
it PRP 101111010 O
is VBZ 101101010 O
suspected VBN 1010010110010 O
that IN 101111110 O
this DT 110110 O
may MD 101101111010 O
relate VB 101000111111 O
to TO 101100 O
the DT 11010 O
potential JJ 1111000111011 O
network NN 001000010 O
relaying VBG X O
capability NN 00101001101 O
alluded VBD X O
to TO 101100 O
for IN 10011111 O
the DT 11010 O
backdoor JJ 00101101000 O
dll NN 0010011111110 O
. . 0110 O

The DT 010000 B-Entity
kernel NN 11100000111 I-Entity
driver NN 00101101111 I-Entity
component NN 00101000011 I-Entity
dropped VBN 101001011111100 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
Backdoor NNP 01110110001 I-Entity
DLL NNP 00101101110 I-Entity
bears VBZ X O
many JJ 111110011111 O
tool NN 001010001110 O
marks NNS 001111011000 O
associating VBG X O
it PRP 101111010 O
with IN 100100 O
the DT 11010 O
CCRootkit NN X O
package NN 0011111111010 O
publicly RB 1010111110010 O
by IN 1001110 O
Steven NNP X O
Lai NNP X O
( NNP 01111000 O
a/k/a IN X O
embedlinux FW X O
) FW 011110100 O
. . 0110 O

This DT 0100010 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
rootkit NN 001011010110 I-Entity
implements VBZ 1011111010110 B-Verb
several JJ 111110011110 B-Entity
hooking VBG X I-Entity
techniques NNS 0011001111010 I-Entity
that WDT 101111110 O
are VBP 101101001 O
aimed VBN 1010011011100 O
at IN 10011110 O
preventing VBG 10111111111100 B-Verb
a DT 11001 B-Entity
system NN 001000000 I-Entity
administrator NN 1111011011010 I-Entity
from IN 100101100 B-Preposition
detecting VBG 1011111111111000 B-Entity
the DT 11010 I-Entity
backdoor JJ 00101101000 I-Entity
DLL NNP 00101101110 I-Entity
. . 0110 O

The DT 010000 O
implementation NN 00011111000 O
of IN 1000 O
these DT 11111000 O
techniques NNS 0011001111010 O
has VBZ 1011011010 O
some DT 11111011110 O
unique JJ 1111011101010 O
idiosyncrasies NNS X O
that WDT 101111110 O
permit VBP X O
direct JJ 00100011000 O
attribution NN 111000110010 O
to TO 101100 O
the DT 11010 O
source NN 00100110111 O
code NN 001001010 O
Steven NNP X O
Lai NNP X O
posted VBD 1010011011011 O
. . 0110 O

This DT 0100010 B-Entity
driver NN 00101101111 I-Entity
attempts VBZ 101000111010 O
to TO 101100 O
hide VB 101010011111 B-Verb
a DT 11001 B-Entity
wide JJ 111100011000 I-Entity
swath NN X I-Entity
of IN 1000 I-Entity
TCP NN 11110110100 I-Entity
ports NNS 1110110001 I-Entity
( VBP 01111000 I-Entity
40000-45000 CD X I-Entity
) NN 011110100 I-Entity
for IN 10011111 B-Preposition
an DT 11000 B-Entity
unknown JJ 1010000000 I-Entity
reason NN 00101001000 I-Entity
, , 1011100 O
however RB 010111 O
it PRP 101111010 O
is VBZ 101101010 O
suspected VBN 1010010110010 O
that IN 101111110 O
this DT 110110 O
may MD 101101111010 O
relate VB 101000111111 O
to TO 101100 O
the DT 11010 O
potential JJ 1111000111011 O
network NN 001000010 O
relaying VBG X O
capability NN 00101001101 O
alluded VBD X O
to TO 101100 O
for IN 10011111 O
the DT 11010 O
backdoor JJ 00101101000 O
dll NN 0010011111110 O
. . 0110 O

Implemented VBN X O
values NNS 0011111011110 O
for IN 10011111 O
cmdID NN X O
are VBP 101101001 O
as IN 10111111110 O
follows VBZ 01110110001 O
: : 0111010 O
cmdType NN X O
can MD 10110111110 O
be VB 10101100 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
following VBG 111101000 O
( NNP 01111000 O
Interesting NNP 0100011011 O
commands NNS 001111101100 O
explained VBD 101001110000 O
in IN 100110 O
detail NN 00100011101 O
) NN 011110100 O
: : 0111010 O
string0 NN X O
can MD 10110111110 O
have VB 101101100 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
following JJ 111101000 O
values NNS 0011111011110 O
dependant JJ X O
upon IN 1011111111111011 O
command NN 0010011100 O
id NN 011111111100 O
and CC 101110111 O
type NN 000110011 O
. . 0110 O

cardmagic JJ X O
writes VBZ 101111101000 O
: : 0111010 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
has VBZ 1011011010 O
changed VBN 10100101111011 O
alot NN X O
on IN 1001010 O
network NN 001000010 O
module NN 00101101100 O
, , 1011100 O
many JJ 111110011111 O
old JJ 111100001010 O
port NN 11100111110 O
hiding NN 10100101111101 O
materials NNS 0011110101111 O
are VBP 101101001 O
no RB 11111011101 O
longer RB 0111100111110 O
usable JJ X O
. . 0110 O

In IN 0101000 O
this DT 110110 O
post NN 001010111101 O
, , 1011100 O
I PRP 101111001111 O
will MD 10110111111 O
share VB 1010101110101 O
with IN 100100 O
you PRP 101111001110 O
a DT 11001 O
simple JJ 1111000111110 O
code NN 001001010 O
to TO 101100 O
hide VB 101010011111 O
port NN 11100111110 O
under IN 10010111111110 O
Vista NNP 0111101101100 O
, , 1011100 O
hope VBP 10101010110 O
it PRP 101111010 O
is VBZ 101101010 O
useful JJ 10100001011 O
for IN 10011111 O
some DT 11111011110 O
guys NNS X O
. . 0110 O

Actually RB X O
under IN 10010111111110 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
, , 1011100 O
netstat.exe NNP X O
will MD 10110111111 O
call VB 10101010101 O
InternalGetTcpTable2 NN X O
which WDT 101111011 O
is VBZ 101101010 O
exported VBN 111101111111010 O
by IN 1001110 O
Iphlpapi.dll NN X O
to TO 101100 O
list VB 0001011110 O
all DT 1111101100 O
open JJ 10101011111011 O
ports NNS 1110110001 O
, , 1011100 O
then RB 101011111110 O
InternalGetTcpTable2 NN X O
will MD 10110111111 O
transfer VB 10101011111001 O
control NN 111000100 O
to TO 101100 O
NsiAllocateAndGetTable NNP X O
which WDT 101111011 O
is VBZ 101101010 O
exported VBN 111101111111010 O
by IN 1001110 O
nsi.dll NN X O
, , 1011100 O
and CC 101110111 O
finally RB 1010111011110 O
nsi.dll NN X O
involve VBP 10101000011 O
NsiEnumerateObjectsAllParametersEx NN X O
to TO 101100 O
interact VB 10100100111 O
with IN 100100 O
kernel NN 11100000111 O
mode NN 0011110111111 O
module NN 00101101100 O
of IN 1000 O
NSI NNP X O
-- : 011101111111110 O
nsiproxy.sys NNS X O
. . 0110 O

nsiproxy.sys NNS X O
is VBZ 101101010 O
almost RB 11111011011 O
like IN 101111111110110 O
a DT 11001 O
wrapper NN 0011110111111 O
of IN 1000 O
netio.sys NNS X O
, , 1011100 O
it PRP 101111010 O
will MD 10110111111 O
then RB 101011111110 O
call VB 10101010101 O
internal JJ 111101111111010 O
subroutines NNS X O
of IN 1000 O
netio.sys NNS X O
. . 0110 O

Here RB 01001011 O
, , 1011100 O
we PRP 101111000 O
will MD 10110111111 O
use VB 10101011100 O
a DT 11001 O
relatively RB 1111111101 O
easy JJ 10100000100 O
way NN 00101001010 O
-- : 011101111111110 O
'' '' 0111101110 O
NSI NNP X O
Kernel NNP 111101110001 O
Module NNP 101111001111 O
Dispatch NNP X O
Routine NNP X O
Hook NNP X O
'' '' 0111101110 O
to TO 101100 O
demonstrate VB 1010101110100 O
the DT 11010 O
specified VBN 1111011101001 O
port NN 11100111110 O
hiding VBG 10100101111101 O
uner JJ X O
Vista NNP 0111101101100 O
. . 0110 O

Dispatch VB X O
routine JJ 0011111110111 O
hook NN 1111011101111 O
is VBZ 101101010 O
an DT 11000 O
old JJ 111100001010 O
topic NN 001010110000 O
, , 1011100 O
this DT 110110 O
time NN 00011010 O
, , 1011100 O
we PRP 101111000 O
will MD 10110111111 O
apply VB 10101000000 O
this DT 110110 O
method NN 001010001100 O
to TO 101100 O
nsiproxy.sys NNS X O
. . 0110 O

Please VB 0100011010 O
focus NN 1010101111001 O
on IN 1001010 O
how WRB 1011111111111000 O
to TO 101100 O
handle VB 101000110000 O
the DT 11010 O
content NN 001111100110 O
filtering VBG 001111100011 O
of IN 1000 O
NSI NNP X O
: : 0111010 O
) CD 011110100 O
Check VB 0100111111 O
the DT 11010 O
following JJ 111101000 O
code NN 001001010 O
( NNP 01111000 O
Notice NNP X O
: : 0111010 O
I PRP 101111001111 O
only RB 10101110010 O
tested VBD 10100101110111 O
it PRP 101111010 O
under IN 10010111111110 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
RTM NNP X O
32bit NNP X O
) NNP 011110100 O
: : 0111010 O
