At IN 0101011111 O
the DT 11010 O
end NN 000111100 O
of IN 1000 O
April NNP 01111101001 O
Microsoft NNP 1110110111 O
announced VBD 101001111000 O
that IN 101111110 O
a DT 11001 O
vulnerability NN 001010110101 O
in IN 100110 O
Word NN 01111011011110 O
was VBD 101101011 O
actively RB 1010111110110 O
being VBG 101011111000 O
exploited VBN 1010010110000 O
. . 0110 O

This DT 0100010 O
vulnerability NN 001010110101 O
occurred VBD 1010010111000 O
in IN 100110 O
parsing VBG 11101110111 O
RTF NN 11100000110 O
files NNS 0011011110 O
and CC 101110111 O
was VBD 101101011 O
assigned VBN 10100010001 O
CVE-2014-1761 NN 0010111001 O
, , 1011100 O
a DT 11001 O
thorough JJ 1111000110100 O
analysis NN 0001110110 O
of IN 1000 O
which WDT 101111011 O
can MD 10110111110 O
be VB 10101100 O
found VBN 10100111110 O
on IN 1001010 O
the DT 11010 O
HP NNP 11110011001 O
Security NNP 01111011001111 O
Research NNP 01111011001110 O
blog NN 00101001111 O
. . 0110 O

We PRP 01001001 O
have VBP 101101100 O
since RB 1011111111111110 O
seen VBN 101001110010 O
multiple JJ 111110011101 O
cases NNS 0011010010 O
where WRB 101111111110100 O
this DT 110110 B-Entity
exploit VBP 001010111010 I-Entity
is VBZ 101101010 O
used VBN 1010011010 O
to TO 101100 O
deliver VB 101010011111 B-Verb
malware NN 00101100 B-Entity
and CC 101110111 O
one NN 111110100 O
was VBD 101101011 O
particularly RB 1010111010111 O
interesting JJ 10100000101 O
as IN 10111111110 O
it PRP 101111010 O
contained VBD 1011111001101 O
a DT 11001 O
new JJ 11110000010 O
variant NN 00101000010 O
of IN 1000 O
MiniDuke FW 11101111011 O
( FW 01111000 O
also RB 10101111110 O
known VBN 1010000110 O
as IN 10111111110 O
Win32/SandyEva FW X O
) FW 011110100 O
. . 0110 O

MiniDuke NNP 11101111011 O
was VBD 101101011 O
first RB 1111010100 O
discussed VBN 101001110011 O
by IN 1001110 O
Kaspersky NNP 11101110110 O
in IN 100110 O
March NNP 01111101000 O
2013 CD 0111111000 O
in IN 100110 O
their PRP$ 11011100 O
paper NN 001010111101 O
The DT 010000 O
MiniDuke NNP 11101111011 O
Mystery NNP X O
: : 0111010 O
PDF NN 11100000110 O
0- CD X O
day NN 001010110100 O
Government NNP 11100101110 O
Spy NNP X O
Assembler NNP X O
0x29A NNP X O
Micro NNP 01111011001110 O
Backdoorand NNP X O
shortly RB 0011010100 O
after IN 100101110100 O
in IN 100110 O
a DT 11001 O
paper NN 001010111101 O
by IN 1001110 O
Bitdefender NNP X O
. . 0110 O

Some DT 010011100 O
of IN 1000 O
the DT 11010 O
characteristics NNS 0011111011101 O
of IN 1000 O
MiniDuke NNP 11101111011 B-Entity
- : 01111001101 O
such JJ 101111111010 O
as IN 10111111110 O
its PRP$ 11011101 O
small JJ 1111000110010 O
size NN 00011111010 O
( NN 01111000 O
20 CD 0111111111111 O
KB NN X O
) NN 011110100 O
, , 1011100 O
its PRP$ 11011101 O
crafty JJ X O
use NN 10101011100 O
of IN 1000 O
assembly NN 001001111100 O
programming NN 1110001101101 O
, , 1011100 O
and CC 101110111 O
the DT 11010 O
use NN 10101011100 B-Verb
of IN 1000 O
zero-day JJ 11100000101 B-Entity
exploits NNS 0011001111101 I-Entity
for IN 10011111 B-Preposition
distribution NN 0001110000 B-Entity
- : 01111001101 O
made VBD 10100101110110 O
it PRP 101111010 O
an DT 11000 O
intriguing JJ 101000110010 O
threat NN 1110000110 O
. . 0110 O

Although IN 010101101 O
the DT 11010 O
backdoor NN 00101101000 O
is VBZ 101101010 O
still RB 10101111111111 O
quite RB 1111111101 O
similar JJ 10100001111 O
to TO 101100 O
its PRP$ 11011101 O
previous JJ 111100001000 O
versions NNS 0011010001 O
, , 1011100 O
some DT 11111011110 O
important JJ 10100000100 O
changes NNS 0011110100100 O
were VBD 101101000 O
made VBN 10100101110110 O
since IN 1011111111111110 O
last JJ 0010111000 O
year NN 001010110100 O
, , 1011100 O
the DT 11010 O
most RBS 111111100 O
notable JJ 1111000111010 O
being VBG 101011111000 O
the DT 11010 O
introduction NN 0001111011 O
of IN 1000 O
a DT 11001 B-Entity
secondary JJ 1111001011001 I-Entity
component NN 00101000011 I-Entity
written VBN 10100110111110 I-Entity
in IN 100110 I-Entity
JScript NN 00100110111 I-Entity
to TO 101100 O
contact VB 101010111111110 B-Verb
a DT 11001 B-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
via IN 100101111011 B-Preposition
Twitter NNP 00100011001 B-Entity
. . 0110 O

The DT 010000 O
exploit VBP 001010111010 O
document NN 00100101101 O
was VBD 101101011 O
named VBN 10100101001 O
Proposal-Cover-Sheet-English.rtf NN X O
and CC 101110111 O
is VBZ 101101010 O
quite RB 1111111101 O
bland JJ X O
when WRB 100101110010 O
compared VBN 10100010100 O
to TO 101100 O
the DT 11010 O
documents NNS 00100101100 O
that WDT 101111110 O
were VBD 101101000 O
used VBN 1010011010 O
in IN 100110 O
2013 CD 0111111000 O
, , 1011100 O
which WDT 101111011 O
were VBD 101101000 O
of IN 1000 O
a DT 11001 O
political JJ 1111001011010 O
nature NN 0001111011 O
. . 0110 O

We PRP 01001001 O
received VBD 10100101101101 O
the DT 11010 O
document NN 00100101101 O
on IN 1001010 O
April NNP 01111101001 O
8th JJ 0111111111101 O
, , 1011100 O
only RB 10101110010 O
three CD 11111001101 O
days NNS 0011010100 O
after IN 100101110100 O
the DT 11010 O
compilation NN 11110011110 O
of IN 1000 O
the DT 11010 O
MiniDuke NNP 11101111011 O
payload NN 001001111000 O
, , 1011100 O
dated VBN 10100101000 O
April NNP 01111101001 O
5th NN X O
in IN 100110 O
the DT 11010 O
PE NN 11110111110100 O
header NN 001111100011 O
. . 0110 O

The DT 010000 O
payload NN 001001111000 O
remains VBZ 101000110110 O
quite RB 1111111101 O
small JJ 1111000110010 O
at IN 10011110 O
only RB 10101110010 O
24 CD 0111111111101 O
KB NN X O
. . 0110 O

The DT 010000 O
functionality NN 00011111001 O
of IN 1000 O
the DT 11010 B-Entity
shellcode NN 001011111100 I-Entity
which WDT 101111011 O
is VBZ 101101010 B-Verb
executed VBN 1010010111100 I-Verb
by IN 1001110 B-Preposition
triggering VBG 111000111001 B-Entity
the DT 11010 I-Entity
vulnerability NN 001010110101 I-Entity
is VBZ 101101010 O
rather RB 011110011101 O
simple JJ 1111000111110 O
and CC 101110111 O
straightforward JJ 10100001011 O
. . 0110 O

After IN 01010101 O
decrypting VBG 101111111111010 O
itself PRP 10111111100010 O
and CC 101110111 O
obtaining VBG 10111111111100 O
the DT 11010 O
addresses NNS 00111001 O
of IN 1000 O
some DT 11111011110 O
functions NNS 0011111011011 O
exported VBN 111101111111010 O
by IN 1001110 O
kernel32.dll NN 011111111000 O
, , 1011100 O
it PRP 101111010 B-Entity
decrypts VBZ 101111101000 B-Verb
and CC 101110111 I-Verb
drops VBZ 1011111010110 I-Verb
the DT 11010 B-Entity
payload NN 001001111000 I-Entity
in IN 100110 B-Preposition
the DT 11010 B-Entity
% NN 011100000 I-Entity
TEMP NN 011100001 I-Entity
% NN 011100000 I-Entity
directory NN 0011111111101 I-Entity
in IN 100110 I-Entity
a DT 11001 I-Entity
file NN 00100100 I-Entity
named VBN 10100101001 I-Entity
'' '' 0111101110 I-Entity
a.l NN X I-Entity
'' '' 0111101110 I-Entity
which WDT 101111011 O
is VBZ 101101010 B-Verb
subsequently RB 10101111111101 I-Verb
loaded VBN 10100100010 I-Verb
by IN 1001110 B-Preposition
calling VBG 11101110111 B-Entity
kernel32 NN X I-Entity
! . 01110111111110 I-Entity
LoadLibraryA NN X I-Entity
. . 0110 O

An DT 0100011111 O
interesting JJ 10100000101 O
thing NN 00101000100 O
about IN 10010110110 O
the DT 11010 O
shellcode NN 001011111100 O
is VBZ 101101010 O
that IN 101111110 O
before IN 100101110101 O
transferring VBG 111000111101 O
control NN 111000100 O
to TO 101100 O
any DT 11111011111 O
API NNP 0111101101101 O
function NN 001010110111 O
it PRP 101111010 B-Entity
checks VBZ 101111101010 O
the DT 11010 O
first JJ 1111010100 O
bytes NNS 11100101111 O
of IN 1000 O
the DT 11010 O
function NN 001010110111 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
detect VB 101010011100 B-Verb
hooks NNS 001111011011 B-Entity
and CC 101110111 I-Entity
debugger NN 1010101111010 I-Entity
breakpoints NNS X I-Entity
which WDT 101111011 I-Entity
may MD 101101111010 I-Entity
be VB 10101100 I-Entity
set VBN 000101110 I-Entity
by IN 1001110 I-Entity
security NN 11100011010 I-Entity
software NN 001100111011 I-Entity
and CC 101110111 I-Entity
monitoring NN 111000111001 I-Entity
tools NNS 0011001111011 I-Entity
. . 0110 O

If IN 0101011100 O
any DT 11111011111 O
of IN 1000 O
these DT 11111000 O
are VBP 101101001 O
found VBN 10100111110 O
the DT 11010 O
shellcode NN 001011111100 O
skips VBZ X O
the DT 11010 O
first JJ 1111010100 O
5 CD 01111111101110 O
bytes NNS 11100101111 O
of IN 1000 O
the DT 11010 O
function NN 001010110111 O
being VBG 101011111000 O
called VBN 10100101000 O
by IN 1001110 O
manually RB 101011100111 O
executing VBG 101111111111010 O
prologue NN X O
instructions NNS 001111101100 O
( CD 01111000 O
mov NN X O
edi NN X O
, , 1011100 O
edi NN X O
; : 0111100100 O
push NN 10101000111 O
ebp NN X O
; : 0111100100 O
mov FW X O
ebp FW X O
, , 1011100 O
esp FW X O
) FW 011110100 O
and CC 101110111 O
then RB 101011111110 O
jumping VBG X O
to TO 101100 O
the DT 11010 O
function NN 001010110111 O
code NN 001001010 O
as IN 10111111110 O
illustrated VBN 101001110001 O
below IN 011110101100 O
. . 0110 O

The DT 010000 O
next JJ 11110101011 O
graph NN 0011111111001 O
presents VBZ 1011111011100 O
the DT 11010 O
execution NN 00100011110 O
flow NN 001111100111 O
of IN 1000 O
this DT 110110 O
malware NN 00101100 O
when WRB 100101110010 O
the DT 11010 O
exploitation NN 111000011110 O
is VBZ 101101010 O
successful JJ 1111000111010 O
. . 0110 O

As IN 01010100 O
mentioned VBN 101001111011 O
previously RB 1010111110101 O
this DT 110110 O
version NN 00011000 O
of IN 1000 O
the DT 11010 O
MiniDuke NNP 11101111011 O
payload NN 001001111000 O
comes VBZ 101111100000 O
with IN 100100 O
two CD 11111001100 O
modules NNS 001101110111 O
which WDT 101111011 O
we PRP 101111000 O
refer VBP 101000111101 O
to TO 101100 O
as IN 10111111110 O
the DT 11010 O
main JJ 11110101101 O
module NN 00101101100 O
and CC 101110111 O
the DT 11010 O
TwitterJS NN 111101111111111 O
module NN 00101101100 O
. . 0110 O

Once IN 0101011101 O
MiniDuke NNP 11101111011 O
receives VBZ 101111101001 O
control NN 111000100 O
it PRP 101111010 O
checks VBZ 101111101010 O
that IN 101111110 O
the DT 11010 O
host NN 00100001111 O
process NN 001001111011 O
is VBZ 101101010 O
not RB 1010111100 O
rundll32.exe NN 111011111110 O
and CC 101110111 O
whether IN 1011111111111010 O
the DT 11010 O
current JJ 111101111111111 O
directory NN 0011111111101 O
is VBZ 101101010 O
% NN 011100000 O
TEMP NN 011100001 O
% NN 011100000 O
. . 0110 O

If IN 0101011100 O
either DT 1010111011100 O
of IN 1000 O
those DT 111101111110111 O
conditions NNS 0011001111110 O
is VBZ 101101010 O
met VBN 10100101110110 O
the DT 11010 O
malware NN 00101100 O
assumes VBZ X O
it PRP 101111010 O
is VBZ 101101010 O
run VBN 101010111111100 O
for IN 10011111 O
the DT 11010 O
first JJ 1111010100 O
time NN 00011010 O
and CC 101110111 O
it PRP 101111010 B-Entity
proceeds VBZ 101000111010 B-Verb
with IN 100100 B-Preposition
its PRP$ 11011101 B-Entity
installation NN 00100011111 I-Entity
onto IN 10010111111111 I-Entity
the DT 11010 I-Entity
system NN 001000000 I-Entity
. . 0110 O

MiniDuke NNP 11101111011 B-Entity
gathers VBZ 101111101010 B-Verb
information NN 001111000 B-Entity
about IN 10010110110 I-Entity
the DT 11010 I-Entity
system NN 001000000 I-Entity
and CC 101110111 O
encrypts VBZ 101111100011 B-Verb
its PRP$ 11011101 B-Entity
configuration NN 00100110010 I-Entity
based VBN 10100101010 B-Preposition
on IN 1001010 I-Preposition
that DT 101111110 B-Entity
information NN 001111000 I-Entity
, , 1011100 O
a DT 11001 O
method NN 001010001100 O
also RB 10101111110 O
used VBN 1010011010 O
by IN 1001110 O
OSX/Flashback FW X O
( FW 01111000 O
this DT 110110 O
process NN 001001111011 O
is VBZ 101101010 O
called VBN 10100101000 O
watermarking VBG X O
by IN 1001110 O
Bitdefender FW X O
) FW 011110100 O
. . 0110 O

The DT 010000 O
end NN 000111100 O
result NN 000101100 O
is VBZ 101101010 O
that IN 101111110 O
it PRP 101111010 O
is VBZ 101101010 O
impossible JJ 10100001010 B-Verb
to TO 101100 I-Verb
retrieve VB 10101001011 I-Verb
the DT 11010 B-Entity
configuration NN 00100110010 I-Entity
of IN 1000 I-Entity
an DT 11000 I-Entity
encrypted JJ 10100100000 I-Entity
payload NN 001001111000 I-Entity
if IN 101111111111110 B-Preposition
analyzing VBG 101111111111011 B-Entity
it PRP 101111010 I-Entity
on IN 1001010 I-Entity
a DT 11001 I-Entity
different JJ 1111000000 I-Entity
computer NN 0010000010 I-Entity
. . 0110 O

The DT 010000 O
information NN 001111000 O
collected VBN 1010010110101 O
on IN 1001010 O
infection NN 0010101110111 O
has VBZ 1011011010 O
not RB 1010111100 O
changed VBN 10100101111011 O
since IN 1011111111111110 O
the DT 11010 O
previous JJ 111100001000 O
version NN 00011000 O
and CC 101110111 O
consists VBZ 00010010 O
of IN 1000 O
the DT 11010 O
following JJ 111101000 O
values NNS 0011111011110 O
: : 0111010 O
Once RB 0101011101 O
the DT 11010 B-Entity
encrypted JJ 10100100000 I-Entity
version NN 00011000 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
malware NN 00101100 I-Entity
is VBZ 101101010 B-Verb
created VBN 1010011011000 I-Verb
, , 1011100 O
it PRP 101111010 B-Entity
is VBZ 101101010 B-Verb
written VBN 10100110111110 I-Verb
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
file NN 00100100 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
% NN 011100000 I-Entity
ALLUSERSPROFILE NN X I-Entity
% NN 011100000 I-Entity
\Application NN 0111011010 I-Entity
Data NN 0111101101011 I-Entity
directory NN 0011111111101 I-Entity
. . 0110 O

The DT 010000 O
name NN 00111111010 O
of IN 1000 O
the DT 11010 O
file NN 00100100 O
is VBZ 101101010 O
randomly RB 1111000110111 O
picked VBN 101001100010 O
from IN 100101100 O
the DT 11010 O
following JJ 111101000 O
values NNS 0011111011110 O
( VBP 01111000 O
you PRP 101111001110 O
can MD 10110111110 O
find VB 10101000101 O
this DT 110110 O
listing NN 0011111111111 O
and CC 101110111 O
those DT 111101111110111 O
of IN 1000 O
the DT 11010 O
next JJ 11110101011 O
screenshots NNS 0011001111110 O
on IN 1001010 O
the DT 11010 O
VirusRadar NNP X O
description NN 0001011110 O
: : 0111010 O
The DT 010000 O
filename NN 01110110111 O
extension NN 0011111111111 O
is VBZ 101101010 O
also RB 10101111110 O
picked VBN 101001100010 O
randomly RB 1111000110111 O
from IN 100101100 O
the DT 11010 O
following JJ 111101000 O
list NN 0001011110 O
: : 0111010 O
To TO 0100011010 O
persist VB X B-Verb
on IN 1001010 B-Preposition
the DT 11010 B-Entity
infected JJ 111101111000 I-Entity
system NN 001000000 I-Entity
after IN 100101110100 B-Preposition
reboots NNS 0011110111010 B-Entity
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
creates VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
hidden JJ 11110001111110 I-Entity
.LNK NN X I-Entity
file NN 00100100 I-Entity
in IN 100110 B-Preposition
the DT 11010 B-Entity
'' '' 0111101110 I-Entity
Startup NNP 11101100110 I-Entity
'' '' 0111101110 I-Entity
directory NN 0011111111101 I-Entity
pointing VBG 10100010000 O
to TO 101100 O
the DT 11010 O
modified VBN 1010010110010 O
main JJ 11110101101 O
module NN 00101101100 O
. . 0110 O

The DT 010000 O
name NN 00111111010 O
of IN 1000 O
the DT 11010 O
.LNK NN X O

file NN 00100100 O
is VBZ 101101010 O
randomly RB 1111000110111 O
drawn VBN 10100101111011 O
from IN 100101100 O
the DT 11010 O
following JJ 111101000 O
values NNS 0011111011110 O
: : 0111010 O
The DT 010000 B-Entity
.LNKfile NN X I-Entity

is VBZ 101101010 B-Verb
created VBN 1010011011000 I-Verb
using VBG 100101111110 B-Preposition
a DT 11001 B-Entity
COM NN X I-Entity
object NN 11100100011 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
IShellLinkA NN X I-Entity
interface NN 0011110111010 I-Entity
and CC 101110111 O
contains VBZ 1011111011111 O
the DT 11010 O
following JJ 111101000 O
command NN 0010011100 O
: : 0111010 O
'' '' 0111101110 O
C NN 011100111 O
: : 0111010 O
\Windows\system32\rundll32.exe NN X O
% NN 011100000 O
pathtomainmodule CD X O
% NN 011100000 O
, , 1011100 O
exportfunction NN X O
'' '' 0111101110 O
Which WDT X O
gives VBZ 1011111001110 O
something NN 111100010100 O
like IN 101111111110110 O
: : 0111010 O
'' '' 0111101110 O
C NN 011100111 O
: : 0111010 O
\Windows\system32\rundll32.exe NN X O
C NN 011100111 O
: : 0111010 O
\DOCUME~1\ALLUSE~1\APPLIC~1\data.cat NN X O
, , 1011100 O
IlqUenn NNP X O
'' '' 0111101110 O
. . 0110 O

When WRB 0101011101 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
is VBZ 101101010 B-Verb
loaded VBN 10100100010 I-Verb
by IN 1001110 O
rundll32.exe NN 111011111110 B-Entity
and CC 101110111 O
the DT 11010 O
current JJ 111101111111111 O
directory NN 0011111111101 O
is VBZ 101101010 O
n't RB 1010111101 O
% NN 011100000 O
TEMP NN 011100001 O
% NN 011100000 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
starts VBZ 101111100000 O
with IN 100100 O
gathering VBG 111000111000 B-Verb
the DT 11010 B-Entity
same JJ 111101001 I-Entity
system NN 001000000 I-Entity
information NN 001111000 I-Entity
as IN 10111111110 I-Entity
described VBN 101001110000 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
'' '' 0111101110 I-Entity
Installation NN 0011111111101 I-Entity
'' '' 0111101110 I-Entity
section NN 0011111111110 I-Entity
to TO 101100 B-Preposition
decrypt VB 10101001010 B-Entity
configuration NN 00100110010 I-Entity
information NN 001111000 I-Entity
. . 0110 O

As IN 01010100 O
with IN 100100 O
the DT 11010 O
previous JJ 111100001000 O
version NN 00011000 O
of IN 1000 O
MiniDuke NNP 11101111011 O
, , 1011100 O
it PRP 101111010 O
checks VBZ 101111101010 O
for IN 10011111 O
the DT 11010 O
presence NN 0001111010 O
of IN 1000 O
the DT 11010 O
following JJ 111101000 O
processes NNS 0011001111110 O
in IN 100110 O
the DT 11010 O
system NN 001000000 O
: : 0111010 O
If IN 0101011100 O
any DT 11111011111 O
of IN 1000 O
these DT 11111000 O
are VBP 101101001 O
found VBN 10100111110 O
in IN 100110 O
the DT 11010 O
system NN 001000000 O
the DT 11010 O
configuration NN 00100110010 O
information NN 001111000 O
will MD 10110111111 O
be VB 10101100 O
decrypted VBN 10100100011 O
incorrectly RB 11100110011 O
, , 1011100 O
i.e NN 01110111001 O
. . 0110 O

the DT 11010 O
malware NN 00101100 O
will MD 10110111111 O
run VB 101010111111100 O
on IN 1001010 O
the DT 11010 O
system NN 001000000 O
without IN 100101110011 O
any DT 11111011111 O
communication NN 001111010000 O
to TO 101100 O
C NN 011100111 O
& CC 01110010 O
C NN 011100111 O
servers NNS 00111010 O
. . 0110 O

If IN 0101011100 O
the DT 11010 O
configuration NN 00100110010 O
data NNS 001111001 O
is VBZ 101101010 O
decrypted VBN 10100100011 O
correctly RB 101011100111 O
, , 1011100 O
MiniDuke NNP 11101111011 B-Entity
retrieves VBZ 101111101001 B-Verb
the DT 11010 B-Entity
Twitter NNP 00100011001 I-Entity
page NN 0011111111001 I-Entity
of IN 1000 I-Entity
@ SYM 011101111100 I-Entity
FloydLSchwartz NNP X I-Entity
in IN 100110 B-Preposition
search NN 101010110100 B-Entity
of IN 1000 I-Entity
URLs NNS 001111100100 I-Entity
by IN 1001110 I-Entity
which WDT 101111011 I-Entity
to TO 101100 I-Entity
reach VB 10101000101 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
server NN 00111011 I-Entity
. . 0110 O

It PRP 01001010 O
looks VBZ 101010110010 O
for IN 10011111 O
the DT 11010 O
tag NN 001011111110 O
'' '' 0111101110 O
X NNP 011111111001 O
) NNP 011110100 O
) NNP 011110100 O
) NNP 011110100 O
'' '' 0111101110 O
on IN 1001010 O
the DT 11010 O
page NN 0011111111001 O
( NNP 01111000 O
MiniDuke NNP 11101111011 O
was VBD 101101011 O
searching VBG 101010110011 O
for IN 10011111 O
'' '' 0111101110 O
uri NN 01110111111110 O
! . 01110111111110 O
'' '' 0111101110 O
in IN 100110 O
previous JJ 111100001000 O
samples NNS 0011011100 O
) NN 011110100 O
and CC 101110111 O
if IN 101111111111110 O
the DT 11010 O
tag NN 001011111110 O
is VBZ 101101010 O
found VBN 10100111110 O
it PRP 101111010 O
decrypts VBZ 101111101000 O
a DT 11001 O
URL NN 001111100100 O
from IN 100101100 O
the DT 11010 O
data NNS 001111001 O
that WDT 101111110 O
follows VBZ 01110110001 O
it PRP 101111010 O
. . 0110 O

The DT 010000 O
Twitter NNP 00100011001 O
account NN 0011110111001 O
@ SYM 011101111100 O
FloydLSchwartz NNP X O
does VBZ 1011011100 O
exist VB 1010010111000 O
but CC 10111111111000 O
has VBZ 1011011010 O
only JJ 10101110010 O
retweets NNS X O
and CC 101110111 O
no DT 11111011101 O
strings NNS 0011111011100 O
with IN 100100 O
the DT 11010 O
special JJ 111100001101 O
tag NN 001011111110 O
. . 0110 O

As IN 01010100 O
the DT 11010 O
next JJ 11110101011 O
step NN 001010001101 O
, , 1011100 O
MiniDuke NNP 11101111011 B-Entity
gathers VBZ 101111101010 B-Verb
the DT 11010 B-Entity
following VBG 111101000 I-Entity
information NN 001111000 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
infected JJ 111101111000 I-Entity
systems NNS 00110011000 I-Entity
: : 0111010 O
This DT 0100010 B-Entity
information NN 001111000 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
sent VBN 10100110111011 I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
along IN 10100100110 O
with IN 100100 O
the DT 11010 O
request NN 001111010100 B-Verb
to TO 101100 B-Preposition
download VB 10101011111010 B-Entity
a DT 11001 I-Entity
payload NN 001001111000 I-Entity
. . 0110 O

The DT 010000 B-Entity
final JJ 111101111111100 I-Entity
URL NN 001111100100 I-Entity
used VBN 1010011010 B-Verb
to TO 101100 B-Preposition
communicate VB 10100100111 B-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
looks VBZ 101010110010 O
like IN 101111111110110 O
this DT 110110 O
: : 0111010 O
< JJR 01110111110110 O
urlstart NN X O
> JJR 011100011 O
/create.php NN X O
? . 0111011111010 O
< JJR 01110111110110 O
rndparam NN X O
> JJR 011100011 O
= JJ 01110111110111 O
< JJR 01110111110110 O
systeminfo NN 01110110111 O
> JJR 011100011 O
Those DT 0100111111 O
tokens NNS X O
are VBP 101101001 O
derived VBN 10101110001 O
as IN 10111111110 O
follows VBZ 01110110001 O
: : 0111010 O
An DT 0100011111 O
example NN 000010 O
of IN 1000 O
such PDT 101111111010 O
a DT 11001 O
URL NN 001111100100 O
is VBZ 101101010 O
given VBN 101000001111 O
below IN 011110101100 O
: : 0111010 O
The DT 010000 B-Entity
payload NN 001001111000 I-Entity
is VBZ 101101010 B-Verb
downloaded VBN 10100101101111 I-Verb
in IN 100110 B-Preposition
the DT 11010 B-Entity
file NN 00100100 I-Entity
named VBN 10100101001 I-Entity
'' '' 0111101110 I-Entity
fdbywu NN X I-Entity
'' '' 0111101110 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
urlmon NN X I-Entity
! . 01110111111110 I-Entity
URLDownloadToFileA JJ X I-Entity
API NN 0111101101101 I-Entity
: : 0111010 O
The DT 010000 O
downloaded VBN 10100101101111 O
payload NN 001001111000 O
is VBZ 101101010 O
a DT 11001 O
fake JJ 111100001101 O
GIF8 NN X O
file NN 00100100 O
containing NN 10010111111111 O
encrypted VBD 10100100000 O
executable JJ 001001111100 O
. . 0110 O

The DT 010000 O
malware NN 00101100 O
processes VBZ 0011001111110 O
the DT 11010 O
downloaded VBN 10100101101111 O
file NN 00100100 O
in IN 100110 O
the DT 11010 O
same JJ 111101001 O
way NN 00101001010 O
as IN 10111111110 O
previous JJ 111100001000 O
samples NNS 0011011100 O
of IN 1000 O
MiniDuke NNP 11101111011 O
: : 0111010 O
it PRP 101111010 B-Entity
verifies VBZ 101111101010 B-Verb
the DT 11010 B-Entity
integrity NN 0001110001 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
file NN 00100100 I-Entity
using VBG 100101111110 B-Preposition
RSA-2048 NN X B-Entity
, , 1011100 O
then RB 101011111110 O
decrypts VBZ 101111101000 O
it PRP 101111010 O
, , 1011100 O
stores NNS 101111101001 O
in IN 100110 O
a DT 11001 O
file NN 00100100 O
and CC 101110111 O
finally RB 1010111011110 O
executes VBZ 101111101001 B-Verb
it PRP 101111010 B-Entity
. . 0110 O

The DT 010000 B-Entity
RSA-2048 NN X I-Entity
public JJ 1111001011101 I-Entity
key NN 001111111010 I-Entity
to TO 101100 O
verify VB 1010101001 B-Verb
integrity NN 0001110001 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
executable JJ 001001111100 I-Entity
inside IN 100101110111 I-Entity
the DT 11010 I-Entity
GIF NN 11110111110101 I-Entity
file NN 00100100 I-Entity
is VBZ 101101010 O
the DT 11010 O
same JJ 111101001 O
as IN 10111111110 O
in IN 100110 O
the DT 11010 O
previous JJ 111100001000 O
version NN 00011000 O
of IN 1000 O
MiniDuke NNP 11101111011 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
event NN 0010101111110 O
that IN 101111110 O
MiniDuke NNP 11101111011 O
is VBZ 101101010 O
unable JJ 10100010110 O
to TO 101100 O
retrieve VB 10101001011 O
a DT 11001 O
C NN 011100111 O
& CC 01110010 O
C NN 011100111 O
URL NN 001111100100 O
from IN 100101100 O
this DT 110110 O
account NN 0011110111001 O
, , 1011100 O
it PRP 101111010 O
generates VBZ 1011111010110 O
a DT 11001 O
username NN 01110110111 O
to TO 101100 O
search VB 101010110100 O
for IN 10011111 O
based VBN 10100101010 O
on IN 1001010 O
the DT 11010 O
current JJ 111101111111111 O
date NN 1010101111011 O
. . 0110 O

The DT 010000 O
search NN 101010110100 O
query NN 101010110100 O
changes VBZ 0011110100100 O
roughly RB 11111011011 O
every DT 1111101011 O
seven CD 0111111111011 O
days NNS 0011010100 O
and CC 101110111 O
is VBZ 101101010 O
similar JJ 10100001111 O
to TO 101100 O
the DT 11010 O
backup NN 1110001101101 O
mechanism NN 00101001101 O
in IN 100110 O
previous JJ 111100001000 O
versions NNS 0011010001 O
that WDT 101111110 O
was VBD 101101011 O
using VBG 100101111110 O
Google NNP 111011111100 O
searches NNS 101010110011 O
. . 0110 O

A DT 010001110 O
Python NNP 00100110111 O
implementation NN 00011111000 O
of IN 1000 O
the DT 11010 O
algorithm NN 0011111111000 O
can MD 10110111110 O
be VB 10101100 O
found VBN 10100111110 O
in IN 100110 O
Appendix NN 01111101110 O
B NN 011111111000 O
. . 0110 O

The DT 010000 O
TwitterJS NN 111101111111111 O
module NN 00101101100 O
is VBZ 101101010 O
extracted VBN 10101110001 O
by IN 1001110 O
creating VBG 101111111111011 B-Verb
a DT 11001 B-Entity
copy NN 0001011111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
Windows NNP 1110110100 I-Entity
DLL NNP 00101101110 I-Entity
cryptdll.dll NNP X I-Entity
, , 1011100 O
injecting VBG X O
a DT 11001 O
block NN 0011110111101 O
of IN 1000 O
code NN 001001010 O
into IN 10010111100 O
it PRP 101111010 O
and CC 101110111 O
redirecting VBG 1010111010100 O
the DT 11010 O
exported VBN 111101111111010 O
functions NNS 0011111011011 O
to TO 101100 O
this DT 110110 O
code NN 001001010 O
. . 0110 O

Here RB 01001011 O
is VBZ 101101010 O
how WRB 1011111111111000 O
the DT 11010 O
export NN 101010111111110 O
address NN 00111000 O
table NN 000101101 O
of IN 1000 O
the DT 11010 O
patched VBN 101001100111 O
binary JJ 001011010100 O
looks NNS 101010110010 O
after IN 100101110100 O
modifications NNS 0011110100100 O
. . 0110 O

This DT 0100010 B-Entity
file NN 00100100 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
stored VBN 1010011101111 I-Verb
in IN 100110 B-Preposition
an DT 11000 B-Entity
Alternate JJ X I-Entity
Data NNP 0111101101011 I-Entity
Stream NNP X I-Entity
( NNP 01111000 I-Entity
ADS NNPS X I-Entity
) NNP 011110100 I-Entity
in IN 100110 I-Entity
NTUSER.DAT NNP X I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
% NN 011100000 I-Entity
USERPROFILE NN X I-Entity
% NN 011100000 I-Entity
folder NN 0011111111100 I-Entity
. . 0110 O

Finally RB 010110 O
this DT 110110 B-Entity
DLL NNP 00101101110 I-Entity
is VBZ 101101010 B-Verb
registered VBN 1010011011001 I-Verb
as IN 10111111110 B-Preposition
the DT 11010 B-Entity
Open NNP 011110110100 I-Entity
command NN 0010011100 I-Entity
when WRB 100101110010 I-Entity
a DT 11001 I-Entity
drive NN 0111101011111 I-Entity
is VBZ 101101010 I-Entity
open JJ 10101011111011 I-Entity
, , 1011100 O
which WDT 101111011 O
has VBZ 1011011010 O
the DT 11010 O
effect NN 0001110101 O
of IN 1000 O
starting VBG 10101110001 B-Verb
the DT 11010 B-Entity
bot NN 001011111111 I-Entity
every DT 1111101011 B-Preposition
time NN 00011010 I-Preposition
the DT 11010 B-Entity
user NN 0010000110 I-Entity
opens VBZ 101111101001 I-Entity
a DT 11001 I-Entity
disk NN 11100111111 I-Entity
drive NN 0111101011111 I-Entity
. . 0110 O

Below IN 01001011 O
you PRP 101111001110 O
can MD 10110111110 O
find VB 10101000101 O
the DT 11010 O
content NN 001111100110 O
of IN 1000 O
the DT 11010 O
init.cmd NN X O
script NN 0010011111111 O
used VBN 1010011010 O
by IN 1001110 O
MiniDuke NNP 11101111011 B-Entity
to TO 101100 O
install VB 10101001000 B-Verb
TwitterJS NN 111101111111111 B-Entity
module NN 00101101100 I-Entity
onto IN 10010111111111 B-Preposition
the DT 11010 B-Entity
system NN 001000000 I-Entity
. . 0110 O

When WRB 0101011101 O
loaded VBN 10100100010 O
, , 1011100 O
TwitterJS NN 111101111111111 O
instantiates VBZ X O
the DT 11010 O
JScript NN 00100110111 O
COM NN X O
object NN 11100100011 O
and CC 101110111 O
decrypts VBZ 101111101000 O
a DT 11001 O
JScript NN 00100110111 O
file NN 00100100 O
containing VBG 10010111111111 O
the DT 11010 O
core NN 00011111011 O
logic NN 000101100 O
of IN 1000 O
the DT 11010 O
module NN 00101101100 O
. . 0110 O

Prior RB X O
to TO 101100 O
executing VBG 101111111111010 O
it PRP 101111010 O
, , 1011100 O
MiniDuke NNP 11101111011 B-Entity
applies VBZ 101000110001 B-Verb
a DT 11001 B-Entity
light JJ 1010101111001 I-Entity
encoding NN 1111011100111 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
script NN 0010011111111 I-Entity
: : 0111010 O
The DT 010000 O
next JJ 11110101011 O
images NNS 001111100010 O
show VBP 1010101110100 O
the DT 11010 O
result NN 000101100 O
of IN 1000 O
two CD 11111001100 O
separate JJ 111100000110 O
obfuscations NNS X O
, , 1011100 O
we PRP 101111000 O
can MD 10110111110 O
see VB 1010101000 O
that IN 101111110 O
the DT 11010 O
variables NNS 0011001101011 O
have VBP 101101100 O
different JJ 1111000000 O
values NNS 0011111011110 O
. . 0110 O

This DT 0100010 B-Entity
is VBZ 101101010 O
probably RB 1010111011010 O
done VBN 101001100111 O
to TO 101100 O
thwart VB X B-Verb
security NN 11100011010 B-Entity
systems NNS 00110011000 I-Entity
that WDT 101111110 I-Entity
scan VBP 101010101110 I-Entity
at IN 10011110 I-Entity
the DT 11010 I-Entity
entry NN 0010101110110 I-Entity
points NNS 001111011000 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
JScript NN 00100110111 I-Entity
engine NN 001111011010 I-Entity
. . 0110 O

The DT 010000 O
purpose NN 00011111011 O
of IN 1000 O
this DT 110110 B-Entity
script NN 0010011111111 I-Entity
is VBZ 101101010 O
to TO 101100 O
use VB 10101011100 B-Verb
Twitter NNP 00100011001 B-Entity
to TO 101100 B-Preposition
find VB 10101000101 B-Entity
a DT 11001 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
and CC 101110111 O
retrieve VB 10101001011 B-Verb
JScript NN 00100110111 B-Entity
code NN 001001010 I-Entity
to TO 101100 I-Entity
execute VB 10101001011 I-Entity
. . 0110 O

It PRP 01001010 O
first RB 1111010100 O
generates VBZ 1011111010110 O
a DT 11001 O
Twitter NNP 00100011001 O
user NN 0010000110 O
to TO 101100 O
search VB 101010110100 O
for IN 10011111 O
; : 0111100100 O
this DT 110110 O
search NN 101010110100 O
term NN 11100100111 O
changes VBZ 0011110100100 O
every DT 1111101011 O
7 CD 01111111101101 O
days NNS 0011010100 O
and CC 101110111 O
is VBZ 101101010 O
actually RB 1111111101 O
a DT 11001 O
match NN 1010101110100 O
to TO 101100 O
the DT 11010 O
real JJ 111100001100 O
account NN 0011110111001 O
name NN 00111111010 O
, , 1011100 O
not RB 1010111100 O
the DT 11010 O
Twitter NNP 00100011001 O
account NN 0011110111001 O
name NN 00111111010 O
. . 0110 O

The DT 010000 O
bot NN 001011111111 O
then RB 101011111110 O
visits VBZ 101111101001 O
the DT 11010 O
Twitter NNP 00100011001 O
profiles NNS 001111101010 O
returned VBN 10100101101101 O
by IN 1001110 O
the DT 11010 O
search NN 101010110100 O
and CC 101110111 O
looks VBZ 101010110010 O
for IN 10011111 O
links NNS 101000110001 O
that WDT 101111110 O
end VBP 000111100 O
with IN 100100 O
'' '' 0111101110 O
.xhtml NN X O

'' '' 0111101110 O
. . 0110 O

When WRB 0101011101 O
one CD 111110100 O
is VBZ 101101010 O
found VBN 10100111110 O
, , 1011100 O
it PRP 101111010 O
replaces VBZ 1011111010111 O
'' '' 0111101110 O
.xhtml NN X O

'' '' 0111101110 O
with IN 100100 O
'' '' 0111101110 O
.php NN X O

'' '' 0111101110 O
and CC 101110111 O
fetches VBZ 101111101000 O
that DT 101111110 O
link NN 101000110000 O
. . 0110 O

Information NNP 0111101100101 O
about IN 10010110110 O
the DT 11010 O
computer NN 0010000010 O
is VBZ 101101010 O
embedded VBN 1111011101000 O
in IN 100110 O
the DT 11010 O
Accept NNP 001111100111 O
HTTP NNP 111101101010 O
header NN 001111100011 O
. . 0110 O

The DT 010000 O
first JJ 1111010100 O
link NN 101000110000 O
on IN 1001010 O
the DT 11010 O
retrieved VBN 10100101101101 O
page NN 0011111111001 O
should MD 1011011110111 O
contain VB 1010101110111 O
base64 NN 1111011100100 O
data NNS 001111001 O
; : 0111100100 O
the DT 11010 O
name NN 00111111010 O
attribute NN 10101000100 O
of IN 1000 O
the DT 11010 O
link NN 101000110000 O
is VBZ 101101010 O
used VBN 1010011010 O
as IN 10111111110 O
a DT 11001 O
rolling JJ X O
XOR NN 1111011100101 O
key NN 001111111010 O
to TO 101100 O
decrypt VB 10101001010 O
the DT 11010 O
JScript NN 00100110111 O
code NN 001001010 O
. . 0110 O

Finally RB 010110 O
, , 1011100 O
MiniDuke NNP 11101111011 O
calculates VBZ 101111101000 O
a DT 11001 O
hash NN 00111111001 O
of IN 1000 O
the DT 11010 O
fetched VBN 10100100011 O
script NN 0010011111111 O
and CC 101110111 O
compares VBZ X O
it PRP 101111010 O
with IN 100100 O
a DT 11001 O
hardcoded JJ 1111011101011 O
hash NN 00111111001 O
in IN 100110 O
the DT 11010 O
TwitterJS NN 111101111111111 O
script NN 0010011111111 O
. . 0110 O

If IN 0101011100 O
they PRP 10111100110 O
match VBP 1010101110100 O
, , 1011100 O
the DT 11010 O
fetched VBN 10100100011 O
script NN 0010011111111 O
is VBZ 101101010 O
executed VBN 1010010111100 O
by IN 1001110 O
calling VBG 11101110111 O
eval JJ X O
( NNP 01111000 O
) NNP 011110100 O
. . 0110 O

The DT 010000 O
code NN 001001010 O
hashing VBG X O
algorithm NN 0011111111000 O
used VBN 1010011010 O
by IN 1001110 O
the DT 11010 O
component NN 00101000011 O
looks VBZ 101010110010 O
very RB 1111111100 O
much RB 111100010100 O
like IN 101111111110110 O
SHA-1 NN 1111111010 O
but CC 10111111111000 O
outputs VBZ 10101110000 O
different JJ 1111000000 O
hashes NNS 0011111011101 O
( VBP 01111000 O
you PRP 101111001110 O
can MD 10110111110 O
find VB 10101000101 O
the DT 11010 O
complete JJ 1111000110101 O
implementation NN 00011111000 O
in IN 100110 O
Appendix NN 01111101110 O
B NN 011111111000 O
. . 0110 O

We PRP 01001001 O
decided VBD 101000111011 O
to TO 101100 O
search VB 101010110100 O
for IN 10011111 O
what WP 1011111111111001 O
was VBD 101101011 O
changed VBN 10100101111011 O
in IN 100110 O
the DT 11010 O
algorithm NN 0011111111000 O
; : 0111100100 O
one CD 111110100 O
of IN 1000 O
our PRP$ 11011110 O
working VBG 10100101111100 O
hypotheses NNS 0011110111101 O
was VBD 101101011 O
that IN 101111110 O
the DT 11010 O
algorithm NN 0011111111000 O
might MD 1011011110010 O
have VB 101101100 O
been VBN 10101101 O
altered VBN 1010010110010 O
to TO 101100 O
make VB 101010011000 O
collisions NNS X O
feasible JJ 10100001011 O
. . 0110 O

We PRP 01001001 O
could MD 101101111000 O
n't RB 1010111101 O
find VB 10101000101 O
an DT 11000 O
obvious JJ 10100000100 O
difference NN 00101000100 O
; : 0111100100 O
all PDT 1111101100 O
the DT 11010 O
constants NNS X O
and CC 101110111 O
the DT 11010 O
steps NNS 0011111011010 O
of IN 1000 O
the DT 11010 O
algorithm NN 0011111111000 O
were VBD 101101000 O
as IN 10111111110 O
expected VBN 10100001000 O
. . 0110 O

Then RB 010101100 O
we PRP 101111000 O
noticed VBD 1010011111110 O
that IN 101111110 O
for IN 10011111 O
short JJ 1111000111110 O
messages NNS 00110111111 O
only RB 10101110010 O
the DT 11010 O
second JJ 11110101010 O
32-bit JJ 1111011101110 O
word NN 11100100111 O
was VBD 101101011 O
different JJ 1111000000 O
when WRB 100101110010 O
compared VBN 10100010100 O
to TO 101100 O
the DT 11010 O
original JJ 11110101111 O
SHA-1 NN 1111111010 O
. . 0110 O

By IN 010001100 O
examining VBG 101111111111011 O
how WRB 1011111111111000 O
this DT 110110 O
2nd JJ 11110011111 O
word NN 11100100111 O
was VBD 101101011 O
generated VBN 101001100010 O
we PRP 101111000 O
finally RB 1010111011110 O
discovered VBD 1010011111110 O
that IN 101111110 O
this DT 110110 O
was VBD 101101011 O
caused VBN 101001100001 O
by IN 1001110 O
a DT 11001 O
scope NN 000111100 O
issue NN 001100011110 O
. . 0110 O

As IN 01010100 O
shown VBN 101001110001 O
below IN 011110101100 O
the DT 11010 O
SHA-1 NN 1111111010 O
function NN 001010110111 O
used VBD 1010011010 O
a DT 11001 O
variable NN 111000110011 O
named VBN 10100101001 O
f SYM 01110110001 O
: : 0111010 O
the DT 11010 O
function NN 001010110111 O
Z NN 011111111000 O
( FW 01111000 O
) FW 011110100 O
is VBZ 101101010 O
then RB 101011111110 O
called VBN 10100101000 O
which WDT 101111011 O
also RB 10101111110 O
uses VBZ 1011111010111 O
a DT 11001 O
variable NN 111000110011 O
named VBN 10100101001 O
f FW 01110110001 O
without IN 100101110011 O
the DT 11010 O
var FW X O
keyword FW X O
, , 1011100 O
causing VBG 10111111111100 O
it PRP 101111010 O
to TO 101100 O
be VB 10101100 O
treated VBN X O
as IN 10111111110 O
a DT 11001 O
global JJ 1111001011001 O
variable NN 111000110011 O
rather RB 011110011101 O
than IN 011110111110 O
local JJ 111101111111110 O
to TO 101100 O
the DT 11010 O
function NN 001010110111 O
. . 0110 O

The DT 010000 O
end NN 000111100 O
result NN 000101100 O
is VBZ 101101010 O
that IN 101111110 O
the DT 11010 O
value NN 001111111000 O
of IN 1000 O
f FW 01110110001 O
is VBZ 101101010 O
also RB 10101111110 O
changed VBN 10100101111011 O
in IN 100110 O
the DT 11010 O
SHA-1 NN 1111111010 O
function NN 001010110111 O
which WDT 101111011 O
affects VBZ 101111100100 O
the DT 11010 O
value NN 001111111000 O
of IN 1000 O
the DT 11010 O
2nd JJ 11110011111 O
word NN 11100100111 O
for IN 10011111 O
that DT 101111110 O
round NN X O
and CC 101110111 O
ultimately RB 10101111111101 O
the DT 11010 O
whole JJ 001001110100 O
hash NN 00111111001 O
for IN 10011111 O
long JJ 11100110110 O
messages NNS 00110111111 O
. . 0110 O

A DT 010001110 O
likely JJ 101011101100 O
explanation NN 00100101110 O
of IN 1000 O
how WRB 1011111111111000 O
this DT 110110 O
problem NN 001011111100 O
came VBD 10101110001 O
to TO 101100 O
be VB 10101100 O
is VBZ 101101010 O
that IN 101111110 O
the DT 11010 O
variable JJ 111000110011 O
names NNS 00111111011 O
were VBD 101101000 O
changed VBN 10100101111011 O
to TO 101100 O
single JJ 111100011000 O
letters NNS 001111010101 O
using VBG 100101111110 O
an DT 11000 O
automated JJ 111100010001 O
tool NN 001010001110 O
prior RB 10100010101 O
to TO 101100 O
embedding VBG 101010111111110 O
it PRP 101111010 O
in IN 100110 O
the DT 11010 O
payload NN 001001111000 O
. . 0110 O

The DT 010000 O
2 CD 0111111110100 O
f LS 01110110001 O
variables NNS 0011001101011 O
probably RB 1010111011010 O
had VBD 1011011011 O
different JJ 1111000000 O
names NNS 00111111011 O
in IN 100110 O
the DT 11010 O
original JJ 11110101111 O
script NN 0010011111111 O
which WDT 101111011 O
avoided VBD X O
the DT 11010 O
issue NN 001100011110 O
. . 0110 O

So IN 010101100 O
this DT 110110 O
leaves VBZ 1011111001110 O
us PRP 10111111100110 O
with IN 100100 O
two CD 11111001100 O
takeaways NNS X O
: : 0111010 O
1 CD 0111111110101 O
) CD 011110100 O
The DT 010000 O
difference NN 00101000100 O
in IN 100110 O
the DT 11010 O
hashing VBG X O
algorithm NN 0011111111000 O
was VBD 101101011 O
unintentional JJ X O
and CC 101110111 O
2 CD 0111111110100 O
) NNS 011110100 O
Always RB X O
declare VBP X O
your PRP$ 110111111 O
local JJ 111101111111110 O
variables NNS 0011001101011 O
with IN 100100 O
the DT 11010 O
var FW X O
keyword FW X O
. . 0110 O

; : 0111100100 O
- : 01111001101 O
) NN 011110100 O
We PRP 01001001 O
generated VBD 101001100010 O
the DT 11010 O
list NN 0001011110 O
of IN 1000 O
Twitter NNP 00100011001 O
search NN 101010110100 O
terms NNS 000000 O
for IN 10011111 O
2013-2014 CD 111000111001 O
and CC 101110111 O
checked VBD 1010010110100 O
if IN 101111111111110 O
any DT 11111011111 O
of IN 1000 O
those DT 111101111110111 O
were VBD 101101000 O
registered VBN 1010011011001 O
. . 0110 O

At IN 0101011111 O
the DT 11010 O
moment NN 0010111011 O
only RB 10101110010 O
one CD 111110100 O
exists VBZ 1010010111001 O
, , 1011100 O
@ IN 011101111100 O
AA2ADcAOAA NN X O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
the DT 11010 O
TwitterJS NN 111101111111111 O
account NN 0011110111001 O
that WDT 101111110 O
was VBD 101101011 O
generated VBN 101001100010 O
between IN 10010110100 O
August NNP 01111101001 O
21st JJ 0111111111101 O
and CC 101110111 O
27th JJ X O
2013 CD 0111111000 O
. . 0110 O

This DT 0100010 O
account NN 0011110111001 O
has VBZ 1011011010 O
no DT 11111011101 O
tweets NNS 001011111100 O
. . 0110 O

In IN 0101000 O
an DT 11000 O
effort NN 00100010111 O
to TO 101100 O
discover VB 101010011101 O
potential JJ 1111000111011 O
victims NNS 00110010110 O
, , 1011100 O
we PRP 101111000 O
registered VBD 1010011011001 O
the DT 11010 O
Twitter NNP 00100011001 O
accounts NNS 0011110111000 O
corresponding VBG 1111011101101 O
to TO 101100 O
the DT 11010 O
current JJ 111101111111111 O
week NN 001010110100 O
both DT 11111011010 O
for IN 10011111 O
the DT 11010 O
main NN 11110101101 O
and CC 101110111 O
TwitterJS NN 111101111111111 O
components NNS 001111101000 O
and CC 101110111 O
set VBD 000101110 O
up RP 10111111100111 O
tweets NNS 001011111100 O
with IN 100100 O
encrypted JJ 10100100000 O
URLs NNS 001111100100 O
so IN 101111111110010 O
that IN 101111110 O
an DT 11000 O
infected JJ 111101111000 O
computer NN 0010000010 O
would MD 1011011110011 O
reach VB 10101000101 O
out RP 1011111110010 O
to TO 101100 O
our PRP$ 11011110 O
server NN 00111011 O
. . 0110 O

So RB 010101100 O
far RB 11100110111 O
we PRP 101111000 O
have VBP 101101100 O
received VBN 10100101101101 O
connections NNS 0011110100101 O
via IN 100101111011 O
the DT 11010 O
TwitterJS NN 111101111111111 O
accounts NNS 0011110111000 O
from IN 100101100 O
four CD 0111111111011 O
computers NNS 001100110011 O
located JJ 101001110101 O
in IN 100110 O
Belgium NNP 0111111010 O
, , 1011100 O
France NNP 010111 O
and CC 101110111 O
the DT 11010 O
UK NNP 1110110010 O
. . 0110 O

We PRP 01001001 O
have VBP 101101100 O
contacted VBN 101001100000 O
national JJ 1111001011000 O
CERTs NNS X O
to TO 101100 O
notify VB 101010011001 O
the DT 11010 O
affected VBN 1010010110001 O
parties NNS 11100100000 O
. . 0110 O

We PRP 01001001 O
detect VBP 101010011100 O
the DT 11010 O
RTF NN 11100000110 O
exploit VBP 001010111010 O
document NN 00100101101 O
as IN 10111111110 O
Win32/Exploit.CVE-2014-1761.D NN X O
and CC 101110111 O
the DT 11010 O
MiniDuke NNP 11101111011 O
components NNS 001111101000 O
as IN 10111111110 O
Win32/SandyEva.G NN X O
. . 0110 O

