One CD 010011101 O
of IN 1000 O
the DT 11010 O
questions NNS 0001110100 O
which WDT 101111011 O
comes VBZ 101111100000 O
up RP 10111111100111 O
in IN 100110 O
the DT 11010 O
months NNS 0011010100 O
after IN 100101110100 O
big JJ 111100101011 O
security NN 11100011010 O
whitepaper NN X O
disclosures NNS 001111101010 O
is VBZ 101101010 O
: : 0111010 O
where WRB 101111111110100 O
are VBP 101101001 O
they PRP 10111100110 O
now RB 1010111011110 O
? . 0111011111010 O
In IN 0101000 O
other JJ 111110010 O
words NNS 00110101110 O
, , 1011100 O
what WP 1011111111111001 O
happened VBD 101000111000 O
to TO 101100 O
the DT 11010 O
operators NNS 00111101001111 O
, , 1011100 O
tools NNS 0011001111011 O
, , 1011100 O
and CC 101110111 O
infrastructure NN 00110001010 O
which WDT 101111011 O
was VBD 101101011 O
revealed VBN 101001111000 O
in IN 100110 O
the DT 11010 O
reports NNS 001111101010 O
, , 1011100 O
blog-posts NNS X O
, , 1011100 O
and CC 101110111 O
press NN 10101011111011 O
interviews NNS X O
. . 0110 O

Did VBD X O
they PRP 10111100110 O
continue VBP 101000111100 O
on IN 1001010 O
as RB 10111111110 O
before RB 100101110101 O
, , 1011100 O
did VBD 10110111010 O
they PRP 10111100110 O
re-build VB X O
the DT 11010 O
disclosed VBN 101001111000 O
infrastructure NN 00110001010 O
and CC 101110111 O
tools NNS 0011001111011 O
, , 1011100 O
did VBD 10110111010 O
they PRP 10111100110 O
go VB 101000111100 O
away RB 00110001000 O
and CC 101110111 O
get VB 10101000100 O
jobs NNS 0011110111001 O
in IN 100110 O
another DT 11111011100 O
line NN 01111001011 O
of IN 1000 O
work NN 1010101111000 O
? . 0111011111010 O
In IN 0101000 O
some DT 11111011110 O
cases NNS 0011010010 O
, , 1011100 O
the DT 11010 O
disclosure NN 000111100 O
had VBD 1011011011 O
little JJ 111100010101 O
, , 1011100 O
if IN 101111111111110 O
any DT 11111011111 O
impact NN 1010101111001 O
on IN 1001010 O
the DT 11010 O
operation NN 0010101111111 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
after IN 100101110100 O
the DT 11010 O
McAfee FW 11101110101 O
ShadyRAT FW X O
report NN 001010111100 O
in IN 100110 O
2011 CD 011111100110 O
, , 1011100 O
there EX 10111100101 O
was VBD 101101011 O
absolutely RB X O
no DT 11111011101 O
change NN 101010111111011 O
in IN 100110 O
the DT 11010 O
attacks NNS 001101100 O
from IN 100101100 O
the DT 11010 O
group NN 00101010110 O
behind IN 1001011111011 O
this DT 110110 O
. . 0110 O

However RB 010110 O
, , 1011100 O
when WRB 100101110010 O
Mandiant NNP 11101110001 O
released VBD 1010011011011 O
their PRP$ 11011100 O
APT1 NN 11101110010 O
report NN 001010111100 O
in IN 100110 O
2013 CD 0111111000 O
, , 1011100 O
there EX 10111100101 O
was VBD 101101011 O
a DT 11001 O
noticeable JJ 111100010011 O
reduction NN X O
in IN 100110 O
activity NN 00110001011 O
from IN 100101100 O
the DT 11010 O
group NN 00101010110 O
– NN 01111001100 O
and CC 101110111 O
much JJ 111100010100 O
of IN 1000 O
the DT 11010 O
tools NNS 0011001111011 O
and CC 101110111 O
infrastructure NN 00110001010 O
has VBZ 1011011010 O
not RB 1010111100 O
been VBN 10101101 O
seen VBN 101001110010 O
since IN 1011111111111110 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
September NNP 01111101001 O
2010 CD 011111100110 O
issue NN 001100011110 O
of IN 1000 O
Foreign NNP 0011001010 O
Affairs NNP 101001111011 O
magazine NN X O
, , 1011100 O
former JJ 111100001111 O
US NNP 1110110010 O
Deputy NNP X O
Secretary NNP X O
of IN 1000 O
Defense NNP 1110111110010 O
William NNP X O
J. NNP 01110111110110 O
Lynn NNP X O
discussed VBD 101001110011 O
a DT 11001 O
cyber-attack NN 001001110111 O
which WDT 101111011 O
happened VBD 101000111000 O
two CD 11111001100 O
years NNS 0011010101 O
previously RB 1010111110101 O
on IN 1001010 O
the DT 11010 O
DoD's NN X O
classified JJ 111000111101 O
computer NN 0010000010 O
networks NNS 0011001101110 O
. . 0110 O

Lynn NNP X O
described VBD 101001110000 O
how WRB 1011111111111000 O
a DT 11001 O
foreign JJ 1111001011000 O
intelligence NN 00100010110 O
agency NN 0011111111010 O
planted VBD 1010011011010 O
malicious JJ 1111011111000 O
code NN 001001010 O
on IN 1001010 O
the DT 11010 O
networks NNS 0011001101110 O
with IN 100100 O
the DT 11010 O
aim NN 101000111110 O
of IN 1000 O
transferring VBG 111000111101 O
data NNS 001111001 O
to TO 101100 O
servers NNS 00111010 O
under IN 10010111111110 O
their PRP$ 11011100 O
control NN 111000100 O
. . 0110 O

The DT 010000 O
article NN 001010111110 O
included VBD 1011111001100 O
the DT 11010 O
now RB 1010111011110 O
oft-quoted JJ X O
phrase NN 001011111100 O
'digital JJ X O
beachhead NN 101010110101 O
' '' 0111101010 O
to TO 101100 O
describe VB 10101010100 O
what WP 1011111111111001 O
was VBD 101101011 O
undoubtedly RB X O
a DT 11001 O
significant JJ 1111000110111 O
compromise NN 1010101111010 O
of IN 1000 O
US NNP 1110110010 O
military JJ 11100101000 O
systems NNS 00110011000 O
. . 0110 O

Further JJ 0100011110 O
reports NNS 001111101010 O
in IN 100110 O
the DT 11010 O
press NN 10101011111011 O
kept VBD 1010010110100 O
the DT 11010 O
story NN 0010011111111 O
alive JJ X O
in IN 100110 O
2011 CD 011111100110 O
, , 1011100 O
but CC 10111111111000 O
since IN 1011111111111110 O
then RB 101011111110 O
this DT 110110 O
threat NN 1110000110 O
has VBZ 1011011010 O
received VBN 10100101101101 O
remarkably RB X O
little JJ 111100010101 O
attention NN 00100010111 O
. . 0110 O

However RB 010110 O
, , 1011100 O
the DT 11010 O
operation NN 0010101111111 O
behind IN 1001011111011 O
the DT 11010 O
attacks NNS 001101100 O
has VBZ 1011011010 O
continued VBN 101000111011 O
with IN 100100 O
little JJ 111100010101 O
modification NN 0001110011 O
to TO 101100 O
the DT 11010 O
tools NNS 0011001111011 O
and CC 101110111 O
techniques NNS 0011001111010 O
, , 1011100 O
in IN 100110 O
spite NN 000000 O
of IN 1000 O
the DT 11010 O
widespread JJ 111100001001 O
attention NN 00100010111 O
a DT 11001 O
few JJ 1111000111100 O
years NNS 0011010101 O
ago RB 100101110101 O
. . 0110 O

They PRP 01001000 B-Entity
use VBP 10101011100 O
highly RB 1111111111 O
sophisticated JJ 111100010011 O
malware NN 00101100 O
tools NNS 0011001111011 O
to TO 101100 O
maintain VB 10101000010 B-Verb
persistent JJ 111100010000 B-Entity
access NN 10100011010 I-Entity
to TO 101100 I-Entity
their PRP$ 11011100 I-Entity
targets NNS 00110010111 I-Entity
. . 0110 O

These DT 010011110 B-Entity
tools NNS 0011001111011 I-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
used VBN 1010011010 I-Verb
for IN 10011111 B-Preposition
covert JJ 111100001001 B-Entity
communications NNS 00111101001110 I-Entity
in IN 100110 B-Preposition
a DT 11001 B-Entity
number NN 00010100 I-Entity
of IN 1000 I-Entity
different JJ 1111000000 I-Entity
modes NNS X I-Entity
, , 1011100 O
some DT 11111011110 B-Entity
of IN 1000 I-Entity
which WDT 101111011 I-Entity
present JJ 101001011111111 B-Verb
significant JJ 1111000110111 B-Entity
challenges NNS 0011111011111 I-Entity
for IN 10011111 I-Entity
traditional JJ 1111001011000 I-Entity
security NN 11100011010 I-Entity
technologies NNS 0011001111100 I-Entity
to TO 101100 I-Entity
detect VB 101010011100 I-Entity
. . 0110 O

There EX 01001011 O
are VBP 101101001 O
some DT 11111011110 O
threats NNS 00110110101 O
which WDT 101111011 O
come VBP 10101110001 O
and CC 101110111 O
go VBP 101000111100 O
, , 1011100 O
whilst IN X O
there EX 10111100101 O
are VBP 101101001 O
others NNS 1110011000 O
which WDT 101111011 O
are VBP 101101001 O
permanent JJ 1111000111000 O
features NNS 0011111011010 O
of IN 1000 O
the DT 11010 O
landscape NN 0010101001 O
. . 0110 O

In IN 0101000 O
this DT 110110 O
paper NN 001010111101 O
, , 1011100 O
we PRP 101111000 O
describe VBP 10101010100 O
the DT 11010 O
tools NNS 0011001111011 O
and CC 101110111 O
techniques NNS 0011001111010 O
of IN 1000 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
most RBS 111111100 O
sophisticated JJ 111100010011 O
and CC 101110111 O
persistent JJ 111100010000 O
threats NNS 00110110101 O
we PRP 101111000 O
track VBP 10101000111 O
. . 0110 O

We PRP 01001001 O
hope VBP 10101010110 O
this DT 110110 O
will MD 10110111111 O
help VB 101010111111001 O
victims NNS 00110010110 O
identify VB 101010011101 O
intrusions NNS 001100011100 O
and CC 101110111 O
understand VB 101010011101 O
their PRP$ 11011100 O
need NN 101000111110 O
to TO 101100 O
improve VB 101010011101 O
defences NNS X O
. . 0110 O

Cyber NNP 0111101100100 O
security NN 11100011010 O
is VBZ 101101010 O
a DT 11001 O
collaborative JJ X O
effort NN 00100010111 O
– CD 01111001100 O
the DT 11010 O
operation NN 0010101111111 O
described VBN 101001110000 O
in IN 100110 O
this DT 110110 O
paper NN 001010111101 O
again RB 1010010111001 O
raises VBZ X O
the DT 11010 O
bar NN 00011111111 O
for IN 10011111 O
the DT 11010 O
security NN 11100011010 O
community NN 001100111000 O
in IN 100110 O
their PRP$ 11011100 O
efforts NNS 0011001111111 O
to TO 101100 O
keep VB 101010011001 O
up RP 10111111100111 O
with IN 100100 O
the DT 11010 O
attackers NNS 001011110 O
in IN 100110 O
cyber-space NN X O
. . 0110 O

When WRB 0101011101 O
antivirus JJ 11101110111 O
back-end JJ X O
classification NN 0001011111 O
platforms NNS 0011001101111 O
can MD 10110111110 O
not RB 1010111100 O
identify VB 101010011101 O
a DT 11001 O
malware NN 00101100 O
family NN 00001111 O
for IN 10011111 O
an DT 11000 O
analysed JJ 1010010110100 O
malicious JJ 1111011111000 O
sample NN 0010100000 O
, , 1011100 O
they PRP 10111100110 O
assign VBP 10101010100 O
generic JJ 11110001111111 O
names NNS 00111111011 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
'' '' 0111101110 O
Trojan NNP 001011010101 O
Horse NNP X O
'' '' 0111101110 O
or CC 101110110 O
'' '' 0111101110 O
Agent NNP 01110110010 O
'' '' 0111101110 O
. . 0110 O

The DT 010000 O
variant JJ 00101000010 O
letters NNS 001111010101 O
are VBP 101101001 O
also RB 10101111110 O
assigned VBN 10100010001 O
automatically RB 101011100110 O
, , 1011100 O
by IN 1001110 O
using VBG 100101111110 O
hexavigesimal JJ X O
( NN 01111000 O
or CC 101110110 O
Base26 FW X O
) FW 011110100 O
notation NN X O
. . 0110 O

That DT 0100011011 O
is VBZ 101101010 O
, , 1011100 O
the DT 11010 O
variant JJ 00101000010 O
letters NNS 001111010101 O
are VBP 101101001 O
auto-assigned JJ X O
starting VBG 10101110001 O
from IN 100101100 O
'' '' 0111101110 O
A NNP 010001110 O
'' '' 0111101110 O
, , 1011100 O
followed VBD 10100110010 O
with IN 100100 O
'' '' 0111101110 O
B NN 011111111000 O
'' '' 0111101110 O
, , 1011100 O
and CC 101110111 O
so RB 101111111110010 O
on IN 1001010 O
until IN 100101110000 O
'' '' 0111101110 O
Z NN 011111111000 O
'' '' 0111101110 O
. . 0110 O

Next NNP 010110 O
comes VBZ 101111100000 O
'' '' 0111101110 O
AA NNP X O
'' '' 0111101110 O
, , 1011100 O
'' '' 0111101110 O
AB NNP X O
'' '' 0111101110 O
and CC 101110111 O
so RB 101111111110010 O
on IN 1001010 O
, , 1011100 O
until IN 100101110000 O
'' '' 0111101110 O
ZZ NNP X O
'' '' 0111101110 O
. . 0110 O

After IN 01010101 O
that DT 101111110 O
, , 1011100 O
the DT 11010 O
variant JJ 00101000010 O
letters NNS 001111010101 O
start VBP 101010111111000 O
from IN 100101100 O
'' '' 0111101110 O
AAA NNP X O
'' '' 0111101110 O
, , 1011100 O
'' '' 0111101110 O
AAB NNP X O
'' '' 0111101110 O
and CC 101110111 O
so RB 101111111110010 O
on IN 1001010 O
, , 1011100 O
until IN 100101110000 O
'' '' 0111101110 O
ZZZ NNP X O
'' '' 0111101110 O
. . 0110 O

Back NNP 010101100 O
in IN 100110 O
2008 CD 011111100110 O
an DT 11000 O
unknown JJ 1010000000 O
malicious JJ 1111011111000 O
file NN 00100100 O
was VBD 101101011 O
discovered VBN 1010011111110 O
and CC 101110111 O
auto-classified JJ X O
as IN 10111111110 O
'' '' 0111101110 O
Agent.BTZ NN 01111110111 O
'' '' 0111101110 O
, , 1011100 O
meaning VBG 101111101101 O
it PRP 101111010 O
was VBD 101101011 O
registered VBN 1010011011001 O
as IN 10111111110 O
unknown JJ 1010000000 O
malicious JJ 1111011111000 O
sample NN 0010100000 O
# # 011101111111111 O
1,898 CD X O
in IN 100110 O
an DT 11000 O
anti-virus JJ 111101111110100 O
classification NN 0001011111 O
system NN 001000000 O
. . 0110 O

It PRP 01001010 O
was VBD 101101011 O
n't RB 1010111101 O
given VBN 101000001111 O
an DT 11000 O
actual JJ 111101111111100 O
name NN 00111111010 O
, , 1011100 O
only RB 10101110010 O
a DT 11001 O
generic JJ 11110001111111 O
one CD 111110100 O
. . 0110 O

Meanwhile RB 010110 O
, , 1011100 O
internally RB 101001011111100 O
the DT 11010 O
authors NNS 00001110 O
behind IN 1001011111011 O
this DT 110110 O
malware NN 00101100 O
were VBD 101101000 O
using VBG 100101111110 O
their PRP$ 11011100 O
own JJ 0010001001 O
naming NN 00001110 O
systems NNS 00110011000 O
- : 01111001101 O
with IN 100100 O
specific JJ 111100001110 O
titles NNS 0011010110 O
for IN 10011111 O
their PRP$ 11011100 O
file NN 00100100 O
components NNS 001111101000 O
and CC 101110111 O
projects NNS 0011001101011 O
such JJ 101111111010 O
as IN 10111111110 O
'' '' 0111101110 O
snake NN 111010 O
'' '' 0111101110 O
, , 1011100 O
'' '' 0111101110 O
uroburos NNS X O
'' '' 0111101110 O
, , 1011100 O
'' '' 0111101110 O
sengoku NN X O
'' '' 0111101110 O
, , 1011100 O
and CC 101110111 O
'' '' 0111101110 O
snark NN X O
'' '' 0111101110 O
used VBN 1010011010 O
to TO 101100 O
denote VB 10101000101 O
variants NNS 00110100111 O
of IN 1000 O
their PRP$ 11011100 O
framework NN 001010001111 O
. . 0110 O

A DT 010001110 O
recent JJ 111100001001 O
report NN 001010111100 O
from IN 100101100 O
German JJ 111100101011 O
security NN 11100011010 O
company NN 0011000010 O
GData NN X O
described VBD 101001110000 O
a DT 11001 O
sample NN 0010100000 O
from IN 100101100 O
the DT 11010 O
'' '' 0111101110 O
uroburos NN X O
'' '' 0111101110 O
variant NN 00101000010 O
of IN 1000 O
this DT 110110 O
framework NN 001010001111 O
. . 0110 O

Their PRP$ 0100011011 O
report NN 001010111100 O
revealed VBD 101001111000 O
the DT 11010 O
complex JJ 111100010011 O
nature NN 0001111011 O
of IN 1000 O
this DT 110110 O
malware NN 00101100 O
family NN 00001111 O
, , 1011100 O
and CC 101110111 O
showed VBD 101001111000 O
that IN 101111110 O
the DT 11010 O
operation NN 0010101111111 O
behind IN 1001011111011 O
'' '' 0111101110 O
Agent.BTZ NN 01111110111 O
'' '' 0111101110 O
has VBZ 1011011010 O
continued VBN 101000111011 O
. . 0110 O

As IN 01010100 O
a DT 11001 O
result NN 000101100 O
of IN 1000 O
this DT 110110 O
disclosure NN 000111100 O
, , 1011100 O
we PRP 101111000 O
are VBP 101101001 O
also RB 10101111110 O
releasing VBG 11100110111 O
our PRP$ 11011110 O
own JJ 0010001001 O
technical JJ 111100100111 O
analysis NN 0001110110 O
of IN 1000 O
the DT 11010 O
threat NN 1110000110 O
, , 1011100 O
including VBG 101111111110111 O
a DT 11001 O
timeline NN 000101100 O
of IN 1000 O
known JJ 1010000110 O
samples NNS 0011011100 O
, , 1011100 O
known VBN 1010000110 O
Command-and-Control NNP X O
( NNP 01111000 O
C NNP 011100111 O
& CC 01110010 O
C NNP 011100111 O
) NNP 011110100 O
servers NNS 00111010 O
, , 1011100 O
and CC 101110111 O
other JJ 111110010 O
indicators NNS 001111101001 O
to TO 101100 O
aid VB 101010111111001 O
investigators NNS 0011110100100 O
in IN 100110 O
discovering VBG X O
attacks NNS 001101100 O
. . 0110 O

Reverse JJ X O
engineering NN 11100000001 O
of IN 1000 O
recent JJ 111100001001 O
malware NN 00101100 O
samples NNS 0011011100 O
shows VBZ 1011111011110 O
these DT 11111000 O
to TO 101100 O
be VB 10101100 O
much RB 111100010100 O
more RBR 1111111110 O
advanced JJ 111100010010 O
variants NNS 00110100111 O
of IN 1000 O
Agent.BTZ NN 01111110111 O
, , 1011100 O
though IN 1011111111100110 O
still RB 10101111111111 O
sharing VBG 111000111000 O
many JJ 111110011111 O
similarities NNS 0011110100100 O
and CC 101110111 O
encryption NN 1111011100111 O
methods NNS 0011001111000 O
with IN 100100 O
the DT 11010 O
original NN 11110101111 O
. . 0110 O

Further JJ 0100011110 O
investigation NN 00100010100 O
allowed VBD 1011111001110 O
us PRP 10111111100110 O
to TO 101100 O
locate VB 101010011101 O
related JJ 10100001110 O
samples NNS 0011011100 O
compiled VBN 1010011011010 O
between IN 10010110100 O
2006 CD 01111110010 O
and CC 101110111 O
2014 CD 0111111000 O
, , 1011100 O
and CC 101110111 O
spanning NN 101111111110101 O
across IN 10010111111101 O
several JJ 111110011110 O
distinctive JJ 111100001100 O
generations NNS 0011010000 O
. . 0110 O

The DT 010000 O
first JJ 1111010100 O
section NN 0011111111110 O
of IN 1000 O
this DT 110110 O
report NN 001010111100 O
gives VBZ 1011111001110 O
an DT 11000 O
overview NN 000010 O
of IN 1000 O
the DT 11010 O
samples NNS 0011011100 O
collected VBN 1010010110101 O
, , 1011100 O
where WRB 101111111110100 O
they PRP 10111100110 O
were VBD 101101000 O
reported VBN 101001111001 O
and CC 101110111 O
the DT 11010 O
timelines NNS X O
derived VBN 10101110001 O
from IN 100101100 O
their PRP$ 11011100 O
analysis NN 0001110110 O
. . 0110 O

Snake NNP 1110111110011 O
's POS 10111010 O
architecture NN 0010101111110 O
turned VBD 1010010111010 O
out RP 1011111110010 O
to TO 101100 O
be VB 10101100 O
quite RB 1111111101 O
interesting JJ 10100000101 O
. . 0110 O

We PRP 01001001 O
have VBP 101101100 O
identified VBN 1010011111111 O
two CD 11111001100 B-Entity
distinct JJ 111100000110 I-Entity
variants NNS 00110100111 I-Entity
, , 1011100 O
both DT 11111011010 O
highly RB 1111111111 O
flexible JJ 111100010011 O
but CC 10111111111000 O
with IN 100100 O
two CD 11111001100 O
different JJ 1111000000 O
techniques NNS 0011001111010 O
for IN 10011111 O
establishing VBG 101111111111011 B-Verb
and CC 101110111 I-Verb
maintaining VBG 10111111111100 I-Verb
a DT 11001 B-Entity
presence NN 0001111010 I-Entity
on IN 1001010 B-Preposition
the DT 11010 B-Entity
target NN 111101111010 I-Entity
system NN 001000000 I-Entity
. . 0110 O

In IN 0101000 O
general JJ 000000 O
, , 1011100 O
its PRP$ 11011101 O
operation NN 0010101111111 O
relies VBZ 10100101011 O
on IN 1001010 O
kernel NN 11100000111 O
mode NN 0011110111111 O
drivers NNS 0011001111111 O
, , 1011100 O
making VBG 10111111111100 O
it PRP 101111010 O
a DT 11001 O
rootkit NN 001011010110 O
. . 0110 O

It PRP 01001010 B-Entity
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
covertly RB X B-Verb
install VB 10101001000 I-Verb
a DT 11001 B-Entity
backdoor NN 00101101000 I-Entity
on IN 1001010 B-Preposition
a DT 11001 B-Entity
compromised VBN 111101111001 I-Entity
system NN 001000000 I-Entity
, , 1011100 O
hide VBP 101010011111 B-Verb
the DT 11010 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
its PRP$ 11011101 I-Entity
components NNS 001111101000 I-Entity
, , 1011100 O
provide VBP 10101000011 B-Verb
a DT 11001 B-Entity
communication NN 001111010000 I-Entity
mechanism NN 00101001101 I-Entity
with IN 100100 I-Entity
its PRP$ 11011101 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
servers NNS 00111010 I-Entity
, , 1011100 O
and CC 101110111 O
enable VB 10101000010 B-Verb
an DT 11000 B-Entity
effective JJ 10100000011 I-Entity
data NN 001111001 I-Entity
exfiltration NN 1110001101111 I-Entity
mechanism NN 00101001101 I-Entity
. . 0110 O

At IN 0101011111 O
the DT 11010 O
same JJ 111101001 O
time NN 00011010 O
, , 1011100 O
Snake NNP 1110111110011 O
exposed VBD 10100010010 O
a DT 11001 O
flexibility NN 001111100010 O
to TO 101100 O
conduct VB 101010011001 O
its PRP$ 11011101 O
operations NNS 001100011100 O
by IN 1001110 O
engaging VBG 1010010110000 O
these DT 11111000 O
noticeably RB X O
different JJ 1111000000 O
architectures NNS 0011010010 O
. . 0110 O

In IN 0101000 O
the DT 11010 O
first JJ 1111010100 O
model NN 001111100000 O
, , 1011100 O
the DT 11010 B-Entity
network NN 001000010 I-Entity
communications NNS 00111101001110 I-Entity
are VBP 101101001 B-Verb
carried VBN 1010010111010 I-Verb
out RP 1011111110010 I-Verb
from IN 100101100 B-Preposition
the DT 11010 B-Entity
userland NN 111101111111111 I-Entity
- : 01111001101 O
i.e NN 01110111001 O
. . 0110 O

the DT 11010 O
area NN 0011110111100 O
of IN 1000 O
the DT 11010 O
computer NN 0010000010 O
system NN 001000000 O
where WRB 101111111110100 O
application NN 0010011111011 O
software NN 001100111011 O
executes VBZ 101111101001 O
. . 0110 O

In IN 0101000 O
another DT 11111011100 O
model NN 001111100000 O
, , 1011100 O
the DT 11010 B-Entity
network NN 001000010 I-Entity
communications NNS 00111101001110 I-Entity
are VBP 101101001 B-Verb
handled VBN 101001100010 I-Verb
by IN 1001110 O
a DT 11001 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
driver NN 00101101111 I-Entity
- : 01111001101 O
i.e NN 01110111001 O
. . 0110 O

the DT 11010 O
area NN 0011110111100 O
where WRB 101111111110100 O
lower JJR 111100010110 O
level NN 000110010 O
system NN 001000000 O
code NN 001001010 O
such JJ 101111111010 O
as IN 10111111110 O
device NN 1111011101111 O
drivers NNS 0011001111111 O
run VBP 101010111111100 O
. . 0110 O

The DT 010000 B-Entity
choice NN 00011111110 I-Entity
of IN 1000 I-Entity
what WDT 1011111111111001 I-Entity
architecture NN 0010101111110 I-Entity
should MD 1011011110111 I-Entity
be VB 10101100 I-Entity
used VBN 1010011010 I-Entity
may MD 101101111010 O
depend VB 10100101011 B-Verb
on IN 1001010 I-Verb
a DT 11001 B-Entity
specific JJ 111100001110 I-Entity
target NN 111101111010 I-Entity
's POS 10111010 I-Entity
environment NN 001100011111 I-Entity
, , 1011100 O
allowing VBG 101111111110101 O
the DT 11010 O
Snake NNP 1110111110011 O
operators NNS 00111101001111 O
to TO 101100 O
choose VB 101000111101 O
the DT 11010 O
most RBS 111111100 O
suitable JJ X O
architecture NN 0010101111110 O
to TO 101100 O
be VB 10101100 O
deployed VBN 101001011111110 O
. . 0110 O

In IN 0101000 O
both DT 11111011010 O
architectures NNS 0011010010 O
there EX 10111100101 O
is VBZ 101101010 O
a DT 11001 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
driver NN 00101101111 I-Entity
installed VBN 101001011111101 B-Verb
and CC 101110111 O
a DT 11001 B-Entity
usermode JJ 00101101001 I-Entity
DLL NN 00101101110 I-Entity
injected VBN 10100100010 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
system NN 001000000 I-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

In IN 0101000 O
both DT 11111011010 O
architectures NNS 0011010010 O
, , 1011100 O
there EX 10111100101 O
is VBZ 101101010 O
both CC 11111011010 O
32-bit JJ 1111011101110 O
and CC 101110111 O
64-bit JJ 1111011101110 O
code NN 001001010 O
involved VBN 101001110110 O
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
distinguish VB 101010011001 O
between IN 10010110100 O
these DT 11111000 O
architectures NNS 0011010010 O
, , 1011100 O
we PRP 101111000 O
will MD 10110111111 O
call VB 10101010101 O
them PRP 1011111110000 O
the DT 11010 O
usermode-centric JJ 1110110000 O
and CC 101110111 O
the DT 11010 O
kernel-centric JJ 111000111001 O
architectures NNS 0011010010 O
respectively RB 01110111001 O
. . 0110 O

The DT 010000 O
remainder NN 0001111011 O
of IN 1000 O
this DT 110110 O
report NN 001010111100 O
gives VBZ 1011111001110 O
a DT 11001 O
detailed JJ 1111000110100 O
explanation NN 00100101110 O
of IN 1000 O
how WRB 1011111111111000 O
the DT 11010 O
two CD 11111001100 O
Snake NNP 1110111110011 O
architectures NNS 0011010010 O
embed VBD 1010101110101 O
themselves PRP 10111111100011 O
in IN 100110 O
the DT 11010 O
target NN 111101111010 O
system NN 001000000 O
and CC 101110111 O
communicate VBP 10100100111 O
with IN 100100 O
the DT 11010 O
outside JJ 00010011 O
world NN 0010111011 O
. . 0110 O

We PRP 01001001 O
have VBP 101101100 O
also RB 10101111110 O
provided VBN 101001100001 O
a DT 11001 O
set NN 000101110 O
of IN 1000 O
technical JJ 111100100111 O
indicators NNS 001111101001 O
in IN 100110 O
the DT 11010 O
Appendix NN 01111101110 O
to TO 101100 O
enable VB 10101000010 O
organisations NNS 001100100011 O
and CC 101110111 O
the DT 11010 O
security NN 11100011010 O
research NN 00100010101 O
community NN 001100111000 O
to TO 101100 O
identify VB 101010011101 O
compromises NNS 101111100010 O
. . 0110 O

In IN 0101000 O
total NN 000000 O
we PRP 101111000 O
have VBP 101101100 O
collected VBN 1010010110101 O
over IN 10010110101 O
100 CD 011111111100 O
unique JJ 1111011101010 O
files NNS 0011011110 O
related VBN 10100001110 O
to TO 101100 O
this DT 110110 O
espionage NN 111000110000 O
toolkit NN 001010001111 O
. . 0110 O

Many JJ 010011100 O
of IN 1000 O
these DT 11111000 O
were VBD 101101000 O
submitted VBN 1010011011100 O
to TO 101100 O
online JJ 11100001010 O
malware NN 00101100 O
analysis NN 0001110110 O
websites NNS 0011001101100 O
by IN 1001110 O
victims NNS 00110010110 O
and CC 101110111 O
investigators NNS 0011110100100 O
over IN 10010110101 O
several JJ 111110011110 O
years NNS 0011010101 O
. . 0110 O

In IN 0101000 O
many JJ 111110011111 O
cases NNS 0011010010 O
the DT 11010 O
source NN 00100110111 O
country NN 001011111101 O
information NN 001111000 O
of IN 1000 O
the DT 11010 O
submission NN 111000110010 O
is VBZ 101101010 O
available JJ 1010011011110 O
. . 0110 O

These DT 010011110 O
allow VBP 10101000000 O
us PRP 10111111100110 O
to TO 101100 O
visualise VB X O
the DT 11010 O
distribution NN 0001110000 O
of IN 1000 O
countries NNS 00110101110 O
where WRB 101111111110100 O
this DT 110110 O
malware NN 00101100 O
has VBZ 1011011010 O
been VBN 10101101 O
seen VBN 101001110010 O
: : 0111010 O
Whilst IN X O
this DT 110110 O
view NN 0001011111 O
is VBZ 101101010 O
likely JJ 101011101100 O
to TO 101100 O
only RB 10101110010 O
be VB 10101100 O
the DT 11010 O
tip NN X O
of IN 1000 O
the DT 11010 O
iceberg NN X O
, , 1011100 O
it PRP 101111010 O
does VBZ 1011011100 O
give VB 10101000011 O
us PRP 10111111100110 O
an DT 11000 O
initial JJ 111101111111101 O
insight NN 00100010111 O
into IN 10010111100 O
the DT 11010 O
profile NN 0010001000 O
of IN 1000 O
targets NNS 00110010111 O
for IN 10011111 O
the DT 11010 O
Snake NNP 1110111110011 O
operations NNS 001100011100 O
. . 0110 O

Other JJ 0100111111 O
useful JJ 10100001011 O
visualisations NNS X O
of IN 1000 O
the DT 11010 O
operations NNS 001100011100 O
come VBP 10101110001 O
from IN 100101100 O
the DT 11010 O
compile VBP 11110011110 O
timestamps NNS 000110110 O
. . 0110 O

Below NNP 01001011 O
is VBZ 101101010 O
shown VBN 101001110001 O
a DT 11001 O
table NN 000101101 O
with IN 100100 O
a DT 11001 O
count NN 0011110111100 O
of IN 1000 O
the DT 11010 O
number NN 00010100 O
of IN 1000 O
files NNS 0011011110 O
in IN 100110 O
our PRP$ 11011110 O
sample NN 0010100000 O
set VBN 000101110 O
from IN 100101100 O
recent JJ 111100001001 O
years NNS 0011010101 O
. . 0110 O

Two CD 0100111110 O
samples NNS 0011011100 O
compiled VBN 1010011011010 O
in IN 100110 O
late JJ 01111101011 O
January NNP 01111101001 O
2014 CD 0111111000 O
show VBP 1010101110100 O
that IN 101111110 O
this DT 110110 O
activity NN 00110001011 O
is VBZ 101101010 O
ongoing JJ 111100100101 O
. . 0110 O

Plotting VBG X O
the DT 11010 O
day NN 001010110100 O
of IN 1000 O
the DT 11010 O
week NN 001010110100 O
in IN 100110 O
which WDT 101111011 O
the DT 11010 O
samples NNS 0011011100 O
were VBD 101101000 O
compiled VBN 1010011011010 O
shows VBZ 1011111011110 O
a DT 11001 O
now RB 1010111011110 O
familiar JJ 10100100100 O
pattern NN 001111100000 O
for IN 10011111 O
analysts NNS 001100111000 O
of IN 1000 O
modern JJ 111100001011 O
cyber-attacks NNS 00100011101 O
. . 0110 O

The DT 010000 O
creators NNS 0001111010 O
of IN 1000 O
the DT 11010 O
malware NN 00101100 O
operate VBP 101010111111010 O
a DT 11001 O
working VBG 10100101111100 O
week NN 001010110100 O
, , 1011100 O
just RB 1010111010101 O
like IN 101111111110110 O
any DT 11111011111 O
other JJ 111110010 O
professional NN 111100011000 O
. . 0110 O

The DT 010000 O
single JJ 111100011000 O
sample NN 0010100000 O
in IN 100110 O
our PRP$ 11011110 O
set NN 000101110 O
which WDT 101111011 O
was VBD 101101011 O
compiled VBN 1010011011010 O
on IN 1001010 O
a DT 11001 O
Saturday NNP 00101001110 O
is VBZ 101101010 O
an DT 11000 O
outlier NN X O
, , 1011100 O
but CC 10111111111000 O
does VBZ 1011011100 O
n't RB 1010111101 O
alter VB 1010101110101 O
the DT 11010 O
conclusion NN 001011010100 O
. . 0110 O

Similarly RB 010110 O
, , 1011100 O
plotting VBG X O
the DT 11010 O
hour NN 11100101111 O
of IN 1000 O
the DT 11010 O
day NN 001010110100 O
in IN 100110 O
which WDT 101111011 O
the DT 11010 O
samples NNS 0011011100 O
were VBD 101101000 O
compiled VBN 1010011011010 O
reveals VBZ 101111101101 O
another DT 11111011100 O
human JJ 11110111111000 O
pattern NN 001111100000 O
– NN 01111001100 O
the DT 11010 O
working VBG 10100101111100 O
day NN 001010110100 O
. . 0110 O

This DT 0100010 O
has VBZ 1011011010 O
been VBN 10101101 O
adjusted VBN X O
to TO 101100 O
UTC+4 NN X O
to TO 101100 O
show VB 1010101110100 O
a DT 11001 O
possible JJ 10100000110 O
fit NN 10101000001 O
to TO 101100 O
the DT 11010 O
operators NNS 00111101001111 O
' POS 0111101010 O
local JJ 111101111111110 O
time NN 00011010 O
. . 0110 O

The DT 010000 O
usermode-centric JJ 1110110000 O
architecture NN 0010101111110 O
of IN 1000 O
Snake NNP 1110111110011 O
is VBZ 101101010 O
known VBN 1010000110 O
to TO 101100 O
have VB 101101100 O
been VBN 10101101 O
used VBN 1010011010 O
from IN 100101100 O
2011 CD 011111100110 O
till IN 100101110000 O
2014 CD 0111111000 O
, , 1011100 O
with IN 100100 O
the DT 11010 O
most RBS 111111100 O
recent JJ 111100001001 O
sample NN 0010100000 O
compiled VBN 1010011011010 O
on IN 1001010 O
January NNP 01111101001 O
28 CD 0111111111101 O
, , 1011100 O
2014 CD 0111111000 O
. . 0110 O

With IN 0101011111 O
this DT 110110 O
architecture NN 0010101111110 O
, , 1011100 O
the DT 11010 B-Entity
Snake NNP 1110111110011 I-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 O
mainly RB 1010111011010 O
used VBN 1010011010 O
to TO 101100 O
load VB 10101001000 B-Verb
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
usermode NN 00101101001 I-Entity
processes NNS 0011001111110 I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
use VB 10101011100 B-Verb
that DT 101111110 B-Entity
module NN 00101101100 I-Entity
for IN 10011111 B-Preposition
the DT 11010 B-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

One CD 010011101 O
of IN 1000 O
the DT 11010 O
analysed VBN 1010010110100 O
samples NNS 0011011100 O
exposed VBD 10100010010 O
multiple JJ 111110011101 O
debug NN 11110111110111 O
messages NNS 00110111111 O
and CC 101110111 O
source NN 00100110111 O
control NN 111000100 O
check-in NN 11110110010 O
logs NNS 0011111110110 O
. . 0110 O

It PRP 01001010 O
is VBZ 101101010 O
not RB 1010111100 O
clear JJ 101000001110 O
why WRB 1011111111111011 O
those DT 111101111110111 O
messages NNS 00110111111 O
were VBD 101101000 O
allowed VBN 1011111001110 O
in IN 100110 O
the DT 11010 O
deployed VBN 101001011111110 O
driver NN 00101101111 O
- : 01111001101 O
possibly RB 1010111010111 O
an DT 11000 O
operational JJ 111100100110 O
security NN 11100011010 O
lapse NN X O
. . 0110 O

However RB 010110 O
, , 1011100 O
they PRP 10111100110 O
give VBP 10101000011 O
some DT 11111011110 O
insight NN 00100010111 O
into IN 10010111100 O
the DT 11010 O
internal JJ 111101111111010 O
structure NN 001111100010 O
of IN 1000 O
the DT 11010 O
source NN 00100110111 O
code NN 001001010 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
the DT 11010 O
analysed JJ 1010010110100 O
driver NN 00101101111 O
gave VBD 1011111011100 O
away RB 00110001000 O
the DT 11010 O
following VBG 111101000 O
source NN 00100110111 O
file NN 00100100 O
names NNS 00111111011 O
: : 0111010 O
The DT 010000 O
source NN 00100110111 O
control NN 111000100 O
check-in NN 11110110010 O
log NN 00100110011 O
examples NNS 00110100110 O
, , 1011100 O
showing VBG 100101110000 O
the DT 11010 O
names NNS 00111111011 O
of IN 1000 O
the DT 11010 O
developers NNS 0001110000 O
to TO 101100 O
be VB 10101100 O
'vlad NN X O
' '' 0111101010 O
and CC 101110111 O
'gilg NN X O
' '' 0111101010 O
: : 0111010 O
It PRP 01001010 O
also RB 10101111110 O
exposed VBD 10100010010 O
the DT 11010 O
project NN 001010110010 O
name NN 00111111010 O
of IN 1000 O
this DT 110110 O
particular JJ 111100000111 O
variant NN 00101000010 O
as IN 10111111110 O
'sengoku NN X O
' '' 0111101010 O
: : 0111010 O
Now RB 010101100 O
it PRP 101111010 O
's VBZ 10111010 O
time NN 00011010 O
to TO 101100 O
execute VB 10101001011 O
the DT 11010 O
driver NN 00101101111 O
and CC 101110111 O
see VB 1010101000 O
what WP 1011111111111001 O
it PRP 101111010 O
does VBZ 1011011100 O
. . 0110 O

When WRB 0101011101 O
first RB 1111010100 O
executed VBN 1010010111100 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
creates VBZ 1011111010110 B-Verb
device NN 1111011101111 B-Entity
named VBN 10100101001 I-Entity
\Device\vstor32 NN X I-Entity
with IN 100100 B-Preposition
a DT 11001 B-Entity
symbolic JJ X I-Entity
link NN 101000110000 I-Entity
\DosDevices\vstor32 NN X I-Entity
. . 0110 O

This DT 0100010 B-Entity
device NN 1111011101111 I-Entity
is VBZ 101101010 B-Verb
used VBN 1010011010 I-Verb
for IN 10011111 B-Preposition
userland/kernel NN X B-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

Next NNP 010110 O
, , 1011100 O
it PRP 101111010 B-Entity
drops VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
DLL NNP 00101101110 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
% NN 011100000 I-Entity
windows NNS 111000110011 I-Entity
% NN 011100000 I-Entity
directory NN 0011111111101 I-Entity
- : 01111001101 O
the DT 11010 O
DLL NNP 00101101110 O
is VBZ 101101010 O
carried VBN 1010010111010 O
in IN 100110 O
the DT 11010 O
body NN 00011111000 O
of IN 1000 O
the DT 11010 O
driver NN 00101101111 O
as IN 10111111110 O
a DT 11001 O
binary JJ 001011010100 O
chunk NN 001111100010 O
with IN 100100 O
XOR NN 1111011100101 B-Entity
0xAA NN X I-Entity
applied VBD 10100001001 B-Verb
on IN 1001010 B-Preposition
top NN 1111111010 I-Preposition
of IN 1000 I-Preposition
it PRP 101111010 B-Entity
, , 1011100 O
so IN 101111111110010 O
the DT 11010 O
driver NN 00101101111 O
decrypts VBZ 101111101000 O
it PRP 101111010 O
first RB 1111010100 O
. . 0110 O

Depending VBG 01001101 O
on IN 1001010 O
the DT 11010 O
variant NN 00101000010 O
, , 1011100 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
is VBZ 101101010 B-Verb
dropped VBN 101001011111100 I-Verb
either CC 1010111011100 O
under IN 10010111111110 B-Preposition
a DT 11001 B-Entity
random JJ 1111000111101 I-Entity
name NN 00111111010 I-Entity
or CC 101110110 I-Entity
a DT 11001 I-Entity
hard-coded JJ 1111011101011 I-Entity
name NN 00111111010 I-Entity
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
mscpx32n.dll NN X O
. . 0110 O

The DT 010000 O
purpose NN 00011111011 O
of IN 1000 O
this DT 110110 B-Entity
DLL NNP 00101101110 I-Entity
is VBZ 101101010 O
to TO 101100 O
be VB 10101100 B-Verb
injected VBN 10100100010 I-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
user-mode JJ 0010111000 I-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

Some DT 010011100 O
variants NNS 00110100111 O
of IN 1000 O
Snake NNP 1110111110011 O
carry VBP 10101000101 O
the DT 11010 O
DLL NNP 00101101110 B-Entity
modules NNS 001101110111 I-Entity
that WDT 101111110 O
can MD 10110111110 O
be VB 10101100 B-Verb
installed VBN 101001011111101 I-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
, , 1011100 O
to TO 101100 O
be VB 10101100 B-Verb
run VBN 101010111111100 I-Verb
within IN 100101111100 B-Preposition
taskhost.exe NN X B-Entity
or CC 101110110 I-Entity
services.exe NN 111101111111111 I-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

Next NNP 010110 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
sets VBZ 1011111001010 B-Verb
up RP 10111111100111 I-Verb
the DT 11010 B-Entity
hooks NNS 001111011011 I-Entity
for IN 10011111 B-Preposition
the DT 11010 B-Entity
following JJ 111101000 I-Entity
kernel-mode JJ 1111011101111 I-Entity
APIs NNS 0111101101101 I-Entity
: : 0111010 O
After IN 01010101 O
that DT 101111110 O
, , 1011100 O
it PRP 101111010 B-Entity
calls VBZ 101111100011 B-Verb
PsSetCreateProcessNotifyRoutine FW X B-Entity
( FW 01111000 I-Entity
) NN 011110100 I-Entity
in IN 100110 O
order NN 0000011 O
to TO 101100 O
be VB 10101100 B-Verb
notified VBN 101001100000 I-Verb
whenever WRB 1011111111111010 B-Preposition
a DT 11001 B-Entity
new JJ 11110000010 I-Entity
process NN 001001111011 I-Entity
is VBZ 101101010 I-Entity
started VBN 10100101110111 I-Entity
. . 0110 O

The DT 010000 O
handlers NNS 0011111011111 O
of IN 1000 O
the DT 11010 O
hooks NNS 001111011011 O
above IN 011110101101 O
along IN 10100100110 O
with IN 100100 O
the DT 11010 O
notification NN 00101001100 O
callback NN 11110111110011 O
allow VBP 10101000000 O
Snake NNP 1110111110011 B-Entity
to TO 101100 O
stay VB 101010110101 B-Verb
persistent JJ 111100010000 B-Entity
on IN 1001010 I-Entity
a DT 11001 I-Entity
system NN 001000000 I-Entity
, , 1011100 O
being VBG 101011111000 O
able JJ 10100010110 O
to TO 101100 O
infect VB 101010011001 B-Verb
any DT 11111011111 B-Entity
newly RB 11110111110011 I-Entity
created VBN 1010011011000 I-Entity
processes NNS 0011001111110 I-Entity
, , 1011100 O
and CC 101110111 O
restore VB 101010011001 B-Verb
its PRP$ 11011101 B-Entity
driver NN 00101101111 I-Entity
file NN 00100100 I-Entity
in IN 100110 B-Preposition
case NN 00001100 I-Preposition
it PRP 101111010 B-Entity
gets VBZ 1011111001010 I-Entity
deleted VBN 10100101111010 I-Entity
. . 0110 O

Another DT 0100011111 B-Entity
set NN 000101110 I-Entity
of IN 1000 I-Entity
hooks NNS 001111011011 I-Entity
it PRP 101111010 B-Entity
sets VBZ 1011111001010 B-Verb
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
hide VB 101010011111 B-Verb
the DT 11010 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
Snake NNP 1110111110011 I-Entity
components NNS 001111101000 I-Entity
on IN 1001010 I-Entity
the DT 11010 I-Entity
system NN 001000000 I-Entity
: : 0111010 O
The DT 010000 B-Entity
driver NN 00101101111 I-Entity
then RB 101011111110 O
watches VBZ X B-Verb
for IN 10011111 B-Preposition
all DT 1111101100 B-Entity
userland JJ 111101111111111 I-Entity
processes NNS 0011001111110 I-Entity
to TO 101100 B-Preposition
see VB 1010101000 B-Entity
if IN 101111111111110 I-Entity
they PRP 10111100110 I-Entity
load VBP 10101001000 I-Entity
any DT 11111011111 I-Entity
web NN 1111011011101 I-Entity
pages NNS 0011111111000 I-Entity
. . 0110 O

As RB 01010100 B-Preposition
long RB 11100110110 I-Preposition
as IN 10111111110 I-Preposition
the DT 11010 B-Entity
user NN 0010000110 I-Entity
is VBZ 101101010 I-Entity
not RB 1010111100 I-Entity
using VBG 100101111110 I-Entity
the DT 11010 I-Entity
Internet NNP 0010111010 I-Entity
, , 1011100 O
Snake NNP 1110111110011 B-Entity
stays VBZ X B-Verb
dormant JJ 1111000111011 B-Entity
too RB 10100000011 O
, , 1011100 O
as IN 10111111110 O
there EX 10111100101 O
is VBZ 101101010 O
no DT 11111011101 O
process NN 001001111011 O
that WDT 101111110 O
communicates VBZ 101111100001 O
with IN 100100 O
the DT 11010 O
web NN 1111011011101 O
servers NNS 00111010 O
. . 0110 O

However RB 010110 O
, , 1011100 O
as RB 10111111110 B-Preposition
soon RB 101111111011 I-Preposition
as IN 10111111110 I-Preposition
the DT 11010 B-Entity
user NN 0010000110 I-Entity
goes VBZ 10100101111100 I-Entity
online NN 11100001010 I-Entity
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
intercepts VBZ 101111101010 B-Verb
that IN 101111110 B-Entity
event NN 0010101111110 I-Entity
and CC 101110111 O
then RB 101011111110 O
immediately RB 101011100110 O
injects VBZ 101111100010 B-Verb
the DT 11010 B-Entity
malicious JJ 1111011111000 I-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
process NN 001001111011 I-Entity
that WDT 101111110 I-Entity
initiated VBD 1010011000111 I-Entity
connection NN 001111010001 I-Entity
( CD 01111000 O
the DT 11010 O
browser NN 00100011010 O
) NN 011110100 O
. . 0110 O

Once RB 0101011101 O
injected VBN 10100100010 O
, , 1011100 O
the DT 11010 B-Entity
module NN 00101101100 I-Entity
initiates VBZ 101111101000 B-Verb
polling NN X B-Entity
from IN 100101100 B-Preposition
one CD 111110100 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
hard-coded JJ 1111011101011 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
servers NNS 00111010 I-Entity
. . 0110 O

The DT 010000 O
purpose NN 00011111011 O
of IN 1000 O
this DT 110110 B-Entity
behaviour NN 111000110010 I-Entity
is VBZ 101101010 O
to TO 101100 O
blend VB 101010011001 B-Verb
Snake NNP 1110111110011 B-Entity
's POS 10111010 I-Entity
traffic NN 0011110100110 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
browser NN 00100011010 I-Entity
traffic NN 0011110100110 I-Entity
, , 1011100 O
bypassing VBG 101111111110101 B-Verb
the DT 11010 B-Entity
firewalls NNS 1110011000 I-Entity
, , 1011100 O
and CC 101110111 O
keeping VBG 101111111111011 B-Verb
a DT 11001 B-Entity
low JJ 111100010111 I-Entity
profile NN 0010001000 I-Entity
at IN 10011110 O
the DT 11010 O
same JJ 111101001 O
time NN 00011010 O
. . 0110 O

By IN 010001100 O
communicating VBG 10100100111 O
from IN 100101100 O
within IN 100101111100 O
a DT 11001 O
process NN 001001111011 O
that WDT 101111110 O
also RB 10101111110 O
communicates VBZ 101111100001 O
, , 1011100 O
even RB 101011101000 O
a DT 11001 O
technically RB 1111111111 O
savvy JJ X O
user NN 0010000110 O
will MD 10110111111 O
find VB 10101000101 O
it PRP 101111010 O
challenging JJ 10100001011 O
to TO 101100 O
detect VB 101010011100 O
Snake NNP 1110111110011 O
traffic NN 0011110100110 O
among IN 101111111110101 O
legitimate JJ 11110111110010 O
traffic NN 0011110100110 O
. . 0110 O

The DT 010000 O
reason NN 00101001000 O
behind IN 1001011111011 O
such JJ 101111111010 O
difficulty NN X O
is VBZ 101101010 O
because IN 1011111111111111 O
modern JJ 111100001011 O
web NN 1111011011101 O
pages NNS 0011111111000 O
often RB 10101111111100 O
fetch VBP 10101001011 O
pages NNS 0011111111000 O
from IN 100101100 O
the DT 11010 O
different JJ 1111000000 O
web NN 1111011011101 O
servers NNS 00111010 O
, , 1011100 O
including VBG 101111111110111 O
such JJ 101111111010 O
data NNS 001111001 O
as IN 10111111110 O
additional JJ 111101111110110 O
scripts NNS 0011110101110 O
, , 1011100 O
CSS NN X O
templates NNS X O
, , 1011100 O
advertising NN 1111011011110 O
contents NNS 0001111010 O
, , 1011100 O
analytics NNS X O
data NNS 001111001 O
, , 1011100 O
blogs NNS X O
, , 1011100 O
social JJ 11110011100 O
networking NN 11100000001 O
data NNS 001111001 O
, , 1011100 O
etc FW 01110111001 O
. . 0110 O

When WRB 0101011101 O
intercepted VBN 10100101111010 O
with IN 100100 O
the DT 11010 O
purpose NN 00011111011 O
of IN 1000 O
analysis NN 0001110110 O
, , 1011100 O
such JJ 101111111010 O
traffic NN 0011110100110 O
may MD 101101111010 O
literally RB X O
represent VB 101010110110 O
itself PRP 10111111100010 O
hundreds NNS 00010011 O
of IN 1000 O
DNS NNP 1111011011111 O
and CC 101110111 O
HTTP NNP 111101101010 O
requests NNS 001111010101 O
made VBD 10100101110110 O
when WRB 100101110010 O
a DT 11001 O
popular JJ 1111000111001 O
website NN 001010110110 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
a DT 11001 O
news NN 1111001011111 O
website NN 001010110110 O
is VBZ 101101010 O
open JJ 10101011111011 O
. . 0110 O

Hiding VBG X B-Verb
a DT 11001 B-Entity
few JJ 1111000111100 I-Entity
DNS/HTTP NN X I-Entity
requests NNS 001111010101 I-Entity
among IN 101111111110101 B-Preposition
busy JJ X B-Entity
network NN 001000010 I-Entity
traffic NN 0011110100110 I-Entity
allows VBZ 101111100100 O
Snake NNP 1110111110011 B-Entity
rootkit NN 001011010110 I-Entity
to TO 101100 O
stay VB 101010110101 B-Verb
unnoticed JJ 10100001011 B-Entity
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
test VB 101010110111 O
Snake NNP 1110111110011 O
's POS 10111010 O
communications NNS 00111101001110 O
with IN 100100 O
the DT 11010 O
C NN 011100111 O
& CC 01110010 O
C NN 011100111 O
servers NNS 00111010 O
, , 1011100 O
and CC 101110111 O
still RB 10101111111111 O
being VBG 101011111000 O
able JJ 10100010110 O
to TO 101100 O
clearly RB 1010111011011 O
distinguish VB 101010011001 O
its PRP$ 11011101 O
traffic NN 0011110100110 O
, , 1011100 O
a DT 11001 O
small JJ 1111000110010 O
tool NN 001010001110 O
was VBD 101101011 O
built VBN 101001011111100 O
to TO 101100 O
generate VB 10101001001 O
GET VB 111101101011 O
request NN 001111010100 O
to TO 101100 O
a DT 11001 O
web NN 1111011011101 O
server NN 00111011 O
running VBG 10100101111101 O
on IN 1001010 O
the DT 11010 O
analysed JJ 1010010110100 O
system NN 001000000 O
. . 0110 O

The DT 010000 O
tool NN 001010001110 O
was VBD 101101011 O
named VBN 10100101001 O
as IN 10111111110 O
chrome.exe NN X O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
trigger VB 101010110111 O
the DT 11010 O
malware NN 00101100 O
communications NNS 00111101001110 O
. . 0110 O

As RB 01010100 O
long RB 11100110110 O
as IN 10111111110 O
the DT 11010 O
test NN 101010110111 O
tool NN 001010001110 O
named VBN 10100101001 O
chrome.exe NN X O
did VBD 10110111010 O
not RB 1010111100 O
make VB 101010011000 O
any DT 11111011111 O
requests NNS 001111010101 O
, , 1011100 O
its PRP$ 11011101 O
memory NN 00100011100 O
stayed VBD X O
pristine JJ X O
. . 0110 O

There EX 01001011 O
were VBD 101101000 O
no DT 11111011101 O
injections NNS X O
made VBN 10100101110110 O
by IN 1001110 O
the DT 11010 O
driver NN 00101101111 O
. . 0110 O

As RB 01010100 O
soon RB 101111111011 O
as IN 10111111110 O
the DT 11010 O
tool NN 001010001110 O
made VBD 10100101110110 O
its PRP$ 11011101 O
first JJ 1111010100 O
GET VB 111101101011 O
requests NNS 001111010101 O
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
immediately RB 101011100110 O
injected VBD 10100100010 B-Verb
a DT 11001 B-Entity
malicious JJ 1111011111000 I-Entity
DLL NN 00101101110 I-Entity
module NN 00101101100 I-Entity
in IN 100110 B-Preposition
it PRP 101111010 B-Entity
, , 1011100 O
and CC 101110111 O
that IN 101111110 B-Entity
module NN 00101101100 I-Entity
started VBD 10100101110111 B-Verb
producing VBG 101111111110101 B-Entity
the DT 11010 I-Entity
following JJ 111101000 I-Entity
traffic NN 0011110100110 I-Entity
: : 0111010 O
↓ CD 01111111101110 O
The DT 010000 B-Entity
domain NN 0010011010 I-Entity
names NNS 00111111011 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
servers NNS 00111010 I-Entity
it PRP 101111010 B-Entity
relies VBZ 10100101011 B-Verb
on IN 1001010 I-Verb
are VBP 101101001 O
hard-coded JJ 1111011101011 O
in IN 100110 O
the DT 11010 O
body NN 00011111000 O
of IN 1000 O
the DT 11010 O
malware NN 00101100 O
. . 0110 O

Some DT 010011100 O
examples NNS 00110100110 O
are VBP 101101001 O
given VBN 101000001111 O
below IN 011110101100 O
, , 1011100 O
and CC 101110111 O
a DT 11001 O
full JJ 1111000110101 O
list NN 0001011110 O
of IN 1000 O
known JJ 1010000110 O
domains NNS 00110111010 O
is VBZ 101101010 O
given VBN 101000001111 O
in IN 100110 O
the DT 11010 O
Appendix NN 01111101110 O
D NN 011111111000 O
: : 0111010 O
As IN 01010100 O
seen VBN 101001110010 O
in IN 100110 O
the DT 11010 O
traffic NN 0011110100110 O
dump NN 101010111111000 O
above IN 011110101101 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
first RB 1111010100 O
resolves VBZ 101000111000 B-Verb
the DT 11010 B-Entity
domain NN 0010011010 I-Entity
name NN 00111111010 I-Entity
of IN 1000 I-Entity
its PRP$ 11011101 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
. . 0110 O

Next NNP 010110 O
, , 1011100 O
it PRP 101111010 B-Entity
fetches VBZ 101111101000 B-Verb
a DT 11001 B-Entity
file NN 00100100 I-Entity
/D/pub.txt NN X I-Entity
, , 1011100 O
and CC 101110111 O
expects VBZ 101111101001 B-Verb
the DT 11010 B-Entity
server NN 00111011 I-Entity
to TO 101100 I-Entity
respond VB 101000111100 I-Entity
with IN 100100 I-Entity
a DT 11001 I-Entity
string NN 001001110110 I-Entity
'' '' 0111101110 I-Entity
1 CD 0111111110101 I-Entity
'' '' 0111101110 I-Entity
, , 1011100 I-Entity
acknowledging VBG X I-Entity
it PRP 101111010 I-Entity
's VBZ 10111010 I-Entity
active JJ 10100000010 I-Entity
: : 0111010 O
Once RB 0101011101 O
acknowledged VBD 101001011111110 O
, , 1011100 O
it PRP 101111010 B-Entity
asks VBZ X B-Verb
the DT 11010 B-Entity
server NN 00111011 I-Entity
for IN 10011111 B-Preposition
a DT 11001 B-Entity
command NN 0010011100 I-Entity
, , 1011100 O
and CC 101110111 O
the DT 11010 B-Entity
server NN 00111011 I-Entity
returns VBZ 1011111001111 B-Verb
a DT 11001 B-Entity
new JJ 11110000010 I-Entity
command NN 0010011100 I-Entity
to TO 101100 I-Entity
execute VB 10101001011 I-Entity
: : 0111010 O
The DT 010000 B-Entity
command NN 0010011100 I-Entity
it PRP 101111010 B-Entity
receives VBZ 101111101001 B-Verb
from IN 100101100 B-Preposition
C NNP 011100111 B-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
above IN 011110101101 O
( NNP 01111000 O
swim.onlinewebshop.net NNP X O
) NNP 011110100 O
is VBZ 101101010 B-Verb
encrypted VBN 10100100000 I-Verb
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
decrypt VB 10101001010 B-Verb
it PRP 101111010 B-Entity
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
first RB 1111010100 O
applies VBZ 101000110001 B-Verb
the DT 11010 B-Entity
XOR NN 1111011100101 I-Entity
mask NN 101010011111 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
bytes NNS 11100101111 I-Entity
that WDT 101111110 I-Entity
start VBP 101010111111000 I-Entity
from IN 100101100 I-Entity
offset VBN 0011010110 I-Entity
0x40 NN X I-Entity
: : 0111010 O
An DT 0100011111 O
identical JJ 10100001000 O
XOR NN 1111011100101 O
mask NN 101010011111 O
was VBD 101101011 O
also RB 10101111110 O
used VBN 1010011010 O
by IN 1001110 O
Agent.BTZ NNP 01111110111 O
. . 0110 O

Next NNP 010110 O
, , 1011100 O
it PRP 101111010 B-Entity
calculates VBZ 101111101000 B-Verb
and CC 101110111 I-Verb
confirms VBZ 101111101101 I-Verb
a DT 11001 B-Entity
CRC32 NN X I-Entity
checksum NN 1010101111001 I-Entity
within IN 100101111100 B-Preposition
the DT 11010 B-Entity
command NN 0010011100 I-Entity
, , 1011100 O
further RB 11110111111001 O
decrypts VBZ 101111101000 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
by IN 1001110 B-Preposition
using VBG 100101111110 B-Entity
the DT 11010 I-Entity
Number NNP 01110110111 I-Entity
Theory NNP X I-Entity
Library NNP 011110110000 I-Entity
( NNP 01111000 I-Entity
NTL NNP X I-Entity
) NNP 011110100 I-Entity
, , 1011100 O
and CC 101110111 O
makes VBZ 1011111001011 B-Verb
sure JJ 101000001110 I-Verb
the DT 11010 B-Entity
command NN 0010011100 I-Entity
is VBZ 101101010 I-Entity
destined VBN 10101011000 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
current JJ 111101111111111 I-Entity
host NN 00100001111 I-Entity
by IN 1001110 B-Preposition
matching VBG 10010111111111 B-Entity
the DT 11010 I-Entity
ID NNP 00111111000 I-Entity
field NN 001111111001 I-Entity
in IN 100110 I-Entity
it PRP 101111010 I-Entity
. . 0110 O

Once RB 0101011101 O
decrypted VBN 10100100011 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
interprets VBZ 101111101001 B-Verb
the DT 11010 B-Entity
received JJ 10100101101101 I-Entity
command NN 0010011100 I-Entity
, , 1011100 O
as IN 10111111110 O
reflected VBN 1011111001100 O
in IN 100110 O
the DT 11010 O
malware NN 00101100 O
log NN 00100110011 O
below IN 011110101100 O
( NN 01111000 O
the DT 11010 O
new JJ 11110000010 O
C NN 011100111 O
& CC 01110010 O
C NN 011100111 O
server NN 00111011 O
address NN 00111000 O
is VBZ 101101010 O
highlighted VBN 101001110110 O
in IN 100110 O
it PRP 101111010 O
) CD 011110100 O
: : 0111010 O
After IN 01010101 O
that DT 101111110 O
, , 1011100 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
connects VBZ 101000111010 B-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
new JJ 11110000010 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
, , 1011100 O
asking VBG 101111111110101 B-Verb
it PRP 101111010 B-Entity
for IN 10011111 B-Preposition
another DT 11111011100 B-Entity
command NN 0010011100 I-Entity
: : 0111010 O
The DT 010000 B-Entity
command NN 0010011100 I-Entity
it PRP 101111010 B-Entity
receives VBZ 101111101001 B-Verb
is VBZ 101101010 O
called VBN 10100101000 O
UpLoad NNP X O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 B-Entity
uploads VBZ 101111101000 B-Verb
all PDT 1111101100 B-Entity
the DT 11010 I-Entity
collected VBN 1010010110101 I-Entity
logs NNS 0011111110110 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
server NN 00111011 I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
cleans VBZ X B-Verb
out RP 1011111110010 I-Verb
those DT 111101111110111 B-Entity
logs NNS 0011111110110 I-Entity
: : 0111010 O
The DT 010000 B-Entity
files NNS 0011011110 I-Entity
it PRP 101111010 B-Entity
uploads VBZ 101111101000 B-Verb
are VBP 101101001 O
stored VBN 1010011101111 O
inside IN 100101110111 O
its PRP$ 11011101 O
home NN 0010001000 O
directory NN 0011111111101 O
% NN 011100000 O
windows NNS 111000110011 O
% NN 011100000 O
\ CD 0111011010 O
$ $ 0111111111110 O
NtUninstallQ FW X O
[ FW 01110111000 O
random JJ 1111000111101 O
] NN 01110111010 O
$ $ 0111111111110 O
, , 1011100 O
where WRB 101111111110100 O
[ JJ 01110111000 O
random JJ 1111000111101 O
] NN 01110111010 O
is VBZ 101101010 O
a DT 11001 O
random JJ 1111000111101 O
number NN 00010100 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
Snake NNP 1110111110011 O
's POS 10111010 O
home NN 0010001000 O
directory NN 0011111111101 O
could MD 101101111000 O
be VB 10101100 O
C NN 011100111 O
: : 0111010 O
\WINDOWS\ NN X O
$ $ 0111111111110 O
NtUninstallQ812589 JJ X O
$ $ 0111111111110 O
. . 0110 O

The DT 010000 B-Entity
files NNS 0011011110 I-Entity
within IN 100101111100 I-Entity
that DT 101111110 I-Entity
directory NN 0011111111101 I-Entity
are VBP 101101001 B-Verb
used VBN 1010011010 I-Verb
by IN 1001110 O
the DT 11010 O
rootkit NN 001011010110 B-Entity
to TO 101100 O
store NN 101010011011 B-Verb
configuration NN 00100110010 B-Entity
and CC 101110111 I-Entity
log NN 00100110011 I-Entity
data NNS 001111001 I-Entity
. . 0110 O

When WRB 0101011101 O
decrypted VBN 10100100011 O
with IN 100100 O
the DT 11010 O
same JJ 111101001 O
XOR NN 1111011100101 O
key NN 001111111010 O
that WDT 101111110 O
was VBD 101101011 O
used VBN 1010011010 O
by IN 1001110 O
Agent.BTZ NN 01111110111 O
, , 1011100 O
these DT 11111000 O
files NNS 0011011110 O
expose VBP 101010011011 O
the DT 11010 O
following JJ 111101000 O
contents NNS 0001111010 O
: : 0111010 O
Analysis NN 010011101 O
of IN 1000 O
the DT 11010 O
sample NN 0010100000 O
reveals VBZ 101111101101 O
that IN 101111110 O
it PRP 101111010 B-Entity
supports VBZ 10010111111100 B-Verb
3 CD 011111111011110 B-Entity
modes NNS X I-Entity
of IN 1000 I-Entity
fetching VBG X I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
commands NNS 001111101100 I-Entity
. . 0110 O

• NN 011101111010 O
In IN 0101000 O
the DT 11010 O
first JJ 1111010100 O
mode NN 0011110111111 O
, , 1011100 O
it PRP 101111010 B-Entity
relies VBZ 10100101011 B-Verb
on IN 1001010 I-Verb
Windows NNP 1110110100 B-Entity
Internet NNP 0010111010 I-Entity
( FW 01111000 I-Entity
WinINet FW X I-Entity
) FW 011110100 I-Entity
APIs NNS 0111101101101 I-Entity
, , 1011100 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
HttpOpenRequest NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 I-Entity
HttpSendRequest NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 I-Entity
InternetReadFile NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 I-Entity
etc FW 01110111001 I-Entity
. . 0110 O

• NN 011101111010 O
In IN 0101000 O
the DT 11010 O
second JJ 11110101010 O
mode NN 0011110111111 O
, , 1011100 O
it PRP 101111010 B-Entity
uses VBZ 1011111010111 B-Verb
Windows NNP 1110110100 B-Entity
Sockets NNP X I-Entity
2 CD 0111111110100 I-Entity
( FW 01111000 I-Entity
Winsock FW X I-Entity
) FW 011110100 I-Entity
APIs NNS 0111101101101 I-Entity
, , 1011100 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
WSAStartup NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 I-Entity
socket NN 001001111001 I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
, , 1011100 I-Entity
connect VB 101000111101 I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
, , 1011100 I-Entity
send VB 10101001010 I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
, , 1011100 I-Entity
etc FW 01110111001 I-Entity
. . 0110 O

• NN 011101111010 O
In IN 0101000 O
the DT 11010 O
third JJ 11110011111 O
mode NN 0011110111111 O
, , 1011100 O
it PRP 101111010 B-Entity
works VBZ 1010010111001 B-Verb
in IN 100110 B-Preposition
the DT 11010 B-Entity
'pipe NN X I-Entity
server NN 00111011 I-Entity
' '' 0111101010 I-Entity
mode NN 0011110111111 I-Entity
, , 1011100 O
when WRB 100101110010 O
it PRP 101111010 B-Entity
passes VBZ 101111101010 B-Verb
the DT 11010 B-Entity
web NN 1111011011101 I-Entity
requests NNS 001111010101 I-Entity
it PRP 101111010 I-Entity
is VBZ 101101010 I-Entity
interested JJ 101001110110 I-Entity
in FW 100110 I-Entity
( FW 01111000 I-Entity
as IN 10111111110 I-Entity
a DT 11001 I-Entity
client NN 00100001110 I-Entity
) NN 011110100 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
that WDT 101111110 I-Entity
runs VBZ 101111101001 I-Entity
within IN 100101111100 I-Entity
Windows NNP 1110110100 I-Entity
Explorer NNP 011111110101 I-Entity
( NNP 01111000 I-Entity
explorer.exe NNP 111011111110 I-Entity
) NNP 011110100 I-Entity
and/or CC 100101110001 I-Entity
Internet NNP 0010111010 I-Entity
Explorer NNP 011111110101 I-Entity
( FW 01111000 I-Entity
iexplore.exe FW 1110110001 I-Entity
) FW 011110100 I-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

Memory NN X O
pipes NNS 0010111001 O
is VBZ 101101010 O
a DT 11001 O
common JJ 1111000111000 O
mechanism NN 00101001101 O
for IN 10011111 O
Inter-Process NNP X O
Communications NNPS 0111011111100 O
( FW 01111000 O
IPC FW X O
) FW 011110100 O
. . 0110 O

When WRB 0101011101 O
the DT 11010 O
pipe NN 0010111001 O
server NN 00111011 O
reads VBZ 101111101000 O
such JJ 101111111010 O
requests NNS 001111010101 O
from IN 100101100 O
the DT 11010 O
pipes NNS 0010111001 O
, , 1011100 O
it PRP 101111010 O
performs VBZ 1011111010110 O
the DT 11010 O
web NN 1111011011101 O
request NN 001111010100 O
on IN 1001010 O
behalf NN 00010011 O
of IN 1000 O
a DT 11001 O
client NN 00100001110 O
by IN 1001110 O
using VBG 100101111110 O
WinINet NNP X O
APIs NNS 0111101101101 O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 O
effectively RB 1010111010110 O
serves VBZ 101010111111010 O
as IN 10111111110 O
a DT 11001 O
proxy NN 1111011011011 O
. . 0110 O

The DT 010000 O
diagram NN 000101101 O
below IN 011110101100 O
demonstrates VBZ 101111101100 O
the DT 11010 O
last JJ 0010111000 O
, , 1011100 O
'pipe JJ X O
server NN 00111011 O
' '' 0111101010 O
mode NN 0011110111111 O
of IN 1000 O
Snake NNP 1110111110011 O
operation NN 0010101111111 O
: : 0111010 O
The DT 010000 O
diagram NN 000101101 O
illustrates VBZ 1011111011110 O
the DT 11010 O
operation NN 0010101111111 O
steps NNS 0011111011010 O
1-4 CD X O
: : 0111010 O
1 CD 0111111110101 O
First NNP 010110 O
, , 1011100 O
the DT 11010 B-Entity
malicious JJ 1111011111000 I-Entity
driver NN 00101101111 I-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
embedded JJ 1111011101000 I-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
injects VBZ 101111100010 B-Verb
that IN 101111110 B-Entity
DLL NNP 00101101110 I-Entity
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
system NN 001000000 I-Entity
process NN 001001111011 I-Entity
, , 1011100 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
services.exe NN 111101111111111 I-Entity
; : 0111100100 O
once RB 1011111001010 O
loaded VBN 10100100010 O
, , 1011100 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
will MD 10110111111 O
function VB 001010110111 B-Verb
in IN 100110 B-Preposition
the DT 11010 B-Entity
'pipe NN X I-Entity
server NN 00111011 I-Entity
' '' 0111101010 I-Entity
mode NN 0011110111111 I-Entity
. . 0110 O

2 CD 0111111110100 O
As RB 01010100 O
soon RB 101111111011 O
as IN 10111111110 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
detects VBZ 101111101000 B-Verb
a DT 11001 B-Entity
usermode NN 00101101001 I-Entity
process NN 001001111011 I-Entity
that WDT 101111110 I-Entity
goes VBZ 10100101111100 I-Entity
online JJ 11100001010 I-Entity
( FW 01111000 I-Entity
e.g FW 01110111001 I-Entity
. . 0110 I-Entity
a DT 11001 I-Entity
browser NN 00100011010 I-Entity
) NN 011110100 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
inject VB 10101001000 B-Verb
malicious JJ 1111011111000 B-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
into IN 10010111100 B-Preposition
it PRP 101111010 B-Entity
; : 0111100100 O
depending VBG 10100101010 O
on IN 1001010 O
the DT 11010 O
operational JJ 111100100110 O
mode NN 0011110111111 O
, , 1011100 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
may MD 101101111010 O
start VB 101010111111000 B-Verb
communicating VBG 10100100111 B-Entity
with IN 100100 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
directly RB 10101110000 I-Entity
. . 0110 O

3 CD 011111111011110 O
In IN 0101000 O
the DT 11010 O
'pipe NN X O
mode NN 0011110111111 O
' '' 0111101010 O
of IN 1000 O
operation NN 0010101111111 O
, , 1011100 O
the DT 11010 B-Entity
injected VBN 10100100010 I-Entity
DLL NNP 00101101110 I-Entity
will MD 10110111111 O
start VB 101010111111000 B-Verb
communicating VBG 10100100111 B-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
by IN 1001110 O
sending VBG 101111111111011 B-Verb
messages NNS 00110111111 B-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
established JJ 1110011010 I-Entity
inter-process JJ X I-Entity
communication NN 001111010000 I-Entity
pipes NNS 0010111001 I-Entity
. . 0110 O

4 CD 011111111011111 O
Once RB 0101011101 O
the DT 11010 B-Entity
task NN 001111100001 I-Entity
of IN 1000 I-Entity
communication NN 001111010000 I-Entity
with IN 100100 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
is VBZ 101101010 B-Verb
delegated VBN X I-Verb
to TO 101100 B-Preposition
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
start VB 101010111111000 B-Verb
communicating VBG 10100100111 B-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
, , 1011100 O
bypassing VBG 101111111110101 B-Verb
the DT 11010 B-Entity
host-based JJ 11110111111100 I-Entity
firewalls NNS 1110011000 I-Entity
that WDT 101111110 I-Entity
keep VBP 101010011001 I-Entity
an DT 11000 I-Entity
infected JJ 111101111000 I-Entity
system NN 001000000 I-Entity
process NN 001001111011 I-Entity
in IN 100110 I-Entity
a DT 11001 I-Entity
white-list NN X I-Entity
. . 0110 O

The DT 010000 O
reason NN 00101001000 O
behind IN 1001011111011 O
the DT 11010 B-Entity
pipes NNS 0010111001 I-Entity
usage NN 000111100 I-Entity
is VBZ 101101010 O
to TO 101100 O
'legitimise VB X B-Verb
' '' 0111101010 I-Verb
the DT 11010 B-Entity
outbound JJ 111101111110101 I-Entity
web NN 1111011011101 I-Entity
requests NNS 001111010101 I-Entity
, , 1011100 O
forcing VBG 101111111110101 O
them PRP 1011111110000 O
to TO 101100 O
originate VB 10101110001 O
from IN 100101100 O
the DT 11010 O
host NN 00100001111 O
firewall- JJ X O
friendly JJ X O
system NN 001000000 O
services NNS 001100011011 O
. . 0110 O

Pipe NNP X O
server NN 00111011 O
is VBZ 101101010 O
a DT 11001 O
special JJ 111100001101 O
mode NN 0011110111111 O
of IN 1000 O
the DT 11010 O
injected VBN 10100100010 O
DLL NNP 00101101110 O
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
switch VB 101000110000 O
into IN 10010111100 O
that DT 101111110 O
mode NN 0011110111111 O
, , 1011100 O
a DT 11001 B-Entity
dedicated JJ 101000001110 I-Entity
thread NN 00101101101 I-Entity
is VBZ 101101010 B-Verb
spawned VBN 10100000110 I-Verb
to TO 101100 O
listen VB 101000111100 B-Verb
for IN 10011111 B-Preposition
IPC NNP X B-Entity
messages NNS 00110111111 I-Entity
received VBD 10100101101101 I-Entity
through IN 100101111010 I-Entity
the DT 11010 I-Entity
pipes NNS 0010111001 I-Entity
. . 0110 O

The DT 010000 O
memory NN 00100011100 O
pipes NNS 0010111001 O
used VBN 1010011010 O
by IN 1001110 O
Snake NNP 1110111110011 O
are VBP 101101001 O
named VBN 10100101001 O
as IN 10111111110 O
: : 0111010 O
Apart RB 01001101 O
from IN 100101100 O
GET VB 111101101011 B-Entity
/ / 0111011111110 O
POST VB 111101101011 B-Entity
requests NNS 001111010101 I-Entity
, , 1011100 O
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
clients NNS 111001110 I-Entity
( VBP 01111000 I-Entity
infected JJ 111101111000 I-Entity
usermode NN 00101101001 I-Entity
processes NNS 0011001111110 I-Entity
) NN 011110100 I-Entity
may MD 101101111010 O
also RB 10101111110 O
ask VB 101010111111101 B-Verb
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
to TO 101100 O
perform VB 101010011011 B-Verb
other JJ 111110010 O
operations NNS 001100011100 O
on IN 1001010 O
their PRP$ 11011100 O
behalf NN 00010011 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
saving VBG 1011111111111010 B-Verb
data NNS 001111001 B-Entity
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
temporary JJ 11110111110101 I-Entity
file NN 00100100 I-Entity
, , 1011100 O
copy VB 0001011111 B-Verb
/ / 0111011111110 O
delete VB 10101001011 B-Verb
files NNS 0011011110 B-Entity
, , 1011100 O
save VB 10101001011 B-Verb
configuration NN 00100110010 B-Entity
data NNS 001111001 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
registry NN 111101110001 I-Entity
under IN 10010111111110 B-Preposition
the DT 11010 B-Entity
aforementioned JJ 11110101111 I-Entity
ShellCore NN X I-Entity
value NN 001111111000 I-Entity
. . 0110 O

This DT 0100010 B-Entity
delegation NN X I-Entity
of IN 1000 I-Entity
tasks NNS 0011001101001 I-Entity
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
keep VB 101010011001 B-Verb
infected JJ 111101111000 B-Entity
processes NNS 0011001111110 I-Entity
under IN 10010111111110 B-Preposition
the DT 11010 B-Entity
radar NN 0010111011 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
behavioural JJ X I-Entity
analysis NN 0001110110 I-Entity
tools NNS 0011001111011 I-Entity
for IN 10011111 B-Preposition
as RB 10111111110 B-Entity
long JJ 11100110110 I-Entity
as IN 10111111110 I-Entity
possible JJ 10100000110 I-Entity
. . 0110 O

Another DT 0100011111 O
reason NN 00101001000 O
is VBZ 101101010 O
to TO 101100 O
overcome VB 10101000100 B-Verb
account NN 0011110111001 B-Entity
restrictions NNS X I-Entity
imposed VBN X I-Entity
on IN 1001010 I-Entity
a DT 11001 I-Entity
browser NN 00100011010 I-Entity
process NN 001001111011 I-Entity
in IN 100110 O
order NN 0000011 O
to TO 101100 O
be VB 10101100 O
able JJ 10100010110 O
to TO 101100 O
write VB 10101011111001 B-Verb
into IN 10010111100 B-Preposition
files NNS 0011011110 B-Entity
/ / 0111011111110 O
registry NN 111101110001 B-Entity
. . 0110 O

To TO 0100011010 O
delegate VB X O
different JJ 1111000000 O
types NNS 0011010000 O
of IN 1000 O
tasks NNS 0011001101001 O
, , 1011100 O
the DT 11010 B-Entity
clients NNS 111001110 I-Entity
send VBP 10101001010 B-Verb
messages NNS 00110111111 B-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
using VBG 100101111110 B-Preposition
the DT 11010 B-Entity
following VBG 111101000 I-Entity
task NN 001111100001 I-Entity
identification NN 1110001101100 I-Entity
headers NNS 001111100101 I-Entity
: : 0111010 O
The DT 010000 B-Entity
usermode JJ 00101101001 I-Entity
component NN 00101000011 I-Entity
of IN 1000 I-Entity
Snake NNP 1110111110011 I-Entity
communicates VBZ 101111100001 B-Verb
with IN 100100 B-Preposition
its PRP$ 11011101 B-Entity
kernel-mode JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
via IN 100101111011 B-Preposition
a DT 11001 B-Entity
device NN 1111011101111 I-Entity
called VBN 10100101000 I-Entity
\\.\vstor32 FW X I-Entity
( FW 01111000 I-Entity
created VBN 1010011011000 I-Entity
under IN 10010111111110 I-Entity
kernel NN 11100000111 I-Entity
as IN 10111111110 I-Entity
\Device\vstor32 FW X I-Entity
) FW 011110100 I-Entity
. . 0110 O

In IN 0101000 O
its PRP$ 11011101 O
communication NN 001111010000 O
protocol NN 0011110111110 O
with IN 100100 O
the DT 11010 O
driver NN 00101101111 O
it PRP 101111010 O
uses VBZ 1011111010111 O
the DT 11010 O
IOCTL NNP 111101111111010 O
code NN 001001010 O
of IN 1000 O
0x222038 NN X O
. . 0110 O

To TO 0100011010 O
write VB 10101011111001 B-Verb
data NNS 001111001 B-Entity
, , 1011100 O
it PRP 101111010 B-Entity
opens VBZ 101111101001 B-Verb
the DT 11010 B-Entity
device NN 1111011101111 I-Entity
with IN 100100 B-Preposition
CreateFile FW X B-Entity
( FW 01111000 I-Entity
'' '' 0111101110 I-Entity
\\.\vstor32 NN X I-Entity
'' '' 0111101110 I-Entity
) NN 011110100 I-Entity
, , 1011100 O
then RB 101011111110 O
calls VBZ 101111100011 B-Verb
DeviceIoControl NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
on IN 1001010 B-Preposition
its PRP$ 11011101 B-Entity
handle VB 101000110000 I-Entity
with IN 100100 B-Preposition
IOCTL NN 111101111111010 B-Entity
code NN 001001010 I-Entity
of IN 1000 I-Entity
0x222038 NN X I-Entity
. . 0110 O

Configuration NN 011110110100 O
parameters NNS 0011111011101 O
along IN 10100100110 O
with IN 100100 O
the DT 11010 B-Entity
initial JJ 111101111111101 I-Entity
set NN 000101110 I-Entity
of IN 1000 I-Entity
domain NN 0010011010 I-Entity
names NNS 00111111011 I-Entity
are VBP 101101001 B-Verb
hard-coded JJ 1111011101011 I-Verb
within IN 100101111100 B-Preposition
the DT 11010 B-Entity
body NN 00011111000 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
DLL NNP 00101101110 I-Entity
. . 0110 O

However RB 010110 O
, , 1011100 O
the DT 11010 O
data NN 001111001 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
defined VBN 101001100110 O
in IN 100110 O
the DT 11010 O
structures NNS 0011111011010 O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 O
is VBZ 101101010 O
very RB 1111111100 O
likely JJ 101011101100 O
the DT 11010 O
DLL NNP 00101101110 O
could MD 101101111000 O
be VB 10101100 O
generated VBN 101001100010 O
by IN 1001110 O
a DT 11001 O
stand-alone JJ 111100011000 O
builder NN 001011010110 O
that WDT 101111110 O
'patches VBZ X O
' '' 0111101010 O
the DT 11010 O
DLL NNP 00101101110 O
with IN 100100 O
the DT 11010 O
new/updated JJ X O
list NN 0001011110 O
of IN 1000 O
C NNP 011100111 O
& CC 01110010 O
C NNP 011100111 O
. . 0110 O

Analysis NNP 010011101 O
of IN 1000 O
the DT 11010 B-Entity
commands NNS 001111101100 I-Entity
performed VBN 1010011000111 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
malware NN 00101100 I-Entity
suggests VBZ 101111101100 O
the DT 11010 O
following JJ 111101000 O
capabilities NNS 0011001111001 O
: : 0111010 O
Together RB X O
, , 1011100 O
these DT 11111000 B-Entity
commands NNS 001111101100 I-Entity
provide VBP 10101000011 B-Verb
complete JJ 1111000110101 B-Entity
backdoor JJ 00101101000 I-Entity
functionality NN 00011111001 I-Entity
, , 1011100 O
allowing VBG 101111111110101 B-Verb
remote JJ 11110111111100 B-Entity
attacker NN 00101111100 I-Entity
full JJ 1111000110101 B-Entity
control NN 111000100 I-Entity
over IN 10010110101 I-Entity
the DT 11010 I-Entity
compromised VBN 111101111001 I-Entity
system NN 001000000 I-Entity
. . 0110 O

The DT 010000 O
ability NN 101000110011 O
to TO 101100 O
update VB 10101011111000 B-Verb
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
and CC 101110111 O
then RB 101011111110 O
rely VB 10100101011 B-Verb
on IN 1001010 I-Verb
its PRP$ 11011101 B-Entity
communication NN 001111010000 I-Entity
capabilities NNS 0011001111001 I-Entity
means VBZ 00101001011 O
that IN 101111110 O
the DT 11010 O
components NNS 001111101000 O
of IN 1000 O
Snake NNP 1110111110011 O
are VBP 101101001 O
flexible JJ 111100010011 O
, , 1011100 O
making VBG 10111111111100 O
possible JJ 10100000110 O
the DT 11010 O
existence NN 0001111011 O
of IN 1000 O
the DT 11010 O
hybrid NN X O
( NN 01111000 O
kernel-centric JJ 111000111001 O
and CC 101110111 O
usermode-centric JJ 1110110000 O
) NN 011110100 O
architectures NNS 0011010010 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
the DT 11010 O
virtual JJ 11110111110101 O
partitions NNS X O
are VBP 101101001 O
used VBN 1010011010 O
by IN 1001110 O
kernel-centric JJ 111000111001 O
Snake NNP 1110111110011 O
variants NNS 00110100111 O
, , 1011100 O
where WRB 101111111110100 O
the DT 11010 B-Entity
kernel-mode JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
responsible JJ 10101011000 B-Entity
for IN 10011111 I-Entity
the DT 11010 I-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

If IN 0101011100 O
such PDT 101111111010 B-Entity
a DT 11001 I-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
installed VBN 101001011111101 I-Verb
via IN 100101111011 B-Preposition
an DT 11000 B-Entity
update VBP 10101011111000 I-Entity
, , 1011100 O
the DT 11010 B-Entity
usermode NN 00101101001 I-Entity
component NN 00101000011 I-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
instructed VBN 10100010001 I-Verb
to TO 101100 O
delegate VB X O
the DT 11010 O
file NN 00100100 O
upload NN 10101011111001 O
task NN 001111100001 O
to TO 101100 O
the DT 11010 O
driver NN 00101101111 O
by IN 1001110 O
copying VBG 11101110111 B-Verb
all PDT 1111101100 B-Entity
the DT 11010 I-Entity
necessary JJ 10100001001 I-Entity
logs NNS 0011111110110 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
shared JJ 1010010110011 I-Entity
virtual JJ 11110111110101 I-Entity
partition NN 0010011111111 I-Entity
, , 1011100 O
physically RB 1010111011010 O
located JJ 101001110101 O
on IN 1001010 O
the DT 11010 O
compromised VBN 111101111001 O
host NN 00100001111 O
and CC 101110111 O
thus RB 1010111010111 O
, , 1011100 O
accessible JJ 10100101101110 O
from IN 100101100 O
kernel NN 11100000111 O
. . 0110 O

This DT 0100010 O
particular JJ 111100000111 O
architecture NN 0010101111110 O
relies VBZ 10100101011 O
on IN 1001010 O
a DT 11001 B-Entity
kernel-mode JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
to TO 101100 O
carry VB 10101000101 B-Verb
out RP 1011111110010 I-Verb
the DT 11010 B-Entity
network NN 001000010 I-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

The DT 010000 B-Entity
usermode JJ 00101101001 I-Entity
DLLs NNS 001111100100 I-Entity
are VBP 101101001 B-Verb
still RB 10101111111111 I-Verb
injected VBN 10100100010 I-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
system NN 001000000 I-Entity
processes VBZ 0011001111110 I-Entity
to TO 101100 B-Preposition
perform VB 101010011011 B-Entity
high-level JJ 1111000111110 I-Entity
tasks NNS 0011001101001 I-Entity
. . 0110 O

The DT 010000 O
delivery NN 1110001101111 O
mechanism NN 00101001101 O
is VBZ 101101010 O
not RB 1010111100 O
known VBN 1010000110 O
: : 0111010 O
it PRP 101111010 B-Entity
may MD 101101111010 O
be VB 10101100 B-Verb
distributed VBN 10100110111010 I-Verb
via IN 100101111011 B-Preposition
a DT 11001 O
thumb-drive JJ X O
, , 1011100 O
a DT 11001 B-Entity
phishing NN 11100000010 I-Entity
email NN 11110110011 I-Entity
attachment NN 00100101110 I-Entity
, , 1011100 O
or CC 101110110 O
be VB 10101100 B-Verb
delivered VBN 10100110111010 I-Verb
via IN 100101111011 B-Preposition
an DT 11000 B-Entity
exploit VB 001010111010 I-Entity
across IN 10010111111101 I-Entity
the DT 11010 I-Entity
network NN 001000010 I-Entity
( FW 01111000 O
e.g FW 01110111001 O
. . 0110 O

by IN 1001110 O
using VBG 100101111110 O
the DT 11010 O
reconnaissance NN 111000111001 O
tool NN 001010001110 O
that WDT 101111110 O
is VBZ 101101010 O
explained VBN 101001110000 O
later JJ 11100110011 O
) NN 011110100 O
. . 0110 O

Infection NN X B-Entity
starts VBZ 101111100000 B-Verb
from IN 100101100 B-Preposition
a DT 11001 B-Entity
dropper NN 001011010111 I-Entity
penetrating VBG X I-Entity
into IN 10010111100 I-Entity
the DT 11010 I-Entity
compromised VBN 111101111001 I-Entity
system NN 001000000 I-Entity
where WRB 101111111110100 I-Entity
it PRP 101111010 I-Entity
is VBZ 101101010 I-Entity
allowed VBN 1011111001110 I-Entity
to TO 101100 I-Entity
run VB 101010111111100 I-Entity
. . 0110 O

Once RB 0101011101 O
executed VBN 1010010111100 B-Verb
, , 1011100 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
installs VBZ 101111101000 B-Verb
the DT 11010 B-Entity
kernel NN 11100000111 I-Entity
mode NN 0011110111111 I-Entity
driver NN 00101101111 I-Entity
in IN 100110 B-Preposition
a DT 11001 B-Entity
pre-defined JJ X I-Entity
location NN 001111100001 I-Entity
. . 0110 O

The DT 010000 O
dropper NN 001011010111 O
itself PRP 10111111100010 O
is VBZ 101101010 O
32-bit JJ 1111011101110 O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 O
will MD 10110111111 O
run VB 101010111111100 O
both DT 11111011010 O
on IN 1001010 O
32-bit JJ 1111011101110 O
and CC 101110111 O
64-bit JJ 1111011101110 O
Windows NNP 1110110100 O
OS NNP 1111011100110 O
( NNP 01111000 O
in IN 100110 O
WoW64 NN X O
mode NN 0011110111111 O
) NN 011110100 O
. . 0110 O

On IN 01010011 B-Preposition
a DT 11001 B-Entity
32-bit JJ 1111011101110 I-Entity
OS NN 1111011100110 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
install VB 10101001000 B-Verb
a DT 11001 B-Entity
32-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

On IN 01010011 B-Preposition
a DT 11001 B-Entity
64-bit JJ 1111011101110 I-Entity
OS NN 1111011100110 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
install VB 10101001000 B-Verb
a DT 11001 B-Entity
64-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

The DT 010000 B-Entity
analysed VBN 1010010110100 I-Entity
32-bit JJ 1111011101110 I-Entity
dropper NN 001011010111 I-Entity
creates VBZ 1011111010110 B-Verb
a DT 11001 B-Entity
driver NN 00101101111 I-Entity
in IN 100110 B-Preposition
the DT 11010 B-Entity
following JJ 111101000 I-Entity
location NN 001111100001 I-Entity
: : 0111010 O
However RB 010110 O
, , 1011100 O
different JJ 1111000000 O
samples NNS 0011011100 O
may MD 101101111010 O
use VB 10101011100 O
a DT 11001 O
different JJ 1111000000 O
path NN 000110111 O
and CC 101110111 O
driver NN 00101101111 O
file NN 00100100 O
name NN 00111111010 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
some DT 11111011110 O
samples NNS 0011011100 O
exposed VBD 10100010010 O
these DT 11111000 O
filenames NNS 0011111011101 O
: : 0111010 O
fdisk32.sys NNS X O
, , 1011100 O
A0009547.sys NNS X O
, , 1011100 O
or CC 101110110 O
Ultra3.sys NNS X O
. . 0110 O

The DT 010000 O
filename NN 01110110111 O
of IN 1000 O
the DT 11010 O
dropper NN 001011010111 O
could MD 101101111000 O
be VB 10101100 O
rknginst.exe NN X O
or CC 101110110 O
fdiskmon.exe NN X O
. . 0110 O

Once RB 0101011101 O
executed VBN 1010010111100 O
, , 1011100 O
the DT 11010 O
driver NN 00101101111 O
first RB 1111010100 O
makes VBZ 1011111001011 O
sure JJ 101000001110 O
it PRP 101111010 O
is VBZ 101101010 O
registered VBN 1010011011001 O
under IN 10010111111110 O
a DT 11001 O
pre-defined JJ X O
name NN 00111111010 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
Ultra3 NN X O
. . 0110 O

Other JJ 0100111111 O
samples NNS 0011011100 O
may MD 101101111010 O
have VB 101101100 O
a DT 11001 O
different JJ 1111000000 O
registration NN 00100110110 O
name NN 00111111010 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
~ROOT NN X O
. . 0110 O

The DT 010000 B-Entity
registration NN 00100110110 I-Entity
is VBZ 101101010 B-Verb
ensured VBN 101001100010 I-Verb
with IN 100100 B-Preposition
creation NN 0001110101 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
following VBG 111101000 I-Entity
registry NN 111101110001 I-Entity
entries NNS 0011111011110 I-Entity
: : 0111010 O
The DT 010000 B-Entity
driver NN 00101101111 I-Entity
then RB 101011111110 O
flags NNS 101111100011 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
events NNS 0011001101001 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
notification NN 00101001100 I-Entity
purposes NNS 001100011110 I-Entity
: : 0111010 O
The DT 010000 B-Entity
rootkit NN 001011010110 I-Entity
then RB 101011111110 O
places VBZ 001111101010 B-Verb
a DT 11001 B-Entity
number NN 00010100 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
hooks NNS 001111011011 I-Entity
. . 0110 O

The DT 010000 O
first JJ 1111010100 O
API NN 0111101101101 O
it PRP 101111010 B-Entity
hooks VBZ 001111011011 B-Verb
is VBZ 101101010 O
IoCreateDevice NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

The DT 010000 B-Entity
installed JJ 101001011111101 I-Entity
hook NN 1111011101111 I-Entity
handler NN 11100100011 I-Entity
calls VBZ 101111100011 B-Verb
the DT 11010 B-Entity
original JJ 11110101111 I-Entity
API NN 0111101101101 I-Entity
and CC 101110111 O
then RB 101011111110 O
checks NNS 101111101010 B-Verb
if IN 101111111111110 B-Entity
the DT 11010 I-Entity
name NN 00111111010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
device NN 1111011101111 I-Entity
is VBZ 101101010 I-Entity
netbt NN X I-Entity
or CC 101110110 I-Entity
afd NN X I-Entity
. . 0110 O

If IN 0101011100 O
so RB 101111111110010 O
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
install VB 10101001000 B-Verb
a DT 11001 B-Entity
TDI NNP 1111011101111 I-Entity
filter NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 O
device NN 1111011101111 O
name NN 00111111010 O
is VBZ 101101010 O
Null NNP X O
, , 1011100 O
Beep NNP X O
, , 1011100 O
tcpip NN X O
or CC 101110110 O
Nsiproxy NNP X O
, , 1011100 O
it PRP 101111010 O
will MD 10110111111 O
activate VB 10101001010 O
itself PRP 10111111100010 O
by IN 1001110 O
enabling VBG 10111111111100 O
its PRP$ 11011101 B-Entity
hooks NNS 001111011011 I-Entity
designed VBN 10100010111 O
to TO 101100 O
hide VB 101010011111 B-Verb
the DT 11010 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
Snake NNP 1110111110011 I-Entity
on IN 1001010 I-Entity
a DT 11001 I-Entity
system NN 001000000 I-Entity
, , 1011100 O
set VBN 000101110 O
up RP 10111111100111 O
its PRP$ 11011101 O
access NN 10100011010 O
control NN 111000100 O
lists NNS 001111011001 O
and CC 101110111 O
the DT 11010 O
messaging NN 1111001011110 O
system NN 001000000 O
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
hide VB 101010011111 B-Verb
its PRP$ 11011101 B-Entity
components NNS 001111101000 I-Entity
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
hooks VBZ 001111011011 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
APIs NNS 0111101101101 I-Entity
: : 0111010 O
For IN 01010010 O
example NN 000010 O
, , 1011100 O
the DT 11010 B-Entity
hook NN 1111011101111 I-Entity
handlers NNS 0011111011111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
registry-related JJ X I-Entity
APIs NNS 0111101101101 I-Entity
will MD 10110111111 O
block VB 0011110111101 B-Verb
access NN 10100011010 B-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
registry NN 111101110001 I-Entity
entries NNS 0011111011110 I-Entity
that WDT 101111110 I-Entity
contain VBP 1010101110111 I-Entity
the DT 11010 I-Entity
name NN 00111111010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

In IN 0101000 O
one CD 111110100 O
example NN 000010 O
, , 1011100 O
the DT 11010 B-Entity
rootkit NN 001011010110 I-Entity
blocks VBZ 0011110111101 B-Verb
access NN 10100011010 B-Entity
to TO 101100 I-Entity
registry NN 111101110001 I-Entity
entries NNS 0011111011110 I-Entity
that WDT 101111110 I-Entity
contain VBP 1010101110111 I-Entity
the DT 11010 I-Entity
strings NNS 0011111011100 I-Entity
'' '' 0111101110 I-Entity
Ultra3 NN X I-Entity
'' '' 0111101110 I-Entity
and CC 101110111 I-Entity
'' '' 0111101110 I-Entity
~ROOT NNP X I-Entity
'' '' 0111101110 I-Entity
. . 0110 O

The DT 010000 B-Entity
ZwReadFile NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
hook NN 1111011101111 I-Entity
handler NN 11100100011 I-Entity
will MD 10110111111 O
block VB 0011110111101 B-Verb
access NN 10100011010 B-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
home NN 0010001000 I-Entity
directory NN 0011111111101 I-Entity
where WRB 101111111110100 I-Entity
the DT 11010 I-Entity
rootkit NN 001011010110 I-Entity
keeps VBZ 1011111001010 I-Entity
its PRP$ 11011101 I-Entity
file NN 00100100 I-Entity
. . 0110 O

In IN 0101000 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
analysed VBN 1010010110100 O
kernel-centric JJ 111000111001 O
Snake NNP 1110111110011 O
samples NNS 0011011100 O
the DT 11010 O
home NN 0010001000 O
directory NN 0011111111101 O
was VBD 101101011 O
hard-coded JJ 1111011101011 O
as IN 10111111110 O
% JJ 011100000 O
windows NNS 111000110011 O
% NN 011100000 O
\ CD 0111011010 O
$ $ 0111111111110 O
NtUninstallQ817473 JJ X O
$ $ 0111111111110 O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 B-Entity
blocked VBD 101001100110 B-Verb
file NN 00100100 B-Entity
read NN 10101011111001 I-Entity
access NN 10100011010 I-Entity
from IN 100101100 I-Entity
that DT 101111110 I-Entity
directory NN 0011111111101 I-Entity
. . 0110 O

The DT 010000 B-Entity
ZwClose FW X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
hook NN 1111011101111 I-Entity
handler NN 11100100011 I-Entity
is VBZ 101101010 O
used VBN 1010011010 O
to TO 101100 O
inject VB 10101001000 B-Verb
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
userland NN 111101111111111 I-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

The DT 010000 B-Entity
hook NN 1111011101111 I-Entity
handler NN 11100100011 I-Entity
for IN 10011111 I-Entity
ZwTerminateProcess NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
checks NNS 101111101010 B-Verb
if IN 101111111111110 B-Entity
the DT 11010 I-Entity
process NN 001001111011 I-Entity
being VBG 101011111000 I-Entity
shut VBN 11110111111001 I-Entity
down RP 001111011011 I-Entity
is VBZ 101101010 I-Entity
svchost.exe NNP 111011111110 I-Entity
. . 0110 O

If IN 0101011100 O
so RB 101111111110010 O
, , 1011100 O
it PRP 101111010 O
considers VBZ 1011111001011 O
it PRP 101111010 O
to TO 101100 O
be VB 10101100 O
a DT 11001 O
system NN 001000000 O
shutdown NN 000111100 O
, , 1011100 O
so IN 101111111110010 O
it PRP 101111010 B-Entity
unloads VBZ X B-Verb
its PRP$ 11011101 B-Entity
usermode NN 00101101001 I-Entity
DLL NN 00101101110 I-Entity
and CC 101110111 O
deactivates VBZ X B-Verb
its PRP$ 11011101 B-Entity
own JJ 0010001001 I-Entity
network NN 001000010 I-Entity
drivers NNS 0011001111111 I-Entity
, , 1011100 O
just RB 1010111010101 O
like IN 101111111110110 O
it PRP 101111010 O
does VBZ 1011011100 O
when WRB 100101110010 O
its PRP$ 11011101 O
ZwShutdownSystem NNP X O
( FW 01111000 O
) FW 011110100 O
hook NN 1111011101111 O
handler NN 11100100011 O
gets VBZ 1011111001010 O
invoked VBN 10100101111010 O
. . 0110 O

The DT 010000 B-Entity
ObOpenObjectByName NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
hook NN 1111011101111 I-Entity
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
hide VB 101010011111 B-Verb
the DT 11010 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
its PRP$ 11011101 I-Entity
virtual JJ 11110111110101 I-Entity
partitions NNS X I-Entity
( RB 01111000 O
described VBN 101001110000 O
later JJ 11100110011 O
) NN 011110100 O
. . 0110 O

To TO 0100011010 O
encrypt VB 101010011101 B-Verb
data NNS 001111001 B-Entity
stored VBN 1010011101111 I-Entity
on IN 1001010 I-Entity
its PRP$ 11011101 I-Entity
virtual JJ 11110111110101 I-Entity
partitions NNS X I-Entity
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
sets VBZ 1011111001010 B-Verb
a DT 11001 B-Entity
hook NN 1111011101111 I-Entity
for IN 10011111 I-Entity
another DT 11111011100 I-Entity
API NNP 0111101101101 I-Entity
: : 0111010 O
To TO 0100011010 O
re-infect VB X B-Verb
the DT 11010 B-Entity
usermode NN 00101101001 I-Entity
process NN 001001111011 I-Entity
svchost.exe NN 111011111110 I-Entity
and CC 101110111 O
to TO 101100 O
re-enable VB X B-Verb
its PRP$ 11011101 B-Entity
network NN 001000010 I-Entity
drivers NNS 0011001111111 I-Entity
, , 1011100 O
the DT 11010 B-Entity
rootkit NN 001011010110 I-Entity
hooks VBZ 001111011011 B-Verb
these DT 11111000 B-Entity
APIs NNS 0111101101101 I-Entity
: : 0111010 O
Snake NNP 1110111110011 O
then RB 101011111110 O
proceeds VBZ 101000111010 O
to TO 101100 O
the DT 11010 O
task NN 001111100001 O
of IN 1000 O
deep JJ 1111011101000 O
packet NN 11100100011 O
inspection NN 0011110111100 O
and CC 101110111 O
modification NN 0001110011 O
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
accomplish VB 101010011100 O
it PRP 101111010 O
, , 1011100 O
it PRP 101111010 B-Entity
registers VBZ 101111100010 B-Verb
a DT 11001 B-Entity
callout NN X I-Entity
driver NN 00101101111 I-Entity
for IN 10011111 I-Entity
Windows NNP 1110110100 I-Entity
Filtering NNP 0111101101100 I-Entity
Platform NNP 0111101100011 I-Entity
( NNP 01111000 I-Entity
WFP NNP X I-Entity
) NNP 011110100 I-Entity
, , 1011100 O
an DT 11000 O
architecture NN 0010101111110 O
first RB 1111010100 O
introduced VBN 1010011011011 O
with IN 100100 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
and CC 101110111 O
nowadays RB X O
normally RB 1010111011111 O
used VBN 1010011010 O
by IN 1001110 O
antivirus NN 11101110111 O
and/or CC 100101110001 O
intrusion NN 0011110111011 O
detection NN 0001110010 O
systems NNS 00110011000 O
to TO 101100 O
inspect/block JJ X O
malicious JJ 1111011111000 O
traffic NN 0011110100110 O
. . 0110 O

Snake NNP 1110111110011 O
sets VBZ 1011111001010 O
filters NNS 01111011001101 O
at IN 10011110 O
the DT 11010 O
layers NNS 0011010000 O
FWPMLAYERSTREAMV4 NN X O
and CC 101110111 O
FWPMLAYERALEFLOWESTABLISHEDV4 NN X O
in IN 100110 O
the DT 11010 O
TCP/ NNP X O
IP NNP 1111011000 O
stack VB 001001111001 O
, , 1011100 O
so IN 101111111110010 O
that IN 101111110 O
its PRP$ 11011101 B-Entity
callout NN X I-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
notified VBN 101001100000 I-Verb
whenever WRB 1011111111111010 B-Preposition
a DT 11001 B-Entity
TCP NN 11110110100 I-Entity
connection NN 001111010001 I-Entity
is VBZ 101101010 I-Entity
established VBN 1110011010 I-Entity
by IN 1001110 I-Entity
a DT 11001 I-Entity
browser NN 00100011010 I-Entity
. . 0110 O

When WRB 0101011101 O
that DT 101111110 O
happens VBZ 1010010111001 O
, , 1011100 O
the DT 11010 B-Entity
rootkit NN 001011010110 I-Entity
triggers VBZ 1011111011100 B-Verb
an DT 11000 B-Entity
event NN 0010101111110 I-Entity
named VBN 10100101001 I-Entity
\BaseNamedObjects\wininetactivate NN X I-Entity
. . 0110 O

When WRB 0101011101 B-Preposition
the DT 11010 B-Entity
data NN 001111001 I-Entity
arrives VBZ 001100011010 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
is VBZ 101101010 B-Verb
intercepted VBN 10100101111010 I-Verb
with IN 100100 B-Preposition
the DT 11010 B-Entity
FwpsCopyStreamDataToBuffer0 NN X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
API NN 0111101101101 I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
scanned VBN 101001100010 B-Verb
for IN 10011111 B-Preposition
the DT 11010 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
hidden JJ 11110001111110 I-Entity
commands NNS 001111101100 I-Entity
from IN 100101100 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
. . 0110 O

The DT 010000 B-Entity
driver NN 00101101111 I-Entity
inspects VBZ X B-Verb
bidirectional JJ X B-Entity
network NN 001000010 I-Entity
data NNS 001111001 I-Entity
on IN 1001010 B-Preposition
a DT 11001 B-Entity
per IN 011110011100 I-Entity
stream NN 000101100 I-Entity
basis NN 001010110110 I-Entity
, , 1011100 O
as IN 10111111110 O
it PRP 101111010 O
's VBZ 10111010 O
located JJ 101001110101 O
right RB 101000110011 O
on IN 1001010 O
the DT 11010 O
stream NN 000101100 O
data NNS 001111001 O
path NN 000110111 O
. . 0110 O

An DT 0100011111 O
ability NN 101000110011 O
to TO 101100 O
manipulate VB 10101001010 B-Verb
data NNS 001111001 B-Entity
streams NNS X I-Entity
is VBZ 101101010 O
provided VBN 101001100001 O
with IN 100100 O
the DT 11010 O
packet NN 11100100011 O
injection NN 11100110110 O
logic NN 000101100 O
below IN 011110101100 O
, , 1011100 O
allowing VBG 101111111110101 O
Snake NNP 1110111110011 B-Entity
to TO 101100 O
covertly RB X O
insert VB 10101001000 B-Verb
traffic NN 0011110100110 B-Entity
destined VBN 10101011000 I-Entity
to TO 101100 I-Entity
its PRP$ 11011101 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
servers NNS 00111010 I-Entity
: : 0111010 O
In IN 0101000 O
order NN 0000011 O
to TO 101100 O
qualify VB X O
as IN 10111111110 O
a DT 11001 O
browser NN 00100011010 O
, , 1011100 O
the DT 11010 O
usermode NN 00101101001 O
process NN 001001111011 O
must MD 1011011110110 O
have VB 101101100 O
any DT 11111011111 O
of IN 1000 O
the DT 11010 O
following JJ 111101000 O
names NNS 00111111011 O
: : 0111010 O
In IN 0101000 O
addition NN 0000010 O
to TO 101100 O
WFP NNP X O
, , 1011100 O
Snake NNP 1110111110011 B-Entity
also RB 10101111110 O
hooks VBZ 001111011011 B-Verb
the DT 11010 B-Entity
Transport NNP X I-Entity
Driver NN 11110101110 I-Entity
Interface NNP 0111101100011 I-Entity
( NNP 01111000 I-Entity
TDI NNP 1111011101111 I-Entity
) NNP 011110100 I-Entity
network NN 001000010 I-Entity
routines NNS 0011111110111 I-Entity
by IN 1001110 B-Preposition
setting VBG 1010010110000 B-Entity
itself PRP 10111111100010 I-Entity
up RP 10111111100111 I-Entity
as IN 10111111110 I-Entity
a DT 11001 I-Entity
TDI NNP 1111011101111 I-Entity
filter NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

TDI NNP 1111011101111 O
is VBZ 101101010 O
considered VBN 101001111010 O
deprecated VBN X O
and CC 101110111 O
will MD 10110111111 O
be VB 10101100 O
removed VBN 10100101111011 O
in IN 100110 O
future JJ 00100011111 O
versions NNS 0011010001 O
of IN 1000 O
Microsoft NNP 1110110111 O
Windows NNP 1110110100 O
, , 1011100 O
but CC 10111111111000 O
it PRP 101111010 O
's VBZ 10111010 O
still RB 10101111111111 O
supported VBN 1010011000110 O
on IN 1001010 O
Windows NNP 1110110100 O
7 CD 01111111101101 O
. . 0110 O

Being VBG X O
registered VBN 1010011011001 B-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
TDI NNP 1111011101111 I-Entity
driver NN 00101101111 I-Entity
on IN 1001010 B-Preposition
the DT 11010 B-Entity
device NN 1111011101111 I-Entity
stack VBP 001001111001 I-Entity
, , 1011100 O
Snake NNP 1110111110011 B-Entity
hooks VBZ 001111011011 B-Verb
TCP NN 11110110100 B-Entity
calls NNS 101111100011 I-Entity
. . 0110 O

This DT 0100010 O
way NN 00101001010 O
it PRP 101111010 B-Entity
intercepts VBZ 101111101010 B-Verb
all DT 1111101100 B-Entity
requests NNS 001111010101 I-Entity
along IN 10100100110 I-Entity
with IN 100100 I-Entity
their PRP$ 11011100 I-Entity
parameters NNS 0011111011101 I-Entity
via IN 100101111011 B-Preposition
IRP NNP X B-Entity
( NNP 01111000 I-Entity
IO NNP X I-Entity
request NN 001111010100 I-Entity
package NN 0011111111010 I-Entity
) CD 011110100 I-Entity
hooks NNS 001111011011 I-Entity
. . 0110 O

By IN 010001100 O
'sniffing NN X O
' '' 0111101010 O
all PDT 1111101100 O
the DT 11010 O
requests NNS 001111010101 O
, , 1011100 O
it PRP 101111010 B-Entity
can MD 10110111110 O
now RB 1010111011110 O
inspect VB 10101001011 B-Verb
the DT 11010 B-Entity
traffic NN 0011110100110 I-Entity
, , 1011100 O
looking VBG 101010110011 B-Verb
for IN 10011111 I-Verb
and CC 101110111 I-Verb
then RB 101011111110 I-Verb
parsing VBG 11101110111 I-Verb
GET VB 111101101011 B-Entity
/ / 0111011111110 I-Entity
POST VB 111101101011 I-Entity
HTTP NNP 111101101010 I-Entity
requests NNS 001111010101 I-Entity
and CC 101110111 I-Entity
also RB 10101111110 I-Entity
SMTP NNP 111101101010 I-Entity
communications NNS 00111101001110 I-Entity
, , 1011100 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
distinguish VB 101010011001 B-Verb
commands NNS 001111101100 B-Entity
addressed VBN 10100110111110 I-Entity
to TO 101100 I-Entity
itself PRP 10111111100010 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 B-Entity
rootkit NN 001011010110 I-Entity
detects VBZ 101111101000 B-Verb
that IN 101111110 B-Preposition
the DT 11010 B-Entity
OS NN 1111011100110 I-Entity
version NN 00011000 I-Entity
is VBZ 101101010 I-Entity
pre-Vista NNP X I-Entity
( NNP 01111000 I-Entity
e.g NNP 01110111001 I-Entity
. . 0110 I-Entity
Windows NNP 1110110100 I-Entity
XP NN 0111101101100 I-Entity
) CD 011110100 I-Entity
or CC 101110110 I-Entity
Windows NNP 1110110100 I-Entity
Server NN 0111101101100 I-Entity
2008 CD 011111100110 I-Entity
( FW 01111000 I-Entity
e.g FW 01110111001 I-Entity
. . 0110 I-Entity
Windows NNP 1110110100 I-Entity
Server NN 0111101101100 I-Entity
2003 CD 111011111100 I-Entity
) NN 011110100 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
invoke VB 10101001010 B-Verb
FwpsStreamInjectAsync0 NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
in IN 100110 O
order NN 0000011 O
to TO 101100 O
generate VB 10101001001 B-Verb
outbound NN 111101111110101 B-Entity
requests NNS 001111010101 I-Entity
. . 0110 O

Whenever NNP X B-Preposition
the DT 11010 B-Entity
client NN 00100001110 I-Entity
establishes VBZ 1011111011101 I-Entity
connections NNS 0011110100101 I-Entity
, , 1011100 O
the DT 11010 B-Entity
TDI NNP 1111011101111 I-Entity
driver NN 00101101111 I-Entity
will MD 10110111111 O
also RB 10101111110 O
'pulse VB X B-Verb
' '' 0111101010 I-Verb
the DT 11010 B-Entity
\BaseNamedObjects\wininetactivate NN X I-Entity
event NN 0010101111110 I-Entity
, , 1011100 O
just RB 1010111010101 O
like IN 101111111110110 O
the DT 11010 O
WPF NNP X O
driver NN 00101101111 O
's POS 10111010 O
component NN 00101000011 O
of IN 1000 O
it PRP 101111010 O
, , 1011100 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
notify VB 101010011001 O
the DT 11010 O
userland NN 111101111111111 O
service NN 001001111110 O
about IN 10010110110 O
the DT 11010 O
event NN 0010101111110 O
. . 0110 O

The DT 010000 B-Entity
data NNS 001111001 I-Entity
that IN 101111110 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
intercepts NNS 101111101010 B-Verb
, , 1011100 O
along IN 10100100110 O
with IN 100100 O
the DT 11010 O
important JJ 10100000100 O
notifications NNS X O
, , 1011100 O
is VBZ 101101010 O
passed VBN 10100110111011 O
to TO 101100 O
the DT 11010 O
userland NN 111101111111111 O
DLL NNP 00101101110 O
to TO 101100 O
be VB 10101100 O
processed VBN 101001100010 O
. . 0110 O

If IN 0101011100 B-Preposition
the DT 11010 B-Entity
data NN 001111001 I-Entity
contains VBZ 1011111011111 I-Entity
commands NNS 001111101100 I-Entity
from IN 100101100 I-Entity
C NNP 011100111 I-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
, , 1011100 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
is VBZ 101101010 O
expected VBN 10100001000 O
to TO 101100 O
execute VB 10101001011 B-Verb
them PRP 1011111110000 B-Entity
and CC 101110111 O
report NN 001010111100 O
results NNS 0011111011111 O
back RB 101000110111 O
to TO 101100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
to TO 101100 O
be VB 10101100 B-Verb
delivered VBN 10100110111010 I-Verb
back RB 101000110111 B-Preposition
to TO 101100 I-Preposition
C NNP 011100111 B-Entity
& CC 01110010 I-Entity
C NNP 011100111 I-Entity
. . 0110 O

For IN 01010010 O
NDIS NN 001001111010 O
versions NNS 0011010001 O
5.X NNP X O
, , 1011100 O
Snake NNP 1110111110011 O
rootkit NN 001011010110 O
contains VBZ 1011111011111 O
code NN 001001010 B-Entity
that WDT 101111110 O
installs VBZ 101111101000 B-Verb
NDIS NN 001001111010 B-Entity
filter NN 1111011101111 I-Entity
intermediate JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

This DT 0100010 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
set VBN 000101110 I-Verb
up RP 10111111100111 I-Verb
above IN 011110101101 B-Preposition
a DT 11001 B-Entity
miniport NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
( CD 01111000 O
a DT 11001 O
driver NN 00101101111 O
that WDT 101111110 O
communicates VBZ 101111100001 O
with IN 100100 O
the DT 11010 O
physical JJ 111100101010 O
device NN 1111011101111 O
) NN 011110100 O
and CC 101110111 O
below IN 011110101100 B-Preposition
a DT 11001 B-Entity
protocol NN 0011110111110 I-Entity
driver NN 00101101111 I-Entity
( CD 01111000 O
a DT 11001 O
driver NN 00101101111 O
that WDT 101111110 O
implements VBZ 1011111010110 O
a DT 11001 O
protocol NN 0011110111110 O
, , 1011100 O
e.g NN 01110111001 O
. . 0110 O

TCP/IP FW X O
) FW 011110100 O
. . 0110 O

The DT 010000 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
registered VBN 1010011011001 I-Verb
with IN 100100 B-Preposition
NdisIMRegisterLayeredMiniport NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
. . 0110 O

After IN 01010101 O
that DT 101111110 O
, , 1011100 O
the DT 11010 B-Entity
drivers NNS 0011001111111 I-Entity
hooks VBZ 001111011011 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
exports NNS 001111010101 I-Entity
within IN 100101111100 B-Preposition
ndis.sys NNS X B-Entity
: : 0111010 O
The DT 010000 O
rootkit NN 001011010110 O
contains VBZ 1011111011111 O
code NN 001001010 B-Entity
that WDT 101111110 O
installs VBZ 101111101000 B-Verb
NDIS NN 001001111010 B-Entity
filter NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
for IN 10011111 I-Entity
NDIS NN 001001111010 I-Entity
6.0 CD 01111001011 I-Entity
and CC 101110111 I-Entity
above JJ 011110101101 I-Entity
: : 0111010 O
NDIS NN 001001111010 B-Entity
filter NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
configuration NN 00100110010 I-Entity
is VBZ 101101010 B-Verb
stored VBN 1010011101111 I-Verb
in IN 100110 B-Preposition
the DT 11010 B-Entity
registry NN 111101110001 I-Entity
entry NN 0010101110110 I-Entity
: : 0111010 O
The DT 010000 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
registered VBN 1010011011001 I-Verb
with IN 100100 B-Preposition
NdisFRegisterFilterDriver NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
. . 0110 O

After IN 01010101 O
that DT 101111110 O
, , 1011100 O
the DT 11010 B-Entity
drivers NNS 0011001111111 I-Entity
hooks VBZ 001111011011 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
exports NNS 001111010101 I-Entity
within IN 100101111100 B-Preposition
ndis.sys NNP X B-Entity
( NNP 01111000 I-Entity
for IN 10011111 I-Entity
NDIS NNP 001001111010 I-Entity
6.0 CD 01111001011 I-Entity
) NN 011110100 I-Entity
: : 0111010 O
Another DT 0100011111 B-Entity
set NN 000101110 I-Entity
of IN 1000 I-Entity
exports NNS 001111010101 I-Entity
it PRP 101111010 B-Entity
attempts VBZ 101000111010 O
to TO 101100 O
hook NN 1111011101111 B-Verb
in IN 100110 B-Preposition
ndis.sys NNP X B-Entity
( NNP 01111000 I-Entity
for IN 10011111 I-Entity
NDIS NNP 001001111010 I-Entity
6.0 CD 01111001011 I-Entity
) NN 011110100 I-Entity
is VBZ 101101010 O
: : 0111010 O
With IN 0101011111 O
the DT 11010 B-Entity
hooks NNS 001111011011 I-Entity
installed VBN 101001011111101 B-Verb
, , 1011100 O
whenever WRB 1011111111111010 O
the DT 11010 O
network NN 001000010 O
adapter NN 0011110111011 O
driver NN 00101101111 O
attempts VBZ 101000111010 O
to TO 101100 O
register VB 10101001001 O
to TO 101100 O
NDIS NNP 001001111010 O
, , 1011100 O
or CC 101110110 O
whenever WRB 1011111111111010 O
there EX 10111100101 O
is VBZ 101101010 O
an DT 11000 O
attempt NN 101000110010 O
to TO 101100 O
install VB 10101001000 O
NDIS NNP 001001111010 O
intermediate JJ 1111011101111 O
driver NN 00101101111 O
or CC 101110110 O
NDIS NN 001001111010 O
filter NN 1111011101111 O
driver NN 00101101111 O
, , 1011100 O
the DT 11010 B-Entity
hook NN 1111011101111 I-Entity
handlers NNS 0011111011111 I-Entity
will MD 10110111111 O
register VB 10101001001 B-Verb
Snake NNP 1110111110011 B-Entity
's POS 10111010 I-Entity
own JJ 0010001001 I-Entity
MiniportXxx NNP X I-Entity
functions NNS 0011111011011 I-Entity
with IN 100100 B-Preposition
the DT 11010 B-Entity
NDIS NN 001001111010 I-Entity
library NN 0010011111110 I-Entity
. . 0110 O

With IN 0101011111 O
its PRP$ 11011101 O
own JJ 0010001001 O
miniport NN 1111011101111 O
handler NN 11100100011 O
functions NNS 0011111011011 O
, , 1011100 O
it PRP 101111010 B-Entity
can MD 10110111110 O
send VB 10101001010 B-Verb
/ / 0111011111110 O
receive VB 10101000001 B-Verb
data NNS 001111001 B-Entity
by IN 1001110 B-Preposition
using VBG 100101111110 B-Entity
a DT 11001 I-Entity
private JJ 111100101011 I-Entity
TCP/IP NN X I-Entity
stack VBP 001001111001 I-Entity
, , 1011100 O
bypassing VBG 101111111110101 B-Verb
all DT 1111101100 B-Entity
firewall NN 111101110000 I-Entity
hooks NNS 001111011011 I-Entity
, , 1011100 O
and CC 101110111 O
making VBG 10111111111100 B-Verb
its PRP$ 11011101 B-Entity
open JJ 10101011111011 I-Entity
ports NNS 1110110001 I-Entity
invisible JJ X B-Entity
to TO 101100 I-Entity
scanners NNS 01111011001101 I-Entity
. . 0110 O

The DT 010000 B-Entity
Snake NNP 1110111110011 I-Entity
rootkit NN 001011010110 I-Entity
registers VBZ 101111100010 B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 B-Preposition
Network NNP 0111101101011 B-Entity
Driver NN 11110101110 I-Entity
Interface NNP 0111101100011 I-Entity
Specification NNP X I-Entity
( FW 01111000 I-Entity
NDIS FW 001001111010 I-Entity
) FW 011110100 I-Entity
protocol NN 0011110111110 I-Entity
driver NN 00101101111 I-Entity
. . 0110 O

Whenever NNP X O
the DT 11010 B-Entity
underlying VBG 111101111111100 I-Entity
miniport NN 1111011101111 I-Entity
driver NN 00101101111 I-Entity
receives VBZ 101111101001 B-Verb
data NNS 001111001 B-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
network NN 001000010 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
calls VBZ 101111100011 O
NDIS NN 001001111010 O
by IN 1001110 O
invoking VBG X B-Verb
a DT 11001 B-Entity
data NNS 001111001 I-Entity
receive VBP 10101000001 I-Entity
indication NN 0001110111 I-Entity
function NN 001010110111 I-Entity
NdisMIndicateReceiveNetBufferLists NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

When WRB 0101011101 O
that DT 101111110 O
happens VBZ 1010010111001 O
, , 1011100 O
NDIS NNP 001001111010 B-Entity
invokes VBZ X B-Verb
Snake NNP 1110111110011 B-Entity
's POS 10111010 I-Entity
hook NN 1111011101111 I-Entity
function NN 001010110111 I-Entity
( FW 01111000 O
ProtocolReceiveNetBufferLists FW X O
) NN 011110100 O
to TO 101100 O
process VB 001001111011 O
the DT 11010 O
received JJ 10100101101101 O
data NNS 001111001 O
. . 0110 O

To TO 0100011010 O
send VB 10101001010 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
back RB 101000110111 O
, , 1011100 O
the DT 11010 B-Entity
protocol NN 0011110111110 I-Entity
driver NN 00101101111 I-Entity
defines VBZ 10010111111110 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
in IN 100110 B-Preposition
a DT 11001 B-Entity
list NN 0001011110 I-Entity
of IN 1000 I-Entity
NETBUFFERLIST NN X I-Entity
structures NNS 0011111011010 I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
passes VBZ 101111101010 O
them PRP 1011111110000 O
to TO 101100 O
NDIS NNP 001001111010 O
by IN 1001110 O
calling VBG 11101110111 B-Verb
NdisSendNetBufferLists NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
. . 0110 O

NDIS NNP 001001111010 B-Entity
, , 1011100 O
in IN 100110 O
turn NN 000000 O
, , 1011100 O
calls VBZ 101111100011 B-Verb
the DT 11010 B-Entity
miniport FW 1111011101111 I-Entity
driver's FW X I-Entity
MiniportSendNetBufferLists FW X I-Entity
( FW 01111000 I-Entity
) FW 011110100 I-Entity
function NN 001010110111 I-Entity
to TO 101100 O
forward RB 10101011111000 O
the DT 11010 O
data NNS 001111001 O
to TO 101100 O
an DT 11000 O
underlying JJ 111101111111100 O
miniport NN 1111011101111 O
driver NN 00101101111 O
. . 0110 O

Being VBG X O
able JJ 10100010110 O
to TO 101100 O
fully RB 1010111110110 O
manipulate VB 10101001010 B-Verb
traffic NN 0011110100110 B-Entity
at IN 10011110 B-Preposition
3 CD 011111111011110 B-Entity
different JJ 1111000000 I-Entity
levels NNS 0011010000 I-Entity
( FW 01111000 I-Entity
NDIS FW 001001111010 I-Entity
protocol NN 0011110111110 I-Entity
driver NN 00101101111 I-Entity
, , 1011100 I-Entity
TDI NN 1111011101111 I-Entity
Driver NN 11110101110 I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
WPF FW X I-Entity
callout FW X I-Entity
driver NN 00101101111 I-Entity
) NN 011110100 I-Entity
, , 1011100 O
Snake NNP 1110111110011 B-Entity
is VBZ 101101010 O
able JJ 10100010110 O
to TO 101100 O
'inject VB X B-Verb
' '' 0111101010 I-Verb
the DT 11010 B-Entity
traffic NN 0011110100110 I-Entity
into IN 10010111100 B-Preposition
existing VBG 111101111110101 B-Entity
communications NNS 00111101001110 I-Entity
to TO 101100 O
reach VB 10101000101 B-Verb
out RP 1011111110010 I-Verb
to TO 101100 B-Preposition
external JJ 111101111111011 B-Entity
components NNS 001111101000 I-Entity
, , 1011100 O
and CC 101110111 O
at IN 10011110 O
the DT 11010 O
same JJ 111101001 O
time NN 00011010 O
parse VB 10101001011 B-Verb
all DT 1111101100 B-Entity
incoming JJ 11110110100 I-Entity
traffic NN 0011110100110 I-Entity
to TO 101100 O
detect VB 101010011100 B-Verb
traffic NN 0011110100110 B-Entity
addressed VBN 10100110111110 I-Entity
to TO 101100 I-Entity
itself PRP 10111111100010 I-Entity
: : 0111010 O
As IN 01010100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
intercepts VBZ 101111101010 B-Verb
all DT 1111101100 B-Entity
connections NNS 0011110100101 I-Entity
( FW 01111000 O
e.g FW 01110111001 O
. . 0110 O

on IN 1001010 O
TDIRECEIVE NNP X O
TDI NNP 1111011101111 O
event NN 0010101111110 O
or CC 101110110 O
ClientEventReceive NNP X O
( NNP 01111000 O
) NNP 011110100 O
event NN 0010101111110 O
notification NN 00101001100 O
triggered VBD 1010010111100 O
through IN 100101111010 O
its PRP$ 11011101 O
TDI NNP 1111011101111 O
Filter NNP X O
Driver NN 11110101110 O
) NN 011110100 O
, , 1011100 O
it PRP 101111010 B-Entity
parses VBZ 101111101001 B-Verb
all DT 1111101100 B-Entity
incoming JJ 11110110100 I-Entity
HTTP NN 111101101010 I-Entity
and CC 101110111 I-Entity
SMTP NN 111101101010 I-Entity
traffic NN 0011110100110 I-Entity
to TO 101100 O
see VB 1010101000 O
if IN 101111111111110 O
it PRP 101111010 B-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
authenticated VBN X I-Verb
as IN 10111111110 B-Preposition
Snake NNP 1110111110011 B-Entity
traffic NN 0011110100110 I-Entity
. . 0110 O

The DT 010000 B-Entity
authentication NN 001010110010 I-Entity
is VBZ 101101010 B-Verb
implemented VBN 10100101111011 I-Verb
by IN 1001110 O
decrypting VBG 101111111111010 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
and CC 101110111 O
making VBG 10111111111100 B-Verb
sure JJ 101000001110 I-Verb
it PRP 101111010 B-Entity
starts VBZ 101111100000 I-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
markers NNS 0011111110110 I-Entity
0xDEADBEAF NN X I-Entity
and CC 101110111 I-Entity
0xC001BA5E NN X I-Entity
( NN 01111000 I-Entity
which WDT 101111011 I-Entity
appear VBP 101000111111 I-Entity
to TO 101100 I-Entity
derive VB X I-Entity
from IN 100101100 I-Entity
'DEAD NNP X I-Entity
BEEF NNP X I-Entity
' POS 0111101010 I-Entity
and CC 101110111 I-Entity
'COOL NNP X I-Entity
BASE NNP X I-Entity
' POS 0111101010 I-Entity
) NN 011110100 I-Entity
. . 0110 O

Here RB 01001011 O
are VBP 101101001 O
specific JJ 111100001110 O
steps NNS 0011111011010 O
: : 0111010 O
By IN 010001100 O
observing VBG 101111111111011 O
such JJ 101111111010 O
behaviour NN 111000110010 O
, , 1011100 O
one CD 111110100 O
might NN 1011011110010 O
wonder NN X O
why WRB 1011111111111011 O
the DT 11010 O
driver NN 00101101111 O
is VBZ 101101010 O
expecting VBG X O
HTTP NN 111101101010 O
or CC 101110110 O
SMTP NN 111101101010 O
clients NNS 111001110 O
? . 0111011111010 O
Why WRB 11101110000 O
does VBZ 1011011100 O
it PRP 101111010 O
act VB 101010111111010 O
like IN 101111111110110 O
HTTP/SMTP NN X O
server NN 00111011 O
processing NN 111000110010 O
client NN 00100001110 O
traffic NN 0011110100110 O
, , 1011100 O
and CC 101110111 O
serving VBG 1010010111010 O
back RB 101000110111 O
normal JJ 111010 O
responses NNS 10111111100011 O
as IN 10111111110 O
per IN 011110011100 O
the DT 11010 O
protocol NN 0011110111110 O
? . 0111011111010 O
For IN 01010010 O
example NN 000010 O
, , 1011100 O
in IN 100110 O
HTTP NNP 111101101010 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
will MD 10110111111 O
respond VB 101000111100 B-Verb
with IN 100100 B-Preposition
messages NNS 00110111111 B-Entity
like IN 101111111110110 I-Entity
'' '' 0111101110 I-Entity
HTTP/1.1 NN 0111011111110 I-Entity
200 CD 0111111111111 I-Entity
OK JJ 01110111111110 I-Entity
'' '' 0111101110 I-Entity
or CC 101110110 I-Entity
'' '' 0111101110 I-Entity
HTTP/1.1 NN 0111011111110 I-Entity
500 CD 0111111111111 I-Entity
Server NN 0111101101100 I-Entity
Error NN 0111101100101 I-Entity
'' '' 0111101110 I-Entity
. . 0110 O

For IN 01010010 O
SMTP NN 111101101010 O
traffic NN 0011110100110 O
, , 1011100 O
it PRP 101111010 O
communicates VBZ 101111100001 O
back RB 101000110111 O
normal JJ 111010 O
SMTP NNP 111101101010 O
server NN 00111011 O
responses NNS 10111111100011 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
'' '' 0111101110 O
250 CD X O
Sender NN X O
OK JJ 01110111111110 O
'' '' 0111101110 O
, , 1011100 O
'' '' 0111101110 O
503 CD X O
Bad JJ X O
sequence NN 000110011 O
of IN 1000 O
commands NNS 001111101100 O
'' '' 0111101110 O
, , 1011100 O
etc FW 01110111001 O
. . 0110 O

The DT 010000 O
reason NN 00101001000 O
behind IN 1001011111011 O
such JJ 101111111010 O
behaviour NN 111000110010 O
is VBZ 101101010 O
that IN 101111110 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
acting VBG 101001110000 I-Verb
in IN 100110 B-Preposition
this DT 110110 B-Entity
mode NN 0011110111111 I-Entity
like IN 101111111110110 B-Preposition
a DT 11001 B-Entity
proxy NN 1111011011011 I-Entity
, , 1011100 O
routing VBG 101010111111110 B-Verb
requests NNS 001111010101 B-Entity
from IN 100101100 I-Entity
other JJ 111110010 I-Entity
infected JJ 111101111000 I-Entity
hosts NNS 001100110010 I-Entity
to TO 101100 B-Preposition
a DT 11001 B-Entity
remote JJ 11110111111100 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
. . 0110 O

Another DT 0100011111 O
opportunity NN 101000110011 O
this DT 110110 O
mode NN 0011110111111 O
unlocks VBZ X O
is VBZ 101101010 O
a DT 11001 O
peer-to-peer JJ 1111001011001 O
network NN 001000010 O
mode NN 0011110111111 O
with IN 100100 O
no DT 11111011101 O
centralised VBN X O
C NNP 011100111 O
& CC 01110010 O
C NNP 011100111 O
. . 0110 O

The DT 010000 O
infected JJ 111101111000 O
hosts NNS 001100110010 O
are VBP 101101001 O
capable JJ 00010000 O
of IN 1000 O
transferring VBG 111000111101 O
the DT 11010 O
following VBG 111101000 O
peer-2-peer NN X O
commands NNS 001111101100 O
defining VBG 101111111111011 O
fragment NN X O
size NN 00011111010 O
, , 1011100 O
reliability NN X O
parameters NNS 0011111011101 O
, , 1011100 O
new JJ 11110000010 O
peer VBP 101010111111110 O
information NN 001111000 O
, , 1011100 O
peer VB 101010111111110 O
impersonation NN X O
flags NNS 101111100011 O
, , 1011100 O
etc FW 01110111001 O
. . 0110 O

: : 0111010 O
Once RB 0101011101 O
the DT 11010 B-Entity
incoming JJ 11110110100 I-Entity
data NNS 001111001 I-Entity
is VBZ 101101010 B-Verb
authenticated VBN X I-Verb
and CC 101110111 I-Verb
decrypted VBN 10100100011 I-Verb
, , 1011100 O
the DT 11010 O
driver NN 00101101111 O
passes VBZ 101111101010 O
it PRP 101111010 O
to TO 101100 O
the DT 11010 O
DLL NN 00101101110 O
by IN 1001110 O
using VBG 100101111110 O
memory NN 00100011100 O
pipes NNS 0010111001 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
on IN 1001010 O
HTTP NN 111101101010 O
traffic NN 0011110100110 O
arrival NN X O
it PRP 101111010 B-Entity
may MD 101101111010 O
send VB 10101001010 B-Verb
traffic NN 0011110100110 B-Entity
data NNS 001111001 I-Entity
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
memory NN 00100011100 I-Entity
pipe NN 0010111001 I-Entity
\Device\NamedPipe\isapihttp NN X I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
, , 1011100 O
send VB 10101001010 B-Verb
a DT 11001 B-Entity
received VBN 10100101101101 I-Entity
peer-2-peer NN X I-Entity
command NN 0010011100 I-Entity
message NN 001001110111 I-Entity
writepeernfo= FW X I-Entity
[ FW 01110111000 I-Entity
IPADDRESS NN X I-Entity
: : 0111010 I-Entity
PORT FW X I-Entity
] FW 01110111010 I-Entity
0fragnoscrambling=Y0 NN X I-Entity
into IN 10010111100 B-Preposition
another DT 11111011100 B-Entity
memory NN 00100011100 I-Entity
pipe NN 0010111001 I-Entity
called VBN 10100101000 I-Entity
\Device\NamedPipe\isapidg NN X I-Entity
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
log VB 00100110011 B-Verb
its PRP$ 11011101 B-Entity
activity NN 00110001011 I-Entity
, , 1011100 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
writes VBZ 101111101000 B-Verb
log NN 00100110011 B-Entity
data NNS 001111001 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
\Device\NamedPipe\isapilog NN X I-Entity
, , 1011100 O
so IN 101111111110010 O
that IN 101111110 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
could MD 101101111000 O
log VB 00100110011 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
log NN 00100110011 I-Entity
files NNS 0011011110 I-Entity
. . 0110 O

Full JJ 01111101111 O
list NN 0001011110 O
of IN 1000 O
the DT 11010 B-Entity
named VBN 10100101001 I-Entity
pipes NNS 0010111001 I-Entity
used VBN 1010011010 B-Verb
for IN 10011111 B-Preposition
communications NNS 00111101001110 B-Entity
is VBZ 101101010 O
provided VBN 101001100001 O
below IN 011110101100 O
: : 0111010 O
Messages NNS X B-Entity
submitted VBN 1010011011100 B-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
pipes NNS 0010111001 I-Entity
are VBP 101101001 O
wrapped VBN 1111011101011 O
into IN 10010111100 O
the DT 11010 O
structures NNS 0011111011010 O
. . 0110 O

The DT 010000 O
structures NNS 0011111011010 O
appear VBP 101000111111 O
to TO 101100 O
contain VB 1010101110111 O
headers NNS 001111100101 O
to TO 101100 O
allow VB 10101000000 O
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
server NN 00111011 I-Entity
, , 1011100 O
that WDT 101111110 O
runs VBZ 101111101001 O
within IN 100101111100 O
an DT 11000 O
infected JJ 111101111000 O
userland NN 111101111111111 O
module NN 00101101100 O
, , 1011100 O
to TO 101100 O
identify VB 101010011101 B-Verb
the DT 11010 B-Entity
messages NNS 00110111111 I-Entity
first RB 1111010100 O
and CC 101110111 O
then RB 101011111110 O
unwrap VB X O
the DT 11010 O
structures NNS 0011111011010 O
accordingly RB 01111110010 O
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
the DT 11010 O
message NN 001001110111 O
headers NNS 001111100101 O
could MD 101101111000 O
be VB 10101100 O
: : 0111010 O
Once RB 0101011101 O
received VBN 10100101101101 B-Verb
from IN 100101100 B-Preposition
the DT 11010 B-Entity
pipes NNS 0010111001 I-Entity
and CC 101110111 O
unwrapped/decoded JJ X O
, , 1011100 O
the DT 11010 B-Entity
data NN 001111001 I-Entity
is VBZ 101101010 O
then RB 101011111110 O
handled VBN 101001100010 O
by IN 1001110 O
the DT 11010 O
usermode NN 00101101001 O
DLL NNP 00101101110 O
as IN 10111111110 O
per IN 011110011100 O
the DT 11010 O
data NNS 001111001 O
intention NN 0001110001 O
- : 01111001101 O
whether IN 1011111111111010 O
it PRP 101111010 O
's VBZ 10111010 O
a DT 11001 O
traffic NN 0011110100110 O
sniffing VBG X O
task NN 001111100001 O
, , 1011100 O
a DT 11001 O
peer-2-peer NN X O
client NN 00100001110 O
logic NN 000101100 O
, , 1011100 O
a DT 11001 O
logging VBG 1110001101101 O
task NN 001111100001 O
, , 1011100 O
or CC 101110110 O
a DT 11001 O
task NN 001111100001 O
of IN 1000 O
saving NN 1011111111111010 O
received VBD 10100101101101 O
files NNS 0011011110 O
into IN 10010111100 O
the DT 11010 O
virtual JJ 11110111110101 O
volumes NNS 0011110111000 O
. . 0110 O

The DT 010000 B-Entity
driver NN 00101101111 I-Entity
creates VBZ 1011111010110 B-Verb
virtual JJ 11110111110101 B-Entity
file NN 00100100 I-Entity
volumes NNS 0011110111000 I-Entity
for IN 10011111 B-Preposition
encrypted JJ 10100100000 B-Entity
storage NN 0011110111100 I-Entity
of IN 1000 I-Entity
its PRP$ 11011101 I-Entity
files NNS 0011011110 I-Entity
and CC 101110111 I-Entity
configuration NN 00100110010 I-Entity
data NNS 001111001 I-Entity
: : 0111010 O
The DT 010000 B-Entity
volumes NNS 0011110111000 I-Entity
are VBP 101101001 B-Verb
mounted VBN X I-Verb
from IN 100101100 B-Preposition
the DT 11010 B-Entity
virtual JJ 11110111110101 I-Entity
file NN 00100100 I-Entity
systems NNS 00110011000 I-Entity
RawDisk1 NN X I-Entity
and CC 101110111 I-Entity
RawDisk2 NN X I-Entity
. . 0110 O

The DT 010000 B-Entity
first JJ 1111010100 I-Entity
partition NN 0010011111111 I-Entity
is VBZ 101101010 B-Verb
created VBN 1010011011000 I-Verb
with IN 100100 B-Preposition
the DT 11010 B-Entity
following JJ 111101000 I-Entity
steps NNS 0011111011010 I-Entity
: : 0111010 O
The DT 010000 B-Entity
hook NN 1111011101111 I-Entity
installed VBN 101001011111101 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
rootkit NN 001011010110 I-Entity
on IN 1001010 B-Preposition
IofCallDriver NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
provides VBZ 1011111011100 B-Verb
on-the-fly JJ X B-Entity
data NNS 001111001 I-Entity
encryption/decryption NN X I-Entity
whenever WRB 1011111111111010 O
that DT 101111110 B-Entity
data NN 001111001 I-Entity
is VBZ 101101010 B-Verb
written VBN 10100110111110 I-Verb
to TO 101100 B-Preposition
or CC 101110110 O
read VB 10101011111001 B-Verb
from IN 100101100 B-Preposition
the DT 11010 B-Entity
volume NN 00011111111 I-Entity
. . 0110 O

The DT 010000 B-Entity
encryption NN 1111011100111 I-Entity
algorithm NN 0011111111000 I-Entity
is VBZ 101101010 B-Verb
based VBN 10100101010 I-Verb
on IN 1001010 B-Preposition
CAST-128 NN X B-Entity
, , 1011100 O
with IN 100100 B-Preposition
the DT 11010 B-Entity
hard-coded JJ 1111011101011 I-Entity
key NN 001111111010 I-Entity
stored VBN 1010011101111 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
rootkit NN 001011010110 I-Entity
body NN 00011111000 I-Entity
. . 0110 O

As IN 01010100 O
a DT 11001 O
result NN 000101100 O
, , 1011100 O
whenever WRB 1011111111111010 O
the DT 11010 B-Entity
data NN 001111001 I-Entity
is VBZ 101101010 B-Verb
saved VBN 10100110111111 I-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
volume NN 00011111111 I-Entity
Hd1 NN X I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
be VB 10101100 B-Verb
scrambled VBN X I-Verb
on-the-fly JJ X B-Entity
, , 1011100 O
and CC 101110111 O
reflected VBN 1011111001100 B-Verb
in IN 100110 B-Entity
the DT 11010 I-Entity
persistent JJ 111100010000 I-Entity
storage NN 0011110111100 I-Entity
file NN 00100100 I-Entity
hotfix.dat NN X I-Entity
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
physically RB 1010111011010 O
located JJ 101001110101 O
within IN 100101111100 O
the DT 11010 O
rootkit NN 001011010110 O
's POS 10111010 O
'home NN X O
' '' 0111101010 O
directory NN 0011111111101 O
: : 0111010 O
Analysis NN 010011101 O
of IN 1000 O
the DT 11010 O
hotfix.dat NN X O
file NN 00100100 O
contents NNS 0001111010 O
reveals VBZ 101111101101 O
it PRP 101111010 B-Entity
's VBZ 10111010 B-Verb
a DT 11001 B-Entity
fully RB 1010111110110 I-Entity
encrypted JJ 10100100000 I-Entity
file NN 00100100 I-Entity
with IN 100100 I-Entity
flat JJ X I-Entity
entropy NN X I-Entity
. . 0110 O

Thus RB 010110 O
, , 1011100 O
it PRP 101111010 O
is VBZ 101101010 O
not RB 1010111100 O
possible JJ 10100000110 O
to TO 101100 O
reveal VB 101010101110 O
the DT 11010 O
contents NNS 0001111010 O
of IN 1000 O
the DT 11010 O
Snake NNP 1110111110011 O
's POS 10111010 O
volume NN 00011111111 O
by IN 1001110 O
accessing VBG 101111111111011 O
the DT 11010 O
contents NNS 0001111010 O
of IN 1000 O
this DT 110110 O
file NN 00100100 O
( NN 01111000 O
unless IN 1011111111111010 O
the DT 11010 O
encryption NN 1111011100111 O
is VBZ 101101010 O
broken VBN 10100110111111 O
, , 1011100 O
that WDT 101111110 O
is VBZ 101101010 O
) NNP 011110100 O
. . 0110 O

Enlisting VBG X O
the DT 11010 O
contents NNS 0001111010 O
of IN 1000 O
the DT 11010 O
created VBN 1010011011000 O
volume NN 00011111111 O
is VBZ 101101010 O
possible JJ 10100000110 O
, , 1011100 O
along IN 10100100110 O
with IN 100100 O
creating VBG 101111111111011 O
files NNS 0011011110 O
on IN 1001010 O
it PRP 101111010 O
: : 0111010 O
However RB 010110 O
, , 1011100 O
as RB 10111111110 O
soon RB 101111111011 O
as IN 10111111110 O
IofCallDriver NNP X O
( NNP 01111000 O
) NNP 011110100 O
hook NN 1111011101111 O
is VBZ 101101010 O
removed VBN 10100101111011 O
, , 1011100 O
the DT 11010 O
same JJ 111101001 O
'dir NN X O
' '' 0111101010 O
command NN 0010011100 O
will MD 10110111111 O
fail VB 10101000000 O
, , 1011100 O
as IN 10111111110 O
with IN 100100 O
no DT 11111011101 O
hook NN 1111011101111 O
the DT 11010 O
rootkit NN 001011010110 O
can MD 10110111110 O
not RB 1010111100 O
decrypt VB 10101001010 O
the DT 11010 O
scrambled VBN X O
volume NN 00011111111 O
: : 0111010 O
The DT 010000 O
second JJ 11110101010 O
volume NN 00011111111 O
\\.\Hd2 NN X O
is VBZ 101101010 O
not RB 1010111100 O
mapped VBN 10100010000 O
to TO 101100 O
a DT 11001 O
file NN 00100100 O
, , 1011100 O
so RB 101111111110010 O
when WRB 100101110010 O
a DT 11001 O
computer NN 0010000010 O
is VBZ 101101010 O
switched VBN X O
off RP 101111100010 O
, , 1011100 O
its PRP$ 11011101 O
contents NNS 0001111010 O
is VBZ 101101010 O
lost VBN 101001100111 O
. . 0110 O

Thus RB 010110 O
, , 1011100 O
it PRP 101111010 O
could MD 101101111000 O
be VB 10101100 O
used VBN 1010011010 O
as IN 10111111110 O
a DT 11001 O
temporary JJ 11110111110101 O
or CC 101110110 O
a DT 11001 O
cache NN 0011111111010 O
storage NN 0011110111100 O
. . 0110 O

The DT 010000 B-Entity
data NNS 001111001 I-Entity
stored VBN 1010011101111 I-Entity
in IN 100110 I-Entity
\\.\Hd2 NN X I-Entity
is VBZ 101101010 B-Verb
encrypted VBN 10100100000 I-Verb
the DT 11010 B-Entity
same JJ 111101001 I-Entity
way NN 00101001010 I-Entity
the DT 11010 I-Entity
first JJ 1111010100 I-Entity
volume NN 00011111111 I-Entity
's POS 10111010 I-Entity
data NNS 001111001 I-Entity
. . 0110 O

Both DT 0100111111 B-Entity
volumes NNS 0011110111000 I-Entity
appear VBP 101000111111 O
to TO 101100 O
be VB 10101100 B-Verb
set VBN 000101110 I-Verb
up RP 10111111100111 I-Verb
as IN 10111111110 B-Preposition
FAT NN 00100110000 B-Entity
volumes NNS 0011110111000 I-Entity
. . 0110 O

An DT 0100011111 O
attempt NN 101000110010 O
to TO 101100 O
read VB 10101011111001 O
the DT 11010 O
data NNS 001111001 O
from IN 100101100 O
these DT 11111000 O
volumes NNS 0011110111000 O
with IN 100100 O
the DT 11010 O
code NN 001001010 O
below IN 011110101100 O
: : 0111010 O
This DT 0100010 O
will MD 10110111111 O
produce VB 1010101110100 O
the DT 11010 O
following JJ 111101000 O
results NNS 0011111011111 O
: : 0111010 O
For IN 01010010 O
\\.\Hd1 NN X O
: : 0111010 O
For IN 01010010 O
\\.\Hd2 NN X O
: : 0111010 O
The DT 010000 O
ability NN 101000110011 O
to TO 101100 O
keep VB 101010011001 B-Verb
its PRP$ 11011101 B-Entity
data NNS 001111001 I-Entity
on IN 1001010 B-Preposition
TrueCrypt-like JJ X B-Entity
volumes NNS 0011110111000 I-Entity
provides VBZ 1011111011100 O
Snake NNP 1110111110011 B-Entity
with IN 100100 O
a DT 11001 O
powerful JJ 1111000111001 O
ability NN 101000110011 O
to TO 101100 O
exchange VB 00101001000 O
data NNS 001111001 O
with IN 100100 O
the DT 11010 O
usermode NN 00101101001 O
DLL NNP 00101101110 O
, , 1011100 O
as IN 10111111110 O
these DT 11111000 O
volumes NNS 0011110111000 O
are VBP 101101001 O
accessible JJ 10100101101110 O
both CC 11111011010 O
from IN 100101100 O
usermode NN 00101101001 O
and CC 101110111 O
kernel NN 11100000111 O
mode NN 0011110111111 O
. . 0110 O

Static JJ X O
analysis NN 0001110110 O
of IN 1000 O
the DT 11010 O
code NN 001001010 O
reveals VBZ 101111101101 O
that IN 101111110 O
the DT 11010 B-Entity
Snake NNP 1110111110011 I-Entity
driver NN 00101101111 I-Entity
uses VBZ 1011111010111 B-Verb
virtual JJ 11110111110101 B-Entity
volumes NNS 0011110111000 I-Entity
to TO 101100 O
store VB 101010011011 B-Verb
its PRP$ 11011101 B-Entity
data NNS 001111001 I-Entity
and CC 101110111 I-Entity
additional JJ 111101111110110 I-Entity
files NNS 0011011110 I-Entity
on IN 1001010 B-Preposition
it PRP 101111010 B-Entity
. . 0110 O

For IN 01010010 O
example NN 000010 O
, , 1011100 O
it PRP 101111010 B-Entity
stores VBZ 101111101001 B-Verb
its PRP$ 11011101 B-Entity
message NN 001001110111 I-Entity
queue NN 00100110011 I-Entity
in IN 100110 B-Preposition
a DT 11001 B-Entity
file NN 00100100 I-Entity
called VBN 10100101000 I-Entity
: : 0111010 O
The DT 010000 O
message NN 001001110111 O
queue NN 00100110011 O
indicates VBZ 101111101100 O
an DT 11000 O
asynchronous JJ X O
communication NN 001111010000 O
model NN 001111100000 O
between IN 10010110100 O
kernel NN 11100000111 O
mode NN 0011110111111 O
driver NN 00101101111 O
and CC 101110111 O
a DT 11001 O
usermode JJ 00101101001 O
DLL NNP 00101101110 O
, , 1011100 O
e.g NNP 01110111001 O
. . 0110 O

to TO 101100 O
pass VB 101010111111101 O
commands NNS 001111101100 O
, , 1011100 O
configuration NN 00100110010 O
parameters NNS 0011111011101 O
, , 1011100 O
binary JJ 001011010100 O
images NNS 001111100010 O
of IN 1000 O
additional JJ 111101111110110 O
Snake NNP 1110111110011 O
components NNS 001111101000 O
. . 0110 O

Other JJ 0100111111 O
files NNS 0011011110 O
that WDT 101111110 O
may MD 101101111010 O
also RB 10101111110 O
be VB 10101100 O
found VBN 10100111110 O
on IN 1001010 O
the DT 11010 O
virtual JJ 11110111110101 O
volume NN 00011111111 O
are VBP 101101001 O
: : 0111010 O
klog NN X O
, , 1011100 O
conlog NN X O
, , 1011100 O
dump NN 101010111111000 O
, , 1011100 O
rknginst.exe NN X O
, , 1011100 O
where WRB 101111111110100 O
rknginst.exe NN X O
could MD 101101111000 O
be VB 10101100 O
the DT 11010 O
name NN 00111111010 O
of IN 1000 O
the DT 11010 O
original JJ 11110101111 O
dropper NN 001011010111 O
, , 1011100 O
and CC 101110111 O
other JJ 111110010 B-Entity
log NN 00100110011 I-Entity
files NNS 0011011110 I-Entity
could MD 101101111000 O
potentially RB 101011101001 O
contain VB 1010101110111 B-Verb
executed VBN 1010010111100 B-Entity
command NN 0010011100 I-Entity
outputs NNS 10101110000 I-Entity
, , 1011100 O
intercepted VBN 10100101111010 B-Verb
keystrokes NNS 10111111100011 B-Entity
, , 1011100 O
and CC 101110111 O
other JJ 111110010 O
output NN 001001110101 O
logs NNS 0011111110110 O
. . 0110 O

The DT 010000 O
64-bit JJ 1111011101110 O
version NN 00011000 O
of IN 1000 O
Snake NNP 1110111110011 O
must MD 1011011110110 O
deal VB 1010101111000 O
with IN 100100 O
a DT 11001 O
number NN 00010100 O
of IN 1000 O
additional JJ 111101111110110 O
security NN 11100011010 O
protections NNS 0011001111000 O
implemented VBN 10100101111011 O
in IN 100110 O
64-bit JJ 1111011101110 O
editions NNS X O
of IN 1000 O
Microsoft NNP 1110110111 O
Windows NNP 1110110100 O
, , 1011100 O
the DT 11010 O
most RBS 111111100 O
significant JJ 1111000110111 O
of IN 1000 O
which WDT 101111011 O
are VBP 101101001 O
kernel NN 11100000111 O
driver NN 00101101111 O
signature NN 0011110101101 O
validation NN 0001110000 O
and CC 101110111 O
Kernel NNP 111101110001 O
Patch NNP X O
Protection NNP 0111101100011 O
( NNP 01111000 O
more RBR 1111111110 O
commonly RB 1010111110011 O
known VBN 1010000110 O
as IN 10111111110 O
PatchGuard NNP X O
) NNP 011110100 O
. . 0110 O

PatchGuard NNP X O
is VBZ 101101010 O
a DT 11001 O
feature NN 001111100000 O
of IN 1000 O
64-bit JJ 1111011101110 O
Windows NNP 1110110100 O
which WDT 101111011 O
aims VBZ 101000111000 O
to TO 101100 O
prevent VB 101010011010 O
modification NN 0001110011 O
of IN 1000 O
the DT 11010 O
Windows NNP 1110110100 O
kernel NN 11100000111 O
, , 1011100 O
something NN 111100010100 O
that WDT 101111110 O
is VBZ 101101010 O
often RB 10101111111100 O
performed VBN 1010011000111 O
by IN 1001110 O
malware NN 00101100 O
attempting VBG 10100010100 O
to TO 101100 O
hide VB 101010011111 O
itself PRP 10111111100010 O
on IN 1001010 O
an DT 11000 O
infected JJ 111101111000 O
system NN 001000000 O
. . 0110 O

Although IN 010101101 O
PatchGuard NN X O
is VBZ 101101010 O
successful JJ 1111000111010 O
at IN 10011110 O
preventing VBG 10111111111100 O
kernel NN 11100000111 O
patching NN 111000111001 O
once RB 1011111001010 O
initialised VBD X O
, , 1011100 O
several JJ 111110011110 O
published VBN 1010011011011 O
bypass NN 10101000100 O
approaches NNS 001111010101 O
exist VBP 1010010111000 O
, , 1011100 O
. . 0110 O

The DT 010000 O
technique NN 001010001101 O
used VBN 1010011010 O
by IN 1001110 O
Snake NNP 1110111110011 O
appears VBZ 101000111001 O
to TO 101100 O
be VB 10101100 O
similar JJ 10100001111 O
to TO 101100 O
these DT 11111000 O
approaches NNS 001111010101 O
. . 0110 O

The DT 010000 O
driver NN 00101101111 O
signing NN 11110111110110 O
policy NN 1111001011100 O
enforced VBN X O
by IN 1001110 O
all DT 1111101100 O
64-bit JJ 1111011101110 O
versions NNS 0011010001 O
of IN 1000 O
Windows NNP 1110110100 O
from IN 100101100 O
Vista NNP 0111101101100 O
onwards NNS X O
requires VBZ 1011111001111 O
all DT 1111101100 O
kernel-mode JJ 1111011101111 O
drivers NNS 0011001111111 O
to TO 101100 O
be VB 10101100 O
signed VBN 10100100100 O
with IN 100100 O
a DT 11001 O
valid JJ 1111000111101 O
digital JJ 11110111110110 O
signature NN 0011110101101 O
. . 0110 O

The DT 010000 O
Snake NNP 1110111110011 O
dropper NN 001011010111 O
contains VBZ 1011111011111 O
both CC 11111011010 O
32-bit JJ 1111011101110 O
and CC 101110111 O
64-bit JJ 1111011101110 O
unsigned JJ 1111011101110 O
drivers NNS 0011001111111 O
, , 1011100 O
and CC 101110111 O
it PRP 101111010 B-Entity
can MD 10110111110 O
successfully RB 1010111110110 O
load VB 10101001000 B-Verb
its PRP$ 11011101 B-Entity
unsigned JJ 1111011101110 I-Entity
64-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
on IN 1001010 B-Preposition
a DT 11001 B-Entity
64-bit JJ 1111011101110 I-Entity
version NN 00011000 I-Entity
of IN 1000 I-Entity
Windows NNP 1110110100 I-Entity
XP NN 0111101101100 I-Entity
– NN 01111001100 O
as IN 10111111110 O
driver NN 00101101111 O
signing NN 11110111110110 O
is VBZ 101101010 O
not RB 1010111100 O
enforced VBN X O
it PRP 101111010 O
does VBZ 1011011100 O
not RB 1010111100 O
have VB 101101100 O
to TO 101100 O
resort VB X O
to TO 101100 O
any DT 11111011111 O
tricks NNS 0011001111010 O
under IN 10010111111110 O
this DT 110110 O
OS NN 1111011100110 O
version NN 00011000 O
. . 0110 O

In IN 0101000 O
this DT 110110 O
case NN 00001100 O
, , 1011100 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
ensure VB 1010101001 B-Verb
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 I-Entity
loaded VBN 10100100010 I-Entity
automatically RB 101011100110 I-Entity
at IN 10011110 I-Entity
startup NN 001001111010 I-Entity
, , 1011100 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
can MD 10110111110 O
install VB 10101001000 B-Verb
the DT 11010 B-Entity
64-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
on IN 1001010 B-Preposition
64-bit JJ 1111011101110 B-Entity
Windows NNP 1110110100 I-Entity
XP NN 0111101101100 I-Entity
in IN 100110 O
the DT 11010 O
same JJ 111101001 O
way NN 00101001010 O
it PRP 101111010 B-Entity
installs VBZ 101111101000 B-Verb
a DT 11001 B-Entity
32-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
on IN 1001010 B-Preposition
a DT 11001 B-Entity
32-bit JJ 1111011101110 I-Entity
version NN 00011000 I-Entity
of IN 1000 I-Entity
Windows NNP 1110110100 I-Entity
XP NN 0111101101100 I-Entity
. . 0110 O

On IN 01010011 B-Preposition
64-bit JJ 1111011101110 B-Entity
versions NNS 0011010001 I-Entity
of IN 1000 I-Entity
Windows NNP 1110110100 I-Entity
Vista NNP 0111101101100 I-Entity
and CC 101110111 I-Entity
above IN 011110101101 I-Entity
it PRP 101111010 B-Entity
behaves VBZ X B-Verb
differently RB 00110001000 B-Entity
. . 0110 O

Firstly RB 010110 O
, , 1011100 O
the DT 11010 B-Entity
64-bit JJ 1111011101110 I-Entity
unsigned JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
file NN 00100100 I-Entity
is VBZ 101101010 B-Verb
created VBN 1010011011000 I-Verb
as IN 10111111110 O
usual JJ 001011111111 O
: : 0111010 O
However RB 010110 O
, , 1011100 O
the DT 11010 O
driver NN 00101101111 O
is VBZ 101101010 O
not RB 1010111100 O
registered VBN 1010011011001 O
; : 0111100100 O
what WP 1011111111111001 O
is VBZ 101101010 B-Verb
registered VBN 1010011011001 I-Verb
instead RB 00010010 O
is VBZ 101101010 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
itself PRP 10111111100010 I-Entity
. . 0110 O

To TO 0100011010 O
do VB 10110111011 O
that DT 101111110 O
, , 1011100 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
first JJ 1111010100 O
copies NNS 101111100010 B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 O
: : 0111010 O
The DT 010000 B-Entity
dropper NN 001011010111 I-Entity
then RB 101011111110 O
registers VBZ 101111100010 B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
to TO 101100 O
ensure VB 1010101001 B-Verb
it PRP 101111010 B-Entity
starts VBZ 101111100000 I-Entity
every DT 1111101011 I-Entity
time NN 00011010 I-Entity
Windows NNP 1110110100 I-Entity
is VBZ 101101010 I-Entity
booted VBN X I-Entity
, , 1011100 O
by IN 1001110 O
creating VBG 101111111111011 O
the DT 11010 O
values NNS 0011111011110 O
: : 0111010 O
Now RB 010101100 O
comes VBZ 101111100000 O
the DT 11010 O
most RBS 111111100 O
interesting JJ 10100000101 O
part NN 00010001 O
: : 0111010 O
does VBZ 1011011100 O
the DT 11010 O
dropper NN 001011010111 O
manage VBP 10101001010 O
to TO 101100 O
load VB 10101001000 O
its PRP$ 11011101 O
64-bit JJ 1111011101110 O
unsigned JJ 1111011101110 O
driver NN 00101101111 O
under IN 10010111111110 O
64-bit JJ 1111011101110 O
versions NNS 0011010001 O
of IN 1000 O
Windows NNP 1110110100 O
Vista NNP 0111101101100 O
and CC 101110111 O
later JJ 11100110011 O
versions NNS 0011010001 O
, , 1011100 O
such JJ 101111111010 O
as IN 10111111110 O
64-bit JJ 1111011101110 O
Windows NNP 1110110100 O
7/8 CD X O
? . 0111011111010 O
The DT 010000 O
answer NN 10101010101 O
: : 0111010 O
Yes UH X O
, , 1011100 O
it PRP 101111010 O
does VBZ 1011011100 O
. . 0110 O

Does VBZ 010101101 O
it PRP 101111010 O
resort NN X O
to TO 101100 O
using VBG 100101111110 O
bootkit NN X O
technology NN 1110001101110 O
, , 1011100 O
which WDT 101111011 O
has VBZ 1011011010 O
been VBN 10101101 O
used VBN 1010011010 O
in IN 100110 O
the DT 11010 O
past NN 0010111001 O
to TO 101100 O
bypass VB 10101000100 O
protections NNS 0011001111000 O
to TO 101100 O
load VB 10101001000 O
unsigned JJ 1111011101110 O
64-bit JJ 1111011101110 O
drivers NNS 0011001111111 O
? . 0111011111010 O
The DT 010000 O
answer NN 10101010101 O
: : 0111010 O
No DT 0111101101010 O
. . 0110 O

Bootkits NNPS X O
must MD 1011011110110 O
overwrite VB 10101001010 O
the DT 11010 O
Master NNP X O
Boot NNP X O
Record NNP 001111011001 O
( NNP 01111000 O
MBR NNP 1110110000 O
) NN 011110100 O
and CC 101110111 O
antivirus NN 11101110111 O
products NNS 001100111001 O
are VBP 101101001 O
well RB 101111111011 O
trained VBN 10100110111110 O
to TO 101100 O
catch VB 101010101110 O
that DT 101111110 O
kind NN 000110010 O
of IN 1000 O
bad JJ 111101111111011 O
behavior NN 00011111000 O
. . 0110 O

The DT 010000 O
masterminds NNS X O
behind IN 1001011111011 O
Snake NNP 1110111110011 O
rootkit NN 001011010110 O
seem VBP 101000111110 O
to TO 101100 O
be VB 10101100 O
well RB 101111111011 O
aware JJ 00010000 O
of IN 1000 O
this DT 110110 O
so RB 101111111110010 O
what WP 1011111111111001 O
they PRP 10111100110 O
resorted VBD X O
to TO 101100 O
instead RB 00010010 O
is VBZ 101101010 O
leveraging VBG 111000111010 O
a DT 11001 O
vulnerability NN 001010110101 O
in IN 100110 O
a DT 11001 O
well-known JJ 1111000111001 O
virtualization NN X O
product NN 001001111010 O
called VBN 10100101000 O
VirtualBox NNP 11100000111 O
, , 1011100 O
a DT 11001 O
product NN 001001111010 O
made VBN 10100101110110 O
by IN 1001110 O
Oracle NNP 01111101011 O
which WDT 101111011 O
is VBZ 101101010 O
widely RB 1010111110011 O
used VBN 1010011010 O
by IN 1001110 O
researchers NNS 001100111000 O
to TO 101100 O
analyse VB 101010011101 O
malware NN 00101100 O
. . 0110 O

VirtualBox NN 11100000111 O
driver NN 00101101111 O
version NN 00011000 O
1.6.2 CD X O
was VBD 101101011 O
released VBN 1010011011011 O
in IN 100110 O
June NNP 01111101001 O
2 CD 0111111110100 O
, , 1011100 O
2008 CD 011111100110 O
. . 0110 O

Two CD 0100111110 O
months NNS 0011010100 O
later RB 11100110011 O
, , 1011100 O
in IN 100110 O
August NNP 01111101001 O
2008 CD 011111100110 O
, , 1011100 O
security NN 11100011010 O
researchers NNS 001100111000 O
reported VBD 101001111001 O
that IN 101111110 O
its PRP$ 11011101 O
main JJ 11110101101 O
driver NN 00101101111 O
component NN 00101000011 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
signed VBN 10100100100 O
under IN 10010111111110 O
the DT 11010 O
entity NN 001010110000 O
'' '' 0111101110 O
innotek FW X O
Gmbh FW X O
'' '' 0111101110 O
, , 1011100 O
contained VBD 1011111001101 O
a DT 11001 O
privilege NN 111000110010 O
escalation NN 111000110011 O
vulnerability NN 001010110101 O
. . 0110 O

In IN 0101000 O
a DT 11001 O
nutshell NN X O
, , 1011100 O
the DT 11010 O
VirtualBox NNP 11100000111 O
software NN 001100111011 O
installs VBZ 101111101000 O
a DT 11001 O
driver NN 00101101111 O
called VBN 10100101000 O
VBoxDrv NNP X O
. . 0110 O

The DT 010000 O
driver NN 00101101111 O
is VBZ 101101010 O
controlled VBN 1010011000111 O
with IN 100100 O
the DT 11010 O
Input/Ouput NNP X O
Control NNP 1110001011 O
Codes NNS X O
( VBP 01111000 O
32-bit JJ 1111011101110 O
values NNS 0011111011110 O
called VBN 10100101000 O
IOCTL FW 111101111111010 O
) FW 011110100 O
passed VBN 10100110111011 O
along IN 10100100110 O
DeviceIoControl NNP X O
( NNP 01111000 O
) NNP 011110100 O
API NNP 0111101101101 O
. . 0110 O

One CD 010011101 O
of IN 1000 O
the DT 11010 O
documented JJ 101001110011 O
transfer NN 10101011111001 O
methods NNS 0011001111000 O
that IN 101111110 O
the DT 11010 O
system NN 001000000 O
uses VBZ 1011111010111 O
to TO 101100 O
pass VB 101010111111101 O
data NNS 001111001 O
between IN 10010110100 O
the DT 11010 O
caller NN X O
of IN 1000 O
DeviceIoControl NNP X O
( NNP 01111000 O
) NNP 011110100 O
API NNP 0111101101101 O
and CC 101110111 O
the DT 11010 O
driver NN 00101101111 O
itself PRP 10111111100010 O
is VBZ 101101010 O
called VBN 10100101000 O
METHODNEITHER NN X O
. . 0110 O

As IN 01010100 O
per FW 011110011100 O
MSDN FW X O
documentation NN 0001110101 O
, , 1011100 O
METHODNEITHER NN X O
is VBZ 101101010 O
a DT 11001 O
special JJ 111100001101 O
transfer NN 10101011111001 O
type NN 000110011 O
when WRB 100101110010 O
Input/Output NNP X O
Request NNP 001111010100 O
Packet NNP 0111101101010 O
( NNP 01111000 O
IRP NNP X O
) NNP 011110100 O
supplies VBZ 1010010111001 O
the DT 11010 O
user-mode JJ 0010111000 O
virtual JJ 11110111110101 O
addresses NNS 00111001 O
of IN 1000 O
the DT 11010 O
input NN 11100000000 O
and CC 101110111 O
output NN 001001110101 O
buffers NNS X O
, , 1011100 O
without IN 100101110011 O
validating VBG X O
or CC 101110110 O
mapping VBG 01111011001101 O
them PRP 1011111110000 O
. . 0110 O

It PRP 01001010 O
is VBZ 101101010 O
the DT 11010 O
responsibility NN 10101011000 O
of IN 1000 O
the DT 11010 O
driver NN 00101101111 O
to TO 101100 O
validate VB 101010011111 O
the DT 11010 O
addresses NNS 00111001 O
sent VBN 10100110111011 O
from IN 100101100 O
user NN 0010000110 O
mode NN 0011110111111 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
make VB 101010011000 O
sure JJ 101000001110 O
those DT 111101111110111 O
addresses NNS 00111001 O
are VBP 101101001 O
valid JJ 1111000111101 O
usermode JJ 00101101001 O
addresses NNS 00111001 O
. . 0110 O

The DT 010000 O
source NN 00100110111 O
code NN 001001010 O
of IN 1000 O
the DT 11010 O
vulnerable JJ 1111011101110 O
driver NN 00101101111 O
( NN 01111000 O
shown VBN 101001110001 O
below IN 011110101100 O
) NN 011110100 O
demonstrates VBZ 101111101100 O
how WRB 1011111111111000 O
the DT 11010 O
integer NN 11100100010 O
value NN 001111111000 O
of IN 1000 O
the DT 11010 O
rc NN X O
variable NN 111000110011 O
is VBZ 101101010 O
first RB 1111010100 O
derived VBN 10101110001 O
from IN 100101100 O
the DT 11010 O
input NN 11100000000 O
parameters NNS 0011111011101 O
pDevObj FW X O
( FW 01111000 O
device NN 1111011101111 O
object NN 11100100011 O
) NN 011110100 O
and CC 101110111 O
pIrp FW X O
( FW 01111000 O
request NN 001111010100 O
packet NN 11100100011 O
) NN 011110100 O
. . 0110 O

Next NNP 010110 O
, , 1011100 O
that IN 101111110 O
integer NN 11100100010 O
value NN 001111111000 O
is VBZ 101101010 O
written VBN 10100110111110 O
into IN 10010111100 O
the DT 11010 O
UserBuffer NNP X O
- : 01111001101 O
an DT 11000 O
arbitrary JJ 111101111110100 O
address NN 00111000 O
, , 1011100 O
pointed VBN 10100010000 O
by IN 1001110 O
the DT 11010 O
input NN 11100000000 O
parameter NN 001111111001 O
pIrp FW X O
( FW 01111000 O
request NN 001111010100 O
packet NN 11100100011 O
) NN 011110100 O
. . 0110 O

As IN 01010100 O
there EX 10111100101 O
are VBP 101101001 O
no DT 11111011101 O
validations NNS X O
made VBN 10100101110110 O
for IN 10011111 O
the DT 11010 O
UserBuffer NNP X O
an DT 11000 B-Entity
attacker NN 00101111100 I-Entity
can MD 10110111110 O
craft VB X B-Verb
such JJ 101111111010 B-Entity
input NN 11100000000 I-Entity
parameters NNS 0011111011101 I-Entity
that WDT 101111110 I-Entity
will MD 10110111111 I-Entity
define VB 1010101110111 I-Entity
address NN 00111000 I-Entity
within IN 100101111100 I-Entity
kernel NN 11100000111 I-Entity
memory NN 00100011100 I-Entity
to TO 101100 I-Entity
patch NN 00100011000 I-Entity
and CC 101110111 I-Entity
the DT 11010 I-Entity
data NNS 001111001 I-Entity
to TO 101100 I-Entity
patch NN 00100011000 I-Entity
it PRP 101111010 I-Entity
with IN 100100 O
: : 0111010 O
Now RB 010101100 O
that IN 101111110 O
the DT 11010 B-Entity
vulnerable JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
used VBN 1010011010 I-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
weapon NN 00101001101 I-Entity
to TO 101100 I-Entity
patch NN 00100011000 I-Entity
kernel NN 11100000111 I-Entity
memory NN 00100011100 I-Entity
, , 1011100 O
all PDT 1111101100 O
the DT 11010 O
malware NN 00101100 O
needs VBZ 10100010011 O
to TO 101100 O
do VB 10110111011 O
is VBZ 101101010 O
to TO 101100 O
patch NN 00100011000 O
the DT 11010 O
content NN 001111100110 O
of IN 1000 O
the DT 11010 O
variable JJ 111000110011 O
nt NN X O
! . 01110111111110 O
gCiEnabled VBN X O
, , 1011100 O
a DT 11001 O
boolean JJ X O
variable NN 111000110011 O
'' '' 0111101110 O
Code NNP 0111101101100 O
Integrity NNP X O
Enabled NNP X O
'' '' 0111101110 O
that IN 101111110 O
marks NNS 001111011000 O
whether IN 1011111111111010 O
the DT 11010 O
system NN 001000000 O
was VBD 101101011 O
booted VBN X O
in IN 100110 O
WinPE NN X O
mode NN 0011110111111 O
. . 0110 O

When WRB 0101011101 O
running VBG 10100101111101 O
in IN 100110 O
WinPE NN X O
mode NN 0011110111111 O
there EX 10111100101 O
is VBZ 101101010 O
no DT 11111011101 O
Code NNP 0111101101100 O
Integrity NNP X O
control NN 111000100 O
, , 1011100 O
therefore RB 101011101001 O
by IN 1001110 O
enabling VBG 10111111111100 O
this DT 110110 O
mode NN 0011110111111 O
by IN 1001110 O
patching VBG 111000111001 O
only RB 10101110010 O
one CD 111110100 O
bit NN 11100101101 O
, , 1011100 O
Code NNP 0111101101100 B-Entity
Integrity NNP X I-Entity
verification NN 001011010110 I-Entity
is VBZ 101101010 B-Verb
disabled JJ 10100101111010 I-Verb
so IN 101111111110010 O
that IN 101111110 O
the DT 11010 B-Entity
unsigned JJ 1111011101110 I-Entity
64-bit JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
can MD 10110111110 O
be VB 10101100 B-Verb
loaded VBN 10100100010 I-Verb
. . 0110 O

This DT 0100010 O
variable NN 111000110011 O
is VBZ 101101010 O
used VBN 1010011010 O
within IN 100101111100 O
the DT 11010 O
function NN 001010110111 O
SepInitializeCodeIntegrity NNP X O
( NNP 01111000 O
) NNP 011110100 O
, , 1011100 O
implemented VBN 10100101111011 O
within IN 100101111100 O
CI.dll NN X O
's POS 10111010 O
function NN 001010110111 O
CiInitialize NNP X O
( NNP 01111000 O
) NNP 011110100 O
and CC 101110111 O
imported VBN 10100100010 O
by IN 1001110 O
the DT 11010 O
NT NNP 0111101101100 O
core NN 00011111011 O
( NNP 01111000 O
ntoskrnl.exe NNP X O
) NNP 011110100 O
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
find VB 10101000101 O
the DT 11010 O
variable NN 111000110011 O
in IN 100110 O
kernel NN 11100000111 O
memory NN 00100011100 O
, , 1011100 O
the DT 11010 B-Entity
Snake NNP 1110111110011 I-Entity
dropper NN 001011010111 I-Entity
loads NNS 101111101000 B-Verb
a DT 11001 B-Entity
copy NN 0001011111 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
NT NN 0111101101100 I-Entity
core NN 00011111011 I-Entity
image NN 00100110000 I-Entity
( NNP 01111000 I-Entity
ntoskrnl.exe NNP X I-Entity
) NNP 011110100 I-Entity
, , 1011100 O
locates VBZ 101111101000 B-Verb
the DT 11010 B-Entity
import NN 1111111010 I-Entity
of IN 1000 I-Entity
CI.dll NN X I-Entity
's POS 10111010 I-Entity
function NN 001010110111 I-Entity
CiInitialize NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
SepInitializeCodeIntegrity NNP X B-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
within IN 100101111100 I-Entity
it PRP 101111010 I-Entity
. . 0110 O

Then RB 010101100 O
it PRP 101111010 B-Entity
parses VBZ 101111101001 B-Verb
the DT 11010 B-Entity
function NN 001010110111 I-Entity
's POS 10111010 I-Entity
code NN 001001010 I-Entity
to TO 101100 B-Preposition
locate VB 101010011101 B-Entity
the DT 11010 I-Entity
offset VBN 0011010110 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
variable NN 111000110011 I-Entity
. . 0110 O

Once RB 0101011101 O
located JJ 101001110101 O
, , 1011100 O
the DT 11010 O
content NN 001111100110 O
of IN 1000 O
the DT 11010 O
variable JJ 111000110011 O
nt NN X O
! . 01110111111110 O
gCiEnabled VBN X O
is VBZ 101101010 O
patched VBN 101001100111 O
in IN 100110 O
kernel NN 11100000111 O
memory NN 00100011100 O
and CC 101110111 O
the DT 11010 B-Entity
64-bit JJ 1111011101110 I-Entity
unsigned JJ 1111011101110 I-Entity
driver NN 00101101111 I-Entity
is VBZ 101101010 B-Verb
loaded VBN 10100100010 I-Verb
. . 0110 O

This DT 0100010 O
explains VBZ 1011111011110 O
why WRB 1011111111111011 O
Snake NNP 1110111110011 B-Entity
dropper NN 001011010111 I-Entity
registers VBZ 101111100010 B-Verb
itself PRP 10111111100010 B-Entity
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
service NN 001001111110 I-Entity
to TO 101100 O
start VB 101010111111000 B-Verb
each DT 1111101010 B-Entity
time NN 00011010 I-Entity
Windows NNP 1110110100 I-Entity
starts VBZ 101111100000 I-Entity
: : 0111010 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
install VB 10101001000 B-Verb
the DT 11010 B-Entity
vulnerable JJ 1111011101110 I-Entity
VBox NN X I-Entity
driver NN 00101101111 I-Entity
first RB 1111010100 O
, , 1011100 O
then RB 101011111110 O
pass VB 101010111111101 O
it PRP 101111010 O
a DT 11001 O
malformed JJ X O
structure NN 001111100010 O
to TO 101100 O
disable VB 101010011010 B-Verb
Code NNP 0111101101100 B-Entity
Integrity NNP X I-Entity
control NN 111000100 I-Entity
with IN 100100 B-Preposition
a DT 11001 B-Entity
DeviceIoControl NNP X I-Entity
( NNP 01111000 I-Entity
) NNP 011110100 I-Entity
API NNP 0111101101101 I-Entity
call NN 10101010101 I-Entity
, , 1011100 O
and CC 101110111 O
finally RB 1010111011110 O
, , 1011100 O
load VBP 10101001000 B-Verb
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
. . 0110 O

In IN 0101000 O
order NN 0000011 O
to TO 101100 O
be VB 10101100 O
able JJ 10100010110 O
to TO 101100 O
perform VB 101010011011 O
the DT 11010 O
steps NNS 0011111011010 O
above RB 011110101101 O
, , 1011100 O
the DT 11010 B-Entity
dropper NN 001011010111 I-Entity
must MD 1011011110110 O
first RB 1111010100 O
obtain VB 10101000110 B-Verb
Administrator NNP X B-Entity
privileges NNS 0011110101111 I-Entity
. . 0110 O

It PRP 01001010 B-Entity
attempts VBZ 101000111010 O
to TO 101100 O
do VB 10110111011 O
this DT 110110 O
by IN 1001110 O
running VBG 10100101111101 B-Verb
MS09-025 NN X B-Entity
and CC 101110111 I-Entity
MS10-015 NN X I-Entity
exploits NNS 0011001111101 I-Entity
on IN 1001010 B-Preposition
the DT 11010 B-Entity
target NN 111101111010 I-Entity
system NN 001000000 I-Entity
. . 0110 O

These DT 010011110 O
exploits NNS 0011001111101 O
are VBP 101101001 O
bundled VBN 101001011111110 O
within IN 100101111100 O
the DT 11010 O
dropper NN 001011010111 O
in IN 100110 O
its PRP$ 11011101 O
resource NN 001001111001 O
section NN 0011111111110 O
as IN 10111111110 O
executable JJ 001001111100 O
files NNS 0011011110 O
. . 0110 O

Other JJ 0100111111 O
resources NNS 001100011010 O
embedded VBN 1111011101000 O
within IN 100101111100 O
the DT 11010 O
dropper NN 001011010111 O
are VBP 101101001 O
the DT 11010 O
32-bit JJ 1111011101110 O
and CC 101110111 O
64-bit JJ 1111011101110 O
builds NNS X O
of IN 1000 O
its PRP$ 11011101 O
driver NN 00101101111 O
, , 1011100 O
a DT 11001 B-Entity
tool NN 001010001110 I-Entity
for IN 10011111 O
creating VBG 101111111111011 B-Verb
NTFS NN 11110111110101 B-Entity
file NN 00100100 I-Entity
systems NNS 00110011000 I-Entity
, , 1011100 O
and CC 101110111 O
the DT 11010 B-Entity
initial JJ 111101111111101 I-Entity
message NN 001001110111 I-Entity
queue NN 00100110011 I-Entity
file NN 00100100 I-Entity
which WDT 101111011 O
is VBZ 101101010 B-Verb
written VBN 10100110111110 I-Verb
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
virtual JJ 11110111110101 I-Entity
volume NN 00011111111 I-Entity
. . 0110 O

The DT 010000 O
message NN 001001110111 O
queue NN 00100110011 O
file NN 00100100 O
contains VBZ 1011111011111 O
configuration NN 00100110010 O
data NNS 001111001 O
and CC 101110111 O
the DT 11010 O
libraries NNS 0011001101111 B-Entity
that WDT 101111110 O
will MD 10110111111 O
be VB 10101100 B-Verb
injected VBN 10100100010 I-Verb
into IN 10010111100 B-Preposition
usermode NN 00101101001 B-Entity
processes NNS 0011001111110 I-Entity
. . 0110 O

The DT 010000 B-Entity
usermode JJ 00101101001 I-Entity
DLLs NNS 001111100100 I-Entity
injected VBN 10100100010 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
kernel-mode JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
userland NN 111101111111111 I-Entity
system NN 001000000 I-Entity
process NN 001001111011 I-Entity
( FW 01111000 O
e.g FW 01110111001 O
. . 0110 O

explorer.exe FW 111011111110 O
) FW 011110100 O
are VBP 101101001 O
: : 0111010 O
The DT 010000 B-Entity
rkctlWin32.dll/rkctlx64.dll NN X I-Entity
module NN 00101101100 I-Entity
uses VBZ 1011111010111 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
hard-coded JJ 1111011101011 I-Entity
named VBN 10100101001 I-Entity
pipe NN 0010111001 I-Entity
for IN 10011111 B-Preposition
communications NNS 00111101001110 B-Entity
: : 0111010 O
The DT 010000 B-Entity
remote JJ 11110111111100 I-Entity
commands NNS 001111101100 I-Entity
it PRP 101111010 B-Entity
receives VBZ 101111101001 B-Verb
appear VBP 101000111111 O
to TO 101100 O
be VB 10101100 O
designed VBN 10100010111 O
to TO 101100 O
control VB 111000100 B-Verb
other JJ 111110010 B-Entity
components NNS 001111101000 I-Entity
of IN 1000 I-Entity
Snake NNP 1110111110011 I-Entity
: : 0111010 O
The DT 010000 O
injsnakeWin32.dll/injsnakex64.dll NN X O
module NN 00101101100 O
exports VBZ 001111010101 O
61 CD 0111111111111 O
functions NNS 0011111011011 O
. . 0110 O

It PRP 01001010 O
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
perform VB 101010011011 O
the DT 11010 O
high-level JJ 1111000111110 O
tasks NNS 0011001101001 O
such JJ 101111111010 O
as IN 10111111110 O
: : 0111010 O
When WRB 0101011101 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
activates VBZ 1011111001010 B-Verb
, , 1011100 O
it PRP 101111010 B-Entity
reads VBZ 101111101000 B-Verb
configuration NN 00100110010 B-Entity
parameters NNS 0011111011101 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
configuration NN 00100110010 I-Entity
queue NN 00100110011 I-Entity
, , 1011100 O
that IN 101111110 O
the DT 11010 B-Entity
driver NN 00101101111 I-Entity
creates VBZ 1011111010110 B-Verb
on IN 1001010 B-Preposition
a DT 11001 B-Entity
virtual JJ 11110111110101 I-Entity
volume NN 00011111111 I-Entity
. . 0110 O

One CD 010011101 O
of IN 1000 O
the DT 11010 O
parameters NNS 0011111011101 O
defines VBZ 10010111111110 O
the DT 11010 B-Entity
pipe NN 0010111001 I-Entity
name NN 00111111010 I-Entity
( CD 01111000 I-Entity
s NN 0111011010 I-Entity
) NN 011110100 I-Entity
that IN 101111110 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
should MD 1011011110111 O
use VB 10101011100 B-Verb
for IN 10011111 B-Preposition
its PRP$ 11011101 B-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

The DT 010000 B-Entity
remote JJ 11110111111100 I-Entity
commands NNS 001111101100 I-Entity
received VBN 10100101101101 B-Verb
by IN 1001110 O
this DT 110110 B-Entity
Snake NNP 1110111110011 I-Entity
DLL NNP 00101101110 I-Entity
module NN 00101101100 I-Entity
are VBP 101101001 O
designed VBN 10100010111 O
to TO 101100 O
set VB 000101110 O
up RP 10111111100111 O
various JJ 111110011100 O
communication NN 001111010000 O
parameters NNS 0011111011101 O
: : 0111010 O
To TO 0100011010 O
post VB 001010111101 B-Verb
the DT 11010 B-Entity
data NNS 001111001 I-Entity
, , 1011100 O
the DT 11010 B-Entity
DLL NNP 00101101110 I-Entity
can MD 10110111110 O
use VB 10101011100 O
the DT 11010 O
following JJ 111101000 O
User-Agent JJ 001111100111 O
string NN 001001110110 O
'' '' 0111101110 O
Mozilla/4.0 FW 01110111100 O
( FW 01111000 O
compatible JJ 0111011010 O
; : 0111100100 O
MSIE NN 01111001010 O
6.0 CD 01111001011 O
) NN 011110100 O
'' '' 0111101110 O
. . 0110 O

It PRP 01001010 B-Entity
may MD 101101111010 O
rely VB 10100101011 B-Verb
on IN 1001010 I-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
Internet NNP 0010111010 I-Entity
Media NNP 0111101100101 I-Entity
types NNS 0011010000 I-Entity
( NNP 01111000 I-Entity
MIME NNP 111110011100 I-Entity
types NNS 0011010000 I-Entity
) NN 011110100 I-Entity
for IN 10011111 B-Preposition
data NNS 001111001 B-Entity
exfiltration NN 1110001101111 I-Entity
: : 0111010 O
Request NN 001111010100 B-Entity
type NN 000110011 I-Entity
it PRP 101111010 B-Entity
uses VBZ 1011111010111 B-Verb
can MD 10110111110 O
either RB 1010111011100 O
be VB 10101100 B-Verb
POST NN 111101101011 B-Entity
of IN 1000 O
GET VB 111101101011 B-Entity
, , 1011100 O
and CC 101110111 O
C NN 011100111 B-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
resource NN 001001111001 I-Entity
name NN 00111111010 I-Entity
is VBZ 101101010 B-Verb
/default.asp NNP X B-Entity
. . 0110 O

One CD 010011101 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
Snake NNP 1110111110011 I-Entity
components NNS 001111101000 I-Entity
that WDT 101111110 O
could MD 101101111000 O
have VB 101101100 O
been VBN 10101101 B-Verb
downloaded VBN 10100101101111 I-Verb
from IN 100101100 B-Preposition
a DT 11001 B-Entity
remote JJ 11110111111100 I-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
, , 1011100 O
was VBD 101101011 B-Verb
identified VBN 1010011111111 I-Verb
as IN 10111111110 B-Preposition
a DT 11001 B-Entity
network NN 001000010 I-Entity
reconnaissance NN 111000111001 I-Entity
tool NN 001010001110 I-Entity
. . 0110 O

When WRB 0101011101 B-Preposition
run VBN 101010111111100 B-Entity
as IN 10111111110 I-Entity
a DT 11001 I-Entity
command NN 0010011100 I-Entity
line NN 01111001011 I-Entity
tool NN 001010001110 I-Entity
, , 1011100 O
with IN 100100 O
its PRP$ 11011101 O
logic NN 000101100 O
defined VBN 101001100110 O
with IN 100100 O
the DT 11010 O
command NN 0010011100 O
line NN 01111001011 O
switches VBZ 001111011011 O
, , 1011100 O
this DT 110110 B-Entity
tool NN 001010001110 I-Entity
enumerates VBZ 101111101010 B-Verb
other JJ 111110010 B-Entity
network NN 001000010 I-Entity
hosts NNS 001100110010 I-Entity
and CC 101110111 O
detects VBZ 101111101000 B-Verb
what WP 1011111111111001 B-Entity
Windows NNP 1110110100 I-Entity
RPC NNP 0111101101101 I-Entity
services NNS 001100011011 I-Entity
are VBP 101101001 I-Entity
enabled VBN 1010010111100 I-Entity
at IN 10011110 I-Entity
the DT 11010 I-Entity
endpoints NNS 00100001111 I-Entity
. . 0110 O

It PRP 01001010 O
carries VBZ X O
a DT 11001 B-Entity
list NN 0001011110 I-Entity
of IN 1000 I-Entity
interface NN 0011110111010 I-Entity
identifiers NNS 00111111000 I-Entity
associated VBN 10100100101 B-Verb
with IN 100100 B-Preposition
the DT 11010 B-Entity
named VBN 10100101001 I-Entity
pipes NNS 0010111001 I-Entity
. . 0110 O

It PRP 01001010 B-Entity
then RB 101011111110 O
uses VBZ 1011111010111 O
these DT 11111000 O
identifiers NNS 00111111000 O
to TO 101100 O
write VB 10101011111001 B-Verb
a DT 11001 B-Entity
message NN 001001110111 I-Entity
to TO 101100 B-Preposition
and CC 101110111 O
read VB 10101011111001 B-Verb
a DT 11001 B-Entity
message NN 001001110111 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
associated VBN 10100100101 I-Entity
named VBN 10100101001 I-Entity
pipes NNS 0010111001 I-Entity
. . 0110 O

By IN 010001100 O
knowing VBG 10111111111100 O
what WP 1011111111111001 O
RPC NNP 0111101101101 O
services NNS 001100011011 O
are VBP 101101001 O
running VBG 10100101111101 O
, , 1011100 O
it PRP 101111010 B-Entity
can MD 10110111110 O
successfully RB 1010111110110 O
fingerprint NN 00111111001 B-Verb
all DT 1111101100 B-Entity
network NN 001000010 I-Entity
hosts NNS 001100110010 I-Entity
by IN 1001110 B-Preposition
mimicking VBG X B-Entity
the DT 11010 I-Entity
Metasploit NNP 111011111101 I-Entity
's POS 10111010 I-Entity
logic NN 000101100 I-Entity
of IN 1000 I-Entity
OS NNP 1111011100110 I-Entity
fingerprinting VBG 001111011011 I-Entity
via IN 100101111011 I-Entity
SMB NNP 111101101010 I-Entity
. . 0110 O

The DT 010000 O
fingerprinting NN 001111011011 O
allows VBZ 101111100100 O
it PRP 101111010 B-Entity
to TO 101100 O
reveal VB 101010101110 B-Verb
the DT 11010 B-Entity
following JJ 111101000 I-Entity
characteristics NNS 0011111011101 I-Entity
for IN 10011111 B-Preposition
each DT 1111101010 B-Entity
host NN 00100001111 I-Entity
found VBN 10100111110 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
network NN 001000010 I-Entity
: : 0111010 O
The DT 010000 B-Entity
data NNS 001111001 I-Entity
it PRP 101111010 O
retrieves VBZ 101111101001 O
is VBZ 101101010 B-Verb
encrypted VBN 10100100000 I-Verb
and CC 101110111 O
saved VBN 10100110111111 B-Verb
into IN 10010111100 B-Preposition
a DT 11001 B-Entity
configuration NN 00100110010 I-Entity
file NN 00100100 I-Entity
% NN 011100000 I-Entity
system NN 001000000 I-Entity
% NN 011100000 I-Entity
\vtmon.bin NN X I-Entity
. . 0110 O

This DT 0100010 B-Entity
file NN 00100100 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
further RB 11110111111001 I-Verb
encrypted VBN 10100100000 I-Verb
with IN 100100 B-Preposition
an DT 11000 B-Entity
NTL-based JJ X I-Entity
( NN 01111000 I-Entity
Number NNP 01110110111 I-Entity
Theory NNP X I-Entity
Library NNP 011110110000 I-Entity
) NNP 011110100 I-Entity
algorithm NN 0011111111000 I-Entity
and CC 101110111 O
is VBZ 101101010 B-Verb
uploaded VBN 1010011011100 I-Verb
by IN 1001110 B-Preposition
the DT 11010 B-Entity
usermode-centric JJ 1110110000 I-Entity
Snake NNP 1110111110011 I-Entity
rootkit NN 001011010110 I-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
C NN 011100111 I-Entity
& CC 01110010 I-Entity
C NN 011100111 I-Entity
server NN 00111011 I-Entity
, , 1011100 O
along IN 10100100110 B-Preposition
with IN 100100 I-Preposition
other JJ 111110010 B-Entity
configuration NN 00100110010 I-Entity
files NNS 0011011110 I-Entity
, , 1011100 I-Entity
such JJ 101111111010 I-Entity
as IN 10111111110 I-Entity
mtmon.sdb NN X I-Entity
, , 1011100 I-Entity
mtmon32.sdb NN X I-Entity
, , 1011100 I-Entity
gstatsnd.bin NN X I-Entity
, , 1011100 I-Entity
gstat.bin NN X I-Entity
, , 1011100 I-Entity
gstat32.bin NN X I-Entity
, , 1011100 I-Entity
and CC 101110111 I-Entity
other JJ 111110010 I-Entity
log NN 00100110011 I-Entity
files NNS 0011011110 I-Entity
found VBN 10100111110 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
% NN 011100000 I-Entity
windows NNS 111000110011 I-Entity
% NN 011100000 I-Entity
\ CD 0111011010 I-Entity
$ $ 0111111111110 I-Entity
NtUninstallQ FW X I-Entity
[ FW 01110111000 I-Entity
random JJ 1111000111101 I-Entity
] NN 01110111010 I-Entity
$ $ 0111111111110 I-Entity
directory NN 0011111111101 I-Entity
. . 0110 O

By IN 010001100 O
using VBG 100101111110 O
this DT 110110 O
function NN 001010110111 O
the DT 11010 B-Entity
remote JJ 11110111111100 I-Entity
attacker NN 00101111100 I-Entity
can MD 10110111110 O
identify VB 101010011101 B-Verb
any DT 11111011111 B-Entity
potentially RB 101011101001 I-Entity
exploitable JJ X I-Entity
hosts NNS 001100110010 I-Entity
located JJ 101001110101 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
same JJ 111101001 I-Entity
network NN 001000010 I-Entity
as IN 10111111110 I-Entity
the DT 11010 I-Entity
victim NN 111101111011 I-Entity
. . 0110 O

The DT 010000 B-Entity
attacker NN 00101111100 I-Entity
may MD 101101111010 O
then RB 101011111110 O
craft VB X O
an DT 11000 O
exploit VB 001010111010 O
against IN 10010110111 O
those DT 111101111110111 O
hosts NNS 001100110010 O
, , 1011100 O
possibly RB 1010111010111 O
by IN 1001110 O
using VBG 100101111110 O
the DT 11010 O
Metasploit NNP 111011111101 O
framework NN 001010001111 O
, , 1011100 O
and CC 101110111 O
then RB 101011111110 O
deliver VB 101010011111 B-Verb
the DT 11010 B-Entity
generated VBN 101001100010 I-Entity
shellcode NN 001011111100 I-Entity
back RB 101000110111 B-Preposition
to TO 101100 I-Preposition
the DT 11010 B-Entity
reconnaissance NN 111000111001 I-Entity
tool NN 001010001110 I-Entity
to TO 101100 B-Preposition
be VB 10101100 B-Entity
applied VBN 10100001001 I-Entity
against IN 10010110111 I-Entity
the DT 11010 I-Entity
identified VBN 1010011111111 I-Entity
hosts NNS 001100110010 I-Entity
by IN 1001110 I-Entity
running VBG 10100101111101 I-Entity
the DT 11010 I-Entity
tool NN 001010001110 I-Entity
with IN 100100 I-Entity
the DT 11010 I-Entity
'expos NNS X I-Entity
' POS 0111101010 I-Entity
switch NN 101000110000 I-Entity
. . 0110 O

If IN 0101011100 O
the DT 11010 B-Entity
tool NN 001010001110 I-Entity
successfully RB 1010111110110 O
delivers VBZ 1011111001011 B-Verb
the DT 11010 B-Entity
payload NN 001001111000 I-Entity
and CC 101110111 O
exploits VBZ 0011001111101 B-Verb
the DT 11010 B-Entity
remote JJ 11110111111100 I-Entity
host NN 00100001111 I-Entity
( CD 01111000 I-Entity
s NN 0111011010 I-Entity
) NN 011110100 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
will MD 10110111111 O
replicate VB X B-Verb
the DT 11010 B-Entity
infection NN 0010101110111 I-Entity
across IN 10010111111101 B-Preposition
the DT 11010 B-Entity
network NN 001000010 I-Entity
, , 1011100 O
taking VBG 11111011011 B-Verb
control NN 111000100 I-Verb
over IN 10010110101 B-Preposition
new JJ 11110000010 B-Entity
hosts NNS 001100110010 I-Entity
, , 1011100 O
thus RB 1010111010111 O
repeating VBG X B-Verb
the DT 11010 B-Entity
infection NN 0010101110111 I-Entity
cycle NN 11100101010 I-Entity
all DT 1111101100 B-Entity
over IN 10010110101 I-Entity
again RB 1010010111001 I-Entity
and CC 101110111 O
spreading VBG 1011111111111011 B-Verb
the DT 11010 B-Entity
infection NN 0010101110111 I-Entity
further RB 11110111111001 B-Entity
. . 0110 O

Unlike IN 010101101 O
traditional JJ 1111001011000 O
worm NN 001010001100 O
techniques NNS 0011001111010 O
, , 1011100 O
this DT 110110 O
process NN 001001111011 O
is VBZ 101101010 O
rather RB 011110011101 O
manual JJ 1111000110110 O
, , 1011100 O
but CC 10111111111000 O
its PRP$ 11011101 O
danger NN 101000110000 O
is VBZ 101101010 O
in IN 100110 O
the DT 11010 O
fact NN 00001101 O
that IN 101111110 O
the DT 11010 B-Entity
attacker NN 00101111100 I-Entity
can MD 10110111110 O
flexibly RB X O
craft VB X O
new JJ 11110000010 O
attack NN 00101011100 O
methods NNS 0011001111000 O
, , 1011100 O
adjusting VBG X B-Verb
them PRP 1011111110000 B-Entity
to TO 101100 B-Preposition
the DT 11010 B-Entity
hosts NNS 001100110010 I-Entity
present JJ 101001011111111 I-Entity
within IN 100101111100 I-Entity
the DT 11010 I-Entity
network NN 001000010 I-Entity
, , 1011100 O
thus RB 1010111010111 O
preying VBG X O
on IN 1001010 O
the DT 11010 O
weakest JJS X O
( NN 01111000 O
least RBS 011110111111 O
updated VBN 101001011111110 O
, , 1011100 O
most RBS 111111100 O
vulnerable JJ 1111011101110 O
) NN 011110100 O
victims NNS 00110010110 O
along IN 10100100110 O
its PRP$ 11011101 O
path NN 000110111 O
. . 0110 O

As IN 01010100 O
seen VBN 101001110010 O
from IN 100101100 O
the DT 11010 O
check-in NN 11110110010 O
logs NNS 0011111110110 O
found VBN 10100111110 O
within IN 100101111100 O
one CD 111110100 O
of IN 1000 O
the DT 11010 O
recent JJ 111100001001 O
samples NNS 0011011100 O
, , 1011100 O
the DT 11010 O
time NN 00011010 O
span NN X O
covers VBZ 1011111001101 O
almost RB 11111011011 O
6 CD 01111111101100 O
years NNS 0011010101 O
from IN 100101100 O
January NNP 01111101001 O
2007 CD 01111110010 O
till IN 100101110000 O
December NNP 01111101001 O
2012 CD 011111100111 O
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
aligned VBN X O
with IN 100100 O
the DT 11010 O
first JJ 1111010100 O
reports NNS 001111101010 O
of IN 1000 O
Agent.BTZ NN 01111110111 O
. . 0110 O

It PRP 01001010 O
's VBZ 10111010 O
worth JJ 1111111101 O
noting VBG 101001111010 O
that IN 101111110 O
Agent.BTZ NN 01111110111 B-Entity
used VBD 1010011010 B-Verb
the DT 11010 B-Entity
same JJ 111101001 I-Entity
XOR NN 1111011100101 I-Entity
key NN 001111111010 I-Entity
for IN 10011111 B-Preposition
its PRP$ 11011101 B-Entity
logs NNS 0011111110110 I-Entity
as IN 10111111110 O
the DT 11010 O
most RBS 111111100 O
recent JJ 111100001001 O
variants NNS 00110100111 O
: : 0111010 O
Log VB 01110111101111 B-Entity
files NNS 0011011110 I-Entity
created VBN 1010011011000 B-Verb
by IN 1001110 O
the DT 11010 B-Entity
latest JJS 11110101110 I-Entity
samples NNS 0011011100 I-Entity
of IN 1000 I-Entity
Snake NNP 1110111110011 I-Entity
, , 1011100 O
compiled VBN 1010011011010 O
in IN 100110 O
2013 CD 0111111000 O
and CC 101110111 O
2014 CD 0111111000 O
, , 1011100 O
were VBD 101101000 O
successfully RB 1010111110110 O
decrypted VBN 10100100011 O
with IN 100100 O
the DT 11010 O
same JJ 111101001 O
XOR NN 1111011100101 O
key NN 001111111010 O
. . 0110 O

Other JJ 0100111111 O
similarities NNS 0011110100100 O
include VBP 1010101110110 O
the DT 11010 O
usage NN 000111100 O
of IN 1000 O
the DT 11010 O
virtual JJ 11110111110101 O
partition NN 0010011111111 O
\\.\Vd1 NN X O
, , 1011100 O
the DT 11010 O
temporary JJ 11110111110101 O
file NN 00100100 O
named VBN 10100101001 O
FA.tmp NN X O
, , 1011100 O
usage NN 000111100 O
of IN 1000 O
files NNS 0011011110 O
named VBN 10100101001 O
mswmpdat.tlb NN X O
, , 1011100 O
wmcache.nld NN X O
, , 1011100 O
winview.ocx NN X O
. . 0110 O

The DT 010000 O
cyber-espionage JJ 111000110000 O
operation NN 0010101111111 O
behind IN 1001011111011 O
the DT 11010 O
Snake NNP 1110111110011 O
rootkit NN 001011010110 O
is VBZ 101101010 O
well RB 101111111011 O
established VBN 1110011010 O
, , 1011100 O
a DT 11001 O
sample NN 0010100000 O
comiled VBN X O
in IN 100110 O
January NNP 01111101001 O
2006 CD 01111110010 O
indicates VBZ 101111101100 O
that IN 101111110 O
the DT 11010 O
activity NN 00110001011 O
would MD 1011011110011 O
have VB 101101100 O
begun VBN 101001110010 O
in IN 100110 O
at IN 10011110 O
least JJS 011110111111 O
2005 CD 01111110010 O
. . 0110 O

It PRP 01001010 B-Entity
is VBZ 101101010 O
also RB 10101111110 O
sophisticated JJ 111100010011 O
, , 1011100 O
using VBG 100101111110 B-Verb
complex JJ 111100010011 B-Entity
techniques NNS 0011001111010 I-Entity
for IN 10011111 B-Preposition
evading VBG 1111101011 B-Entity
host NN 00100001111 I-Entity
defences NNS X I-Entity
and CC 101110111 O
providing VBG 101111111111011 B-Verb
the DT 11010 B-Entity
attackers NNS 001011110 I-Entity
covert JJ 111100001001 B-Entity
communication NN 001111010000 I-Entity
channels NNS 0011110111110 I-Entity
. . 0110 O

Toolmarks NNPS X O
left VBD 1010011000110 O
behind RP 1001011111011 O
by IN 1001110 O
the DT 11010 O
authors NNS 00001110 O
'vlad NN X O
' '' 0111101010 O
& CC 01110010 O
'gilg NN X O
' '' 0111101010 O
, , 1011100 O
leave VBP 10101000010 O
tantalizing JJ X O
clues NNS 00110100110 O
as IN 10111111110 O
to TO 101100 O
the DT 11010 O
personas NNS 00110110101 O
behind IN 1001011111011 O
this DT 110110 O
. . 0110 O

From IN 0101011110 O
a DT 11001 O
technical JJ 111100100111 O
perspective NN 0001110101 O
, , 1011100 O
Snake NNP 1110111110011 O
demonstrates VBZ 101111101100 O
two CD 11111001100 O
very RB 1111111100 O
different JJ 1111000000 O
approaches NNS 001111010101 O
to TO 101100 O
the DT 11010 O
task NN 001111100001 O
of IN 1000 O
building VBG 1110001101110 O
a DT 11001 O
cyber-espionage JJ 111000110000 O
toolkit NN 001010001111 O
. . 0110 O

One CD 010011101 O
approach NN 00101000101 O
is VBZ 101101010 O
to TO 101100 O
delegate VB X B-Verb
the DT 11010 B-Entity
network NN 001000010 I-Entity
communication NN 001111010000 I-Entity
engine NN 001111011010 I-Entity
to TO 101100 B-Preposition
usermode NN 00101101001 B-Entity
code NN 001001010 I-Entity
, , 1011100 O
backed VBD X O
up RP 10111111100111 O
by IN 1001110 O
a DT 11001 O
usermode NN 00101101001 O
rootkit NN 001011010110 O
. . 0110 O

Another DT 0100011111 O
approach NN 00101000101 O
is VBZ 101101010 O
to TO 101100 O
carry VB 10101000101 B-Verb
out RP 1011111110010 I-Verb
all DT 1111101100 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
communications NNS 00111101001110 I-Entity
from IN 100101100 B-Preposition
the DT 11010 B-Entity
kernel-mode JJ 1111011101111 I-Entity
driver NN 00101101111 I-Entity
, , 1011100 O
which WDT 101111011 O
is VBZ 101101010 O
a DT 11001 O
very RB 1111111100 O
challenging JJ 10100001011 O
task NN 001111100001 O
by IN 1001110 O
itself PRP 10111111100010 O
. . 0110 O

The DT 010000 O
complexity NN 000111100 O
of IN 1000 O
the DT 11010 O
usermode-centric JJ 1110110000 O
approach NN 00101000101 O
is VBZ 101101010 O
on IN 1001010 O
par NN X O
with IN 100100 O
Rustock NN X O
rootkit NN 001011010110 O
- : 01111001101 O
it PRP 101111010 O
uses VBZ 1011111010111 O
similar JJ 10100001111 O
techniques NNS 0011001111010 O
. . 0110 O

It PRP 01001010 O
's VBZ 10111010 O
an DT 11000 O
old JJ 111100001010 O
well-polished JJ X O
technology NN 1110001101110 O
that WDT 101111110 O
evolved VBD 10100101110111 O
over IN 10010110101 O
the DT 11010 O
years NNS 0011010101 O
and CC 101110111 O
demonstrated VBD 101001100000 O
its PRP$ 11011101 O
resilience NN X O
and CC 101110111 O
survivability NN X O
under IN 10010111111110 O
the DT 11010 O
stress NN X O
of IN 1000 O
security NN 11100011010 O
counter- NN X O
measures NNS 0011001111100 O
. . 0110 O

The DT 010000 O
complexity NN 000111100 O
of IN 1000 O
the DT 11010 O
kernel-centric JJ 111000111001 O
architecture NN 0010101111110 O
of IN 1000 O
Snake NNP 1110111110011 O
is VBZ 101101010 O
quite RB 1111111101 O
unique JJ 1111011101010 O
. . 0110 O

This DT 0100010 O
architecture NN 0010101111110 O
is VBZ 101101010 O
designed VBN 10100010111 O
to TO 101100 O
grant VB 10101000010 O
Snake NNP 1110111110011 O
as IN 10111111110 O
much JJ 111100010100 O
flexibility NN 001111100010 O
as IN 10111111110 O
possible JJ 10100000110 O
. . 0110 O

When WRB 0101011101 B-Preposition
most JJS 111111100 B-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
infected JJ 111101111000 I-Entity
hosts NNS 001100110010 I-Entity
are VBP 101101001 I-Entity
cut VBN 1010010111010 I-Entity
off RP 101111100010 I-Entity
from IN 100101100 I-Entity
the DT 11010 I-Entity
outside JJ 00010011 I-Entity
world NN 0010111011 I-Entity
, , 1011100 O
it PRP 101111010 B-Entity
only RB 10101110010 B-Verb
needs VBZ 10100010011 I-Verb
one CD 111110100 B-Entity
host NN 00100001111 I-Entity
to TO 101100 I-Entity
be VB 10101100 I-Entity
connected JJ 10100010011 I-Entity
online NN 11100001010 I-Entity
. . 0110 O

The DT 010000 B-Entity
traffic NN 0011110100110 I-Entity
is VBZ 101101010 B-Verb
then RB 101011111110 I-Verb
routed VBN X I-Verb
through IN 100101111010 B-Preposition
that DT 101111110 B-Entity
host NN 00100001111 I-Entity
to TO 101100 O
make VB 101010011000 B-Verb
external JJ 111101111111011 B-Entity
control NN 111000100 I-Entity
and CC 101110111 O
data NN 001111001 B-Entity
exfiltration NN 1110001101111 I-Entity
still RB 10101111111111 B-Entity
possible JJ 10100000110 I-Entity
. . 0110 O

The DT 010000 B-Entity
presence NN 0001111010 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
reconnaissance NN 111000111001 I-Entity
tool NN 001010001110 I-Entity
in IN 100110 I-Entity
the DT 11010 I-Entity
Snake NNP 1110111110011 I-Entity
operators NNS 00111101001111 I-Entity
' POS 0111101010 I-Entity
framework NN 001010001111 I-Entity
suggests VBZ 101111101100 B-Verb
the DT 11010 B-Entity
existence NN 0001111011 I-Entity
of IN 1000 I-Entity
an DT 11000 I-Entity
arsenal NN 0001110101 I-Entity
of IN 1000 I-Entity
infiltration NN 0001110001 I-Entity
tools NNS 0011001111011 I-Entity
, , 1011100 O
designed VBN 10100010111 O
to TO 101100 O
compromise VB 1010101111010 B-Verb
a DT 11001 B-Entity
system NN 001000000 I-Entity
, , 1011100 O
then RB 101011111110 O
find VB 10101000101 O
a DT 11001 O
way NN 00101001010 O
to TO 101100 O
replicate VB X B-Verb
into IN 10010111100 B-Preposition
other JJ 111110010 B-Entity
hosts NNS 001100110010 I-Entity
, , 1011100 O
infect VB 101010011001 B-Verb
them PRP 1011111110000 B-Entity
, , 1011100 O
and CC 101110111 O
spread VBD 101010111111101 B-Verb
the DT 11010 B-Entity
infection NN 0010101110111 I-Entity
even RB 101011101000 B-Entity
further RBR 11110111111001 I-Entity
. . 0110 O

As IN 01010100 O
demonstrated VBN 101001100000 O
, , 1011100 O
the DT 11010 B-Entity
backdoor JJ 00101101000 I-Entity
commands NNS 001111101100 I-Entity
allow VBP 10101000000 B-Verb
Snake NNP 1110111110011 B-Entity
to TO 101100 O
provide VB 10101000011 B-Verb
remote JJ 11110111111100 B-Entity
attackers NNS 001011110 I-Entity
with IN 100100 B-Preposition
full JJ 1111000110101 B-Entity
remote JJ 11110111111100 I-Entity
access NN 10100011010 I-Entity
to TO 101100 I-Entity
the DT 11010 I-Entity
compromised VBN 111101111001 I-Entity
system NN 001000000 I-Entity
. . 0110 O

Its PRP$ 0100011110 O
ability NN 101000110011 O
to TO 101100 O
hibernate VB X B-Verb
, , 1011100 O
staying VBG X B-Verb
fully RB 1010111110110 B-Entity
inactive JJ 10100000010 I-Entity
for IN 10011111 B-Preposition
a DT 11001 B-Entity
number NN 00010100 I-Entity
of IN 1000 I-Entity
days NNS 0011010100 I-Entity
, , 1011100 O
makes VBZ 1011111001011 B-Verb
its PRP$ 11011101 B-Entity
detection NN 0001110010 I-Entity
during IN 100101110110 I-Entity
that DT 101111110 I-Entity
time NN 00011010 I-Entity
very RB 1111111100 B-Entity
difficult JJ 10100001011 I-Entity
. . 0110 O

The DT 010000 O
analysed JJ 1010010110100 O
code NN 001001010 O
suggests VBZ 101111101100 O
that IN 101111110 O
even RB 101011101000 O
file VB 00100100 O
system NN 001000000 O
and CC 101110111 O
registry NN 111101110001 O
operations NNS 001100011100 O
can MD 10110111110 O
be VB 10101100 O
delegated VBN X O
by IN 1001110 O
an DT 11000 O
infected JJ 111101111000 O
module NN 00101101100 O
to TO 101100 O
another DT 11111011100 O
module NN 00101101100 O
in IN 100110 O
order NN 0000011 O
to TO 101100 O
stay VB 101010110101 B-Verb
unnoticed JJ 10100001011 B-Entity
by IN 1001110 B-Preposition
behaviour NN 111000110010 B-Entity
analysis NN 0001110110 I-Entity
engines NNS 001100111001 I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
antivirus JJ 11101110111 I-Entity
products NNS 001100111001 I-Entity
, , 1011100 O
and CC 101110111 O
to TO 101100 O
overcome VB 10101000100 B-Verb
account NN 0011110111001 B-Entity
restrictions NNS X I-Entity
of IN 1000 I-Entity
the DT 11010 I-Entity
browser NN 00100011010 I-Entity
processes NNS 0011001111110 I-Entity
so IN 101111111110010 O
that IN 101111110 O
the DT 11010 B-Entity
injected VBN 10100100010 I-Entity
module NN 00101101100 I-Entity
could MD 101101111000 O
still RB 10101111111111 O
write VB 10101011111001 B-Verb
into IN 10010111100 B-Preposition
files NNS 0011011110 B-Entity
and CC 101110111 O
into IN 10010111100 B-Preposition
the DT 11010 B-Entity
sensitive JJ 111000111101 I-Entity
registry NN 111101110001 I-Entity
hives NNS X I-Entity
. . 0110 O

The DT 010000 B-Entity
logs NNS 0011111110110 I-Entity
and CC 101110111 I-Entity
dumps VBZ 000110010 I-Entity
it PRP 101111010 B-Entity
creates VBZ 1011111010110 B-Verb
on IN 1001010 B-Preposition
the DT 11010 B-Entity
hidden JJ 11110001111110 I-Entity
virtual JJ 11110111110101 I-Entity
volumes NNS 0011110111000 I-Entity
contributes VBZ X O
to TO 101100 O
its PRP$ 11011101 O
stealthiness NN X O
too RB 10100000011 O
. . 0110 O

A DT 010001110 O
great JJ 1111000110011 O
deal NN 1010101111000 O
of IN 1000 O
attention NN 00100010111 O
has VBZ 1011011010 O
also RB 10101111110 O
been VBN 10101101 O
given VBN 101000001111 O
to TO 101100 O
keep VB 101010011001 B-Verb
its PRP$ 11011101 B-Entity
network NN 001000010 I-Entity
communications NNS 00111101001110 I-Entity
as RB 10111111110 B-Entity
quiet JJ X I-Entity
as IN 10111111110 I-Entity
possible JJ 10100000110 I-Entity
. . 0110 O

Its PRP$ 0100011110 O
ability NN 101000110011 O
to TO 101100 O
generate VB 10101001001 B-Verb
malicious JJ 1111011111000 B-Entity
traffic NN 0011110100110 I-Entity
whenever WRB 1011111111111010 B-Preposition
the DT 11010 B-Entity
user NN 0010000110 I-Entity
goes VBZ 10100101111100 I-Entity
online NN 11100001010 I-Entity
and CC 101110111 I-Entity
start VB 101010111111000 I-Entity
loading VBG 111000111001 I-Entity
the DT 11010 I-Entity
web NN 1111011011101 I-Entity
pages NNS 0011111111000 I-Entity
allows VBZ 101111100100 O
it PRP 101111010 B-Entity
to TO 101100 O
'blend FW X B-Verb
in FW 100110 I-Verb
' '' 0111101010 I-Verb
with IN 100100 B-Preposition
the DT 11010 B-Entity
legitimate JJ 11110111110010 I-Entity
communications NNS 00111101001110 I-Entity
. . 0110 O

We PRP 01001001 O
expect VBP 10101010101 O
much RB 111100010100 O
more RBR 1111111110 O
will MD 10110111111 O
be VB 10101100 O
uncovered VBN 1010011111110 O
by IN 1001110 O
researchers NNS 001100111000 O
in IN 100110 O
the DT 11010 O
coming VBG 10101110001 O
weeks NNS 0011010101 O
as IN 10111111110 O
the DT 11010 O
capabilities NNS 0011001111001 O
of IN 1000 O
this DT 110110 O
operation NN 0010101111111 O
are VBP 101101001 O
further RB 11110111111001 O
fleshed VBN X O
out RP 1011111110010 O
. . 0110 O

However RB 010110 O
, , 1011100 O
as IN 10111111110 O
we PRP 101111000 O
implied VBD X O
in IN 100110 O
the DT 11010 O
opening NN 10111111111100 O
section NN 0011111111110 O
, , 1011100 O
we PRP 101111000 O
view VBP 0001011111 O
this DT 110110 O
threat NN 1110000110 O
to TO 101100 O
be VB 10101100 O
a DT 11001 O
permanent JJ 1111000111000 O
feature NN 001111100000 O
of IN 1000 O
the DT 11010 O
landscape NN 0010101001 O
. . 0110 O

Whether NNP 0101011101 O
they PRP 10111100110 O
dismantle VBP X O
this DT 110110 O
toolset NN 001100011101 O
and CC 101110111 O
start VB 101010111111000 O
from IN 100101100 O
scratch NN X O
, , 1011100 O
or CC 101110110 O
continue VB 101000111100 O
using VBG 100101111110 O
tools NNS 0011001111011 O
which WDT 101111011 O
have VBP 101101100 O
been VBN 10101101 O
exposed VBN 10100010010 O
, , 1011100 O
remains VBZ 101000110110 O
to TO 101100 O
be VB 10101100 O
seen VBN 101001110010 O
. . 0110 O

For IN 01010010 O
their PRP$ 11011100 O
targets NNS 00110010111 O
though IN 1011111111100110 O
the DT 11010 O
considerable JJ 1111000110011 O
challenge NN 00101001101 O
of IN 1000 O
keeping VBG 101111111111011 O
secrets NNS 0011001101101 O
safe JJ 11110001111110 O
on IN 1001010 O
sensitive JJ 111000111101 O
networks NNS 0011001101110 O
will MD 10110111111 O
certainly RB 10101111111111 O
continue VB 101000111100 O
for IN 10011111 O
years NNS 0011010101 O
to TO 101100 O
come VB 10101110001 O
. . 0110 O

