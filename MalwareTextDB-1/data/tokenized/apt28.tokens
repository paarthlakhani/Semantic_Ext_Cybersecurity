Our PRP$ O
clients NNS O
often RB O
ask VBP O
us PRP O
to TO O
assess VB O
the DT O
threat NN O
Russia NNP O
poses VBZ O
in IN O
cyberspace NN O
. . O

Russia NNP O
has VBZ O
long RB O
been VBN O
a DT O
whispered VBN O
frontrunner NN O
among IN O
capable JJ O
nations NNS O
for IN O
performing VBG O
sophisticated JJ O
network NN O
operations NNS O
. . O

This DT O
perception NN O
is VBZ O
due JJ O
in IN O
part NN O
to TO O
the DT O
Russian JJ O
government NN O
's POS O
alleged JJ O
involvement NN O
in IN O
the DT O
cyber NN O
attacks NNS O
accompanying VBG O
its PRP$ O
invasion NN O
of IN O
Georgia NNP O
in IN O
2008 CD O
, , O
as RB O
well RB O
as IN O
the DT O
rampant JJ O
speculation NN O
that IN O
Moscow NNP O
was VBD O
behind IN O
a DT O
major JJ O
U.S. NNP O
Department NNP O
of IN O
Defense NNP O
network NN O
compromise NN O
, , O
also RB O
in IN O
2008 CD O
. . O

These DT O
rumored VBN O
activities NNS O
, , O
combined VBN O
with IN O
a DT O
dearth NN O
of IN O
hard JJ O
evidence NN O
, , O
have VBP O
made VBN O
Russia NNP O
into IN O
something NN O
of IN O
a DT O
phantom JJ O
in IN O
cyberspace NN O
. . O

In IN O
this DT O
paper NN O
we PRP O
discuss VBP O
a DT O
threat NN O
group NN O
whose WP$ O
malware NN O
is VBZ O
already RB O
fairly RB O
well-known JJ O
in IN O
the DT O
cybersecurity NN O
community NN O
. . O

This DT O
group NN O
, , O
unlike IN O
the DT O
China-based JJ O
threat NN O
actors NNS O
we PRP O
track VBP O
, , O
does VBZ O
not RB O
appear VB O
to TO O
conduct VB O
widespread JJ O
intellectual JJ O
property NN O
theft NN O
for IN O
economic JJ O
gain NN O
. . O

Nor CC O
have VBP O
we PRP O
observed VBD O
the DT O
group NN O
steal VB O
and CC O
profit VB O
from IN O
financial JJ O
account NN O
information NN O
. . O

The DT O
activity NN O
that IN O
we PRP O
profile VBP O
in IN O
this DT O
paper NN O
appears VBZ O
to TO O
be VB O
the DT O
work NN O
of IN O
a DT O
skilled JJ O
team NN O
of IN O
developers NNS O
and CC O
operators NNS O
collecting VBG O
intelligence NN O
on IN O
defense NN O
and CC O
geopolitical JJ O
issues NNS O
– NN O
intelligence NN O
that WDT O
would MD O
only RB O
be VB O
useful JJ O
to TO O
a DT O
government NN O
. . O

We PRP O
believe VBP O
that IN O
this DT O
is VBZ O
an DT O
advanced JJ O
persistent JJ O
threat NN O
( FW O
APT FW O
) FW O
group NN O
engaged VBD O
in IN O
espionage NN O
against IN O
political JJ O
and CC O
military JJ O
targets NNS O
including VBG O
the DT O
country NN O
of IN O
Georgia NNP O
, , O
Eastern NNP O
European NNP O
governments NNS O
and CC O
militaries NNS O
, , O
and CC O
European JJ O
security NN O
organizations NNS O
since IN O
at IN O
least JJS O
2007 CD O
. . O

They PRP O
compile VBP O
malware NN O
samples NNS O
with IN O
Russian JJ O
language NN O
settings NNS O
during IN O
working VBG O
hours NNS O
consistent JJ O
with IN O
the DT O
time NN O
zone NN O
of IN O
Russia NNP O
's POS O
major JJ O
cities NNS O
, , O
including VBG O
Moscow NNP O
and CC O
St. NNP O
Petersburg NNP O
. . O

While IN O
we PRP O
do VBP O
n't RB O
have VB O
pictures NNS O
of IN O
a DT O
building NN O
, , O
personas NNS O
to TO O
reveal VB O
, , O
or CC O
a DT O
government NN O
agency NN O
to TO O
name NN O
, , O
what WP O
we PRP O
do VBP O
have VB O
is VBZ O
evidence NN O
of IN O
long- JJ O
standing NN O
, , O
focused VBD O
operations NNS O
that WDT O
indicate VBP O
a DT O
government NN O
sponsor NN O
– NN O
specifically RB O
, , O
a DT O
government NN O
based VBN O
in IN O
Moscow NNP O
. . O

We PRP O
are VBP O
tracking VBG O
this DT O
group NN O
as IN O
APT28 NN O
. . O

APT28 NN O
targets VBZ O
insider NN O
information NN O
related VBN O
to TO O
governments NNS O
, , O
militaries NNS O
, , O
and CC O
security NN O
organizations NNS O
that WDT O
would MD O
likely RB O
benefit VB O
the DT O
Russian JJ O
government NN O
. . O

Malware NNP O
compile VBP O
times NNS O
suggest VBP O
that IN O
APT28 NN O
developers NNS O
have VBP O
consistently RB O
updated VBN O
their PRP$ O
tools NNS O
over IN O
the DT O
last JJ O
seven CD O
years NNS O
. . O

Since IN O
2007 CD O
, , O
APT28 NN O
has VBZ O
systematically RB O
evolved VBN O
its PRP$ O
malware NN O
, , O
using VBG O
flexible JJ O
and CC O
lasting JJ O
platforms NNS O
indicative JJ O
of IN O
plans NNS O
for IN O
long-term JJ O
use NN O
. . O

The DT O
coding VBG O
practices NNS O
evident JJ O
in IN O
the DT O
group's FW O
malware FW O
suggest VBP O
both CC O
a DT O
high JJ O
level NN O
of IN O
skill NN O
and CC O
an DT O
interest NN O
in IN O
complicating VBG O
reverse JJ O
engineering NN O
efforts NNS O
. . O

• FW O
Malware FW O
compile VBP O
times NNS O
suggest VBP O
that IN O
APT28 NN O
developers NNS O
have VBP O
consistently RB O
updated VBN O
their PRP$ O
tools NNS O
over IN O
the DT O
last JJ O
seven CD O
years NNS O
. . O

• FW O
APT28 FW O
malware FW O
, , O
in IN O
particular JJ O
the DT O
family NN O
of IN O
modular JJ O
backdoors NNS O
that IN O
we PRP O
call VBP O
CHOPSTICK NNP O
, , O
indicates VBZ O
a DT O
formal JJ O
code NN O
development NN O
environment NN O
. . O

Such PDT O
an DT O
environment NN O
would MD O
almost RB O
certainly RB O
be VB O
required VBN O
to TO O
track VB O
and CC O
define VB O
the DT O
various JJ O
modules NNS O
that WDT O
can MD O
be VB O
included VBN O
in IN O
the DT O
backdoor NN O
at IN O
compile VB O
time NN O
. . O

• FW O
APT28 FW O
tailors VBZ O
implants NNS O
for IN O
specific JJ O
victim NN O
environments NNS O
. . O

They PRP B-Entity
steal VBP B-Action
data NNS B-Entity
by IN O
configuring VBG O
their PRP$ B-Entity
implants NNS I-Entity
to TO O
send VB B-Action
data NNS B-Entity
out IN B-Modifier
of IN I-Modifier
the DT B-Entity
network NN I-Entity
using VBG B-Modifier
a DT B-Entity
victim NN I-Entity
network NN I-Entity
's POS I-Entity
mail NN I-Entity
server NN I-Entity
. . O

• CD O
Several JJ B-Entity
of IN I-Entity
APT28 NN I-Entity
's POS I-Entity
malware NN I-Entity
samples NNS I-Entity
contain VBP B-Action
counter- NN B-Entity
analysis NN I-Entity
capabilities NNS I-Entity
including VBG O
runtime NN B-Entity
checks NNS I-Entity
to TO O
identify VB B-Action
an DT B-Entity
analysis NN I-Entity
environment NN I-Entity
, , O
obfuscated VBN B-Entity
strings NNS I-Entity
unpacked JJ B-Action
at IN B-Modifier
runtime NN B-Entity
, , O
and CC O
the DT O
inclusion NN B-Entity
of IN I-Entity
unused JJ I-Entity
machine NN I-Entity
instructions NNS I-Entity
to TO O
slow VB B-Action
analysis NN B-Entity
. . O

Indicators NNPS O
in IN O
APT28 NN O
's POS O
malware NN O
suggest VBP O
that IN O
the DT O
group NN O
consists VBZ O
of IN O
Russian JJ O
speakers NNS O
operating VBG O
during IN O
business NN O
hours NNS O
in IN O
Russia NNP O
's POS O
major JJ O
cities NNS O
. . O

More JJR O
than IN O
half NN O
of IN O
the DT O
malware NN O
samples NNS O
with IN O
Portable NNP O
Executable NNP O
( NNP O
PE NNP O
) NNP O
resources NNS O
that IN O
we PRP O
have VBP O
attributed VBN O
to TO O
APT28 NN O
included VBD O
Russian JJ O
language NN O
settings NNS O
( VBP O
as IN O
opposed VBN O
to TO O
neutral JJ O
or CC O
English JJ O
settings NNS O
) NN O
, , O
suggesting VBG O
that IN O
a DT O
significant JJ O
portion NN O
of IN O
APT28 NN O
malware NN O
was VBD O
compiled VBN O
in IN O
a DT O
Russian JJ O
language NN O
build VBP O
environment NN O
consistently RB O
over IN O
the DT O
course NN O
of IN O
six CD O
years NNS O
( JJ O
2007 CD O
to TO O
2013 CD O
) NNP O
. . O

Over NNP O
96 CD O
% NN O
of IN O
the DT O
malware NN O
samples NNS O
we PRP O
have VBP O
attributed VBN O
to TO O
APT28 NN O
were VBD O
compiled VBN O
between IN O
Monday NNP O
and CC O
Friday NNP O
. . O

More JJR O
than IN O
89 CD O
% NN O
were VBD O
compiled VBN O
between IN O
8AM NN O
and CC O
6PM NN O
in IN O
the DT O
UTC+4 NN O
time NN O
zone NN O
, , O
which WDT O
parallels VBZ O
the DT O
working VBG O
hours NNS O
in IN O
Moscow NNP O
and CC O
St. NNP O
Petersburg NNP O
. . O

These DT O
samples NNS O
had VBD O
compile VB O
dates NNS O
ranging VBG O
from IN O
mid-2007 NN O
to TO O
September NNP O
2014 CD O
. . O

Three CD O
themes NNS O
in IN O
APT28 NN O
's POS O
targeting NN O
clearly RB O
reflect VBP O
areas NNS O
of IN O
specific JJ O
interest NN O
to TO O
an DT O
Eastern JJ O
European JJ O
government NN O
, , O
most RBS O
likely RB O
the DT O
Russian JJ O
government NN O
. . O

Many JJ O
of IN O
APT28 NN O
's POS O
targets NNS O
align VBP O
generally RB O
with IN O
interests NNS O
that WDT O
are VBP O
typical JJ O
of IN O
any DT O
government NN O
. . O

However RB O
, , O
three CD O
themes NNS O
in IN O
APT28 NN O
's POS O
targeting NN O
clearly RB O
reflects VBZ O
areas NNS O
of IN O
specific JJ O
interest NN O
to TO O
an DT O
Eastern JJ O
European JJ O
government NN O
, , O
most RBS O
likely RB O
the DT O
Russian JJ O
government NN O
. . O

These DT O
include VBP O
the DT O
Caucasus NNP O
( NNP O
especially RB O
the DT O
Georgian JJ O
government NN O
) NN O
, , O
Eastern JJ O
European JJ O
governments NNS O
and CC O
militaries NNS O
, , O
and CC O
specific JJ O
security NN O
organizations NNS O
. . O

APT28 NN B-Entity
uses VBZ B-Action
spearphishing VBG B-Entity
emails NNS I-Entity
to TO B-Modifier
target VB B-Entity
its PRP$ I-Entity
victims NNS I-Entity
, , O
a DT O
common JJ O
tactic NN O
in IN O
which WDT O
the DT B-Entity
threat NN I-Entity
group NN I-Entity
crafts VBZ B-Action
its PRP$ B-Entity
emails NNS I-Entity
to TO B-Modifier
mention VB B-Entity
specific JJ I-Entity
topics NNS I-Entity
( NN I-Entity
lures VBZ I-Entity
) RB I-Entity
relevant JJ I-Entity
to TO I-Entity
recipients NNS I-Entity
. . O

This DT O
increases VBZ O
the DT O
likelihood NN O
that IN O
recipients NNS O
will MD O
believe VB O
that IN O
the DT O
email NN O
is VBZ O
legitimate JJ O
and CC O
will MD O
be VB O
interested JJ O
in IN O
opening VBG O
the DT O
message NN O
, , O
opening VBG O
any DT O
attached JJ O
files NNS O
, , O
or CC O
clicking VBG O
on IN O
a DT O
link NN O
in IN O
the DT O
body NN O
of IN O
the DT O
email NN O
. . O

Since IN O
spearphishing VBG O
lures NNS O
are VBP O
tailored VBN O
to TO O
the DT O
recipients NNS O
whose WP$ O
accounts NNS O
APT28 NN O
hopes VBZ O
to TO O
breach VB O
, , O
the DT O
subjects NNS O
of IN O
the DT O
lures NNS O
provide VBP O
clues NNS O
as IN O
to TO O
APT28's JJ O
targets NNS O
and CC O
interests NNS O
. . O

For IN O
example NN O
, , O
if IN O
the DT O
group's CD O
lures NNS O
repeatedly RB O
refer VBP O
to TO O
the DT O
Caucasus NNP O
, , O
then RB O
this DT O
most RBS O
likely RB O
indicates VBZ O
that IN O
APT28 NN O
is VBZ O
trying VBG O
to TO O
gain VB O
access NN O
to TO O
the DT O
accounts NNS O
of IN O
individuals NNS O
whose WP$ O
work NN O
pertains NNS O
to TO O
the DT O
Caucasus NNP O
. . O

Similarly RB O
, , O
APT28 NN O
's POS O
practice NN O
of IN O
registering VBG O
domains NNS O
that WDT O
mimic VBP O
those DT O
of IN O
legitimate JJ O
news NN O
, , O
politics NNS O
, , O
or CC O
other JJ O
websites NNS O
indicates VBZ O
topics NNS O
that WDT O
are VBP O
relevant JJ O
to TO O
APT28 NN O
's POS O
targets NNS O
. . O

We PRP O
identified VBD O
three CD O
themes NNS O
in IN O
APT28 NN O
's POS O
lures NNS O
and CC O
registered JJ O
domains NNS O
, , O
which WDT O
together RB O
are VBP O
particularly RB O
relevant JJ O
to TO O
the DT O
Russian JJ O
government NN O
. . O

In IN O
addition NN O
to TO O
these DT O
themes NNS O
, , O
we PRP O
have VBP O
seen VBN O
APT28 NN O
target NN O
a DT O
range NN O
of IN O
political JJ O
and CC O
military JJ O
organizations NNS O
. . O

We PRP O
assess VBP O
that IN O
the DT O
work NN O
of IN O
these DT O
organizations NNS O
serves VBZ O
nation NN O
state NN O
governments NNS O
. . O

The DT O
Caucasus NNP O
, , O
a DT O
region NN O
that WDT O
includes VBZ O
Chechnya NNP O
and CC O
other JJ O
Russian JJ O
republics NNS O
and CC O
the DT O
independent JJ O
states NNS O
of IN O
Georgia NNP O
, , O
Armenia NNP O
, , O
and CC O
Azerbaijan NNP O
, , O
continues VBZ O
to TO O
experience VB O
political JJ O
unrest NN O
. . O

The DT O
Georgian JJ O
government NN O
's POS O
posture NN O
and CC O
ties NNS O
to TO O
the DT O
West NNP O
are VBP O
a DT O
frequent JJ O
source NN O
of IN O
Moscow NNP O
's POS O
frustration NN O
, , O
particularly RB O
after IN O
the DT O
2008 CD O
war NN O
. . O

Overall NNP O
, , O
issues NNS O
in IN O
the DT O
Caucasus NNP O
likely RB O
serve VBP O
as IN O
focal JJ O
points NNS O
for IN O
Russian JJ O
intelligence NN O
collection NN O
efforts NNS O
. . O

Since IN O
2011 CD O
, , O
APT28 NN B-Entity
has VBZ O
used VBN B-Action
lures NNS B-Entity
written VBN I-Entity
in IN I-Entity
Georgian JJ I-Entity
that WDT O
are VBP O
probably RB O
intended VBN O
to TO O
target VB O
Georgian JJ O
government NN O
agencies NNS O
or CC O
citizens NNS O
. . O

APT28 NN O
is VBZ O
likely JJ O
seeking VBG O
information NN O
on IN O
Georgia's NN O
security NN O
and CC O
diplomatic JJ O
postures NNS O
. . O

Specifically RB O
, , O
the DT O
group NN O
has VBZ O
targeted VBN O
the DT O
Georgian JJ O
Ministry NNP O
of IN O
Internal NNP O
Affairs NNP O
( NNP O
MIA NNP O
) NNP O
and CC O
the DT O
Ministry NNP O
of IN O
Defense NNP O
( FW O
MOD FW O
) FW O
. . O

We PRP O
also RB O
observed VBD O
efforts NNS O
to TO O
target VB O
a DT O
journalist NN O
working VBG O
on IN O
issues NNS O
in IN O
the DT O
Caucasus NNP O
and CC O
a DT O
controversial JJ O
Chechen JJ O
news NN O
site NN O
. . O

APT28 NN O
made VBN O
at IN O
least JJS O
two CD O
specific JJ O
attempts NNS O
to TO O
target VB O
the DT O
Georgian JJ O
Ministry NNP O
of IN O
Internal NNP O
Affairs NNP O
. . O

The DT O
MIA NNP O
harbors VBZ O
sensitive JJ O
information NN O
about IN O
the DT O
inner JJ O
workings NNS O
of IN O
Georgia NNP O
's POS O
security NN O
operations NNS O
, , O
the DT O
country NN O
's POS O
engagement NN O
in IN O
multilateral JJ O
institutions NNS O
, , O
and CC O
the DT O
government NN O
's POS O
communications NNS O
backbone NN O
. . O

It PRP O
is VBZ O
responsible JJ O
for IN O
: : O
APT28 NN O
made VBN O
at IN O
least JJS O
two CD O
specific JJ O
attempts NNS O
to TO O
target VB O
the DT O
MIA NNP O
. . O

In IN O
one CD O
case NN O
, , O
we PRP O
identified VBD O
an DT O
APT28 NN O
lure NN O
from IN O
mid-2013 NN O
that WDT O
referenced VBD O
MIA-related JJ O
topics NNS O
and CC O
employed VBN O
malware NN B-Entity
that WDT O
attempted VBD O
to TO O
disguise VB B-Action
its PRP$ B-Entity
activity NN I-Entity
as IN B-Modifier
legitimate JJ B-Entity
MIA NNP I-Entity
email NN I-Entity
traffic NN I-Entity
. . O

The DT O
lure NN O
consisted VBD O
of IN O
a DT B-Entity
weaponized VBN I-Entity
Excel NNP I-Entity
file NN I-Entity
that WDT O
presented VBD B-Action
a DT B-Entity
decoy NN I-Entity
document NN I-Entity
containing VBG I-Entity
a DT I-Entity
list NN I-Entity
of IN I-Entity
Georgian JJ I-Entity
driver NN I-Entity
's POS I-Entity
license NN I-Entity
numbers NNS I-Entity
. . O

The DT B-Entity
backdoor NN I-Entity
attempted VBD O
to TO O
establish VB B-Action
a DT B-Entity
connection NN I-Entity
to TO I-Entity
a DT I-Entity
Georgian JJ I-Entity
MIA NN I-Entity
mail NN I-Entity
server NN I-Entity
and CC O
communicate VBP B-Action
via IN B-Modifier
MIA NN B-Entity
email NN I-Entity
addresses NNS I-Entity
ending VBG I-Entity
with IN I-Entity
'' '' I-Entity
@ SYM I-Entity
mia.ge.gov NN I-Entity
'' '' I-Entity
. . O

Once RB O
connected VBN O
to TO O
the DT O
mail NN O
server NN O
, , O
APT28 NN B-Entity
's POS I-Entity
backdoor NN I-Entity
sent VBD B-Action
an DT B-Entity
email NN I-Entity
message NN I-Entity
using VBG I-Entity
a DT I-Entity
subject NN I-Entity
line NN I-Entity
related VBN I-Entity
to TO I-Entity
driver's NN I-Entity
licenses NNS I-Entity
( VBP I-Entity
in IN I-Entity
Georgian JJ I-Entity
) NN I-Entity
, , O
and CC O
attached VBD B-Action
a DT B-Entity
file NN I-Entity
containing VBG I-Entity
system NN I-Entity
reconnaissance NN I-Entity
information NN I-Entity
. . O

This DT O
tactic NN O
could MD O
allow VB O
APT28 NN B-Entity
to TO O
obtain VB B-Action
data NNS B-Entity
from IN B-Modifier
the DT B-Entity
MIA NNP I-Entity
's POS I-Entity
network NN I-Entity
through IN B-Modifier
a DT B-Entity
less-monitored JJ I-Entity
route NN I-Entity
, , O
limiting VBG B-Action
the DT B-Entity
MIA NNP I-Entity
network NN I-Entity
security NN I-Entity
department NN I-Entity
's POS I-Entity
abilities NNS I-Entity
to TO I-Entity
detect VB I-Entity
the DT I-Entity
traffic NN I-Entity
. . O

In IN O
the DT O
second JJ O
example NN O
of IN O
MIA NNP O
targeting NN O
, , O
an DT B-Entity
APT28 NN I-Entity
lure NN I-Entity
used VBD B-Action
an DT B-Entity
information NN I-Entity
technology-themed JJ I-Entity
decoy NN I-Entity
document NN I-Entity
that WDT I-Entity
included VBD I-Entity
references NNS I-Entity
to TO I-Entity
the DT I-Entity
Windows NNP I-Entity
domain NN I-Entity
'' '' I-Entity
MIA NNP I-Entity
Users\Ortachala… NNP I-Entity
'' '' I-Entity
( NNP I-Entity
Figure NNP I-Entity
1 CD I-Entity
) NN I-Entity
. . O

This DT O
probably RB O
referred VBN O
to TO O
the DT O
MIA NNP O
facility NN O
in IN O
the DT O
Ortachala NNP O
district NN O
of IN O
Tbilisi NNP O
, , O
Georgia NNP O
's POS O
capital NN O
city NN O
. . O

The DT B-Entity
decoy NN I-Entity
document NN I-Entity
also RB O
contains VBZ B-Action
metadata NN B-Entity
listing NN I-Entity
'' '' I-Entity
MIA NN I-Entity
'' '' I-Entity
as IN I-Entity
the DT I-Entity
company NN I-Entity
name NN I-Entity
and CC I-Entity
'' '' I-Entity
Beka NNP I-Entity
Nozadze NNP I-Entity
'' '' I-Entity
as IN I-Entity
an DT I-Entity
author NN I-Entity
, , O
a DT O
possible JJ O
reference NN O
to TO O
a DT O
system NN O
administrator NN O
in IN O
Tbilisi NNP O
. . O

The DT B-Entity
text NN I-Entity
of IN I-Entity
the DT I-Entity
document NN I-Entity
purports VBZ B-Action
to TO B-Modifier
provide VB B-Entity
domain NN I-Entity
and CC I-Entity
user NN I-Entity
group NN I-Entity
setup NN I-Entity
information NN I-Entity
for IN I-Entity
internal JJ I-Entity
Windows NNP I-Entity
XP NN I-Entity
and CC I-Entity
Windows NNP I-Entity
7 CD I-Entity
systems NNS I-Entity
. . O

APT28 NN B-Entity
possibly RB O
crafted VBD B-Action
this DT B-Entity
document NN I-Entity
to TO B-Modifier
appear VB B-Entity
legitimate JJ I-Entity
to TO I-Entity
all DT I-Entity
MIA NNP I-Entity
system NN I-Entity
users NNS I-Entity
and CC O
intended VBN O
to TO O
breach VB O
the DT O
MIA NNP O
network NN O
specifically RB O
using VBG O
the DT O
embedded JJ O
malware NN O
. . O

APT28 NN O
also RB O
appeared VBD O
to TO O
target VB O
Georgia NNP O
's POS O
MOD NN O
along IN O
with IN O
a DT O
U.S. NNP O
defense NN O
contractor NN O
that WDT O
was VBD O
training VBG O
the DT O
Georgian JJ O
military NN O
. . O

APT28 NN B-Entity
used VBD B-Action
a DT B-Entity
lure NN I-Entity
document NN I-Entity
that WDT O
installed VBD B-Action
a DT B-Entity
SOURFACE FW I-Entity
downloader FW I-Entity
( FW O
further RBR O
discussed VBN O
in IN O
the DT O
Malware NNP O
section NN O
) NN O
and CC O
contained VBD B-Action
a DT B-Entity
listing NN I-Entity
of IN I-Entity
birthdays NNS I-Entity
for IN I-Entity
members NNS I-Entity
of IN I-Entity
a DT I-Entity
working VBG I-Entity
group NN I-Entity
between IN I-Entity
the DT I-Entity
Georgian JJ I-Entity
MOD NN I-Entity
and CC I-Entity
the DT I-Entity
U.S. NNP I-Entity
defense NN I-Entity
contractor NN I-Entity
. . O

The DT O
U.S. NNP O
contractor NN O
was VBD O
involved VBN O
in IN O
a DT O
working VBG O
group NN O
to TO O
advise VB O
the DT O
MOD NN O
and CC O
Georgian JJ O
Armed NNP O
Forces NNP O
, , O
assess VB O
Georgia's NN O
military JJ O
capabilities NNS O
, , O
and CC O
develop VB O
a DT O
military JJ O
training NN O
program NN O
for IN O
the DT O
country NN O
. . O

We PRP O
believe VBP O
that IN O
APT28 NN O
's POS O
targeting NN O
of IN O
the DT O
MOD NN O
aligns VBZ O
with IN O
Russian JJ O
threat NN O
perceptions NNS O
. . O

The DT O
growing VBG O
U.S.-Georgian JJ O
military JJ O
relationship NN O
has VBZ O
been VBN O
a DT O
source NN O
of IN O
angst NN O
for IN O
Russia NNP O
. . O

Georgia NNP O
and CC O
Russia NNP O
severed VBD O
diplomatic JJ O
relations NNS O
following VBG O
the DT O
Russia-Georgia NNP O
War NNP O
in IN O
2008 CD O
, , O
and CC O
Georgia NNP O
has VBZ O
since IN O
sought VBN O
to TO O
align VB O
itself PRP O
more RBR O
closely RB O
with IN O
western JJ O
security NN O
organizations NNS O
. . O

Additionally RB O
, , O
in IN O
June NNP O
2014 CD O
, , O
despite IN O
Russia NNP O
's POS O
vocal JJ O
objections NNS O
, , O
Georgia NNP O
, , O
along IN O
with IN O
Ukraine NNP O
and CC O
Moldova NNP O
, , O
signed VBD O
association NN O
accords NNS O
with IN O
the DT O
EU NNP O
. . O

This DT O
move NN O
placed VBD O
all DT O
three CD O
countries NNS O
more RBR O
firmly RB O
in IN O
the DT O
EU NNP O
's POS O
political JJ O
, , O
economic JJ O
, , O
and CC O
security NN O
spheres NNS O
of IN O
influence NN O
. . O

Georgian JJ O
military JJ O
security NN O
issues NNS O
, , O
particularly RB O
with IN O
regard NN O
to TO O
U.S. NNP O
cooperation NN O
and CC O
NATO NNP O
, , O
provide VBP O
a DT O
strong JJ O
incentive NN O
for IN O
Russian JJ O
state-sponsored JJ O
threat NN O
actors NNS O
to TO O
steal VB O
information NN O
that WDT O
sheds VBZ O
light NN O
on IN O
these DT O
topics NNS O
. . O

Targeting NN O
journalists NNS O
could MD O
provide VB O
APT28 NN O
and CC O
its PRP$ O
sponsors NNS O
with IN O
a DT O
way NN O
to TO O
monitor VB O
public JJ O
opinion NN O
, , O
identify VB O
dissidents NNS O
, , O
spread NN O
disinformation NN O
, , O
or CC O
facilitate VB O
further JJ O
targeting NN O
. . O

Another DT B-Entity
one CD I-Entity
of IN I-Entity
APT28 NN I-Entity
's POS I-Entity
lures NNS I-Entity
appeared VBD O
to TO O
target VB B-Action
a DT B-Entity
specific JJ I-Entity
journalist NN I-Entity
covering VBG I-Entity
issues NNS I-Entity
in IN I-Entity
the DT I-Entity
Caucasus NNP I-Entity
region NN I-Entity
. . O

In IN O
late JJ O
2013 CD O
, , O
APT28 NN B-Entity
used VBD B-Action
a DT B-Entity
lure NN I-Entity
that WDT I-Entity
contained VBD I-Entity
a DT I-Entity
letter NN I-Entity
addressing VBG I-Entity
a DT I-Entity
journalist NN I-Entity
by IN I-Entity
his PRP$ I-Entity
first JJ I-Entity
name NN I-Entity
and CC I-Entity
claiming VBG I-Entity
to TO I-Entity
originate VB I-Entity
from IN I-Entity
a DT I-Entity
'' '' I-Entity
Chief NNP I-Entity
Coordinator NNP I-Entity
'' '' I-Entity
in IN I-Entity
Reason NNP I-Entity
Magazine's NNP I-Entity
'' '' I-Entity
Caucasian NNP I-Entity
Issues NNP I-Entity
Department NNP I-Entity
'' '' I-Entity
- : I-Entity
a DT I-Entity
division NN I-Entity
that WDT I-Entity
does VBZ I-Entity
not RB I-Entity
appear VB I-Entity
to TO I-Entity
exist VB I-Entity
. . O

( CD O
Reason NNP O
Magazine NNP O
is VBZ O
a DT O
US-based JJ O
magazine NN O
) CD O
The DT O
letter NN O
welcomed VBD O
the DT O
individual NN O
as IN O
a DT O
contributor NN O
and CC O
requested VBD O
topic NN O
ideas NNS O
and CC O
identification NN O
information NN O
in IN O
order NN O
to TO O
establish VB O
him PRP O
at IN O
the DT O
magazine NN O
. . O

In IN O
the DT O
background NN O
, , O
the DT B-Entity
decoy NN I-Entity
document NN I-Entity
installed VBD B-Action
a DT B-Entity
SOURFACE FW I-Entity
backdoor FW I-Entity
on IN B-Modifier
the DT B-Entity
victim NN I-Entity
's POS I-Entity
system NN I-Entity
. . O

The DT O
body NN O
of IN O
the DT O
letter NN O
suggests VBZ O
that IN O
APT28 NN O
actors NNS O
are VBP O
able JJ O
to TO O
read VB O
at IN O
least JJS O
two CD O
languages NNS O
– NNP O
Russian NNP O
and CC O
English NNP O
. . O

The DT O
grammar NN O
of IN O
the DT O
letter NN O
also RB O
indicates VBZ O
that IN O
English NNP O
is VBZ O
not RB O
the DT O
author NN O
's POS O
first JJ O
language NN O
, , O
despite IN O
it PRP O
purportedly RB O
originating VBG O
from IN O
a DT O
US-based JJ O
magazine NN O
. . O

This DT O
implies VBZ O
that IN O
Russian NNP O
may MD O
be VB O
the DT O
APT28 NN O
author NN O
's POS O
preferred JJ O
language NN O
. . O

Targeting NN O
journalists NNS O
could MD O
provide VB O
APT28 NN O
and CC O
its PRP$ O
sponsors NNS O
with IN O
a DT O
way NN O
to TO O
monitor VB O
public JJ O
opinion NN O
, , O
identify VB O
dissidents NNS O
, , O
spread NN O
disinformation NN O
, , O
or CC O
facilitate VB O
further JJ O
targeting NN O
. . O

Several JJ O
other JJ O
nation NN O
states NNS O
are VBP O
suspected VBN O
of IN O
targeting VBG O
journalists NNS O
and CC O
dissidents NNS O
to TO O
monitor VB O
their PRP$ O
activity NN O
, , O
including VBG O
China NNP O
and CC O
Iran. NNP O
, , O
Journalists NNS O
in IN O
the DT O
Caucasus NNP O
working VBG O
on IN O
Caucasus NNP O
independence NN O
issues NNS O
would MD O
be VB O
a DT O
prime JJ O
target NN O
for IN O
intelligence NN O
collection NN O
for IN O
Moscow NNP O
. . O

Journalists NNS O
critical JJ O
of IN O
the DT O
Kremlin NNP O
have VBP O
long RB O
been VBN O
targets NNS O
of IN O
surveillance NN O
and CC O
harassment NN O
, , O
and CC O
a DT O
number NN O
of IN O
governments NNS O
and CC O
human JJ O
rights NNS O
organizations NNS O
have VBP O
publicly RB O
criticized VBN O
the DT O
government NN O
for IN O
its PRP$ O
treatment NN O
of IN O
journalists NNS O
and CC O
its PRP$ O
increasing VBG O
consolidation NN O
of IN O
control NN O
over IN O
the DT O
media NNS O
. . O

We PRP O
have VBP O
seen VBN O
APT28 NN B-Entity
register NN B-Action
at IN B-Entity
least JJS I-Entity
two CD I-Entity
domains NNS I-Entity
mimicking VBG I-Entity
the DT I-Entity
domains NNS I-Entity
of IN I-Entity
legitimate JJ I-Entity
organizations NNS I-Entity
in IN I-Entity
the DT I-Entity
Caucasus NNP I-Entity
, , O
as IN O
shown VBN O
in IN O
the DT O
table NN O
below IN O
. . O

One CD B-Entity
APT28 NN I-Entity
domain NN I-Entity
imitated VBD B-Action
a DT B-Entity
key JJ I-Entity
Chechen-focused JJ I-Entity
news NN I-Entity
website NN I-Entity
, , O
while IN O
the DT B-Entity
other JJ I-Entity
appeared VBD O
to TO O
target VB B-Action
members NNS B-Entity
of IN I-Entity
the DT I-Entity
Armenian JJ I-Entity
military NN I-Entity
by IN B-Modifier
hosting VBG B-Entity
a DT I-Entity
fake JJ I-Entity
login NN I-Entity
page NN I-Entity
. . O

Of IN O
particular JJ O
note NN O
, , O
the DT O
Kavkaz NNP O
Center NNP O
is VBZ O
a DT O
Chechen-run JJ O
website NN O
designed VBN O
to TO O
present VB O
an DT O
alternative JJ O
view NN O
to TO O
the DT O
long-running JJ O
conflict NN O
between IN O
Russia NNP O
and CC O
Chechen NNP O
separatists NNS O
. . O

In IN O
2004 CD O
and CC O
2013 CD O
, , O
Russia NNP O
's POS O
Foreign NNP O
Minister NNP O
voiced VBD O
his PRP$ O
displeasure NN O
that IN O
a DT O
Swedish JJ O
company NN O
continues VBZ O
to TO O
host VB O
the DT O
Kavkaz NNP O
Center NNP O
website NN O
. . O

Eastern JJ O
European JJ O
countries NNS O
' POS O
political JJ O
and CC O
military JJ O
postures NNS O
are VBP O
traditionally RB O
core JJ O
Russian JJ O
government NN O
interests NNS O
. . O

The DT O
Kremlin NNP O
has VBZ O
long RB O
regarded VBN O
the DT O
former JJ O
Soviet NNP O
Republics NNPS O
and CC O
satellite NN O
states NNS O
as IN O
in IN O
its PRP$ O
sphere NN O
of IN O
economic JJ O
, , O
political JJ O
, , O
and CC O
military JJ O
interest NN O
. . O

Over IN O
the DT O
past JJ O
two CD O
decades NNS O
, , O
as IN O
many JJ O
of IN O
these DT O
states NNS O
joined VBD O
NATO NNP O
and CC O
the DT O
EU NNP O
, , O
Russia NNP O
has VBZ O
attempted VBN O
to TO O
regain VB O
its PRP$ O
influence NN O
in IN O
the DT O
region NN O
. . O

Many JJ O
of IN O
APT28 NN O
's POS O
targets NNS O
parallel VBP O
this DT O
continued JJ O
focus NN O
on IN O
Eastern JJ O
European JJ O
governments NNS O
and CC O
militaries NNS O
. . O

We PRP O
have VBP O
evidence NN O
that IN O
APT28 NN O
made VBN O
at IN O
least JJS O
two CD O
attempts NNS O
to TO O
compromise VB O
Eastern JJ O
European JJ O
government NN O
organizations NNS O
: : O
• CD O
In IN O
a DT O
late JJ O
2013 CD O
incident NN O
, , O
a DT O
FireEye NNP O
device NN O
deployed VBD O
at IN O
an DT O
Eastern NNP O
European NNP O
Ministry NNP O
of IN O
Foreign NNP O
Affairs NNP O
detected VBD O
APT28 NN O
malware NN O
in IN O
the DT O
client NN O
's POS O
network NN O
. . O

• NN O
More RBR O
recently RB O
, , O
in IN O
August NNP O
2014 CD O
APT28 NN B-Entity
used VBD B-Action
a DT B-Entity
lure NN I-Entity
( NNP I-Entity
Figure NNP I-Entity
3 CD I-Entity
) NN I-Entity
about IN I-Entity
hostilities NNS I-Entity
surrounding VBG I-Entity
a DT I-Entity
Malaysia NNP I-Entity
Airlines NNP I-Entity
flight NN I-Entity
downed VBD I-Entity
in IN I-Entity
Ukraine NNP I-Entity
in IN B-Modifier
a DT B-Entity
probable JJ I-Entity
attempt NN I-Entity
to TO I-Entity
compromise VB I-Entity
the DT I-Entity
Polish JJ I-Entity
government NN I-Entity
. . O

A DT B-Entity
SOURFACE NN I-Entity
sample NN I-Entity
employed VBN B-Action
in IN B-Modifier
the DT B-Entity
same JJ I-Entity
Malaysia NNP I-Entity
Airlines NNPS I-Entity
lure NN I-Entity
was VBD O
referenced VBN O
by IN O
a DT O
Polish JJ O
computer NN O
security NN O
company NN O
in IN O
a DT O
blog NN O
post NN O
. . O

The DT O
Polish JJ O
security NN O
company NN O
indicated VBD O
that IN O
the DT O
sample NN O
was VBD O
'' '' O
sent VBN O
to TO O
the DT O
government NN O
, , O
'' '' O
presumably RB O
the DT O
Polish JJ O
government NN O
, , O
given VBN O
the DT O
company NN O
's POS O
location NN O
and CC O
visibility NN O
. . O

We PRP O
have VBP O
evidence NN O
that IN O
APT28 NN O
made VBN O
at IN O
least JJS O
two CD O
attempts NNS O
to TO O
compromise VB O
Eastern JJ O
European JJ O
government NN O
organizations NNS O
. . O

APT28 NN B-Entity
has VBZ O
registered VBN B-Action
domains NNS B-Entity
similar JJ I-Entity
to TO I-Entity
those DT I-Entity
of IN I-Entity
legitimate JJ I-Entity
Eastern JJ I-Entity
European JJ I-Entity
news NN I-Entity
sites NNS I-Entity
and CC I-Entity
governments NNS I-Entity
, , O
listed VBN O
in IN O
Table NNP O
2 CD O
. . O

These DT O
domain NN O
registrations NNS O
not RB O
only RB O
suggest VBP O
that IN O
APT28 NN O
is VBZ O
interested JJ O
in IN O
Eastern JJ O
European JJ O
political JJ O
affairs NNS O
, , O
but CC O
also RB O
that IN O
the DT O
group NN O
targets VBZ O
Eastern JJ O
European JJ O
governments NNS O
directly RB O
. . O

In IN O
addition NN O
, , O
APT28 NN B-Entity
used VBD B-Action
one CD B-Entity
domain NN I-Entity
for IN I-Entity
command NN I-Entity
and CC I-Entity
control NN I-Entity
sessions NNS I-Entity
( FW I-Entity
baltichost FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
org FW I-Entity
) NN I-Entity
that WDT I-Entity
was VBD I-Entity
themed VBN I-Entity
after IN I-Entity
the DT I-Entity
Baltic JJ I-Entity
Host NN I-Entity
exercises NNS I-Entity
. . O

Baltic NNP O
Host NNP O
is VBZ O
a DT O
multinational JJ O
logistics NNS O
planning VBG O
exercise NN O
, , O
hosted VBN O
annually RB O
since IN O
2009 CD O
by IN O
one CD O
of IN O
the DT O
three CD O
Baltic NNP O
States NNP O
( NNP O
Estonia NNP O
, , O
Latvia NNP O
, , O
and CC O
Lithuania NNP O
, , O
all DT O
three CD O
of IN O
which WDT O
are VBP O
on IN O
Russia NNP O
's POS O
border NN O
) NN O
on IN O
a DT O
rotational JJ O
basis NN O
. . O

In IN O
June NNP O
2014 CD O
, , O
this DT O
event NN O
was VBD O
integrated VBN O
with IN O
a DT O
larger JJR O
U.S. NNP O
Army NNP O
training NN O
event NN O
, , O
and CC O
focused VBD O
on IN O
exercises NNS O
to TO O
improve VB O
interoperability NN O
with IN O
regional JJ O
allies NNS O
and CC O
partners. NN O
, , O
This DT O
domain NN O
registration NN O
suggests VBZ O
that IN O
APT28 NN O
sought VBD O
to TO O
target VB O
individuals NNS O
either CC O
participating VBG O
in IN O
the DT O
exercises NNS O
or CC O
interested JJ O
in IN O
Baltic JJ O
military NN O
and CC O
security NN O
matters NNS O
. . O

Such JJ O
targets NNS O
would MD O
potentially RB O
provide VB O
APT28 NN O
with IN O
sensitive JJ O
tactical JJ O
and CC O
strategic JJ O
intelligence NN O
concerning VBG O
regional JJ O
military JJ O
capabilities NNS O
and CC O
relationships NNS O
. . O

These DT O
exercises NNS O
are VBP O
a DT O
particular JJ O
point NN O
of IN O
interest NN O
in IN O
Moscow NNP O
: : O
pro- JJ O
Kremlin NNP O
press NN O
cited VBD O
Russia NNP O
's POS O
interpretation NN O
of IN O
these DT O
military JJ O
exercises NNS O
and CC O
NATO NNP O
's POS O
involvement NN O
as IN O
a DT O
'' '' O
sign NN O
of IN O
aggression NN O
, , O
'' '' O
and CC O
Russia NNP O
's POS O
Foreign NNP O
Minister NNP O
publicly RB O
stated VBD O
that IN O
the DT O
exercise NN O
was VBD O
'' '' O
a DT O
demonstration NN O
of IN O
hostile JJ O
intention NN O
. . O

'' '' O
APT28 NN O
's POS O
lures NNS O
and CC O
domain NN O
registrations NNS O
also RB O
demonstrate VBP O
their PRP$ O
interest NN O
in IN O
NATO NNP O
and CC O
other JJ O
European JJ O
security NN O
organizations NNS O
. . O

NATO NNP O
remains VBZ O
a DT O
chief JJ O
Russian JJ O
adversary NN O
, , O
or CC O
in IN O
the DT O
words NNS O
of IN O
Russia NNP O
's POS O
2010 CD O
military JJ O
doctrine NN O
, , O
a DT O
'' '' O
main JJ O
external JJ O
military JJ O
danger NN O
'' '' O
particularly RB O
as IN O
it PRP O
moves VBZ O
'' '' O
closer RBR O
to TO O
the DT O
borders NNS O
of IN O
the DT O
Russian NNP O
Federation NNP O
. . O

'' '' O
As IN O
the DT O
traditional JJ O
western JJ O
counterweight NN O
to TO O
the DT O
Soviet NNP O
Union NNP O
, , O
Russia NNP O
regards VBZ O
NATO NNP O
, , O
particularly RB O
NATO NNP O
's POS O
eastward RB O
expansion NN O
, , O
as IN O
a DT O
threat NN O
to TO O
Russia NNP O
's POS O
strategic JJ O
stability NN O
. . O

APT28 NN O
also RB O
registered VBD O
a DT O
domain NN O
name NN O
imitating VBG O
the DT O
Organization NNP O
for IN O
Security NNP O
and CC O
Cooperation NNP O
in IN O
Europe NNP O
( NNP O
OSCE NNP O
) NNP O
, , O
an DT O
intergovernmental JJ O
organization NN O
that WDT O
has VBZ O
cited VBN O
widespread JJ O
fraud NN O
in IN O
numerous JJ O
Russian JJ O
state NN O
elections NNS O
. . O

Insider NNP O
information NN O
about IN O
NATO NNP O
, , O
the DT O
OSCE NNP O
and CC O
other JJ O
security NN O
organizations NNS O
would MD O
inform VB O
Russian JJ O
political JJ O
and CC O
military JJ O
policy NN O
. . O

Several JJ B-Entity
of IN I-Entity
the DT I-Entity
domains NNS I-Entity
APT28 NN I-Entity
registered VBD I-Entity
imitated VBN B-Action
NATO NNP B-Entity
domain NN I-Entity
names NNS I-Entity
, , O
including VBG O
those DT O
of IN O
NATO NNP O
Special JJ O
Operations NNP O
Headquarters NN O
and CC O
the DT O
NATO NNP O
Future NNP O
Forces NNP O
Exhibition NNP O
. . O

We PRP O
also RB O
observed VBD O
a DT O
user NN O
that IN O
we PRP O
suspect VBP O
works NNS O
for IN O
NATO NNP O
HQ NNP O
submit VB O
an DT O
APT28 NN O
sample NN O
to TO O
VirusTotal NNP O
, , O
probably RB O
as IN O
a DT O
result NN O
of IN O
receiving VBG O
a DT O
suspicious JJ O
email NN O
. . O

APT28 NN O
also RB O
demonstrated VBD O
an DT O
interest NN O
in IN O
defense NN O
attaches VBZ O
working VBG O
in IN O
European JJ O
countries NNS O
. . O

We PRP O
identified VBD O
an DT B-Entity
APT28 NN I-Entity
lure NN I-Entity
containing VBG B-Action
a DT B-Entity
decoy NN I-Entity
document NN I-Entity
with IN I-Entity
a DT I-Entity
list NN I-Entity
of IN I-Entity
British JJ I-Entity
officers NNS I-Entity
and CC I-Entity
U.S. NNP I-Entity
and CC I-Entity
Canadian JJ I-Entity
military JJ I-Entity
attachés NNS I-Entity
in IN I-Entity
London NNP I-Entity
. . O

Finally RB O
, , O
APT28 NN B-Entity
used VBD B-Action
a DT B-Entity
lure NN I-Entity
that WDT I-Entity
contained VBD I-Entity
an DT I-Entity
apparent JJ I-Entity
non-public JJ I-Entity
listing NN I-Entity
of IN I-Entity
contact NN I-Entity
information NN I-Entity
for IN I-Entity
defense NN I-Entity
attachés NNS I-Entity
in IN I-Entity
the DT I-Entity
'' '' I-Entity
Ankara NNP I-Entity
Military NNP I-Entity
Attaché NNP I-Entity
Corps NNP I-Entity
( NNP I-Entity
AMAC NNP I-Entity
) NNP I-Entity
, , I-Entity
'' '' I-Entity
which WDT O
appears VBZ O
to TO O
be VB O
a DT O
professional JJ O
organization NN O
of IN O
defense NN O
attachés NNS O
in IN O
Turkey NNP O
. . O

In IN O
addition NN O
to TO O
targeting VBG O
European JJ O
security NN O
organizations NNS O
and CC O
governments NNS O
, , O
it PRP O
appears VBZ O
that IN O
APT28 NN O
is VBZ O
targeting VBG O
attendees NNS O
of IN O
European JJ O
defense NN O
exhibitions NNS O
. . O

Some DT B-Entity
of IN I-Entity
the DT I-Entity
APT28- JJ I-Entity
registered JJ I-Entity
domains NNS I-Entity
imitated VBD B-Action
those DT B-Entity
of IN I-Entity
defense NN I-Entity
events NNS I-Entity
held VBN I-Entity
in IN I-Entity
Europe NNP I-Entity
, , O
such JJ O
as IN O
the DT O
Farnborough NNP O
Airshow NNP O
2014 CD O
, , O
EuroNaval NNP O
2014 CD O
, , O
EUROSATORY NN O
2014 CD O
, , O
and CC O
the DT O
Counter NNP O
Terror NN O
Expo NNP O
. . O

In IN O
September NNP O
2014 CD O
, , O
APT28 NN B-Entity
registered VBD B-Action
a DT B-Entity
domain NN I-Entity
( FW I-Entity
smigroup- FW I-Entity
online.co FW I-Entity
[ FW I-Entity
. . I-Entity
] FW I-Entity
uk FW I-Entity
) NN I-Entity
that WDT I-Entity
appeared VBD I-Entity
to TO I-Entity
mimic VB I-Entity
that IN I-Entity
for IN I-Entity
the DT I-Entity
SMi NNP I-Entity
Group NNP I-Entity
, , O
a DT O
company NN O
that WDT O
plans VBZ O
events NNS O
for IN O
the DT O
'' '' O
Defence NNP O
, , O
Security NNP O
, , O
Energy NNP O
, , O
Utilities NNP O
, , O
Finance NNP O
and CC O
Pharmaceutical NNP O
sectors NNS O
. . O

'' '' O
Among IN O
other JJ O
events NNS O
, , O
the DT O
SMi NNP O
Group NNP O
is VBZ O
currently RB O
planning VBG O
a DT O
military JJ O
satellite NN O
communications NNS O
event NN O
for IN O
November NNP O
2014 CD O
. . O

Targeting NN O
organizations NNS O
and CC O
professionals NNS O
involved VBN O
in IN O
these DT O
defense NN O
events NNS O
would MD O
likely RB O
provide VB O
APT28 NN O
with IN O
an DT O
opportunity NN O
to TO O
procure VB O
intelligence NN O
pertaining VBG O
to TO O
new JJ O
defense NN O
technologies NNS O
, , O
as RB O
well RB O
as IN O
the DT O
victim NN O
organizations' NN O
operations NNS O
, , O
communications NNS O
, , O
and CC O
future JJ O
plans NNS O
. . O

APT28 NN O
has VBZ O
targeted VBN O
a DT O
variety NN O
of IN O
organizations NNS O
that WDT O
fall VBP O
outside IN O
of IN O
the DT O
three CD O
themes NNS O
we PRP O
highlighted VBD O
above IN O
. . O

However RB O
, , O
we PRP O
are VBP O
not RB O
profiling VBG O
all DT O
of IN O
APT28 NN O
's POS O
targets NNS O
with IN O
the DT O
same JJ O
detail NN O
because IN O
they PRP O
are VBP O
not RB O
particularly RB O
indicative JJ O
of IN O
a DT O
specific JJ O
sponsor NN O
's POS O
interests NNS O
. . O

They PRP O
do VBP O
indicate VB O
parallel JJ O
areas NNS O
of IN O
interest NN O
to TO O
many JJ O
governments NNS O
and CC O
do VBP O
not RB O
run VB O
counter RB O
to TO O
Russian JJ O
state NN O
interests NNS O
. . O

Other JJ O
probable JJ O
APT28 NN O
targets NNS O
that IN O
we PRP O
have VBP O
identified VBN O
: : O
Our PRP$ O
analysis NN O
of IN O
some DT O
of IN O
the DT O
group NN O
's POS O
more RBR O
commonly RB O
used VBN O
tools NNS O
indicates VBZ O
that IN O
APT28 NN O
has VBZ O
been VBN O
systematically RB O
updating VBG O
their PRP$ O
malware NN O
since IN O
2007 CD O
. . O

APT28 NN O
's POS O
tools NNS O
are VBP O
suggestive JJ O
of IN O
the DT O
group NN O
's POS O
skills NNS O
, , O
ambitions NNS O
, , O
and CC O
identity NN O
. . O

Our PRP$ O
analysis NN O
of IN O
some DT O
of IN O
the DT O
group NN O
's POS O
more RBR O
commonly RB O
used VBN O
tools NNS O
indicates VBZ O
that IN O
APT28 NN O
has VBZ O
been VBN O
systematically RB O
updating VBG O
their PRP$ O
tools NNS O
since IN O
2007 CD O
. . O

APT28 NN O
is VBZ O
most RBS O
likely RB O
supported VBN O
by IN O
a DT O
group NN O
of IN O
developers NNS O
creating VBG O
tools NNS O
intended VBN O
for IN O
long-term JJ O
use NN O
and CC O
versatility NN O
, , O
who WP O
make VBP O
an DT O
effort NN O
to TO O
obfuscate VB O
their PRP$ O
activity NN O
. . O

This DT O
suggests VBZ O
that IN O
APT28 NN O
receives VBZ O
direct JJ O
ongoing JJ O
financial JJ O
and CC O
other JJ O
resources NNS O
from IN O
a DT O
well-established JJ O
organization NN O
, , O
most RBS O
likely RB O
a DT O
nation NN O
state NN O
government NN O
. . O

APT28 NN O
's POS O
malware NN O
settings NNS O
suggest VBP O
that IN O
the DT O
developers NNS O
have VBP O
done VBN O
the DT O
majority NN O
of IN O
their PRP$ O
work NN O
in IN O
a DT O
Russian JJ O
language NN O
build VBP O
environment NN O
during IN O
Russian JJ O
business NN O
hours NNS O
, , O
which WDT O
suggests VBZ O
that IN O
the DT O
Russian JJ O
government NN O
is VBZ O
APT28 NN O
's POS O
sponsor NN O
. . O

Some DT B-Entity
of IN I-Entity
APT28 NN I-Entity
's POS I-Entity
more RBR I-Entity
commonly RB I-Entity
used VBN I-Entity
tools NNS I-Entity
are VBP B-Action
the DT B-Entity
SOURFACE NNP I-Entity
downloader NN I-Entity
, , O
its PRP$ B-Entity
second JJ I-Entity
stage NN I-Entity
backdoor JJ I-Entity
EVILTOSS NN I-Entity
, , O
and CC O
a DT B-Entity
modular JJ I-Entity
family NN I-Entity
of IN I-Entity
implants NNS I-Entity
that IN I-Entity
we PRP I-Entity
call VBP I-Entity
CHOPSTICK NNP I-Entity
. . O

• NNP O
SOURFACE NNP O
: : O
This DT O
downloader NN O
is VBZ O
typically RB O
called VBN O
Sofacy NNP O
within IN O
the DT O
cyber NN O
security NN O
community NN O
. . O

However RB O
because IN O
we PRP O
have VBP O
observed VBN O
the DT O
name NN O
'' '' O
Sofacy NNP O
'' '' O
used VBN O
to TO O
refer VB O
to TO O
APT28 NN O
malware NN O
generally RB O
( CD O
to TO O
include VB O
the DT O
SOURFACE NNP O
dropper NN O
, , O
EVILTOSS NN O
, , O
CHOPSTICK NN O
, , O
and CC O
the DT O
credential NN O
harvester NN O
OLDBAIT FW O
) FW O
, , O
we PRP O
are VBP O
using VBG O
the DT B-Entity
name NN I-Entity
SOURFACE NNP I-Entity
to TO O
precisely RB O
refer VB B-Action
to TO B-Modifier
a DT B-Entity
specific JJ I-Entity
downloader NN I-Entity
. . O

This DT B-Entity
downloader NN I-Entity
obtains VBZ B-Action
a DT B-Entity
second-stage JJ I-Entity
backdoor NN I-Entity
from IN B-Modifier
a DT B-Entity
C2 NN I-Entity
server NN I-Entity
. . O

CORESHELL NN O
is VBZ O
an DT O
updated VBN O
version NN O
of IN O
SOURFACE NNP O
. . O

• NNP O
EVILTOSS NNP O
: : O
This DT B-Entity
backdoor NN I-Entity
has VBZ O
been VBN B-Action
delivered VBN I-Action
through IN B-Modifier
the DT B-Entity
SOURFACE NNP I-Entity
downloader NN I-Entity
to TO O
gain VB B-Action
system NN B-Entity
access NN I-Entity
for IN B-Modifier
reconnaissance NN B-Entity
, , O
monitoring NN B-Entity
, , O
credential NN B-Entity
theft NN I-Entity
, , O
and CC O
shellcode NN B-Entity
execution NN I-Entity
. . O

• JJ O
CHOPSTICK NN O
: : O
This DT O
is VBZ O
a DT O
modular JJ O
implant VB O
compiled VBN O
from IN O
a DT O
software NN O
framework NN O
that WDT O
provides VBZ O
tailored VBN O
functionality NN O
and CC O
flexibility NN O
. . O

A DT O
number NN O
of IN O
the DT O
malware NN O
variants NNS O
that IN O
we PRP O
profile VBP O
below IN O
, , O
especially RB O
the DT O
CHOPSTICK NN O
family NN O
, , O
demonstrate VBP O
formal JJ O
coding NN O
practices NNS O
indicative JJ O
of IN O
methodical JJ O
, , O
diligent JJ O
programmers NNS O
. . O

The DT O
modularity NN O
of IN O
CHOPSTICK NN O
alone RB O
, , O
with IN O
its PRP$ O
flexible JJ O
and CC O
lasting JJ O
platform NN O
, , O
demonstrates VBZ O
planning NN O
for IN O
long-term JJ O
use NN O
and CC O
versatility NN O
. . O

We PRP O
have VBP O
also RB O
noted VBN O
that IN O
APT28 NN O
tailors VBZ O
implants NNS O
to TO O
their PRP$ O
target NN O
environments NNS O
, , O
configuring VBG O
them PRP B-Entity
to TO O
use VB B-Action
local JJ B-Entity
network NN I-Entity
resources NNS I-Entity
such JJ I-Entity
as IN I-Entity
email NN I-Entity
servers NNS I-Entity
. . O

APT28 NN B-Entity
has VBZ O
attempted VBN O
to TO O
obfuscate VB B-Action
their PRP$ B-Entity
code NN I-Entity
and CC O
implement VB B-Action
counter-analysis NN B-Entity
techniques NNS I-Entity
: : O
• CD O
One CD B-Entity
of IN I-Entity
the DT I-Entity
latest JJS I-Entity
samples NNS I-Entity
of IN I-Entity
CORESHELL NN I-Entity
includes VBZ B-Action
counter-reverse JJ B-Entity
engineering NN I-Entity
tactics NNS I-Entity
via IN B-Modifier
unused JJ B-Entity
machine NN I-Entity
instructions NNS I-Entity
. . O

This DT B-Entity
would MD O
hinder VB B-Action
static JJ B-Entity
analysis NN I-Entity
of IN I-Entity
CORESHELL NN I-Entity
behavior NN I-Entity
by IN B-Modifier
creating VBG B-Entity
a DT I-Entity
large JJ I-Entity
amount NN I-Entity
of IN I-Entity
unnecessary JJ I-Entity
noise NN I-Entity
in IN I-Entity
the DT I-Entity
disassembly NN I-Entity
. . O

• NN O
A NN B-Entity
number NN I-Entity
of IN I-Entity
CORESHELL NN I-Entity
droppers NNS I-Entity
also RB O
conduct VBP B-Action
runtime NN B-Entity
checks NNS I-Entity
, , O
attempting VBG O
to TO O
determine VB B-Action
if IN B-Entity
they PRP I-Entity
are VBP I-Entity
executing VBG I-Entity
in IN I-Entity
an DT I-Entity
analysis NN I-Entity
environment NN I-Entity
, , O
and CC O
if IN O
so RB O
, , O
they PRP O
do VBP O
not RB O
trigger VB O
their PRP$ O
payloads NNS O
. . O

• CD O
Many JJ B-Entity
samples NNS I-Entity
across IN I-Entity
the DT I-Entity
SOURFACE/ NNP I-Entity
CORESHELL NNP I-Entity
, , I-Entity
CHOPSTICK NNP I-Entity
, , I-Entity
and CC I-Entity
EVILTOSS FW I-Entity
malware FW I-Entity
families NNS I-Entity
obfuscate VBP B-Action
strings NNS B-Entity
that WDT I-Entity
are VBP I-Entity
decoded VBN I-Entity
at IN I-Entity
runtime NN I-Entity
. . O

Two CD B-Entity
of IN I-Entity
the DT I-Entity
malware NN I-Entity
families NNS I-Entity
( FW I-Entity
SOURFACE/CORESHELL FW I-Entity
and CC I-Entity
EVILTOSS FW I-Entity
) FW I-Entity
use VBP B-Action
the DT B-Entity
same JJ I-Entity
decryption NN I-Entity
sequence NN I-Entity
and CC I-Entity
similar JJ I-Entity
algorithms NNS I-Entity
for IN B-Modifier
string NN B-Entity
encoding VBG I-Entity
and CC I-Entity
decoding VBG I-Entity
. . O

These DT B-Entity
families NNS I-Entity
encode VBP B-Action
their PRP$ B-Entity
strings NNS I-Entity
at IN B-Modifier
compile VBP B-Entity
time NN I-Entity
using VBG B-Modifier
a DT B-Entity
custom NN I-Entity
stream NN I-Entity
cipher NN I-Entity
. . O

From IN O
a DT O
high JJ O
level NN O
, , O
these DT O
ciphers NNS O
share VBP O
a DT O
similar JJ O
design NN O
across IN O
the DT O
malware NN O
families NNS O
but CC O
differ VBP O
slightly RB O
in IN O
the DT O
internal JJ O
arithmetic NN O
operations NNS O
. . O

• FW O
APT28 FW B-Entity
has VBZ O
employed VBN B-Action
RSA NNP B-Entity
encryption NN I-Entity
to TO B-Modifier
protect VB B-Entity
files NNS I-Entity
and CC I-Entity
stolen VBN I-Entity
information NN I-Entity
moved VBD I-Entity
from IN I-Entity
the DT I-Entity
victim NN I-Entity
's POS I-Entity
network NN I-Entity
to TO I-Entity
the DT I-Entity
controller NN I-Entity
. . O

APT28 NN O
has VBZ O
made VBN O
incremental JJ O
and CC O
systematic JJ O
changes NNS O
to TO O
the DT O
SOURFACE NNP O
downloader NN O
and CC O
its PRP$ O
surrounding JJ O
ecosystem NN O
since IN O
as RB O
early RB O
as IN O
2007 CD O
. . O

These DT O
changes NNS O
indicate VBP O
a DT O
long-standing JJ O
and CC O
dedicated JJ O
development NN O
effort NN O
behind IN O
APT28 NN O
. . O

We PRP O
have VBP O
observed VBN O
samples NNS O
of IN O
the DT O
SOURFACE NNP O
downloader NN O
compiled VBD O
between IN O
2007 CD O
and CC O
2014 CD O
. . O

We PRP O
call VBP O
SOURFACE FW B-Entity
( FW O
samples NNS O
are VBP O
frequently RB O
named VBN O
netids.dll FW O
) FW O
a DT O
first JJ O
stage NN O
downloader NN O
because IN O
its PRP$ O
primary JJ O
job NN O
is VBZ O
to TO O
retrieve VB B-Action
a DT B-Entity
second JJ I-Entity
stage NN I-Entity
payload NN I-Entity
from IN B-Modifier
a DT B-Entity
C2 NN I-Entity
server NN I-Entity
. . O

Until IN O
2013 CD O
, , O
the DT B-Entity
SOURFACE NNP I-Entity
downloader NN I-Entity
used VBD B-Action
hard-coded JJ B-Entity
IP NNP I-Entity
addresses NNS I-Entity
for IN B-Modifier
C2 NN B-Entity
communications NNS I-Entity
, , O
whereas IN O
the DT B-Entity
future JJ I-Entity
CORESHELL NN I-Entity
samples NNS I-Entity
use VBP B-Action
domains NNS B-Entity
. . O

First NNP O
, , O
a DT O
malware NN O
family NN O
is VBZ O
a DT O
collection NN O
of IN O
malware NN O
in IN O
which WDT O
each DT O
sample NN O
shares VBZ O
a DT O
significant JJ O
amount NN O
of IN O
code NN O
with IN O
all DT O
of IN O
the DT O
others NNS O
. . O

There EX O
are VBP O
exceptions NNS O
: : O
for IN O
example NN O
, , O
some DT O
files NNS O
contain VBP O
public JJ O
and CC O
standard JJ O
code NN O
libraries NNS O
that IN O
we PRP O
do VBP O
not RB O
take VB O
into IN O
consideration NN O
when WRB O
making VBG O
a DT O
family NN O
determination NN O
. . O

A DT O
malware NN O
ecosystem NN O
is VBZ O
a DT O
group NN O
of IN O
malware NN O
families NNS O
that WDT O
work VBP O
together RB O
to TO O
perform VB O
the DT O
same JJ O
objective NN O
. . O

Perhaps RB O
the DT O
simplest JJS O
and CC O
most RBS O
typical JJ O
ecosystem NN O
is VBZ O
a DT O
dropper NN O
and CC O
a DT O
backdoor NN O
that WDT O
are VBP O
used VBN O
together RB O
. . O

They PRP O
may MD O
not RB O
share VB O
the DT O
same JJ O
code NN O
structure NN O
, , O
but CC O
they PRP O
are VBP O
related JJ O
because IN O
one NN B-Entity
drops VBZ B-Action
and CC I-Action
installs VBZ I-Action
the DT B-Entity
other JJ I-Entity
. . O

The DT O
ecosystem NN O
surrounding VBG O
the DT O
SOURFACE NNP O
downloader NN O
frequently RB O
consists VBZ O
of IN O
a DT B-Entity
dropper NN I-Entity
, , O
which WDT O
installs VBZ B-Action
SOURFACE NNP B-Entity
. . O

The DT B-Entity
SOURFACE NNP I-Entity
downloader NN I-Entity
then RB O
receives VBZ B-Action
another DT B-Entity
dropper NN I-Entity
from IN B-Modifier
its PRP$ B-Entity
C2 NN I-Entity
server NN I-Entity
, , O
and CC O
this DT B-Entity
second JJ I-Entity
dropper NN I-Entity
installs VBZ B-Action
a DT B-Entity
second JJ I-Entity
stage NN I-Entity
backdoor NN I-Entity
, , O
which WDT O
is VBZ O
usually RB O
EVILTOSS NNP O
. . O

In IN O
April NNP O
2013 CD O
, , O
based VBN O
on IN O
compile VB O
time NN O
, , O
the DT O
group NN O
began VBD O
to TO O
make VB O
significant JJ O
alterations NNS O
to TO O
the DT O
SOURFACE NNP O
downloader NN O
. . O

They PRP O
started VBD O
by IN O
changing VBG O
the DT O
compiled VBN O
DLL NNP O
name NN O
to TO O
'' '' O
coreshell.dll NN O
'' '' O
and CC O
making VBG O
minor JJ O
changes NNS O
to TO O
the DT O
network NN O
communications NNS O
, , O
as IN O
seen VBN O
in IN O
Figure NNP O
7 CD O
. . O

The DT O
hostname NN O
, , O
volume NN O
serial NN O
number NN O
and CC O
OS NN O
version NN O
data NNS O
are VBP O
encoded VBN O
in IN O
the DT O
new JJ O
URL NN O
format NN O
. . O

As IN O
seen VBN O
in IN O
the DT O
table NN O
below IN O
, , O
the DT O
SOURFACE/ NNP O
CORESHELL NNP O
developers NNS O
also RB O
made VBD O
other JJ O
modifications NNS O
that WDT O
changed VBD O
the DT O
exported VBN O
function NN O
name NN O
and CC O
file NN O
size NN O
over IN O
time NN O
. . O

In IN O
April NNP O
2013 CD O
, , O
based VBN O
on IN O
compile VB O
time NN O
, , O
the DT O
group NN O
began VBD O
to TO O
make VB O
significant JJ O
alterations NNS O
to TO O
the DT O
SOURFACE NNP O
downloader NN O
. . O

Variants NNS O
of IN O
the DT O
SOURFACE NNP O
second JJ O
stage NN O
backdoor NN O
, , O
EVILTOSS NN O
, , O
share VBP O
some DT O
code NN O
similarities NNS O
with IN O
SOURFACE NN O
. . O

However RB O
, , O
it PRP B-Entity
contains VBZ O
more JJR O
capabilities NNS O
, , O
including VBG O
the DT O
ability NN O
to TO O
provide VB B-Action
access NN B-Entity
to TO I-Entity
the DT I-Entity
file NN I-Entity
system NN I-Entity
and CC I-Entity
registry NN I-Entity
, , O
enumerate VB B-Action
network NN B-Entity
resources NNS I-Entity
, , O
create VB B-Action
processes NNS B-Entity
, , O
log NN B-Action
keystrokes NNS B-Entity
, , O
access NN B-Action
stored VBD B-Entity
credentials NNS I-Entity
, , O
and CC O
execute VB B-Action
shellcode NN B-Entity
. . O

The DT B-Entity
backdoor NN I-Entity
encrypts VBZ B-Action
data NNS B-Entity
that IN O
it PRP B-Entity
uploads VBZ B-Action
with IN B-Modifier
an DT B-Entity
RSA NN I-Entity
public JJ I-Entity
key NN I-Entity
. . O

Many JJ O
of IN O
its PRP$ O
variants NNS O
we PRP O
have VBP O
seen VBN O
are VBP O
named VBN O
netui.dll NN O
. . O

EVILTOSS NN B-Entity
variants NNS I-Entity
may MD O
use VB B-Action
the DT B-Entity
Simple JJ I-Entity
Mail NNP I-Entity
Transfer NN I-Entity
Protocol NNP I-Entity
( NNP I-Entity
SMTP NNP I-Entity
) NNP I-Entity
to TO B-Modifier
send VB B-Entity
stolen JJ I-Entity
data NNS I-Entity
in IN I-Entity
an DT I-Entity
attachment NN I-Entity
named VBN I-Entity
'' '' I-Entity
detaluri FW I-Entity
. . I-Entity
dat NN I-Entity
'' '' I-Entity
. . O

The DT B-Entity
backdoor NN I-Entity
attaches VBZ B-Action
this DT B-Entity
file NN I-Entity
to TO B-Modifier
a DT B-Entity
preformatted JJ I-Entity
email NN I-Entity
and CC O
sends VBZ B-Action
it PRP B-Entity
out RP B-Modifier
through IN B-Modifier
a DT B-Entity
victim NN I-Entity
's POS I-Entity
mail NN I-Entity
server NN I-Entity
. . O

Interestingly RB O
, , O
we PRP O
found VBD O
an DT O
antivirus JJ O
report NN O
from IN O
2004 CD O
detailing VBG O
what WP O
appears VBZ O
to TO O
be VB O
an DT O
early JJ O
variant NN O
of IN O
EVILTOSS NN O
. . O

The DT B-Entity
backdoor NN I-Entity
was VBD B-Action
installed VBN I-Action
alongside IN B-Modifier
the DT B-Entity
NATO-themed JJ I-Entity
decoy NN I-Entity
document NN I-Entity
depicted VBN I-Entity
in IN I-Entity
Figure NNP I-Entity
8 CD I-Entity
. . O

The DT B-Entity
backdoor NN I-Entity
sent VBD B-Action
data NNS B-Entity
via IN B-Modifier
SMTP NN B-Entity
to TO B-Modifier
natosmtp NN B-Entity
@ IN I-Entity
mail NN I-Entity
[ NN I-Entity
. . I-Entity
] FW I-Entity
ru FW I-Entity
and CC O
received VBD B-Action
its PRP$ B-Entity
tasking NN I-Entity
via IN B-Modifier
POP NNP B-Entity
from IN B-Modifier
natopop NN B-Entity
@ IN I-Entity
mail NN I-Entity
[ NN I-Entity
. . I-Entity
] FW I-Entity
ru FW I-Entity
. . O

Although IN O
we PRP O
have VBP O
not RB O
conclusively RB O
attributed VBD O
this DT O
sample NN O
to TO O
APT28 NN O
, , O
it PRP O
does VBZ O
suggest VB O
the DT O
possibility NN O
that IN O
APT28 NN O
has VBZ O
been VBN O
operating VBG O
since IN O
as RB O
early RB O
as IN O
2004 CD O
. . O

A DT O
modular JJ O
development NN O
framework NN O
suggests VBZ O
the DT O
group NN O
has VBZ O
had VBN O
an DT O
organized VBN O
development NN O
effort NN O
since IN O
as RB O
early RB O
as IN O
2007 CD O
. . O

During IN O
our PRP$ O
research NN O
, , O
we PRP O
discovered VBD O
that IN O
APT28 NN B-Entity
uses VBZ B-Action
a DT B-Entity
backdoor NN I-Entity
developed VBD I-Entity
using VBG I-Entity
a DT I-Entity
modular JJ I-Entity
framework NN I-Entity
. . O

We PRP O
call VBP O
this DT O
backdoor JJ O
CHOPSTICK NN O
, , O
a DT O
somewhat RB O
ironic JJ O
name NN O
that WDT O
comes VBZ O
from IN O
our PRP$ O
semi-random JJ O
name NN O
generator NN O
. . O

The DT O
modular JJ O
design NN O
allows VBZ O
flexible JJ O
options NNS O
for IN O
compiling VBG O
variants NNS O
with IN O
different JJ O
capabilities NNS O
as IN O
needed VBN O
, , O
as RB O
well RB O
as IN O
deploying VBG O
additional JJ O
capabilities NNS O
at IN O
runtime NN O
. . O

This DT O
allows VBZ O
the DT O
developers NNS O
to TO O
make VB O
targeted JJ O
implants NNS O
, , O
including VBG O
only RB O
the DT O
capabilities NNS O
and CC O
protocols NNS O
necessary JJ O
for IN O
a DT O
specific JJ O
environment NN O
. . O

Such PDT O
a DT O
modular JJ O
framework NN O
suggests VBZ O
the DT O
group NN O
has VBZ O
had VBN O
an DT O
organized VBN O
development NN O
effort NN O
since IN O
as RB O
early RB O
as IN O
2007 CD O
. . O

A DT O
formal JJ O
development NN O
environment NN O
, , O
in IN O
which WDT O
code NN O
is VBZ O
versioned VBN O
and CC O
well-organized JJ O
, , O
would MD O
almost RB O
certainly RB O
be VB O
required VBN O
to TO O
track VB O
and CC O
define VB O
the DT O
various JJ O
modules NNS O
that WDT O
can MD O
be VB O
included VBN O
in IN O
the DT O
backdoor NN O
at IN O
compile VB O
time NN O
. . O

CHOPSTICK NN O
variants NNS O
may MD O
move VB O
messages NNS O
and CC O
information NN O
using VBG O
at IN O
least JJS O
three CD O
methods NNS O
: : O
1 CD O
. . O

Communications NNPS B-Entity
with IN I-Entity
a DT I-Entity
C2 NN I-Entity
server NN I-Entity
using VBG B-Action
HTTP NN B-Entity
. . O

These DT O
protocols NNS O
are VBP O
covered VBN O
in IN O
more JJR O
detail NN O
in IN O
Appendix NNP O
D. NNP O
2 CD O
. . O

Email VB B-Entity
sent VBN B-Action
through IN B-Modifier
a DT B-Entity
specified VBN I-Entity
mail NN I-Entity
server NN I-Entity
. . O

One CD B-Entity
CHOPSTICK NN I-Entity
v1 NN I-Entity
variant NN I-Entity
contained VBD O
modules NNS O
and CC O
functions NNS O
for IN O
collecting VBG B-Action
keystroke NN B-Entity
logs NNS I-Entity
, , O
Microsoft NNP B-Entity
Office NNP I-Entity
documents NNS I-Entity
, , O
and CC O
PGP NNP B-Entity
files NNS I-Entity
. . O

The DT B-Entity
monitoring NN I-Entity
for IN I-Entity
new JJ I-Entity
files NNS I-Entity
of IN I-Entity
interest NN I-Entity
is VBZ B-Action
performed VBN I-Action
by IN O
a DT B-Entity
'' '' I-Entity
Directory NNP I-Entity
Observer NNP I-Entity
'' '' I-Entity
module NN I-Entity
. . O

In IN O
one CD O
sample NN O
this DT B-Entity
information NN I-Entity
was VBD O
intended VBN O
to TO O
be VB B-Action
sent VBN I-Action
via IN B-Modifier
SMTP NN B-Entity
using VBG B-Modifier
a DT B-Entity
Georgian JJ I-Entity
MIA NN I-Entity
mail NN I-Entity
server NN I-Entity
. . O

It PRP B-Entity
used VBD B-Action
one CD B-Entity
of IN I-Entity
four CD I-Entity
embedded JJ I-Entity
sender NN I-Entity
email NN I-Entity
addresses NNS I-Entity
( VBP I-Entity
@ SYM I-Entity
mia.gov.ge FW I-Entity
) FW I-Entity
to TO B-Modifier
send VB B-Entity
files NNS I-Entity
via IN I-Entity
email NN I-Entity
to TO I-Entity
another DT I-Entity
email NN I-Entity
address NN I-Entity
on IN I-Entity
the DT I-Entity
same JJ I-Entity
mail NN I-Entity
server NN I-Entity
. . O

All DT O
information NN O
required VBN O
for IN O
the DT O
email NN O
was VBD O
hardcoded VBN O
in IN O
the DT O
backdoor NN O
. . O

3 CD O
. . O

Local JJ O
copying NN O
to TO O
defeat VB O
closed JJ O
networks NNS O
. . O

One CD B-Entity
variant NN I-Entity
of IN I-Entity
CHOPSTICK NN I-Entity
focuses VBZ O
on IN O
apparent JJ O
air NN O
gap NN O
/ : O
closed VBN O
network NN O
capabilities NNS O
by IN O
routing VBG B-Action
messages NNS B-Entity
between IN B-Modifier
local JJ B-Entity
directories NNS I-Entity
, , I-Entity
the DT I-Entity
registry NN I-Entity
and CC I-Entity
USB JJ I-Entity
drives NNS I-Entity
. . O

During IN O
our PRP$ O
research NN O
into IN O
APT28 NN O
's POS O
malware NN O
, , O
we PRP O
noted VBD O
two CD O
details NNS O
consistent JJ O
across IN O
malware NN O
samples NNS O
. . O

The DT O
first JJ O
was VBD O
that IN O
APT28 NN O
had VBD O
consistently RB O
compiled VBN O
Russian JJ O
language NN O
settings NNS O
into IN O
their PRP$ O
malware NN O
. . O

The DT O
second NN O
was VBD O
that IN O
malware NN O
compile VBP O
times NNS O
from IN O
2007 CD O
to TO O
2014 CD O
corresponded VBD O
to TO O
normal JJ O
business NN O
hours NNS O
in IN O
the DT O
UTC NNP O
+ CC O
4 CD O
time NN O
zone NN O
, , O
which WDT O
includes VBZ O
major JJ O
Russian JJ O
cities NNS O
such JJ O
as IN O
Moscow NNP O
and CC O
St. NNP O
Petersburg NNP O
. . O

PE NN O
resources NNS O
include VBP O
language NN O
information NN O
that WDT O
can MD O
be VB O
helpful JJ O
if IN O
a DT O
developer NN O
wants VBZ O
to TO O
show VB O
user NN O
interface NN O
items NNS O
in IN O
a DT O
specific JJ O
language NN O
. . O

Non-default JJ O
language NN O
settings NNS O
packaged VBN O
with IN O
PE NN O
resources NNS O
are VBP O
dependent JJ O
on IN O
the DT O
developer NN O
's POS O
build VB O
environment NN O
. . O

Each JJ O
PE NN O
resource NN O
includes VBZ O
a DT O
'' '' O
locale NN O
'' '' O
identifier NN O
with IN O
a DT O
language NN O
ID NN O
'' '' O
composed VBN O
of IN O
a DT O
primary JJ O
language NN O
identifier NN O
indicating VBG O
the DT O
language NN O
and CC O
a DT O
sublanguage JJ O
identifier NN O
indicating VBG O
the DT O
country/region NN O
. . O

'' '' O
At IN O
the DT O
time NN O
of IN O
the DT O
writing NN O
of IN O
this DT O
paper NN O
, , O
we PRP O
had VBD O
identified VBN O
103 CD O
malware NN O
samples NNS O
that WDT O
were VBD O
both DT O
attributed VBN O
to TO O
APT28 NN O
and CC O
contained VBD O
PE NN O
resources NNS O
. . O

Table NNP O
5 CD O
shows VBZ O
the DT O
locale NN O
identifiers NNS O
with IN O
associated VBN O
language NN O
and CC O
country/region NN O
for IN O
these DT O
samples NNS O
. . O

The DT O
samples NNS O
with IN O
Russian JJ O
language NN O
settings NNS O
were VBD O
compiled VBN O
between IN O
late JJ O
2007 CD O
and CC O
late JJ O
2013 CD O
, , O
as IN O
depicted VBN O
in IN O
Figure NNP O
9 CD O
. . O

This DT O
consistency NN O
over IN O
a DT O
long JJ O
timeframe NN O
suggests VBZ O
that IN O
the DT O
developers NNS O
of IN O
APT28 NN O
malware NN O
were VBD O
using VBG O
a DT O
build VB O
environment NN O
with IN O
Russian JJ O
language NN O
settings NNS O
at IN O
least JJS O
some DT O
of IN O
the DT O
time NN O
and CC O
made VBD O
no DT O
effort NN O
to TO O
obscure VB O
this DT O
detail NN O
. . O

Overall NNP O
, , O
the DT O
locale NN O
IDs NNS O
suggest VBP O
that IN O
APT28 NN O
developers NNS O
can MD O
operate VB O
in IN O
both DT O
Russian NNP O
and CC O
English NNP O
. . O

Of IN O
the DT O
140 CD O
malware NN O
samples NNS O
that IN O
we PRP O
have VBP O
attributed VBN O
to TO O
APT28 NN O
so RB O
far RB O
, , O
over IN O
89 CD O
% NN O
were VBD O
compiled VBN O
between IN O
0400 CD O
and CC O
1400 CD O
UTC NNP O
time NN O
, , O
as IN O
depicted VBN O
in IN O
Figure NNP O
10 CD O
. . O

Over NNP O
96 CD O
% NN O
were VBD O
compiled VBN O
between IN O
Monday NNP O
and CC O
Friday NNP O
. . O

This DT O
parallels VBZ O
the DT O
working VBG O
hours NNS O
in IN O
UTC+0400 FW O
( FW O
that DT O
is VBZ O
, , O
compile VB O
times NNS O
begin VB O
about IN O
8AM NN O
and CC O
end NN O
about IN O
6PM NN O
in IN O
this DT O
time NN O
zone NN O
) NN O
. . O

This DT O
time NN O
zone NN O
includes VBZ O
major JJ O
Russian JJ O
cities NNS O
such JJ O
as IN O
Moscow NNP O
and CC O
St. NNP O
Petersburg NNP O
. . O

We PRP O
started VBD O
researching VBG O
APT28 NN O
based VBN O
on IN O
activity NN O
we PRP O
observed VBD O
on IN O
our PRP$ O
clients NNS O
' POS O
networks NNS O
, , O
similar JJ O
to TO O
other JJ O
targeted VBN O
threat NN O
groups NNS O
we PRP O
have VBP O
identified VBN O
over IN O
time NN O
. . O

We PRP O
assess VBP O
that IN O
APT28 NN O
is VBZ O
most RBS O
likely RB O
sponsored VBN O
by IN O
the DT O
Russian JJ O
government NN O
. . O

We PRP O
summarize VBP O
our PRP$ O
key JJ O
observations NNS O
about IN O
APT28 NN O
in IN O
Figure NNP O
11 CD O
below IN O
. . O

APT28 NN O
's POS O
characteristics-their JJ O
targeting NN O
, , O
malware NN O
, , O
language NN O
, , O
and CC O
working VBG O
hours-have NN O
led VBD O
us PRP O
to TO O
conclude VB O
that IN O
we PRP O
are VBP O
tracking VBG O
a DT O
focused JJ O
, , O
long- JJ O
standing NN O
espionage NN O
effort NN O
. . O

Given IN O
the DT O
available JJ O
data NNS O
, , O
we PRP O
assess VBP O
that IN O
APT28 NN O
's POS O
work NN O
is VBZ O
sponsored VBN O
by IN O
the DT O
Russian JJ O
government NN O
. . O

We PRP O
use VBP O
the DT O
term NN O
'' '' O
threat NN O
group NN O
'' '' O
to TO O
refer VB O
to TO O
actors NNS O
who WP O
work VBP O
together RB O
to TO O
target VB O
and CC O
penetrate VB O
networks NNS O
of IN O
interest NN O
. . O

These DT O
individuals NNS O
may MD O
share VB O
the DT O
same JJ O
set NN O
of IN O
tasks NNS O
, , O
coordinate JJ O
targets NNS O
, , O
and CC O
share NN O
tools NNS O
and CC O
methodology NN O
. . O

They PRP B-Entity
work VBP O
together RB O
to TO O
gain VB B-Action
access NN B-Entity
to TO I-Entity
their PRP$ I-Entity
targets NNS I-Entity
and CC O
steal VB B-Action
data NNS B-Entity
. . O

The DT O
art NN O
of IN O
attributing VBG O
disparate JJ O
intrusion NN O
activities NNS O
to TO O
the DT O
same JJ O
threat NN O
group NN O
is VBZ O
not RB O
always RB O
simple JJ O
. . O

Different JJ O
groups NNS O
may MD O
use VB O
similar JJ O
intrusion NN O
methodologies NNS O
and CC O
common JJ O
tools NNS O
, , O
particularly RB O
those DT O
that WDT O
are VBP O
widely RB O
available JJ O
on IN O
the DT O
Internet NNP O
, , O
such JJ O
as IN O
pwdump NN O
, , O
HTran NN O
, , O
or CC O
Gh0st NN O
RAT NN O
. . O

There EX O
may MD O
be VB O
overlaps VBZ O
between IN O
groups NNS O
caused VBN O
by IN O
the DT O
sharing NN O
of IN O
malware NN O
or CC O
exploits NNS O
they PRP O
have VBP O
authored VBN O
, , O
or CC O
even RB O
the DT O
sharing NN O
of IN O
personnel NNS O
. . O

Individual NNP O
threat NN O
actors NNS O
may MD O
move VB O
between IN O
groups NNS O
either CC O
temporarily RB O
or CC O
permanently RB O
. . O

A DT O
threat NN O
actor NN O
may MD O
also RB O
be VB O
a DT O
private JJ O
citizen NN O
who WP O
is VBZ O
hired VBN O
by IN O
multiple JJ O
groups NNS O
. . O

Multiple JJ O
groups NNS O
, , O
on IN O
occasion NN O
, , O
compromise VBP O
the DT O
same JJ O
target NN O
within IN O
the DT O
same JJ O
timeframe NN O
. . O

Distinguishing VBG O
one CD O
threat NN O
group NN O
from IN O
another DT O
is VBZ O
possible JJ O
with IN O
enough JJ O
information NN O
, , O
analytical JJ O
experience NN O
, , O
and CC O
tools NNS O
to TO O
piece VB O
it PRP O
all RB O
together RB O
. . O

We PRP O
can MD O
analyze VB O
multiple JJ O
incidents NNS O
and CC O
tell VB O
by IN O
the DT O
evidence NN O
left VBD O
behind RP O
that IN O
a DT O
given VBN O
incident NN O
was VBD O
the DT O
result NN O
of IN O
one CD O
threat NN O
group NN O
and CC O
not RB O
another DT O
. . O

Threat NN O
actors NNS O
leave VBP O
behind IN O
various JJ O
forensic JJ O
details NNS O
. . O

They PRP B-Entity
may MD O
send VB B-Action
spear JJ B-Entity
phishing NN I-Entity
emails NNS I-Entity
from IN B-Modifier
a DT B-Entity
specific JJ I-Entity
IP NNP I-Entity
address NN I-Entity
or CC I-Entity
email NN I-Entity
address NN I-Entity
. . O

Their PRP$ O
emails NNS O
may MD O
contain VB O
certain JJ O
patterns NNS O
; : O
files NNS O
have VBP O
specific JJ O
names NNS O
, , O
MD5 NN O
hashes NNS O
, , O
timestamps NNS O
, , O
custom NN O
functions NNS O
, , O
and CC O
encryption NN O
algorithms NNS O
. . O

Their PRP$ O
backdoors NNS O
may MD O
have VB O
command NN O
and CC O
control NN O
IP NNP O
addresses NNS O
or CC O
domain NN O
names NNS O
embedded VBD O
. . O

These DT O
are VBP O
just RB O
a DT O
few JJ O
examples NNS O
of IN O
the DT O
myriad JJ O
of IN O
forensic JJ O
details NNS O
that IN O
we PRP O
consider VBP O
when WRB O
distinguishing VBG O
one CD O
threat NN O
group NN O
from IN O
another DT O
. . O

At IN O
the DT O
most RBS O
basic JJ O
level NN O
, , O
we PRP O
say VBP O
that IN O
two CD O
intrusion NN O
events NNS O
are VBP O
attributed VBN O
to TO O
the DT O
same JJ O
group NN O
when WRB O
we PRP O
have VBP O
collected VBN O
enough JJ O
indicators NNS O
to TO O
show VB O
beyond IN O
a DT O
reasonable JJ O
doubt NN O
that IN O
the DT O
same JJ O
actor NN O
or CC O
group NN O
of IN O
actors NNS O
were VBD O
involved VBN O
. . O

We PRP O
track VBP O
all DT O
of IN O
the DT O
indicators NNS O
and CC O
significant JJ O
linkages NNS O
associated VBN O
with IN O
identified VBN O
threat NN O
groups NNS O
in IN O
a DT O
proprietary JJ O
database NN O
that WDT O
comprises VBZ O
millions NNS O
of IN O
nodes NNS O
and CC O
linkages NNS O
between IN O
them PRP O
. . O

In IN O
this DT O
way NN O
, , O
we PRP O
can MD O
always RB O
go VB O
back RB O
and CC O
answer VB O
'' '' O
why WRB O
'' '' O
we PRP O
associated VBD O
cyber NN O
threat NN O
activity NN O
with IN O
a DT O
particular JJ O
group NN O
. . O

SOURFACE NNP B-Entity
is VBZ B-Action
a DT B-Entity
downloader NN I-Entity
that WDT O
obtains VBZ B-Action
a DT B-Entity
second JJ I-Entity
stage NN I-Entity
backdoor NN I-Entity
from IN B-Modifier
a DT B-Entity
C2 NN I-Entity
server NN I-Entity
. . O

Over NNP O
time NN O
the DT O
downloader NN O
has VBZ O
evolved VBN O
and CC O
the DT O
newer JJR O
versions NNS O
, , O
usually RB O
compiled VBN O
with IN O
the DT O
DLL NNP O
name NN O
'coreshell.dll NN O
' '' O
, , O
are VBP O
distinct JJ O
enough RB O
from IN O
the DT O
older JJR O
versions NNS O
that IN O
we PRP O
refer VBP O
to TO O
it PRP O
as IN O
SOURFACE/CORESHELL NN O
or CC O
simply RB O
CORESHELL NNP O
. . O

This DT O
appendix NN O
focuses VBZ O
on IN O
these DT O
newer JJR O
versions NNS O
. . O

CORESHELL NNP B-Entity
uses VBZ B-Action
two CD B-Entity
threads NNS I-Entity
to TO B-Modifier
communicate VB B-Entity
with IN I-Entity
its PRP$ I-Entity
C2 NN I-Entity
server NN I-Entity
. . O

The DT B-Entity
first JJ I-Entity
thread NN I-Entity
sends VBZ B-Action
beacons NNS B-Entity
that WDT I-Entity
contain VBP I-Entity
the DT I-Entity
process NN I-Entity
listing NN I-Entity
of IN I-Entity
the DT I-Entity
compromised VBN I-Entity
host NN I-Entity
. . O

The DT B-Entity
second JJ I-Entity
thread NN I-Entity
is VBZ O
responsible JJ O
for IN O
downloading VBG B-Action
and CC O
executing VBG B-Action
stage NN B-Entity
two CD I-Entity
payloads NNS I-Entity
. . O

Messages NNS B-Entity
are VBP B-Action
sent VBN I-Action
using VBG B-Modifier
HTTP NNP B-Entity
POST NNP I-Entity
requests NNS I-Entity
whose WP$ O
bodies NNS O
contain VBP B-Action
encrypted JJ B-Entity
and CC I-Entity
Base64 NN I-Entity
encoded VBD I-Entity
data NNS I-Entity
. . O

The DT O
encryption NN O
algorithm NN O
is VBZ O
a DT O
custom NN O
stream NN O
cipher NN O
using VBG O
a DT O
six-byte JJ O
key NN O
. . O

Commands NNPS B-Entity
from IN I-Entity
the DT I-Entity
controller NN I-Entity
to TO I-Entity
the DT I-Entity
CORESHELL NN I-Entity
implant VB I-Entity
are VBP B-Action
encrypted VBN I-Action
using VBG B-Modifier
another DT B-Entity
stream NN I-Entity
cipher NN I-Entity
but CC I-Entity
this DT I-Entity
time NN I-Entity
using VBG I-Entity
an DT I-Entity
eight-byte JJ I-Entity
key NN I-Entity
. . O

CORESHELL NNP O
has VBZ O
used VBN O
the DT O
same JJ O
user NN O
agent NN O
string NN O
( NN O
'' '' O
MSIE NN O
8.0 CD O
'' '' O
) NNP O
that IN O
SOURFACE NNP O
previously RB O
used VBN O
, , O
but CC O
in IN O
more RBR O
recent JJ O
samples NNS O
CORESHELL NN O
uses VBZ O
the DT O
default NN O
Internet NNP O
Explorer NNP O
user NN O
agent NN O
string NN O
obtained VBN O
from IN O
the DT O
system NN O
. . O

Figure NNP O
11 CD O
shows VBZ O
an DT O
example NN O
POST NN O
request NN O
. . O

When WRB O
Base64 NN O
decoded VBD O
, , O
the DT O
POST NN O
content NN O
looks VBZ O
like IN O
this DT O
: : O
The DT O
key NN O
used VBN O
to TO O
encrypt VB O
the DT O
message NN O
is VBZ O
six CD O
bytes NNS O
long RB O
and CC O
is VBZ O
appended VBN O
to TO O
the DT O
end NN O
of IN O
the DT O
message NN O
. . O

In IN O
this DT O
is VBZ O
example NN O
the DT O
key NN O
would MD O
be VB O
: : O
30 CD O
ac FW O
e5 FW O
21 CD O
e4 FW O
a6 FW O
. . O

When WRB O
the DT O
message NN O
is VBZ O
decrypted VBN O
, , O
the DT O
resulting VBG O
plaintext NN O
is VBZ O
: : O
The DT O
following VBG O
table NN O
contains VBZ O
a DT O
breakdown NN O
of IN O
each DT O
of IN O
the DT O
field NN O
's POS O
C2 NN O
message NN O
. . O

Commands NNPS B-Entity
are VBP B-Action
sent VBN I-Action
from IN B-Modifier
the DT B-Entity
C2 NN I-Entity
server NN I-Entity
to TO B-Modifier
the DT B-Entity
CORESHELL NNP I-Entity
backdoor NN I-Entity
in IN B-Modifier
HTTP NN B-Entity
responses NNS I-Entity
to TO I-Entity
the DT I-Entity
POST NN I-Entity
requests NNS I-Entity
. . O

The DT O
command NN O
is VBZ O
identified VBN O
by IN O
the DT O
NULL NN O
terminated VBN O
UNICODE NNP O
string NN O
'' '' O
OK JJ O
'' '' O
( NN O
O\x00\K\x00\x00\ NN O
x00 NN O
) NN O
. . O

The DT O
command NN O
is VBZ O
Base64 NN O
encoded VBN O
and CC O
immediately RB O
follows VBZ O
the DT O
'' '' O
OK JJ O
'' '' O
string NN O
. . O

Figure NNP O
12 CD O
shows VBZ O
a DT O
sample NN O
CORESHELL NN O
command NN O
: : O
The DT O
Base64 NN O
decoded VBD O
string NN O
is VBZ O
: : O
The DT O
following VBG O
table NN O
contains VBZ O
a DT O
description NN O
of IN O
each DT O
field NN O
in IN O
the DT O
command NN O
message NN O
: : O
When WRB O
the DT O
above JJ O
command NN O
'' '' O
10 CD O
41 CD O
70 CD O
41 CD O
10 CD O
42 CD O
33… CD O
'' '' O
is VBZ O
decrypted VBN O
using VBG O
the DT O
key JJ O
'' '' O
01 CD O
01 CD O
01 CD O
01 CD O
01 CD O
01 CD O
01 CD O
01 CD O
'' '' O
the DT O
following VBG O
command NN O
message NN O
is VBZ O
produced VBN O
: : O
The DT O
implant VBP O
supports VBZ O
the DT O
following JJ O
four CD O
command NN O
identifiers NNS O
from IN O
the DT O
controller NN O
as IN O
seen VBN O
in IN O
Table NNP O
8 CD O
. . O

The DT O
first JJ O
byte NN O
of IN O
the DT O
command NN O
message NN O
specifies VBZ O
the DT O
command NN O
type NN O
and CC O
is VBZ O
immediately RB O
followed VBN O
by IN O
the DT O
PE NN O
or CC O
shellcode NN O
to TO O
be VB O
executed VBN O
. . O

In IN O
this DT O
example NN O
the DT O
command NN O
byte NN O
is VBZ O
04 CD O
indicating VBG O
the DT O
following JJ O
bytes NNS O
are VBP O
shellcode JJ O
. . O

If IN O
the DT O
command NN O
byte NN O
was VBD O
01 CD O
, , O
02 CD O
, , O
or CC O
03 CD O
the DT O
following JJ O
bytes NNS O
would MD O
be VB O
a DT B-Entity
DLL NNP I-Entity
or CC I-Entity
EXE NNP I-Entity
that WDT O
would MD O
be VB B-Action
written VBN I-Action
to TO B-Modifier
disk NN B-Entity
and CC O
executed VBN B-Action
. . O

CHOPSTICK NN B-Entity
is VBZ B-Action
a DT B-Entity
backdoor NN I-Entity
that WDT O
uses VBZ O
a DT O
modularized JJ O
, , O
object-oriented JJ O
framework NN O
written VBN O
in IN O
C++ NNP O
. . O

This DT O
framework NN O
allows VBZ O
for IN O
a DT O
diverse JJ O
set NN O
of IN O
capabilities NNS O
across IN O
malware NN O
variants NNS O
sharing VBG O
a DT O
common JJ O
code NN O
base NN O
. . O

CHOPSTICK NN B-Entity
may MD O
communicate VB B-Action
with IN B-Modifier
external JJ B-Entity
servers NNS I-Entity
using VBG B-Modifier
SMTP NN B-Entity
or CC I-Entity
HTTP NN I-Entity
. . O

This DT O
appendix NN O
documents VBZ O
variants NNS O
using VBG O
HTTP NNP O
communications NNS O
. . O

The DT O
first JJ O
time NN O
CHOPSTICK NN O
is VBZ O
executed VBN O
, , O
it PRP B-Entity
may MD O
encrypt VB B-Action
and CC I-Action
store VB I-Action
configuration NN B-Entity
data NNS I-Entity
in IN B-Modifier
the DT B-Entity
Registry NNP I-Entity
key JJ I-Entity
HKU\S-1-5-19Classes\Software\Microsoft\MediaPlayer\ NN I-Entity
{ FW I-Entity
E6696105-E63E-4EF1-939E- FW I-Entity
15DDD83B669A FW I-Entity
} FW I-Entity
\chnnl FW I-Entity
. . O

The DT O
user NN O
HKU\S-1-5-19 NN O
corresponds VBZ O
to TO O
the DT O
LOCALSERVICE NN O
account NN O
SID NNP O
. . O

The DT B-Entity
configuration NN I-Entity
block NN I-Entity
is VBZ B-Action
encrypted VBN I-Action
using VBG B-Modifier
RC4 NN B-Entity
encryption NN I-Entity
. . O

The DT O
key NN O
is VBZ O
a DT O
combination NN O
of IN O
a DT O
50-byte JJ O
static JJ O
key NN O
and CC O
a DT O
four-byte JJ O
salt NN O
value NN O
randomly RB O
generated VBN O
at IN O
runtime NN O
. . O

The DT O
static JJ O
key NN O
is VBZ O
derived VBN O
from IN O
opcodes NNS O
in IN O
the DT O
backdoor NN O
. . O

CHOPSTICK NN B-Entity
collects VBZ B-Action
detailed JJ B-Entity
information NN I-Entity
from IN B-Modifier
the DT B-Entity
host NN I-Entity
including VBG O
the DT B-Entity
Windows NNP I-Entity
version NN I-Entity
, , O
CPU NNP B-Entity
architecture NN I-Entity
, , O
Windows NNP B-Entity
Firewall NNP I-Entity
state NN I-Entity
, , O
User NN B-Entity
Account NNP I-Entity
Control NNP I-Entity
( FW I-Entity
UAC FW I-Entity
) FW I-Entity
configuration NN I-Entity
settings NNS I-Entity
on IN I-Entity
Windows NNP I-Entity
Vista NNP I-Entity
and CC I-Entity
above JJ I-Entity
and CC O
Internet NNP B-Entity
Explorer NNP I-Entity
settings NNS I-Entity
. . O

It PRP B-Entity
also RB O
tests VBZ B-Action
for IN B-Modifier
the DT B-Entity
installation NN I-Entity
of IN I-Entity
specific JJ I-Entity
security NN I-Entity
products NNS I-Entity
( NNP I-Entity
Table NNP I-Entity
9 CD I-Entity
) NN I-Entity
and CC I-Entity
applications NNS I-Entity
( NNP I-Entity
Table NNP I-Entity
10 CD I-Entity
) NN I-Entity
. . O

After IN O
collecting VBG B-Action
host NN B-Entity
information NN I-Entity
, , O
CHOPSTICK NN B-Entity
creates VBZ B-Action
a DT B-Entity
hidden JJ I-Entity
file NN I-Entity
that WDT I-Entity
may MD I-Entity
be VB I-Entity
named VBN I-Entity
% NN I-Entity
ALLUSERSPROFILE NN I-Entity
% NN I-Entity
\edg6EF885E2.tmp NN I-Entity
for IN B-Modifier
temporary JJ B-Entity
storage NN I-Entity
and CC O
creates VBZ B-Action
a DT B-Entity
Windows NNP I-Entity
mailslot NN I-Entity
with IN B-Modifier
the DT B-Entity
name NN I-Entity
'' '' I-Entity
checkmesv5555 NN I-Entity
'' '' I-Entity
. . O

Its PRP$ O
usage NN O
of IN O
a DT O
Windows NNP O
mailslot NN O
would MD O
potentially RB O
allow VB O
external JJ B-Entity
binaries NNS I-Entity
to TO O
write VB B-Action
data NNS B-Entity
to TO B-Modifier
the DT B-Entity
'' '' I-Entity
checkmesv5555 NN I-Entity
'' '' I-Entity
mailslot NN I-Entity
, , O
possibly RB O
allowing VBG O
CHOPSTICK NNP B-Entity
to TO O
encrypt VB B-Action
and CC O
store VB O
output NN B-Entity
from IN I-Entity
other JJ I-Entity
malware NN I-Entity
. . O

It PRP B-Entity
creates VBZ B-Action
a DT B-Entity
thread NN I-Entity
that WDT O
records VBZ B-Action
user NN B-Entity
activity NN I-Entity
on IN I-Entity
the DT I-Entity
host NN I-Entity
, , O
capturing VBG B-Action
desktop NN B-Entity
screenshots NNS I-Entity
in IN B-Modifier
JPEG NN B-Entity
format NN I-Entity
, , O
tracks VBZ B-Action
current JJ B-Entity
window NN I-Entity
focus NN I-Entity
, , O
collects VBZ B-Action
keystrokes NNS B-Entity
, , O
and CC O
scrapes VBZ B-Action
window NN B-Entity
contents NNS I-Entity
( CD I-Entity
text NN I-Entity
, , I-Entity
context NN I-Entity
menus NNS I-Entity
, , I-Entity
etc. FW I-Entity
) FW I-Entity
. . O

User NN B-Entity
activity NN I-Entity
is VBZ B-Action
captured VBN I-Action
once RB B-Entity
every DT B-Modifier
500 CD B-Entity
milliseconds NNS I-Entity
and CC O
logged VBD B-Action
in IN B-Modifier
an DT B-Entity
HTML-like JJ I-Entity
format NN I-Entity
. . O

The DT B-Entity
thread NN I-Entity
writes VBZ B-Action
user NN B-Entity
activity NN I-Entity
log NN I-Entity
messages NNS I-Entity
to TO B-Modifier
the DT B-Entity
'' '' I-Entity
checkmesv5555 NN I-Entity
'' '' I-Entity
mailslot NN I-Entity
in IN B-Modifier
plain JJ B-Entity
text NN I-Entity
. . O

CHOPSTICK NN B-Entity
reads VBZ B-Action
messages NNS B-Entity
from IN B-Modifier
the DT B-Entity
mailslot NN I-Entity
, , O
encrypts VBZ B-Action
them PRP B-Entity
using VBG B-Modifier
RC4 NN B-Entity
, , O
and CC O
then RB O
stores VBZ B-Action
the DT B-Entity
encrypted JJ I-Entity
message NN I-Entity
in IN B-Modifier
an DT B-Entity
edg6EF885E2.tmp NN I-Entity
temporary JJ I-Entity
file NN I-Entity
. . O

The DT O
RC4 NN O
encryption NN O
used VBN O
here RB O
also RB O
uses VBZ O
a DT O
50- CD O
byte NN O
static JJ O
key NN O
plus CC O
four-byte JJ O
random JJ O
salt NN O
value NN O
. . O

After IN O
approximately RB O
60 CD O
seconds NNS O
of IN O
execution NN O
time NN O
, , O
CHOPSTICK NNP B-Entity
begins VBZ O
communicating VBG B-Action
with IN B-Modifier
one CD B-Entity
of IN I-Entity
its PRP$ I-Entity
C2 NN I-Entity
servers NNS I-Entity
over IN B-Modifier
HTTP NNP B-Entity
. . O

After IN O
sending VBG B-Action
an DT B-Entity
initial JJ I-Entity
HTTP NN I-Entity
GET VBP I-Entity
request NN I-Entity
it PRP B-Entity
uploads VBZ B-Action
the DT B-Entity
file NN I-Entity
contents NNS I-Entity
of IN I-Entity
edg6EF885E2 NN I-Entity
. . I-Entity
tmp NN I-Entity
to TO B-Modifier
the DT B-Entity
C2 NN I-Entity
server NN I-Entity
using VBG B-Modifier
HTTP NN B-Entity
POST NN I-Entity
requests NNS I-Entity
. . O

It PRP O
does VBZ O
not RB O
wait VB O
for IN O
a DT O
response NN O
from IN O
the DT O
server NN O
to TO O
begin VB O
uploading VBG O
. . O

Once RB O
the DT B-Entity
contents NNS I-Entity
of IN I-Entity
edg6EF885E2.tmp NN I-Entity
are VBP B-Action
uploaded VBN I-Action
, , O
CHOPSTICK NNP B-Entity
deletes VBZ B-Action
the DT B-Entity
file NN I-Entity
. . O

Figure NNP O
13 CD O
below IN O
contains VBZ O
an DT O
example NN O
of IN O
an DT B-Entity
HTTP JJ I-Entity
POST NN I-Entity
request NN I-Entity
uploading VBG B-Action
a DT B-Entity
segment NN I-Entity
from IN I-Entity
edg6EF885E2.tmp NN I-Entity
. . O

CHOPSTICK NN B-Entity
uses VBZ B-Action
a DT B-Entity
URL-safe JJ I-Entity
Base64 NN I-Entity
encoding NN I-Entity
, , O
using VBG B-Modifier
an DT B-Entity
alphabet NN I-Entity
that WDT I-Entity
substitutes VBZ I-Entity
'' '' I-Entity
+ CC I-Entity
'' '' I-Entity
and CC I-Entity
'' '' I-Entity
/ : I-Entity
'' '' I-Entity
for IN I-Entity
'' '' I-Entity
- : I-Entity
'' '' I-Entity
and CC I-Entity
'' '' I-Entity
 NN I-Entity
'' '' I-Entity
, , I-Entity
respectively RB I-Entity
. . O

Each DT O
HTTP NN O
request NN O
contains VBZ O
multiple JJ O
Base64 NN O
encoded VBD O
URL NN O
parameters NNS O
, , O
however RB O
only RB O
one CD O
parameter NN O
contains VBZ O
information NN O
encoded VBN O
by IN O
the DT O
malware FW O
( FW O
'' '' O
ai= NN O
'' '' O
) NN O
and CC O
the DT O
rest NN O
of IN O
the DT O
URL NN O
parameters NNS O
appear VBP O
to TO O
be VB O
randomly RB O
generated VBN O
per IN O
request NN O
. . O

CHOPSTICK NN B-Entity
encrypts VBZ B-Action
an DT B-Entity
11-byte JJ I-Entity
sequence NN I-Entity
in IN B-Modifier
the DT B-Entity
'' '' I-Entity
ai= NN I-Entity
'' '' I-Entity
parameter NN I-Entity
. . O

The DT O
purpose NN O
of IN O
this DT O
parameter NN O
appears VBZ O
to TO O
be VB O
to TO O
uniquely RB O
identify VB B-Action
the DT B-Entity
particular JJ I-Entity
instance NN I-Entity
of IN I-Entity
the DT I-Entity
backdoor NN I-Entity
to TO B-Modifier
the DT B-Entity
C2 NN I-Entity
server NN I-Entity
. . O

The DT O
Base64 NN O
encoded VBD O
text NN O
of IN O
this DT O
parameter NN O
begins VBZ O
with IN O
a DT O
number NN O
of IN O
randomly RB O
generated VBN O
alphabetical JJ O
characters NNS O
presumably RB O
intended VBN O
to TO O
prevent VB O
people NNS O
from IN O
Base64 NN O
decoding VBG O
the DT O
whole JJ O
string NN O
without IN O
some DT O
knowledge NN O
of IN O
how WRB O
the DT O
malware NN O
family NN O
works VBZ O
. . O

The DT O
first JJ O
four CD O
bytes NNS O
of IN O
the DT O
message NN O
are VBP O
an DT O
XOR NN O
key NN O
for IN O
the DT O
remainder NN O
of IN O
the DT O
data NNS O
. . O

Once RB O
decrypted VBN O
using VBG O
the DT O
XOR NN O
key NN O
, , O
an DT O
11-byte JJ O
sequence NN O
is VBZ O
revealed VBN O
. . O

The DT O
first JJ O
seven CD O
bytes NNS O
are VBP O
static JJ O
, , O
and CC O
are VBP O
hard-coded JJ O
in IN O
CHOPSTICK NNP O
, , O
while IN O
the DT O
last JJ O
four CD O
bytes NNS O
appear VBP O
to TO O
be VB O
unique JJ O
. . O

The DT B-Entity
message NN I-Entity
body NN I-Entity
of IN I-Entity
the DT I-Entity
POST NN I-Entity
request NN I-Entity
is VBZ B-Action
also RB I-Action
Base64 NN I-Action
encoded VBD I-Action
. . O

This DT O
encoded VBN O
string NN O
is VBZ O
also RB O
prefixed VBN O
with IN O
random JJ O
characters NNS O
designed VBN O
to TO O
break VB O
the DT O
output NN O
of IN O
a DT O
Base64 FW O
decode FW O
operation NN O
on IN O
the DT O
entire JJ O
string NN O
. . O

The DT O
first JJ O
15 CD O
bytes NNS O
of IN O
the DT O
decoded VBN O
message NN O
body NN O
comprise VBP O
another DT O
11-byte JJ O
sequence NN O
similar JJ O
to TO O
the DT O
sequence NN O
stored VBN O
in IN O
the DT O
'' '' O
ai= NN O
'' '' O
parameter NN O
as IN O
described VBN O
above IN O
. . O

Decrypting VBG O
these DT O
bytes NNS O
yields VBZ O
another DT O
static JJ O
seven-byte JJ O
sequence NN O
, , O
followed VBN O
by IN O
four CD O
unique JJ O
bytes NNS O
. . O

The DT O
remainder NN O
of IN O
the DT O
message NN O
body NN O
consists VBZ O
of IN O
the DT O
RC4 NN O
encrypted JJ O
data NNS O
containing VBG O
the DT O
HTML-formatted JJ O
user NN O
activity NN O
log NN O
, , O
edg6EF885E2.tmp NN O
. . O

After IN O
uploading VBG B-Action
edg6EF885E2.tmp NN B-Entity
, , O
CHOPSTICK NN B-Entity
continues VBZ O
to TO O
query VB B-Action
its PRP$ B-Entity
C2 NN I-Entity
servers NNS I-Entity
for IN B-Modifier
commands NNS B-Entity
using VBG B-Modifier
HTTP NN B-Entity
GET VB I-Entity
requests NNS I-Entity
. . O

The DT O
malware NN O
contains VBZ O
code NN O
which WDT O
allows VBZ O
it PRP B-Entity
to TO O
load NN B-Action
or CC O
memory-map JJ B-Action
external JJ B-Entity
modules NNS I-Entity
that WDT I-Entity
export VBP I-Entity
the DT I-Entity
following JJ I-Entity
functions NNS I-Entity
: : I-Entity
SendRawPacket NNP I-Entity
, , I-Entity
GetRawPacket NNP I-Entity
, , I-Entity
InitializeExp NNP I-Entity
, , I-Entity
DestroyExp NNP I-Entity
, , I-Entity
IsActiveChannel NNP I-Entity
, , I-Entity
GetChannelInfo NNP I-Entity
, , I-Entity
SetChannelInfo NNP I-Entity
, , I-Entity
Run NNP I-Entity
, , I-Entity
GetModuleInfo NNP I-Entity
, , I-Entity
GiveMessage NNP I-Entity
, , I-Entity
and CC I-Entity
TakeMessage NNP I-Entity
. . O

CHOPSTICK NNP O
backdoors NNS O
are VBP O
compiled VBN O
within IN O
a DT O
modularized JJ O
development NN O
framework NN O
. . O

This DT O
means VBZ O
that IN O
two CD O
separate JJ O
CHOPSTICK NN O
backdoors NNS O
may MD O
contain VB O
vastly RB O
different JJ O
functionality NN O
, , O
depending VBG O
on IN O
which WDT O
modules NNS O
were VBD O
included VBN O
at IN O
compile VB O
time NN O
. . O

The DT B-Entity
modules NNS I-Entity
that WDT I-Entity
are VBP I-Entity
included VBN I-Entity
in IN I-Entity
an DT I-Entity
instance NN I-Entity
of IN I-Entity
CHOPSTICK NN I-Entity
may MD O
be VB B-Action
reported VBN I-Action
to TO B-Modifier
the DT B-Entity
C2 NN I-Entity
server NN I-Entity
as IN B-Modifier
part NN B-Entity
of IN I-Entity
POST NN I-Entity
messages NNS I-Entity
. . O

Figure NNP O
14 CD O
includes VBZ O
an DT O
example NN O
from IN O
a DT O
CHOPSTICK NN O
v1 NN O
variant NN O
: : O
To TO O
decode VB O
the DT O
POST NN O
content NN O
, , O
the DT O
first JJ O
step NN O
is VBZ O
to TO O
remove VB O
characters NNS O
from IN O
the DT O
Base64 NN O
string NN O
( CD O
the DT O
number NN O
of IN O
characters NNS O
to TO O
remove VB O
may MD O
vary VB O
between IN O
different JJ O
communication NN O
channels NNS O
) VBP O
. . O

In IN O
the DT O
example NN O
from IN O
Figure NNP O
14 CD O
, , O
the DT O
number NN O
of IN O
characters NNS O
removed VBN O
is VBZ O
seven CD O
. . O

Once RB O
these DT O
characters NNS O
are VBP O
removed VBN O
the DT O
decoded VBN O
( NN O
but CC O
still RB O
encrypted JJ O
) NN O
text NN O
looks VBZ O
like IN O
this DT O
: : O
The DT B-Entity
first JJ I-Entity
two CD I-Entity
words NNS I-Entity
( CD I-Entity
'' '' I-Entity
72 CD I-Entity
11 CD I-Entity
'' '' I-Entity
and CC I-Entity
'' '' I-Entity
fd NN I-Entity
22 CD I-Entity
'' '' I-Entity
) NN I-Entity
are VBP O
checksums NNS O
that WDT O
are VBP O
used VBN O
to TO O
validate VB B-Action
the DT B-Entity
message NN I-Entity
. . O

The DT O
next JJ O
4 CD O
bytes NNS O
'' '' O
f8 FW O
dc FW O
33 CD O
9e NN O
'' '' O
are VBP O
a DT O
salt NN O
value NN O
that WDT O
is VBZ O
appended VBN O
to TO O
the DT O
end NN O
of IN O
an DT O
RC4 NN O
key NN O
. . O

Once RB O
decrypted VBN O
, , O
the DT O
message NN O
looks VBZ O
like IN O
the DT O
following NN O
: : O
The DT O
strings NNS O
'' '' O
V4MGNxZWlvcmhjOG9yZQ NN O
'' '' O
and CC O
'' '' O
= JJ O
< JJR O
< JJR O
\xee NN O
'' '' O
are VBP O
hardcoded VBN O
in IN O
the DT O
implant VBP O
. . O

The DT O
module NN O
information NN O
starts VBZ O
at IN O
offset VBN O
0x20 NN O
with IN O
the DT O
string NN O
'' '' O
01 CD O
00 CD O
00 CD O
'' '' O
and CC O
is VBZ O
formatted VBN O
as IN O
follows VBZ O
: : O
The DT O
modules NNS O
included VBN O
in IN O
this DT O
CHOPSTICK NN O
v1 NN O
implant VB O
are VBP O
: : O
Our PRP$ O
determination NN O
of IN O
a DT O
CHOPSTICK NN O
'' '' O
v1 NN O
'' '' O
versus CC O
'' '' O
v2 NN O
'' '' O
is VBZ O
based VBN O
on IN O
the DT O
self-identification NN O
of IN O
the DT O
kernel NN O
ID NN O
and CC O
associated VBN O
modules NNS O
. . O

Compare VB O
the DT O
list NN O
of IN O
CHOPSTICK FW O
v1 FW O
modules NNS O
in IN O
Table NNP O
12 CD O
with IN O
the DT O
list NN O
of IN O
modules NNS O
in IN O
an DT O
example NN O
CHOPSTICK NN O
v2 NN O
variant NN O
in IN O
Table NNP O
13 CD O
: : O
The DT O
kernel NN O
IDs NNS O
0x0001 NN O
and CC O
0x0002 NN O
indicate VBP O
different JJ O
versions NNS O
. . O

The DT O
corresponding JJ O
modules NNS O
in IN O
each DT O
backdoor NN O
also RB O
are VBP O
consistently RB O
identified VBN O
with IN O
0x01 NN O
and CC O
0x02 NN O
, , O
respectively RB O
, , O
in IN O
the DT O
second JJ O
byte NN O
. . O

In IN O
both DT O
variants NNS O
the DT O
modules NNS O
with IN O
keystroke NN O
log NN O
, , O
file NN O
system NN O
access NN O
, , O
and CC O
command NN O
shell NN O
capabilities NNS O
have VBP O
the DT O
consistent JJ O
identifiers NNS O
0x10 NN O
, , O
0x11 NN O
, , O
and CC O
0x13 NN O
, , O
respectively RB O
, , O
in IN O
the DT O
first JJ O
byte NN O
. . O

This DT O
suggests VBZ O
that IN O
the DT O
first JJ O
byte NN O
in IN O
the DT O
module NN O
ID NNP O
identifies VBZ O
the DT O
module NN O
type NN O
whereas IN O
the DT O
second JJ O
byte NN O
identifies VBZ O
the DT O
kernel NN O
version NN O
. . O

The DT O
kernel NN O
sends VBZ O
commands NNS O
to TO O
each DT O
module NN O
using VBG O
its PRP$ O
module NN O
ID NNP O
. . O

The DT O
commands NNS O
that IN O
each DT O
module NN O
understands VBZ O
are VBP O
likely RB O
consistent JJ O
from IN O
build VB O
to TO O
build VB O
. . O

Table NNP O
14 CD O
and CC O
Table NNP O
15 CD O
show NN O
examples NNS O
of IN O
commands NNS O
that IN O
each DT O
module NN O
understands VBZ O
. . O

OLDBAIT NNP B-Entity
is VBZ B-Action
a DT B-Entity
credential NN I-Entity
harvester NN I-Entity
that WDT O
installs VBZ B-Action
itself PRP B-Entity
in IN B-Modifier
% NN B-Entity
ALLUSERPROFILE CD I-Entity
% NN I-Entity
\\Application NN I-Entity
Data\ FW I-Entity
Microsoft\MediaPlayer\updatewindws.exe FW I-Entity
. . O

There EX O
is VBZ O
a DT O
missing VBG O
space NN O
in IN O
the DT O
MediaPlayer NNP O
directory NN O
and CC O
the DT O
filename NN O
is VBZ O
missing VBG O
the DT O
'o NN O
' POS O
character NN O
. . O

Both CC B-Entity
the DT I-Entity
internal JJ I-Entity
strings NNS I-Entity
and CC I-Entity
logic NN I-Entity
are VBP B-Action
obfuscated VBN I-Action
and CC O
are VBP O
unpacked JJ O
at IN O
startup NN O
. . O

Credentials NNS B-Entity
for IN I-Entity
the DT I-Entity
following JJ I-Entity
applications NNS I-Entity
are VBP B-Action
collected VBN I-Action
: : O
Both CC O
email NN B-Entity
and CC O
HTTP NN B-Entity
can MD O
be VB B-Action
used VBN I-Action
to TO B-Modifier
send VB B-Entity
out RP I-Entity
the DT I-Entity
collected VBN I-Entity
credentials NNS I-Entity
. . O

Sample NNP O
HTTP NNP O
traffic NN O
is VBZ O
displayed VBN O
in IN O
Figure NNP O
15 CD O
. . O

OLDBAIT NNP O
handles VBZ O
APIs NNS O
very RB O
similarly RB O
to TO O
SOURFACE NNP O
and CC O
EVILTOSS NNP O
. . O

There EX O
is VBZ O
a DT O
setup NN O
routine NN O
that IN O
loads NNS O
the DT O
imports NNS O
into IN O
a DT O
table NN O
and CC O
all DT O
API NNP O
calls NNS O
reference VBP O
an DT O
index NN O
to TO O
this DT O
table NN O
. . O

In IN O
SOURFACE NNP O
and CC O
EVILTOSS NNP O
the DT O
table NN O
is VBZ O
stored VBN O
in IN O
a DT O
global JJ O
variable NN O
while IN O
in FW O
OLDBAIT FW O
this DT O
table NN O
is VBZ O
allocated VBN O
at IN O
runtime NN O
and CC O
a DT O
pointer NN O
is VBZ O
passed VBN O
between IN O
functions NNS O
. . O

