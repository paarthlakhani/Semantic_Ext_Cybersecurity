Recently RB O
, , O
research NN O
was VBD O
published VBN O
identifying VBG O
a DT B-Entity
Tor NN I-Entity
exit NN I-Entity
node NN I-Entity
, , O
located JJ O
in IN O
Russia NNP O
, , O
that WDT O
was VBD B-Action
consistently RB I-Action
and CC I-Action
maliciously RB I-Action
modifying VBG I-Action
any DT B-Entity
uncompressed JJ I-Entity
Windows NNP I-Entity
executables NNS I-Entity
downloaded VBD I-Entity
through IN I-Entity
it PRP I-Entity
. . O

Naturally RB O
this DT O
piqued VBD O
our PRP$ O
interest NN O
, , O
so IN O
we PRP O
decided VBD O
to TO O
peer VB O
down RP O
the DT O
rabbit NN O
hole NN O
. . O

Suffice NNP O
to TO O
say VB O
, , O
the DT O
hole NN O
was VBD O
a DT O
lot NN O
deeper JJR O
than IN O
we PRP O
expected VBD O
! . O
In IN O
fact NN O
, , O
it PRP O
went VBD O
all PDT O
the DT O
way NN O
back RB O
to TO O
the DT O
notorious JJ O
Russian NNP O
APT NNP O
family NN O
MiniDuke NNP O
, , O
known VBN O
to TO O
have VB O
been VBN O
used VBN O
in IN O
targeted VBN O
attacks NNS O
against IN O
NATO NNP O
and CC O
European JJ O
government NN O
agencies NNS O
. . O

The DT O
malware NN O
used VBN O
in IN O
this DT O
case NN O
is VBZ O
, , O
however RB O
, , O
not RB O
a DT O
version NN O
of IN O
MiniDuke NNP O
. . O

It PRP O
is VBZ O
instead RB O
a DT O
separate JJ O
, , O
distinct JJ O
family NN O
of IN O
malware NN O
that IN O
we PRP O
have VBP O
since IN O
taken VBN O
to TO O
calling VBG O
OnionDuke NNP O
. . O

But CC O
lets VBZ O
start NN O
from IN O
the DT O
beginning NN O
. . O

When WRB O
a DT O
user NN O
attempts VBZ O
to TO O
download VB O
an DT O
executable JJ O
via IN O
the DT O
malicious JJ O
Tor NN O
exit NN O
node NN O
, , O
what WP O
they PRP O
actually RB O
receive VBP O
is VBZ O
an DT O
executable JJ O
'' '' O
wrapper NN O
'' '' O
that WDT O
embeds VBZ O
both CC O
the DT O
original JJ O
executable JJ O
and CC O
a DT O
second JJ O
, , O
malicious JJ O
executable JJ O
. . O

By IN B-Modifier
using VBG B-Entity
a DT I-Entity
separate JJ I-Entity
wrapper NN I-Entity
, , O
the DT B-Entity
malicious JJ I-Entity
actors NNS I-Entity
are VBP O
able JJ O
to TO O
bypass VB B-Action
any DT B-Entity
integrity NN I-Entity
checks VBZ I-Entity
the DT I-Entity
original JJ I-Entity
binary JJ I-Entity
might MD I-Entity
contain VB I-Entity
. . O

Upon IN O
execution NN O
, , O
the DT O
wrapper NN O
will MD O
proceed VB O
to TO O
write VB O
to TO O
disk NN O
and CC O
execute VB O
the DT O
original JJ O
executable JJ O
, , O
thereby RB O
tricking VBG O
the DT O
user NN O
into IN O
believing VBG O
that DT O
everything NN O
went VBD O
fine JJ O
. . O

However RB O
, , O
the DT O
wrapper NN O
will MD O
also RB O
write VB O
to TO O
disk NN O
and CC O
execute VB O
the DT O
second JJ O
executable JJ O
. . O

In IN O
all PDT O
the DT O
cases NNS O
we PRP O
have VBP O
observed VBN O
, , O
this DT O
malicious JJ O
executable JJ O
has VBZ O
been VBN O
the DT O
same JJ O
binary JJ O
( NN O
SHA1 NN O
: : O
a75995f94854dea8799650a2f4a97980b71199d2 NN O
, , O
detected VBN O
as IN O
Trojan-Dropper NNP O
: : O
W32/OnionDuke.A FW O
) FW O
. . O

This DT B-Entity
executable JJ I-Entity
is VBZ B-Action
a DT B-Entity
dropper NN I-Entity
containing VBG O
a DT B-Entity
PE NN I-Entity
resource NN I-Entity
that WDT O
pretends VBZ B-Action
to TO B-Modifier
be VB B-Entity
an DT I-Entity
embedded JJ I-Entity
GIF NN I-Entity
image NN I-Entity
file NN I-Entity
. . O

In IN O
reality NN O
, , O
the DT O
resource NN O
is VBZ O
actually RB O
an DT O
encrypted JJ O
dynamically RB O
linked VBN O
library NN O
( NN O
DLL NN O
) NN O
file NN O
. . O

The DT B-Entity
dropper NN I-Entity
will MD O
proceed VB B-Action
to TO B-Modifier
decrypt VB B-Entity
this DT I-Entity
DLL NNP I-Entity
, , I-Entity
write VB I-Entity
it PRP I-Entity
to TO I-Entity
disk NN I-Entity
and CC I-Entity
execute VB I-Entity
it PRP I-Entity
. . O

Once RB O
executed VBN O
, , O
the DT B-Entity
DLL NNP I-Entity
file NN I-Entity
( NN O
SHA1 NN O
: : O
b491c14d8cfb48636f6095b7b16555e9a575d57f NN O
, , O
detected VBN O
as IN O
Backdoor NNP O
: : O
W32/OnionDuke.B NNP O
) NNP O
will MD O
decrypt VB O
an DT O
embedded JJ O
configuration NN O
( NN O
shown VBN O
below IN O
) NN O
and CC O
attempt NN O
to TO O
connect VB B-Action
to TO B-Modifier
hardcoded JJ B-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
URLs NNS I-Entity
specified VBN I-Entity
in IN I-Entity
the DT I-Entity
configuration NN I-Entity
data NNS I-Entity
. . O

From IN O
these DT O
C NNP O
& CC O
Cs NNP O
the DT B-Entity
malware NN I-Entity
may MD O
receive VB B-Action
instructions NNS B-Entity
to TO O
download VB B-Action
and CC I-Action
execute VB I-Action
additional JJ B-Entity
malicious JJ I-Entity
components NNS I-Entity
. . O

It PRP O
should MD O
be VB O
noted VBN O
, , O
that IN O
we PRP O
believe VBP O
all DT O
five CD O
domains NNS O
contacted VBN O
by IN O
the DT O
malware NN O
are VBP O
innocent JJ O
websites NNS O
compromised VBN O
by IN O
the DT O
malware NN O
operators NNS O
, , O
not RB O
dedicated VBN O
malicious JJ O
servers NNS O
. . O

Through IN O
our PRP$ O
research NN O
, , O
we PRP O
have VBP O
also RB O
been VBN O
able JJ O
to TO O
identify VB O
multiple JJ O
other JJ O
components NNS O
of IN O
the DT O
OnionDuke NNP O
malware NN O
family NN O
. . O

We PRP O
have VBP O
, , O
for IN O
instance NN O
, , O
observed VBN O
components NNS B-Entity
dedicated VBN O
to TO O
stealing VBG B-Action
login NN B-Entity
credentials NNS I-Entity
from IN B-Modifier
the DT B-Entity
victim NN I-Entity
machine NN I-Entity
and CC O
components NNS B-Entity
dedicated VBN O
to TO O
gathering VBG B-Action
further JJ B-Entity
information NN I-Entity
on IN I-Entity
the DT I-Entity
compromised VBN I-Entity
system NN I-Entity
like IN I-Entity
the DT I-Entity
presence NN I-Entity
of IN I-Entity
antivirus NN I-Entity
software NN I-Entity
or CC I-Entity
a DT I-Entity
firewall NN I-Entity
. . O

Some DT B-Entity
of IN I-Entity
these DT I-Entity
components NNS I-Entity
have VBP O
been VBN O
observed VBN O
being VBG B-Action
downloaded VBN I-Action
and CC I-Action
executed VBN I-Action
by IN O
the DT B-Entity
original JJ I-Entity
backdoor JJ I-Entity
process NN I-Entity
but CC O
for IN O
other JJ O
components NNS O
, , O
we PRP O
have VBP O
yet RB O
to TO O
identify VB O
the DT O
infection NN O
vector NN O
. . O

Most JJS B-Entity
of IN I-Entity
these DT I-Entity
components NNS I-Entity
do VBP O
n't RB O
embed VB O
their PRP$ O
own JJ O
C NN O
& CC O
C NN O
information NN O
but CC O
rather RB O
communicate VBP B-Action
with IN B-Modifier
their PRP$ B-Entity
controllers NNS I-Entity
through IN B-Modifier
the DT B-Entity
original JJ I-Entity
backdoor JJ I-Entity
process NN I-Entity
. . O

One CD O
component NN O
, , O
however RB O
, , O
is VBZ O
an DT O
interesting JJ O
exception NN O
. . O

This DT B-Entity
DLL NNP I-Entity
file NN I-Entity
( NNP O
SHA1 NNP O
d433f281cf56015941a1c2cb87066ca62ea1db37 NNP O
, , O
detected VBN O
as IN O
Backdoor NNP O
: : O
W32/OnionDuke.A FW O
) FW O
contains VBZ B-Action
among IN B-Modifier
its PRP$ B-Entity
configuration NN I-Entity
data NNS I-Entity
a DT B-Entity
different JJ I-Entity
hardcoded NN I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
domain NN I-Entity
, , I-Entity
overpict.com NN I-Entity
and CC O
also RB O
evidence NN O
suggesting VBG O
that IN O
this DT B-Entity
component NN I-Entity
may MD O
abuse VB B-Action
Twitter NNP B-Entity
as IN B-Modifier
an DT B-Entity
additional JJ I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
channel NN I-Entity
. . O

What WP O
makes VBZ O
the DT O
overpict.com NN O
domain NN O
interesting JJ O
, , O
is VBZ O
it PRP O
was VBD O
originally RB O
registered VBN O
in IN O
2011 CD O
with IN O
the DT O
alias NNS O
of IN O
'' '' O
John NNP O
Kasai NNP O
'' '' O
. . O

Within IN O
a DT O
two-week JJ O
window NN O
, , O
'' '' O
John NNP O
Kasai NNP O
'' '' O
also RB O
registered VBD O
the DT O
following JJ O
domains NNS O
: : O
airtravelabroad.com NN O
, , O
beijingnewsblog.net NN O
, , O
grouptumbler.com NN O
, , O
leveldelta.com NN O
, , O
nasdaqblog.net NN O
, , O
natureinhome.com NN O
, , O
nestedmail.com NN O
, , O
nostressjob.com NN O
, , O
nytunion.com NN O
, , O
oilnewsblog.com NN O
, , O
sixsquare.net NN O
and CC O
ustradecomp.com NN O
. . O

This DT O
is VBZ O
significant JJ O
because IN O
the DT B-Entity
domains NNS I-Entity
leveldelta.com NN I-Entity
and CC I-Entity
grouptumbler.com NN I-Entity
have VBP O
previously RB O
been VBN B-Action
identified VBN I-Action
as IN B-Modifier
C NN B-Entity
& CC I-Entity
C NN I-Entity
domains NNS I-Entity
used VBN I-Entity
by IN I-Entity
MiniDuke NNP I-Entity
. . O

This NNP O
strongly RB O
suggests VBZ O
that IN O
although IN O
OnionDuke NNP O
and CC O
MiniDuke NNP O
are VBP O
two CD O
separate JJ O
families NNS O
of IN O
malware NN O
, , O
the DT O
actors NNS O
behind IN O
them PRP O
are VBP O
connected VBN O
through IN O
the DT O
use NN O
of IN O
shared JJ O
infrastructure NN O
. . O

Based VBN O
on IN O
compilation NN O
timestamps NNS O
and CC O
discovery NN O
dates NNS O
of IN O
samples NNS O
we PRP O
have VBP O
observed VBN O
, , O
we PRP O
believe VBP O
the DT B-Entity
OnionDuke NNP I-Entity
operators NNS I-Entity
have VBP O
been VBN B-Action
infecting VBG I-Action
downloaded VBN B-Entity
executables NNS I-Entity
at IN O
least JJS O
since IN B-Modifier
the DT B-Entity
end NN I-Entity
of IN I-Entity
October NNP I-Entity
2013 CD I-Entity
. . O

We PRP O
also RB O
have VBP O
evidence NN O
suggesting VBG O
that IN O
, , O
at IN O
least JJS O
since IN O
February NNP O
of IN O
2014 CD O
, , O
OnionDuke NNP B-Entity
has VBZ O
not RB O
only RB O
been VBN B-Action
spread VBN I-Action
by IN B-Modifier
modifying VBG B-Entity
downloaded VBN I-Entity
executables NNS I-Entity
but CC O
also RB O
by IN B-Modifier
infecting VBG B-Entity
executables NNS I-Entity
in IN I-Entity
.torrent JJ I-Entity
files NNS I-Entity
containing VBG I-Entity
pirated VBN I-Entity
software NN I-Entity
. . O

However RB O
, , O
it PRP O
would MD O
seem VB O
that IN O
the DT O
OnionDuke NNP O
family NN O
is VBZ O
much RB O
older JJR O
, , O
both DT O
based VBN O
on IN O
older JJR O
compilation NN O
timestamps NNS O
and CC O
also RB O
on IN O
the DT O
fact NN O
that IN O
some DT O
of IN O
the DT O
embedded JJ O
configuration NN O
data NNS O
make VBP O
reference NN O
to TO O
an DT O
apparent JJ O
version NN O
number NN O
of IN O
4 CD O
suggesting VBG O
that IN O
at IN O
least JJS O
three CD O
earlier JJR O
versions NNS O
of IN O
the DT O
family NN O
exist VBP O
. . O

During IN O
our PRP$ O
research NN O
, , O
we PRP O
have VBP O
also RB O
uncovered VBN O
strong JJ O
evidence NN O
suggesting VBG O
that IN O
OnionDuke NNP O
has VBZ O
been VBN O
used VBN O
in IN O
targeted VBN O
attacks NNS O
against IN O
European JJ O
government NN O
agencies NNS O
, , O
although IN O
we PRP O
have VBP O
so RB O
far RB O
been VBN O
unable JJ O
to TO O
identify VB O
the DT O
infection NN O
vector NN O
( CD O
s NN O
) NN O
. . O

Interestingly RB O
, , O
this DT O
would MD O
suggest VB O
two CD O
very RB O
different JJ O
targeting NN O
strategies NNS O
. . O

On IN O
one CD O
hand NN O
is VBZ O
the DT O
'' '' O
shooting VBG O
a DT O
fly NN O
with IN O
a DT O
cannon NN O
'' '' O
mass-infection NN O
strategy NN O
through IN O
modified VBN O
binaries NNS O
and CC O
, , O
on IN O
the DT O
other JJ O
, , O
the DT O
more RBR O
surgical JJ O
targeting NN O
traditionally RB O
associated VBN O
with IN O
APT NN O
operations NNS O
. . O

In IN O
any DT O
case NN O
, , O
although IN O
much JJ O
is VBZ O
still RB O
shrouded VBN O
in IN O
mystery NN O
and CC O
speculation NN O
, , O
one CD O
thing NN O
is VBZ O
certain JJ O
. . O

While IN O
using VBG O
Tor NNP O
may MD O
help VB O
you PRP O
stay VB O
anonymous JJ O
, , O
it PRP O
does VBZ O
at IN O
the DT O
same JJ O
time NN O
paint VBP O
a DT O
huge JJ O
target NN O
on IN O
your PRP$ O
back NN O
. . O

It PRP O
's VBZ O
never RB O
a DT O
good JJ O
idea NN O
to TO O
download VB O
binaries NNS O
via IN O
Tor FW O
( FW O
or CC O
anything NN O
else JJ O
) NN O
without IN O
encryption NN O
. . O

The DT O
problem NN O
with IN O
Tor NN O
is VBZ O
that IN O
you PRP O
have VBP O
no DT O
idea NN O
who WP O
is VBZ O
maintaining VBG O
the DT O
exit NN O
node NN O
you PRP O
are VBP O
using VBG O
and CC O
what WP O
their PRP$ O
motives NNS O
are VBP O
. . O

VPNs FW O
( FW O
such JJ O
as IN O
our PRP$ O
Freedome NNP O
VPN NNP O
) NNP O
will MD O
encrypt VB O
your PRP$ O
connection NN O
all PDT O
the DT O
way NN O
through IN O
the DT O
Tor NNP O
network NN O
, , O
so IN O
the DT O
maintainers NNS O
of IN O
Tor NN O
exit NN O
nodes NNS O
will MD O
not RB O
see VB O
your PRP$ O
traffic NN O
and CC O
ca MD O
n't RB O
tamper VB O
with IN O
it PRP O
. . O

Samples NNPS O
: : O
