Two CD O
years NNS O
ago RB O
, , O
we PRP O
published VBD O
our PRP$ O
research NN O
into IN O
RedOctober NNP O
, , O
a DT O
complex JJ O
cyber-espionage JJ O
operation NN O
targeting VBG O
diplomatic JJ O
embassies NNS O
worldwide RB O
. . O

We PRP O
named VBD O
it PRP O
RedOctober NNP O
because IN O
we PRP O
started VBD O
this DT O
investigation NN O
in IN O
October NNP O
2012 CD O
, , O
an DT O
unusually RB O
hot JJ O
month NN O
. . O

After IN O
our PRP$ O
announcement NN O
in IN O
January NNP O
2013 CD O
, , O
the DT O
RedOctober NNP O
operation NN O
was VBD O
promptly RB O
shut VBN O
down RP O
and CC O
the DT O
network NN O
of IN O
C NNP O
& CC O
Cs NNP O
was VBD O
dismantled VBN O
. . O

As IN O
usually RB O
happens VBZ O
with IN O
these DT O
big JJ O
operations NNS O
, , O
considering VBG O
the DT O
huge JJ O
investment NN O
and CC O
number NN O
of IN O
resources NNS O
behind IN O
it PRP O
, , O
they PRP O
do VBP O
n't RB O
just RB O
'' '' O
go VB O
away RB O
'' '' O
forever RB O
. . O

Normally RB O
, , O
the DT O
group NN O
goes VBZ O
underground JJ O
for IN O
a DT O
few JJ O
months NNS O
, , O
redesigns VBZ O
the DT O
tools NNS O
and CC O
the DT O
malware NN O
and CC O
resume VB O
operations NNS O
. . O

See NNP O
: : O
Since IN O
January NNP O
2013 CD O
, , O
we PRP O
've VBP O
been VBN O
on IN O
the DT O
lookout NN O
for IN O
a DT O
possible JJ O
RedOctober NNP O
comeback NN O
. . O

One CD O
possible JJ O
hit NN O
was VBD O
triggered VBN O
when WRB O
we PRP O
observed VBD O
Mevade NNP O
, , O
an DT O
unusual JJ O
piece NN O
of IN O
malware NN O
that WDT O
appeared VBD O
late RB O
in IN O
2013 CD O
. . O

The DT O
Mevade NNP O
C NNP O
& CC O
C NNP O
name NN O
styles NNS O
as RB O
well RB O
as IN O
some DT O
other JJ O
technical JJ O
similarities NNS O
indicated VBD O
a DT O
connection NN O
to TO O
RedOctober NNP O
, , O
but CC O
the DT O
link NN O
was VBD O
weak JJ O
. . O

It PRP O
was VBD O
n't RB O
until IN O
August NNP O
2014 CD O
that IN O
we PRP O
observed VBD O
something NN O
which WDT O
made VBD O
us PRP O
wonder VB O
if IN O
RedOctober NNP O
is VBZ O
back RB O
for IN O
good NN O
. . O

In IN O
August NNP O
2014 CD O
, , O
some DT O
of IN O
our PRP$ O
users NNS O
observed VBD O
targeted VBN O
attacks NNS O
with IN O
a DT O
variation NN O
of IN O
CVE-2012-0158 NN O
and CC O
an DT O
unusual JJ O
set NN O
of IN O
malware NN O
. . O

We PRP O
did VBD O
a DT O
quick JJ O
analysis NN O
of IN O
the DT O
malware NN O
and CC O
it PRP O
immediately RB O
stood VBD O
out RP O
because IN O
of IN O
certain JJ O
unusual JJ O
things NNS O
that WDT O
are VBP O
not RB O
very RB O
common JJ O
in IN O
the DT O
APT NNP O
world NN O
. . O

Some DT O
of IN O
the DT O
filenames NNS O
used VBN O
in IN O
the DT O
attacks NNS O
included VBD O
: : O
At IN O
least JJS O
one CD O
of IN O
them PRP O
immediately RB O
reminded VBD O
us PRP O
of IN O
RedOctober NNP B-Entity
, , O
which WDT O
used VBD B-Action
a DT B-Entity
very RB I-Entity
similarly RB I-Entity
named VBN I-Entity
spearphish NN I-Entity
: : I-Entity
'' '' I-Entity
Diplomatic JJ I-Entity
Car NN I-Entity
for IN I-Entity
Sale.doc NN I-Entity
'' '' I-Entity
. . O

As IN O
we PRP O
started VBD O
digging NN O
into IN O
the DT O
operation NN O
, , O
more JJR O
details NNS O
emerged VBD O
which WDT O
supported VBD O
this DT O
theory NN O
. . O

Perhaps RB O
the DT O
most RBS O
unusual JJ O
fact NN O
was VBD O
that IN O
the DT O
Microsoft NNP O
Office NNP O
exploit VB O
did VBD O
n't RB O
directly RB O
write VB O
a DT O
Windows NNP O
PE NNP O
backdoor NN O
on IN O
disk NN O
. . O

Instead RB O
, , O
it PRP B-Entity
writes VBZ B-Action
an DT B-Entity
encrypted JJ I-Entity
Visual JJ I-Entity
Basic JJ I-Entity
Script NN I-Entity
and CC O
runs VBZ B-Action
it PRP B-Entity
. . O

This DT B-Entity
VBScript NN I-Entity
drops VBZ B-Action
a DT B-Entity
pair NN I-Entity
of IN I-Entity
files NNS I-Entity
on IN B-Modifier
disk NN B-Entity
- : O
a DT O
loader NN O
and CC O
an DT O
encrypted JJ O
payload NN O
. . O

The DT O
loader NN O
appears VBZ O
to TO O
be VB O
different JJ O
every DT O
time NN O
and CC O
internal JJ O
strings NNS O
indicate VBP O
it PRP O
is VBZ O
'' '' O
polymorphically RB O
'' '' O
generated VBN O
. . O

The DT B-Entity
payload NN I-Entity
is VBZ B-Action
always RB I-Action
encrypted VBN I-Action
with IN B-Modifier
a DT B-Entity
unique JJ I-Entity
key NN I-Entity
, , O
making VBG O
it PRP O
impossible JJ O
to TO O
decrypt VB O
unless IN O
the DT O
DLL NNP O
is VBZ O
available JJ O
. . O

We PRP O
observed VBD O
several JJ B-Entity
different JJ I-Entity
spear-phishing JJ I-Entity
documents NNS I-Entity
that WDT O
drop VBP B-Action
uniquely RB B-Entity
named VBN I-Entity
payloads NNS I-Entity
. . O

For IN O
instance NN O
, , O
the DT O
'' '' O
qPd0aKJu.vbs NN O
'' '' O
file NN O
MD5 NN O
: : O
E211C2BAD9A83A6A4247EC3959E2A730 NN B-Entity
drops VBZ B-Action
the DT B-Entity
following JJ I-Entity
files NNS I-Entity
: : O
The DT B-Entity
VBS NNP I-Entity
also RB O
adds VBZ B-Action
a DT B-Entity
registry NN I-Entity
key NN I-Entity
: : I-Entity
HKEYCURRENTUSER\Software\Microsoft\Windows\CurrentVersion\Run\ NN I-Entity
setting VBG B-Action
the DT B-Entity
key JJ I-Entity
'' '' I-Entity
bookstore NN I-Entity
'' '' I-Entity
to TO B-Modifier
the DT B-Entity
value NN I-Entity
'' '' I-Entity
regsvr32 CD I-Entity
% NN I-Entity
path NN I-Entity
% NN I-Entity
\ctfmonrn.dll FW I-Entity
/s FW I-Entity
'' '' I-Entity
, , O
which WDT O
ensures VBZ B-Action
the DT B-Entity
malware NN I-Entity
runs VBZ I-Entity
every DT I-Entity
time NN I-Entity
at IN I-Entity
system NN I-Entity
boot NN I-Entity
. . O

Some DT O
of IN O
the DT O
DLL NNP O
names NNS O
we PRP O
observed VBD O
include VBP O
: : O
Some DT O
of IN O
the DT O
payload NN O
names NNS O
include VBP O
: : O
The DT O
payload NN O
includes VBZ O
an DT B-Entity
encrypted JJ I-Entity
configuration NN I-Entity
block NN I-Entity
which WDT O
contains VBZ B-Action
information NN B-Entity
about IN I-Entity
the DT I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
sever VBP I-Entity
: : O
The DT O
information NN O
from IN O
the DT O
config NN O
includes VBZ O
a DT B-Entity
WebDAV NN I-Entity
URL NN I-Entity
which WDT O
is VBZ B-Action
used VBN I-Action
for IN B-Modifier
connections NNS B-Entity
, , O
a DT O
username NN O
and CC O
password NN O
, , O
two CD O
folders NNS O
on IN O
the DT O
WebDAV NN O
server NN O
used VBN O
to TO O
store VB O
plugins/modules NNS O
for IN O
the DT O
malware NN O
and CC O
where WRB O
data NNS B-Entity
from IN I-Entity
the DT I-Entity
victim NN I-Entity
should MD O
be VB B-Action
uploaded VBN I-Action
. . O

The DT B-Entity
Cloud NNP I-Entity
Atlas NNP I-Entity
implants NNS I-Entity
utilize VBP B-Action
a DT B-Entity
rather RB I-Entity
unusual JJ I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
mechanism NN I-Entity
. . O

All PDT B-Entity
the DT I-Entity
malware NN I-Entity
samples NNS I-Entity
we PRP I-Entity
've VBP I-Entity
seen VBN I-Entity
communicate VBP B-Action
via IN B-Modifier
HTTPS NNP B-Entity
and CC I-Entity
WebDav NNP I-Entity
with IN B-Modifier
the DT B-Entity
same JJ I-Entity
server NN I-Entity
'' '' I-Entity
cloudme.com NNP I-Entity
'' '' I-Entity
, , I-Entity
a DT I-Entity
cloud NN I-Entity
services NNS I-Entity
provider NN I-Entity
. . O

According VBG O
to TO O
their PRP$ O
website NN O
, , O
CloudMe NN O
is VBZ O
owned VBN O
and CC O
operated VBN O
by IN O
CloudMe NNP O
AB NNP O
, , O
a DT O
company NN O
based VBN O
in IN O
Link√∂ping NNP O
, , O
Sweden NNP O
. . O

( CD O
Important JJ O
note NN O
: : O
we PRP O
do VBP O
not RB O
believe VB O
that DT O
CloudMe NN O
is VBZ O
in IN O
any DT O
way NN O
related JJ O
to TO O
the DT O
Cloud NNP O
Atlas NNP O
group NN O
- : O
the DT O
attackers NNS O
simply RB O
create VB O
free JJ O
accounts NNS O
on IN O
this DT O
provider NN O
and CC O
abuse VB O
them PRP O
for IN O
command-and-control JJ O
) NN O
. . O

Each DT B-Entity
malware NN I-Entity
set VBD I-Entity
we PRP I-Entity
have VBP I-Entity
observed VBN I-Entity
so RB I-Entity
far RB I-Entity
communicates VBZ B-Action
with IN B-Modifier
a DT B-Entity
different JJ I-Entity
CloudMe NN I-Entity
account NN I-Entity
though RB O
. . O

The DT O
attackers NNS O
upload VBP O
data NNS B-Entity
to TO O
the DT O
account NN O
, , O
which WDT O
is VBZ B-Action
downloaded VBN I-Action
by IN O
the DT B-Entity
implant VBP I-Entity
, , O
decrypted VBN O
and CC O
interpreted VBN O
. . O

In IN O
turn NN O
, , O
the DT B-Entity
malware NN I-Entity
uploads VBZ B-Action
the DT B-Entity
replies NNS I-Entity
back RB B-Modifier
to TO I-Modifier
the DT B-Entity
server NN I-Entity
via IN B-Modifier
the DT B-Entity
same JJ I-Entity
mechanism NN I-Entity
. . O

Of IN O
course NN O
, , O
it PRP O
should MD O
be VB O
possible JJ O
to TO O
reconfigure NN O
the DT O
malware NN O
to TO O
use VB O
any DT O
Cloud-based JJ O
storage NN O
service NN O
that WDT O
supports VBZ O
WebDAV NNP O
. . O

Here RB O
's VBZ O
a DT O
look NN O
at IN O
one CD O
such JJ O
account NN O
from IN O
CloudMe NN O
: : O
The DT O
data NNS O
from IN O
the DT O
account NN O
: : O
The DT B-Entity
files NNS I-Entity
stored VBN I-Entity
in IN I-Entity
the DT I-Entity
randomly RB I-Entity
named VBN I-Entity
folder NN I-Entity
were VBD B-Action
uploaded VBN I-Action
by IN O
the DT B-Entity
malware NN I-Entity
and CC O
contain VBP B-Action
various JJ B-Entity
things NNS I-Entity
, , I-Entity
such JJ I-Entity
as IN I-Entity
system NN I-Entity
information NN I-Entity
, , I-Entity
running VBG I-Entity
processes NNS I-Entity
and CC I-Entity
current JJ I-Entity
username NN I-Entity
. . O

The DT B-Entity
data NN I-Entity
is VBZ B-Action
compressed VBN I-Action
with IN B-Modifier
LZMA NN B-Entity
and CC O
encrypted JJ B-Action
with IN B-Modifier
AES NN B-Entity
, , O
however RB O
, , O
the DT O
keys NNS O
are VBP O
stored VBN O
in IN O
the DT O
malware NN O
body NN O
which WDT O
makes VBZ O
it PRP O
possible JJ O
to TO O
decrypt VB O
the DT O
information NN O
from IN O
the DT O
C NNP O
& CC O
C NNP O
. . O

We PRP O
previously RB O
observed VBD O
only RB B-Entity
one CD I-Entity
other JJ I-Entity
group NN I-Entity
using VBG O
a DT O
similar JJ O
method NN O
‚Äì FW O
ItaDuke FW O
‚Äì NN O
that WDT O
connected VBD B-Action
to TO B-Modifier
accounts NNS B-Entity
on IN I-Entity
the DT I-Entity
cloud NN I-Entity
provider NN I-Entity
mydrive.ch NN I-Entity
. . O

Just RB O
like IN O
with IN O
RedOctober NNP O
, , O
the DT O
top JJ O
target NN O
of IN O
Cloud NNP O
Atlas NNP O
is VBZ O
Russia NNP O
, , O
followed VBD O
closely RB O
by IN O
Kazakhstan NNP O
, , O
according VBG O
to TO O
data NNS O
from IN O
the DT O
Kaspersky NNP O
Security NNP O
Network NNP O
( FW O
KSN FW O
) FW O
. . O

Actually RB O
, , O
we PRP O
see VBP O
an DT O
obvious JJ O
overlap VBP O
of IN O
targets NNS O
between IN O
the DT O
two CD O
, , O
with IN O
subtle JJ O
differences NNS O
which WDT O
closely RB O
account VBP O
for IN O
the DT O
geopolitical JJ O
changes NNS O
in IN O
the DT O
region NN O
that WDT O
happened VBD O
during IN O
the DT O
last JJ O
two CD O
years NNS O
. . O

Interestingly RB O
, , O
some DT B-Entity
of IN I-Entity
the DT I-Entity
spear-phishing JJ I-Entity
documents NNS I-Entity
between IN I-Entity
Cloud NNP I-Entity
Atlas NNP I-Entity
and CC I-Entity
RedOctober NNP I-Entity
seem VBP O
to TO O
exploit VB B-Action
the DT B-Entity
same JJ I-Entity
theme NN I-Entity
and CC O
were VBD O
used VBN O
to TO O
target VB B-Action
the DT B-Entity
same JJ I-Entity
entity NN I-Entity
at IN B-Modifier
different JJ B-Entity
times NNS I-Entity
. . O

Both DT O
Cloud NNP O
Atlas NNP O
and CC O
RedOctober NNP O
malware NN O
implants NNS O
rely VBP O
on IN O
a DT O
similar JJ O
construct NN O
, , O
with IN O
a DT O
loader NN O
and CC O
the DT O
final JJ O
payload NN O
that WDT O
is VBZ O
stored VBN O
encrypted JJ O
and CC O
compressed VBN O
in IN O
an DT O
external JJ O
file NN O
. . O

There EX O
are VBP O
some DT O
important JJ O
differences NNS O
though RB O
, , O
especially RB O
in IN O
the DT O
encryption NN O
algorithms NNS O
used VBD O
‚Äì CD O
RC4 NN O
in IN O
RedOctober NN O
vs CC O
AES NN O
in IN O
Cloud NNP O
Atlas NNP O
. . O

The DT O
usage NN O
of IN O
the DT O
compression NN O
algorithms NNS O
in IN O
Cloud NNP O
Altas NNP O
and CC O
RedOctober NNP O
is VBZ O
another DT O
interesting JJ O
similarity NN O
. . O

Both DT O
malicious JJ O
programs NNS O
share VBP O
the DT O
code NN O
for IN O
LZMA NN O
compression NN O
algorithm NN O
. . O

In IN O
CloudAtlas NNP O
it PRP O
is VBZ O
used VBN O
to TO O
compress VB O
the DT O
logs NNS O
and CC O
to TO O
decompress VB O
the DT O
decrypted JJ O
payload NN O
from IN O
the DT O
C NN O
& CC O
C NN O
servers NNS O
, , O
while IN O
in IN O
Red NNP O
October NNP O
the DT O
'' '' O
scheduler NN O
'' '' O
plugin NN O
uses VBZ O
it PRP O
to TO O
decompress VB O
executable JJ O
payloads NNS O
from IN O
the DT O
C NNP O
& CC O
C NNP O
. . O

It PRP O
turns VBZ O
out RP O
that IN O
the DT O
implementation NN O
of IN O
the DT O
algorithm NN O
is VBZ O
identical JJ O
in IN O
both CC O
malicious JJ O
modules NNS O
, , O
however RB O
the DT O
way NN O
it PRP O
is VBZ O
invoked VBN O
is VBZ O
a DT O
bit RB O
different JJ O
, , O
with IN O
additional JJ O
input NN O
sanity NN O
checks NNS O
added VBD O
to TO O
the DT O
CloudAtlas NNP O
version NN O
. . O

Another DT O
interesting JJ O
similarity NN O
between IN O
the DT O
malware NN O
families NNS O
is VBZ O
the DT O
configuration NN O
of IN O
the DT O
build VBP O
system NN O
used VBN O
to TO O
compile VB O
the DT O
binaries NNS O
. . O

Every DT O
binary JJ O
created VBN O
using VBG O
the DT O
Microsoft NNP O
Visual NNP O
Studio NNP O
toolchain NN O
has VBZ O
a DT O
special JJ O
header NN O
that WDT O
contains VBZ O
information NN O
about IN O
the DT O
number NN O
of IN O
input NN O
object NN O
files NNS O
and CC O
version NN O
information NN O
of IN O
the DT O
compilers NNS O
used VBN O
to TO O
create VB O
them PRP O
, , O
the DT O
'' '' O
Rich NNP O
'' '' O
header NN O
called VBN O
so RB O
by IN O
the DT O
magic JJ O
string NN O
that WDT O
is VBZ O
used VBN O
to TO O
identify VB O
it PRP O
in IN O
the DT O
file NN O
. . O

We PRP O
have VBP O
been VBN O
able JJ O
to TO O
identify VB O
several JJ O
RedOctober NNP O
binaries NNS O
that WDT O
have VBP O
'' '' O
Rich NNP O
'' '' O
headers NNS O
describing VBG O
exactly RB O
the DT O
same JJ O
layout NN O
of IN O
VC NN O
2010 CD O
+ CC O
VC NN O
2008 CD O
object NN O
files NNS O
. . O

Although IN O
this DT O
does VBZ O
n't RB O
necessarily RB O
mean VB O
that IN O
the DT O
binaries NNS O
were VBD O
created VBN O
on IN O
the DT O
same JJ O
development NN O
computer NN O
, , O
they PRP O
were VBD O
definitely RB O
compiled VBN O
using VBG O
the DT O
same JJ O
version NN O
of IN O
the DT O
Microsoft NNP O
Visual NNP O
Studio NNP O
up IN O
to TO O
the DT O
build VB O
number NN O
version NN O
and CC O
using VBG O
similar JJ O
project NN O
configuration NN O
. . O

To TO O
summarize VB O
the DT O
similarities NNS O
between IN O
the DT O
two CD O
: : O
Finally RB O
, , O
perhaps RB O
the DT O
strongest JJS O
connection NN O
comes VBZ O
from IN O
targeting VBG O
. . O

Based VBN O
on IN O
observations NNS O
from IN O
KSN NNP O
, , O
some DT B-Entity
of IN I-Entity
the DT I-Entity
victims NNS I-Entity
of IN I-Entity
RedOctober NNP I-Entity
are VBP O
also RB O
being VBG B-Action
targeted VBN I-Action
by IN O
CloudAtlas NNP B-Entity
. . O

In IN O
at IN O
least JJS O
one CD O
case NN O
, , O
the DT O
victim NN O
's POS O
computer NN O
was VBD O
attacked VBN O
only RB O
twice RB O
in IN O
the DT O
last JJ O
two CD O
years NNS O
, , O
with IN O
only RB O
two CD O
malicious JJ O
programs NNS O
‚Äì NNP O
RedOctober NNP O
and CC O
Cloud NNP O
Atlas NNP O
. . O

These DT O
and CC O
other JJ O
details NNS O
make VBP O
us PRP O
believe VB O
that IN O
CloudAtlas NNP O
represents VBZ O
a DT O
rebirth NN O
of IN O
the DT O
RedOctober NNP O
attacks NNS O
. . O

Following VBG O
big JJ O
announcements NNS O
and CC O
public JJ O
exposures NNS O
of IN O
targeted VBN O
attack NN O
operations NNS O
, , O
APT NN O
groups NNS O
behave VBP O
in IN O
a DT O
predictable JJ O
manner NN O
. . O

Most JJS B-Entity
Chinese-speaking JJ I-Entity
attackers NNS I-Entity
simply RB O
relocate VBP B-Action
C NN B-Entity
& CC I-Entity
C NN I-Entity
servers NNS I-Entity
to TO B-Modifier
a DT B-Entity
different JJ I-Entity
place NN I-Entity
, , O
recompile VBP O
the DT O
malware NN O
and CC O
carry VB O
on RP O
as IN O
if IN O
nothing NN O
happened VBD O
. . O

Other JJ O
groups NNS O
that WDT O
are VBP O
more RBR O
nervous JJ O
about IN O
exposure NN O
go VBP O
in IN O
a DT O
hibernation NN O
mode NN O
for IN O
months NNS O
or CC O
years NNS O
. . O

Some DT O
may MD O
never RB O
return VB O
using VBG O
the DT O
same JJ O
tools NNS O
and CC O
techniques NNS O
. . O

However RB O
, , O
when WRB O
a DT O
major JJ O
cyber-espionage JJ O
operation NN O
is VBZ O
exposed VBN O
, , O
the DT O
attackers NNS O
are VBP O
unlikely JJ O
to TO O
completely RB O
shut VB O
down RP O
everything NN O
. . O

They PRP O
simply RB O
go VBP O
offline JJ O
for IN O
some DT O
time NN O
, , O
completely RB O
reshuffle VB O
their PRP$ O
tools NNS O
and CC O
return NN O
with IN O
rejuvenated VBN O
forces NNS O
. . O

We PRP O
believe VBP O
this DT O
is VBZ O
also RB O
the DT O
case NN O
of IN O
RedOctober NNP O
, , O
which WDT O
makes VBZ O
a DT O
classy JJ O
return NN O
with IN O
Cloud NNP O
Atlas NNP O
. . O

Kaspersky NNP O
products NNS O
detect VBP O
the DT O
malware NN O
from IN O
the DT O
Cloud NNP O
Atlas NNP O
toolset NN O
with IN O
the DT O
following JJ O
verdicts NNS O
: : O
Blue NNP O
Coat NNP O
Exposes VBZ O
Inception NNP O
Framework NNP O
