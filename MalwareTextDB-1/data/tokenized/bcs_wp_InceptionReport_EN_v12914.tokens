Blue NNP O
Coat NNP O
researchers NNS O
have VBP O
uncovered VBN O
a DT O
previously-undocumented JJ O
, , O
highly RB O
automated VBN O
, , O
and CC O
extremely RB O
sophisticated JJ O
framework NN O
for IN O
performing VBG O
targeted VBN O
attacks NNS O
. . O

The DT B-Entity
framework NN I-Entity
is VBZ O
notable JJ O
for IN O
a DT O
number NN O
of IN O
reasons NNS O
, , O
including VBG O
( NN O
but CC O
not RB O
limited VBN O
to TO O
) VB O
its PRP$ O
use NN B-Action
of IN O
a DT B-Entity
cloud-based JJ I-Entity
infrastructure NN I-Entity
for IN B-Modifier
command-and-control JJ B-Entity
and CC O
its PRP$ O
use NN B-Action
of IN O
the DT B-Entity
WebDAV NN I-Entity
protocol NN I-Entity
to TO B-Modifier
send VB B-Entity
instructions NNS I-Entity
and CC O
receive VB B-Entity
exfiltrated JJ I-Entity
information NN I-Entity
from IN I-Entity
compromised VBN I-Entity
systems NNS I-Entity
. . O

Initial JJ O
malware NN O
components NNS O
were VBD O
embedded VBN O
in IN O
Rich NNP O
Text VB O
Format FW O
( FW O
RTF NN O
) CD O
files NNS O
. . O

Exploitation NN B-Entity
of IN I-Entity
vulnerabilities NNS I-Entity
in IN I-Entity
this DT I-Entity
file NN I-Entity
format NN I-Entity
is VBZ B-Action
leveraged JJ I-Action
to TO B-Modifier
gain VB B-Entity
remote JJ I-Entity
access NN I-Entity
to TO I-Entity
victim NN I-Entity
's POS I-Entity
computers NNS I-Entity
. . O

The DT B-Entity
framework NN I-Entity
, , O
thus RB O
far RB O
, , O
has VBZ O
been VBN B-Action
using VBG I-Action
the DT B-Entity
services NNS I-Entity
of IN I-Entity
a DT I-Entity
cloud NN I-Entity
service NN I-Entity
provider NN I-Entity
based VBN I-Entity
in IN I-Entity
Sweden NNP I-Entity
, , I-Entity
CloudMe.com NNP I-Entity
, , O
for IN B-Modifier
its PRP$ B-Entity
main JJ I-Entity
command-and-control JJ I-Entity
infrastructure NN I-Entity
. . O

Malware NNP O
payloads NNS O
designed VBN O
for IN O
a DT O
wide JJ O
array NN O
of IN O
potential JJ O
devices NNS O
, , O
including VBG O
home NN O
routers NNS O
and CC O
mobile JJ O
devices NNS O
running VBG O
iOS NNP O
, , O
BlackBerryOS NNP O
or CC O
Android NNP O
, , O
were VBD O
also RB O
recovered VBN O
during IN O
the DT O
course NN O
of IN O
our PRP$ O
research NN O
. . O

The DT O
framework NN O
is VBZ O
designed VBN O
in IN O
such PDT O
a DT O
way NN O
that IN O
all DT B-Entity
post-infection JJ I-Entity
communication NN I-Entity
( FW I-Entity
i.e FW I-Entity
. . I-Entity
target NN I-Entity
surveying NN I-Entity
, , I-Entity
configuration NN I-Entity
updates NNS I-Entity
, , I-Entity
malware NN I-Entity
updates NNS I-Entity
, , I-Entity
and CC I-Entity
data NNS I-Entity
exfiltration NN I-Entity
) NN I-Entity
can MD O
be VB B-Action
performed VBN I-Action
via IN B-Modifier
the DT B-Entity
cloud NN I-Entity
service NN I-Entity
. . O

The DT O
malware NN O
components NNS O
of IN O
this DT O
framework NN O
follow VBP O
a DT O
plugin NN O
model NN O
, , O
where WRB O
new JJ O
malware NN O
rely VBP O
on IN O
other JJ O
, , O
previously RB O
delivered VBN O
malware NN O
components NNS O
to TO O
interact VB O
with IN O
the DT O
framework NN O
. . O

Initial JJ O
attacks NNS O
were VBD O
largely RB O
focused VBN O
on IN O
Russia NNP O
and CC O
a DT O
few JJ O
other JJ O
Eastern JJ O
European JJ O
countries NNS O
. . O

However RB O
, , O
we PRP O
have VBP O
later RB O
seen VBN O
that IN O
attackers NNS O
are VBP O
interested JJ O
in IN O
targets NNS O
all DT O
over IN O
the DT O
globe NN O
. . O

The DT O
framework NN O
is VBZ O
itself PRP O
target-agnostic JJ O
, , O
and CC O
seems VBZ O
highly RB O
automated VBN O
. . O

The DT O
operational JJ O
security NN O
exhibited VBN O
by IN O
the DT O
attackers NNS O
is VBZ O
very RB O
good JJ O
- : O
among IN O
the DT O
best JJS O
we PRP O
have VBP O
seen VBN O
. . O

Most JJS B-Entity
interaction NN I-Entity
between IN I-Entity
attackers NNS I-Entity
and CC I-Entity
their PRP$ I-Entity
infrastructure NN I-Entity
is VBZ B-Action
performed VBN I-Action
via IN B-Modifier
a DT B-Entity
convoluted JJ I-Entity
network NN I-Entity
of IN I-Entity
router NN I-Entity
proxies NNS I-Entity
and CC I-Entity
rented VBN I-Entity
hosts NNS I-Entity
. . O

Although IN O
the DT O
attackers NNS O
have VBP O
left VBN O
a DT O
few JJ O
clues NNS O
, , O
we PRP O
have VBP O
been VBN O
unable JJ O
to TO O
provide VB O
attribution NN O
with IN O
any DT O
degree NN O
of IN O
accuracy NN O
. . O

The DT O
use NN O
of IN O
software NN O
vulnerabilities NNS O
in IN O
order NN O
to TO O
execute VB O
malicious JJ O
software NN O
on IN O
unsuspecting JJ O
users NNS O
' POS O
computers NNS O
is VBZ O
an DT O
important JJ O
parameter NN O
to TO O
monitor VB O
. . O

This DT O
method NN O
of IN O
attack NN O
is VBZ O
not RB O
only RB O
known VBN O
to TO O
have VB O
a DT O
considerable JJ O
success NN O
rate NN O
, , O
it PRP O
is VBZ O
also RB O
often RB O
deployed VBN O
by IN O
resourceful JJ O
attackers NNS O
and CC O
, , O
as IN O
such JJ O
, , O
marks VBZ O
a DT O
threat NN O
worth JJ O
paying VBG O
attention NN O
to TO O
. . O

The DT O
use NN O
of IN O
exploits NNS O
in IN O
document NN O
formats NNS O
like IN O
PDF NN O
, , O
DOC NN O
and CC O
RTF NN O
is VBZ O
in IN O
some DT O
ways NNS O
especially RB O
noteworthy JJ O
. . O

Documents NNS O
are VBP O
commonly RB O
exchanged VBN O
via IN O
mail NN O
, , O
which WDT O
make VBP O
them PRP O
perfect JJ O
for IN O
email-borne JJ O
targeted JJ O
attacks NNS O
; : O
what WP O
is VBZ O
otherwise RB O
known VBN O
as IN O
spear NN O
phishing NN O
. . O

In IN O
March NNP O
, , O
2014 CD O
, , O
Microsoft NNP O
published VBD O
information NN O
about IN O
a DT O
new JJ O
vulnerability NN O
in IN O
Rich NNP O
Text VB O
Format FW O
( FW O
RTF NN O
) NN O
. . O

This DT O
vulnerability NN O
, , O
named VBN O
CVE-2014-1761 NN O
( NN O
Microsoft NNP O
Word NNP O
RTF NNP O
Object NNP O
Confusion NNP O
) NNP O
, , O
had VBD O
already RB O
been VBN O
used VBN O
effectively RB O
by IN O
attackers NNS O
at IN O
the DT O
time NN O
of IN O
the DT O
announcement NN O
. . O

Two CD O
previous JJ O
vulnerabilities NNS O
in IN O
the DT O
RTF NN O
file NN O
format NN O
, , O
known VBN O
as IN O
CVE-2010-3333 NN O
and CC O
CVE-2012-0158 NN O
, , O
had VBD O
become VBN O
, , O
by IN O
that DT O
time NN O
, , O
mainstays NNS O
of IN O
targeted VBN O
attacks NNS O
, , O
so IN O
we PRP O
tracked VBD O
how WRB O
attackers NNS O
implemented VBD O
this DT O
new JJ O
exploit VBP O
with IN O
keen JJ O
interest NN O
. . O

By IN O
late JJ O
August NNP O
, , O
we PRP O
identified VBD O
a DT O
malware NN O
espionage NN O
operation NN O
that WDT O
used VBD O
both DT O
the DT O
CVE-2014-1761 NN O
and CC O
CVE-2012-0158 NN O
vulnerabilities NNS O
to TO O
trigger VB O
execution NN O
of IN O
the DT O
malicious JJ O
payload NN O
, , O
and CC O
which WDT O
leveraged VBD O
a DT O
single JJ O
cloud NN O
service NN O
as IN O
the DT O
backbone NN O
of IN O
its PRP$ O
entire JJ O
visible JJ O
infrastructure NN O
. . O

When WRB O
we PRP O
examined VBD O
the DT O
suspicious JJ O
documents NNS O
, , O
it PRP O
was VBD O
discovered VBN O
that IN O
they PRP O
were VBD O
somewhat RB O
anomalous JJ O
compared VBN O
to TO O
the DT O
run-of-the-mill JJ O
material NN O
. . O

They PRP O
turned VBD O
out RP O
to TO O
belong VB O
to TO O
a DT B-Entity
highly RB I-Entity
advanced JJ I-Entity
and CC I-Entity
professional JJ I-Entity
targeted VBN I-Entity
attack NN I-Entity
framework NN I-Entity
, , O
which WDT O
utilized VBD B-Action
a DT B-Entity
complex JJ I-Entity
series NN I-Entity
of IN I-Entity
techniques NNS I-Entity
to TO B-Modifier
survey VB B-Entity
potential JJ I-Entity
targets NNS I-Entity
. . O

Due JJ O
to TO O
the DT O
many JJ O
levels NNS O
of IN O
obfuscation NN O
and CC O
indirection NN O
, , O
we PRP O
named VBD O
this DT O
the DT O
Inception NNP O
framework NN O
; : O
but CC O
there EX O
ends VBZ O
all DT O
similarity NN O
with IN O
the DT O
movie NN O
by IN O
the DT O
same JJ O
name NN O
. . O

Leonardo NNP O
DiCaprio NNP O
is VBZ O
not RB O
associated VBN O
with IN O
this DT O
investigation NN O
. . O

We PRP O
initially RB O
knew VBD O
little JJ O
about IN O
who WP O
the DT O
actual JJ O
targets NNS O
were VBD O
; : O
apart RB O
from IN O
one CD O
. . O

In IN O
that DT O
particular JJ O
case NN O
we PRP B-Entity
had VBD B-Action
the DT B-Entity
actual JJ I-Entity
phishing NN I-Entity
email NN I-Entity
, , O
so IN O
we PRP O
knew VBD O
the DT O
apparent JJ O
recipient JJ O
– NN O
the DT O
CEO NN O
of IN O
a DT O
large JJ O
Russian JJ O
bank NN O
. . O

The DT O
email NN O
was VBD O
apparently RB O
sent VBN O
from IN O
'' '' O
Mrs. NNP O
World NNP O
'' '' O
; : O
note VB O
the DT O
Mrs. NNP O
, , O
and CC O
not RB O
Miss NNP O
- : O
World NNP O
. . O

We PRP O
soon RB O
discovered VBD O
that IN O
our PRP$ O
malware NN O
repository NN O
contained VBD O
several JJ O
other JJ O
, , O
similar JJ O
documents NNS O
, , O
but CC O
these DT O
had VBD O
come VBN O
from IN O
other JJ O
sources NNS O
which WDT O
did VBD O
not RB O
include VB O
the DT O
email NN O
message NN O
, , O
or CC O
any DT O
identifiable JJ O
information NN O
about IN O
the DT O
targets NNS O
. . O

However RB O
, , O
the DT O
text NN O
of IN O
the DT O
documents NNS O
covered VBD O
a DT O
variety NN O
of IN O
topics NNS O
mostly RB O
revolving VBG O
around IN O
Russian JJ O
issues NNS O
relating VBG O
to TO O
a DT O
variety NN O
of IN O
business NN O
sectors NNS O
. . O

The DT O
following JJ O
pages NNS O
highlight VBP O
a DT O
representative JJ O
selection NN O
of IN O
these DT O
documents NNS O
. . O

All DT O
documents NNS O
that IN O
we PRP O
have VBP O
found VBN O
so RB O
far RB O
have VBP O
been VBN O
rather RB O
standard JJ O
Word NN O
documents NNS O
, , O
of IN O
the DT O
old JJ O
97-2003 CD O
compatible JJ O
format NN O
based VBN O
on IN O
OLE2 NN O
. . O

Such JJ O
documents NNS O
can MD O
, , O
and CC O
typically RB O
do VBP O
, , O
contain VBP O
quite RB O
a DT O
bit NN O
of IN O
metadata NN O
: : O
The DT O
name NN O
of IN O
the DT O
document NN O
creator NN O
; : O
the DT O
user NN O
who WP O
edited VBD O
it PRP O
most RBS O
recently RB O
; : O
the DT O
name NN O
of IN O
the DT O
company NN O
whose WP$ O
copy NN O
of IN O
Word NN O
was VBD O
used VBN O
to TO O
create VB O
the DT O
document NN O
, , O
et FW O
al FW O
. . O

Users NNS O
can MD O
optionally RB O
configure VB O
Word NN O
to TO O
remove VB O
this DT O
metadata NN O
when WRB O
a DT O
document NN O
is VBZ O
saved VBN O
, , O
and CC O
that DT O
's VBZ O
exactly RB O
what WP O
the DT O
creator NN O
of IN O
these DT O
documents NNS O
did VBD O
, , O
stripping VBG O
out RP O
this DT O
potential JJ O
source NN O
of IN O
attribution NN O
data NNS O
. . O

However RB O
, , O
Word NN O
documents NNS O
in IN O
this DT O
format NN O
contain VBP O
additional JJ O
information NN O
, , O
if IN O
you PRP O
know VBP O
where WRB O
to TO O
look VB O
. . O

All NNP O
Word NNP O
documents NNS O
of IN O
this DT O
format NN O
contain VBP O
what WP O
's VBZ O
known VBN O
as IN O
a DT O
File NNP O
Information NNP O
Block NNP O
( FW O
FIB FW O
) FW O
. . O

The DT O
FIB NN O
contains VBZ O
information NN O
about IN O
the DT O
file NN O
's POS O
internal JJ O
structure NN O
, , O
and CC O
also RB O
– CD O
to TO O
some DT O
extent NN O
– CD O
data NNS O
on IN O
the DT O
program NN O
used VBN O
to TO O
create VB O
the DT O
file NN O
. . O

In IN O
the DT O
case NN O
of IN O
the DT O
samples NNS O
we PRP O
analyzed VBD O
, , O
all DT O
of IN O
the DT O
documents NNS O
were VBD O
saved VBN O
using VBG O
the DT O
same JJ O
build VB O
of IN O
Microsoft NNP O
Word NNP O
from IN O
Office14 FW O
( FW O
better RBR O
known VBN O
as IN O
Office NNP O
2010 CD O
) NNP O
. . O

In IN O
addition NN O
, , O
documents NNS O
can MD O
contain VB O
slack JJ O
space NN O
in IN O
which WDT O
old JJ O
data NNS O
remains VBZ O
. . O

For IN O
example NN O
, , O
the DT O
decoy NN O
that WDT O
came VBD O
with IN O
the DT O
attack NN O
named VBN O
'' '' O
Organigrama FW O
Gobierno FW O
Rusia.doc NN O
'' '' O
contains VBZ O
Visual JJ O
Basic JJ O
leftovers NNS O
indicating VBG O
that IN O
it PRP O
originally RB O
was VBD O
created VBN O
on IN O
a DT O
computer NN O
that WDT O
was VBD O
configured VBN O
to TO O
be VB O
used VBN O
by IN O
a DT O
native JJ O
Spanish JJ O
speaker NN O
, , O
apparently RB O
by IN O
an DT O
advisor NN O
at IN O
the DT O
Spanish NNP O
Embassy NNP O
in IN O
Moscow NNP O
. . O

This DT B-Entity
document NN I-Entity
was VBD B-Action
presumably RB I-Action
obtained VBN I-Action
by IN O
the DT B-Entity
attackers NNS I-Entity
and CC O
repurposed VBN B-Action
for IN B-Modifier
the DT B-Entity
attack NN I-Entity
. . O

Despite IN O
the DT O
limited JJ O
information NN O
at IN O
our PRP$ O
disposal NN O
about IN O
the DT O
targets NNS O
of IN O
these DT O
attacks NNS O
, , O
their PRP$ O
content NN O
reveals VBZ O
some DT O
context NN O
about IN O
who WP O
the DT O
possible JJ O
targets NNS O
may MD O
have VB O
been VBN O
. . O

First NNP O
of IN O
all DT O
, , O
we PRP B-Entity
have VBP B-Action
the DT B-Entity
decoy NN I-Entity
documents NNS I-Entity
which WDT O
indicate VBP O
an DT O
interest NN O
in IN O
: : O
We PRP B-Entity
also RB O
have VBP B-Action
a DT B-Entity
set NN I-Entity
of IN I-Entity
phishing FW I-Entity
mails FW I-Entity
, , O
which WDT O
were VBD O
targeted VBN O
at IN O
: : O
The DT O
shellcode NN O
used VBN O
is VBZ O
a DT O
pretty RB O
standard JJ O
variant NN O
previously RB O
used VBN O
by IN O
a DT O
number NN O
of IN O
campaigns NNS O
typically RB O
operating VBG O
out IN O
of IN O
China NNP O
, , O
but CC O
with IN O
some DT O
minor JJ O
changes NNS O
. . O

The DT B-Entity
malicious JJ I-Entity
content NN I-Entity
is VBZ B-Action
stored VBN I-Action
inside IN B-Modifier
the DT B-Entity
document NN I-Entity
in IN B-Modifier
encoded VBN B-Entity
form NN I-Entity
, , O
and CC O
the DT B-Entity
shellcode NN I-Entity
decodes VBZ O
and CC O
writes VBZ B-Action
this DT B-Entity
to TO B-Modifier
disk NN B-Entity
. . O

Upon IN O
successful JJ O
execution NN O
this DT B-Entity
code NN I-Entity
drops VBZ B-Action
a DT B-Entity
Word NN I-Entity
document NN I-Entity
and CC I-Entity
a DT I-Entity
Visual JJ I-Entity
Basic JJ I-Entity
script NN I-Entity
. . O

The DT O
Word NN O
document NN O
is VBZ O
displayed VBN O
to TO O
the DT O
user NN O
to TO O
avoid VB O
arousing VBG O
any DT O
suspicion NN O
while IN O
the DT B-Entity
script NN I-Entity
is VBZ B-Action
executed VBN I-Action
in IN B-Modifier
the DT B-Entity
background NN I-Entity
. . O

Unusual JJ O
for IN O
many JJ O
exploit VBP O
campaigns NNS O
, , O
the DT B-Entity
names NNS I-Entity
of IN I-Entity
the DT I-Entity
dropped VBN I-Entity
files NNS I-Entity
vary VBP O
; : O
for IN O
example NN O
HyHa9AJ.vbs NNS O
, , O
ewRg.vbs NNS O
, , O
0QHdN.vbs NNS O
, , O
etc FW O
. . O

– NN O
clearly RB O
randomized VBN B-Action
in IN B-Modifier
order NN I-Modifier
to TO I-Modifier
avoid VB B-Entity
detection NN I-Entity
by IN I-Entity
name NN I-Entity
. . O

The DT O
VBScript NN O
dropper NN O
code NN O
is VBZ O
also RB O
a DT O
little RB O
unusual JJ O
. . O

It PRP O
declares VBZ O
a DT O
Windows NNP O
Management NNP O
Instrumentation NNP O
( FW O
WMI FW O
) FW O
object NN O
in IN O
order NN O
to TO O
reach VB O
components NNS O
like IN O
the DT O
registry NN O
and CC O
file NN O
system NN O
. . O

This DT O
seems VBZ O
adapted VBN O
from IN O
Microsoft NNP O
example NN O
code NN O
, , O
like IN O
the DT O
one NN O
found VBN O
at IN O
http NN O
: : O
//msdn.microsoft.com/en-us/library/aa387236 FW O
( FW O
v=vs.85 FW O
) FW O
.aspx FW O

When WRB O
the DT O
VBSript NN O
is VBZ O
run VBN O
it PRP B-Entity
drops VBZ B-Action
two CD B-Entity
files NNS I-Entity
to TO B-Modifier
disk NN B-Entity
. . O

One CD O
is VBZ O
a DT O
polymorphed JJ O
dll NN O
file NN O
and CC O
the DT O
other JJ O
a DT O
binary JJ O
data NN O
file NN O
with IN O
no DT O
obvious JJ O
internal JJ O
structure NN O
. . O

This DT B-Entity
data NNS I-Entity
file NN I-Entity
turns VBZ O
out RP O
to TO O
be VB B-Action
encrypted VBN I-Action
using VBG B-Modifier
AES-256 NN B-Entity
. . O

The DT B-Entity
files NNS I-Entity
will MD O
be VB B-Action
installed VBN I-Action
in IN B-Modifier
several JJ B-Entity
locations NNS I-Entity
: : O
These DT O
locations NNS O
will MD O
vary VB O
some DT O
between IN O
operating VBG O
system NN O
versions NNS O
. . O

The DT B-Entity
VBScript NN I-Entity
then RB O
sets VBZ B-Action
a DT B-Entity
startup NN I-Entity
key NN I-Entity
in IN B-Modifier
the DT B-Entity
'' '' I-Entity
HKCU\Software\Microsoft\Windows\CurrentVersion\Run NN I-Entity
'' '' I-Entity
registry NN I-Entity
path NN I-Entity
to TO O
execute VB B-Action
the DT B-Entity
DLLs NNS I-Entity
at IN B-Modifier
boot NN B-Entity
time NN I-Entity
. . O

Regardless RB O
of IN O
whether IN O
the DT O
registry NN O
launches VBZ O
the DT O
DLL NNP O
or CC O
when WRB O
another DT O
malware FW O
executable FW O
starts VBZ O
the DT O
DLL NNP O
directly RB O
, , O
the DT B-Entity
DLL NNP I-Entity
is VBZ B-Action
launched VBN I-Action
using VBG B-Modifier
regsrv32.exe NN B-Entity
with IN B-Modifier
the DT B-Entity
/s FW I-Entity
( FW I-Entity
silent JJ I-Entity
) NN I-Entity
option NN I-Entity
. . O

The DT O
names NNS O
of IN O
these DT O
dropped VBN O
files NNS O
change VBP O
from IN O
attack NN O
to TO O
attack NN O
. . O

The DT B-Entity
one CD I-Entity
above JJ I-Entity
drops NNS B-Action
ctfmonrc.dll NN B-Entity
. . O

Other JJ O
names NNS O
observed VBN O
were VBD O
: : O
The DT O
encrypted JJ O
data NN O
files NNS O
are VBP O
named VBN O
using VBG O
random JJ O
words NNS O
apparently RB O
taken VBN O
from IN O
a DT O
dictionary NN O
– NN O
'' '' O
acholias FW O
'' '' O
, , O
'' '' O
arzner NN O
'' '' O
, , O
'' '' O
bicorporate NN O
'' '' O
, , O
'' '' O
crockrell NN O
'' '' O
, , O
'' '' O
damnatorily RB O
'' '' O
etc FW O
. . O

Looking VBG O
at IN O
one CD O
of IN O
the DT O
dropped VBN O
dlls NNS O
we PRP O
can MD O
see VB O
the DT O
authors NNS O
originally RB O
called VBD O
it PRP O
95Num3P3gm.dll.polymorphed.dll NN O
. . O

When WRB O
executed VBN O
it PRP O
will MD O
rebuild VB O
the DT O
original JJ O
dll FW O
( FW O
95Num3p3gm.dll NN O
, , O
presumably RB O
) CD O
, , O
load VB B-Action
it PRP B-Entity
from IN B-Modifier
memory NN B-Entity
and CC O
pass NN O
over IN O
execution NN O
. . O

It PRP O
is VBZ O
hard JJ O
to TO O
describe VB O
the DT O
polymorphed JJ O
dlls NNS O
with IN O
any DT O
real JJ O
depth NN O
, , O
as IN O
there EX O
is VBZ O
little JJ O
consistency NN O
between IN O
them PRP O
. . O

When WRB O
two CD O
nearly RB O
identical JJ O
dlls NNS O
are VBP O
encoded VBN O
using VBG O
the DT O
polymorphic JJ O
scheme NN O
there EX O
is VBZ O
very RB O
little JJ O
code NN O
in IN O
common JJ O
. . O

The DT O
call NN O
graphs NNS O
are VBP O
different JJ O
and CC O
key JJ O
functions NNS O
have VBP O
varying VBG O
number NN O
of IN O
arguments NNS O
. . O

The DT B-Entity
polymorphing VBG I-Entity
mechanism NN I-Entity
also RB O
generates VBZ O
, , O
and CC O
inserts NNS O
, , O
unique JJ O
functions NNS O
all DT O
of IN O
which WDT O
make VBP O
calls NNS O
to TO O
different JJ O
floating-point JJ O
operations NNS O
– VBP O
all DT O
done VBN O
just RB O
to TO O
obfuscate VB B-Action
the DT B-Entity
actual JJ I-Entity
decoding NN I-Entity
process NN I-Entity
. . O

The DT O
sizes NNS O
of IN O
buffers NNS O
allocated VBN O
are VBP O
also RB O
randomized VBN O
to TO O
mask NN O
their PRP$ O
intent NN O
. . O

What WP O
is VBZ O
common JJ O
is VBZ O
that IN O
somewhere RB O
along IN O
the DT O
execution NN O
cycle NN O
is VBZ O
one CD O
extremely RB O
large JJ O
function NN O
( NN O
over IN O
200 CD O
kb NN O
in IN O
length NN O
) NN O
where WRB O
early RB O
in IN O
a DT O
large JJ O
allocation NN O
is VBZ O
made VBN O
where WRB O
the DT O
un-obfuscated JJ O
binary JJ O
will MD O
be VB O
placed VBN O
. . O

The DT O
binary JJ O
is VBZ O
then RB O
built VBN O
from IN O
de- NN O
obfuscating VBG O
segments NNS O
of IN O
it PRP O
that WDT O
have VBP O
been VBN O
dispersed VBN O
through IN O
the DT O
'.rdata NN O
' POS O
section NN O
. . O

The DT O
order NN O
, , O
size NN O
, , O
and CC O
locations NNS O
of IN O
these DT O
segments NNS O
vary VBP O
from IN O
build VB O
to TO O
build VB O
but CC O
somewhere RB O
near IN O
the DT O
end NN O
of IN O
the DT O
large JJ O
function NN O
there EX O
will MD O
be VB O
a DT B-Entity
call NN I-Entity
to TO I-Entity
a DT I-Entity
subfunction NN I-Entity
that IN O
loads NNS B-Action
the DT B-Entity
PE NN I-Entity
image NN I-Entity
into IN B-Modifier
memory NN B-Entity
, , O
followed VBN O
by IN O
a DT B-Entity
call NN I-Entity
to TO O
free VB B-Action
the DT B-Entity
PE NN I-Entity
image NN I-Entity
allocation NN I-Entity
from IN B-Modifier
memory NN B-Entity
. . O

Simply RB O
halting VBG O
execution NN O
before IN O
this DT O
function NN O
call NN O
permits VBZ O
a DT O
researcher NN O
to TO O
extract VB O
the DT O
reconstructed JJ O
DLL NN O
from IN O
memory NN O
. . O

Here RB O
, , O
pausing VBG O
execution NN O
before IN O
the DT O
call NN O
to TO O
'loadpefrommemory NN O
' '' O
reveals VBZ O
the DT O
extracted VBN O
PE NN O
at IN O
the DT O
memory NN O
address NN O
pointed VBD O
to TO O
by IN O
edx NN O
. . O

This NNP O
reconstructed VBD O
DLL NNP O
, , O
once RB O
loaded VBN O
, , O
will MD O
decode VB O
a DT O
configuration NN O
structure NN O
from IN O
its PRP$ O
'.data NN O
' '' O
section NN O
which WDT O
contains VBZ O
three CD O
important JJ O
details NNS O
: : O
the DT O
name NN O
of IN O
the DT O
encrypted JJ O
data NNS O
file NN O
dropped VBN O
by IN O
the DT O
VBScript NN O
; : O
the DT O
AES NN O
key NN O
used VBN O
to TO O
decrypt VB O
the DT O
file NN O
; : O
and CC O
the DT O
name NN O
of IN O
a DT O
unique JJ O
global JJ O
mutex NN O
to TO O
hold VB O
while IN O
running VBG O
to TO O
prevent VB O
multiple JJ O
instances NNS O
. . O

This DT B-Entity
configuration NN I-Entity
information NN I-Entity
is VBZ O
used VBN O
to TO O
load VB B-Action
the DT B-Entity
encrypted JJ I-Entity
file NN I-Entity
into IN B-Modifier
memory NN B-Entity
and CC O
decrypt VB O
it PRP O
. . O

This DT O
turns VBZ O
out RP O
to TO O
be VB O
yet RB O
another DT O
dll NN O
. . O

The DT O
first JJ O
ordinal NN O
exported VBN O
by IN O
this DT O
dll NN O
is VBZ O
located JJ O
and CC O
then RB O
called VBN O
, , O
passing VBG O
in IN O
the DT O
configuration NN O
and CC O
the DT O
name NN O
of IN O
the DT O
encrypted JJ O
file NN O
on IN O
disk NN O
as IN O
parameters NNS O
. . O

This DT O
last JJ O
dll NN O
is VBZ O
the DT O
heart NN O
of IN O
the DT O
threat NN O
( NN O
originally RB O
called VBN O
q5Byo.dll NN O
in IN O
this DT O
instance NN O
. . O

This DT O
file NN O
contains VBZ O
the DT O
true JJ O
intent NN O
of IN O
this DT O
campaign NN O
. . O

It PRP B-Entity
is VBZ B-Action
designed VBN I-Action
as IN B-Modifier
a DT B-Entity
survey NN I-Entity
tool NN I-Entity
. . O

The DT B-Entity
PE NN I-Entity
file NN I-Entity
gathers VBZ B-Action
system NN B-Entity
information NN I-Entity
including VBG O
OS NN B-Entity
version NN I-Entity
, , O
computer NN B-Entity
name NN I-Entity
, , O
user NN B-Entity
name NN I-Entity
, , O
user NN B-Entity
group NN I-Entity
membership NN I-Entity
, , O
the DT B-Entity
process NN I-Entity
it PRP I-Entity
is VBZ I-Entity
running VBG I-Entity
in RP I-Entity
, , O
locale NN B-Entity
ID NNP I-Entity
's POS I-Entity
, , O
as RB O
well RB O
as IN O
system NN B-Entity
drive NN I-Entity
and CC I-Entity
volume NN I-Entity
information NN I-Entity
. . O

All DT B-Entity
of IN I-Entity
this DT I-Entity
is VBZ B-Action
encrypted JJ I-Action
and CC O
then RB O
sent VBD B-Action
to TO B-Modifier
cloud VB B-Entity
storage NN I-Entity
via IN B-Modifier
WebDAV NN B-Entity
. . O

WebDAV NN O
is VBZ O
a DT O
communication NN O
standard NN O
that WDT O
allows VBZ O
file NN O
management NN O
over IN O
HTTP NNP O
or CC O
HTTPS NNP O
. . O

Windows NNP O
allows VBZ O
WebDAV NN O
sessions NNS O
to TO O
be VB O
mapped VBN O
as IN O
network NN O
resources NNS O
. . O

The DT O
use NN O
of IN O
WebDAV NN O
as IN O
the DT O
communication NN O
channel NN O
is VBZ O
atypical JJ O
for IN O
most JJS O
malware NN O
samples NNS O
we PRP O
see VBP O
. . O

By IN O
using VBG O
a DT O
network NN O
resource NN O
, , O
the DT O
actual JJ O
web NN O
traffic NN O
originates VBZ O
from IN O
the DT O
system NN O
itself PRP O
, , O
and CC O
not RB O
from IN O
the DT O
process NN O
in IN O
which WDT O
the DT O
malware NN O
resides VBZ O
. . O

Additionally RB O
, , O
once RB O
the DT O
resource NN O
is VBZ O
established VBN O
, , O
the DT B-Entity
malware NN I-Entity
can MD O
transfer VB B-Action
files NNS B-Entity
to TO B-Modifier
and CC O
from IN B-Modifier
the DT B-Entity
command NN I-Entity
and CC I-Entity
control NN I-Entity
servers NNS I-Entity
using VBG B-Modifier
standard JJ B-Entity
file NN I-Entity
IO NN I-Entity
commands NNS I-Entity
. . O

All PDT O
the DT O
authentication NN O
information NN O
for IN O
the DT O
WebDAV NN O
session NN O
including VBG O
the DT O
URL NN O
, , O
folders NNS O
, , O
path NN O
, , O
user NN O
name NN O
, , O
and CC O
password NN O
is VBZ O
stored VBN O
within IN O
this DT O
last JJ O
DLL NNP O
in IN O
another DT O
AES-encrypted JJ O
configuration NN O
structure NN O
in IN O
the DT O
binary JJ O
. . O

A DT O
unique JJ O
path NN O
, , O
username NN O
, , O
and CC O
password NN O
were VBD O
used VBN O
for IN O
each DT O
malware NN O
instance NN O
we PRP O
've VBP O
seen VBN O
in IN O
the DT O
wild JJ O
. . O

This DT O
allows VBZ O
the DT B-Entity
attackers NNS I-Entity
to TO O
uniquely RB O
identify VB B-Action
every DT B-Entity
targeted VBN I-Entity
attack NN I-Entity
and CC O
track NN O
how WRB O
successful JJ O
each DT O
phishing VBG O
campaign NN O
is VBZ O
. . O

Also RB O
contained VBN O
within IN O
the DT O
configuration NN O
structure NN O
is VBZ O
information NN O
on IN O
how WRB O
to TO O
name VB O
the DT O
survey NN O
data NNS O
on IN O
the DT O
remote JJ O
file NN O
server NN O
. . O

The DT O
binary JJ O
reads VBZ O
from IN O
its PRP$ O
configuration NN O
a DT O
string NN O
on IN O
how WRB O
to TO O
generate VB O
the DT O
remote JJ O
filename NN O
, , O
and CC O
a DT O
list NN O
of IN O
extensions NNS O
to TO O
use VB O
. . O

An DT O
example NN O
would MD O
be VB O
'' '' O
1-7d0-8s NNS O
'' '' O
, , O
[ NNP O
'' '' O
TIF NNP O
'' '' O
, , O
'' '' O
TAR NN O
'' '' O
, , O
'' '' O
SIT NN O
'' '' O
] NN O
which WDT O
instructs VBZ O
the DT O
binary JJ O
to TO O
generate VB O
a DT O
filename NN O
with IN O
1 CD O
to TO O
7 CD O
numeric JJ O
digit NN O
characters NNS O
followed VBN O
by IN O
0 CD O
to TO O
8 CD O
ASCII NN O
letters NNS O
with IN O
one CD O
of IN O
the DT O
three CD O
listed VBN O
extensions NNS O
such JJ O
as IN O
'' '' O
664gher.TAR NN O
'' '' O
. . O

The DT B-Entity
survey NN I-Entity
is VBZ B-Action
then RB I-Action
uploaded VBN I-Action
to TO B-Modifier
the DT B-Entity
server NN I-Entity
in IN B-Modifier
a DT B-Entity
specified JJ I-Entity
folder NN I-Entity
with IN B-Modifier
the DT B-Entity
generated VBN I-Entity
name NN I-Entity
. . O

Files NNS B-Entity
are VBP B-Action
compressed VBN I-Action
using VBG B-Modifier
a DT B-Entity
modified VBN I-Entity
LZMA-compression NN I-Entity
and CC O
encrypted VBN B-Action
using VBG B-Modifier
AES NN B-Entity
cipher-block-chaining JJ I-Entity
( NN I-Entity
CBC NN I-Entity
) NN I-Entity
before IN O
being VBG B-Action
uploaded VBN I-Action
to TO B-Modifier
the DT B-Entity
cloud NN I-Entity
server NN I-Entity
. . O

The DT B-Entity
binary JJ I-Entity
also RB O
checks VBZ B-Action
a DT B-Entity
separate JJ I-Entity
folder NN I-Entity
on IN I-Entity
the DT I-Entity
cloud NN I-Entity
service NN I-Entity
designated VBN I-Entity
to TO I-Entity
contain VB I-Entity
new JJ I-Entity
configuration NN I-Entity
information NN I-Entity
. . O

If IN O
such PDT O
a DT O
file NN O
is VBZ O
present JJ O
on IN O
the DT O
server NN O
, , O
the DT B-Entity
malware NN I-Entity
downloads NNS B-Action
the DT B-Entity
new JJ I-Entity
configuration NN I-Entity
file NN I-Entity
then RB O
deletes VBZ B-Action
it PRP B-Entity
from IN B-Modifier
the DT B-Entity
server NN I-Entity
. . O

The DT O
cloud NN O
storage NN O
provider NN O
in IN O
every DT O
case NN O
we PRP O
have VBP O
seen VBN O
was VBD O
the DT O
Swedish JJ O
company NN O
CloudMe.com NN O
, , O
which WDT O
offers VBZ O
free JJ O
and CC O
paid VBN O
WebDAV NN O
cloud NN O
storage NN O
. . O

The DT O
URI NNP O
model NN O
used VBN O
by IN O
the DT O
malware NN O
is VBZ O
http JJ O
: : O
//webdav.cloudme.com/ CD O
% NN O
username JJ O
% NN O
/CloudDrive/ NN O
which WDT O
is VBZ O
a DT O
direct JJ O
reference NN O
to TO O
file VB O
storage NN O
. . O

It PRP O
must MD O
be VB O
noted VBN O
that IN O
the DT O
CloudMe NN O
service NN O
is VBZ O
not RB O
actively RB O
spreading VBG O
the DT O
malicious JJ O
content NN O
; : O
the DT O
attackers NNS O
are VBP O
only RB O
using VBG O
it PRP O
for IN O
storing VBG O
their PRP$ O
files NNS O
. . O

We PRP O
notified VBD O
CloudMe.com NNP O
about IN O
the DT O
abuse NN O
of IN O
their PRP$ O
services NNS O
. . O

Their PRP$ O
CEO NN O
, , O
Mr. NNP O
Daniel NNP O
Arthursson NNP O
, , O
was VBD O
none NN O
too RB O
happy JJ O
about IN O
this DT O
, , O
and CC O
was VBD O
very RB O
helpful JJ O
in IN O
our PRP$ O
further JJ O
research NN O
. . O

CloudMe NN O
has VBZ O
shared VBN O
a DT O
great JJ O
deal NN O
of IN O
log NN O
information NN O
related VBN O
to TO O
this DT O
attack NN O
. . O

These DT O
indicate VBP O
that IN O
there EX O
are VBP O
many JJ O
other JJ O
accounts NNS O
( CD O
over IN O
100 CD O
) CD O
likely RB O
related JJ O
to TO O
this DT O
attack NN O
system NN O
. . O

We PRP O
have VBP O
no DT O
way NN O
of IN O
verifying VBG O
this DT O
with IN O
absolute JJ O
certainty NN O
, , O
but CC O
this DT O
is VBZ O
what WP O
we PRP O
regard VBP O
as IN O
a DT O
high JJ O
confidence NN O
assumption NN O
. . O

The DT O
cloud NN O
accounts NNS O
are VBP O
not RB O
used VBN O
for IN O
one-way JJ O
communication NN O
only RB O
. . O

The DT B-Entity
malware NN I-Entity
also RB O
checks NNS B-Action
configured VBD B-Entity
subfolders NNS I-Entity
for IN B-Modifier
updates NNS B-Entity
; : O
and CC O
if IN O
these DT O
are VBP O
found VBN O
they PRP B-Entity
will MD O
be VB B-Action
downloaded VBN I-Action
, , O
decrypted VBN O
and CC O
used VBN O
as IN O
appropriate JJ O
. . O

One CD O
such JJ O
case NN O
is VBZ O
the DT O
franko7046 NN O
account NN O
, , O
used VBN O
against IN O
the DT O
previously RB O
mentioned VBN O
bank NN O
CEO NN O
. . O

In IN O
this DT O
account NN O
there EX O
was VBD O
hidden VBN O
another DT B-Entity
encrypted JJ I-Entity
configuration NN I-Entity
file NN I-Entity
which WDT O
the DT B-Entity
malware NN I-Entity
downloaded VBN B-Action
and CC O
decrypted VBN O
. . O

This DT O
is VBZ O
how WRB O
we PRP O
found VBD O
the DT O
depp3353 NN O
account NN O
. . O

In IN O
this DT O
new JJ O
account NN O
there EX O
was VBD O
another DT O
surprise NN O
waiting VBG O
for IN O
us PRP O
– VBD O
a DT O
download NN O
folder NN O
with IN O
two CD O
new JJ O
encrypted JJ O
files NNS O
, , O
921.bin NN O
and CC O
922.bin NN O
. . O

Once RB O
decrypted VBN O
, , O
these DT O
turned VBD O
out RP O
to TO O
be VB O
PE JJ O
executables NNS O
. . O

The DT O
two CD O
new JJ O
executables NNS O
are VBP O
plugins NNS O
- : O
quite RB O
similar JJ O
to TO O
each DT O
other JJ O
and CC O
obviously RB O
compiled VBN O
on IN O
the DT O
same JJ O
setup NN O
. . O

They PRP B-Entity
are VBP O
lightweight JJ O
and CC O
intended VBN O
to TO O
pull VB B-Action
specific JJ B-Entity
survey NN I-Entity
information NN I-Entity
from IN B-Modifier
their PRP$ B-Entity
target NN I-Entity
. . O

Of IN O
interest NN O
, , O
both DT O
of IN O
the DT O
DLLs NNS O
originally RB O
had VBD O
the DT O
same JJ O
internal JJ O
name NN O
( FW O
78wO13YrJ0cB.dll FW O
) FW O
. . O

Presumably RB O
the DT O
same JJ O
PE NN O
sanitization NN O
script NN O
and CC O
parameters NNS O
were VBD O
used VBN O
on IN O
both DT O
. . O

None NN O
of IN O
these DT O
plugins NNS O
contain VBP O
any DT O
means NNS O
of IN O
CnC NN O
communication NN O
. . O

Instead RB O
, , O
when WRB O
they PRP O
are VBP O
executed VBN O
they PRP B-Entity
are VBP B-Action
passed VBN I-Action
a DT B-Entity
pointer NN I-Entity
to TO I-Entity
a DT I-Entity
function NN I-Entity
to TO B-Modifier
use VB B-Entity
for IN I-Entity
sending VBG I-Entity
data NNS I-Entity
back RB I-Entity
home RB I-Entity
. . O

Neither DT O
are VBP O
they PRP O
ever RB O
written VBD O
to TO O
disk NN O
. . O

They PRP B-Entity
are VBP B-Action
executed VBN I-Action
in IN B-Modifier
memory NN B-Entity
only RB O
, , O
and CC O
once RB B-Modifier
they PRP B-Entity
have VBP I-Entity
completed VBN I-Entity
the DT B-Entity
memory NN I-Entity
is VBZ B-Action
freed VBN I-Action
. . O

This DT O
makes VBZ O
these DT O
modules NNS O
extremely RB O
stealthy JJ O
, , O
flexible JJ O
and CC O
compatible JJ O
with IN O
multiple JJ O
toolsets NNS O
independent JJ O
of IN O
what WDT O
CnC NN O
method NN O
is VBZ O
being VBG O
used VBN O
. . O

921.bin NN B-Entity
retrieves VBZ B-Action
several JJ B-Entity
datapoints NNS I-Entity
about IN B-Modifier
the DT B-Entity
infected JJ I-Entity
machine NN I-Entity
: : O
Domain NN B-Entity
info NN I-Entity
; : O
a DT B-Entity
list NN I-Entity
of IN I-Entity
running VBG I-Entity
processes NNS I-Entity
with IN I-Entity
all DT I-Entity
loaded JJ I-Entity
modules NNS I-Entity
in IN I-Entity
each DT I-Entity
; : O
the DT B-Entity
list NN I-Entity
of IN I-Entity
installed JJ I-Entity
software NN I-Entity
; : O
and CC O
a DT B-Entity
complete JJ I-Entity
hardware NN I-Entity
profile NN I-Entity
of IN I-Entity
the DT I-Entity
target NN I-Entity
machine NN I-Entity
. . O

922.bin NN B-Entity
compiles VBZ B-Action
a DT B-Entity
dirwalk FW I-Entity
– FW I-Entity
a DT I-Entity
complete JJ I-Entity
listing NN I-Entity
of IN I-Entity
every DT I-Entity
file NN I-Entity
path NN I-Entity
– NN I-Entity
of IN I-Entity
each DT I-Entity
fixed VBN I-Entity
drive NN I-Entity
. . O

All DT B-Entity
of IN I-Entity
this DT I-Entity
information NN I-Entity
is VBZ B-Action
exfiltrated VBN I-Action
back RB B-Modifier
via IN I-Modifier
the DT B-Entity
same JJ I-Entity
WebDAV NN I-Entity
connection NN I-Entity
. . O

This DT O
model NN O
makes VBZ O
it PRP O
possible JJ O
to TO O
do VB O
the DT O
intrusion NN O
in IN O
steps NNS O
, , O
with IN O
verification NN O
stages NNS O
in IN O
between IN O
; : O
and CC O
the DT O
files NNS O
will MD O
not RB O
be VB O
easily RB O
found VBN O
on IN O
affected JJ O
computers NNS O
. . O

Based VBN O
on IN O
the DT O
information NN O
gathered VBN O
from IN O
these DT O
modules NNS O
, , O
the DT O
attackers NNS O
appear VBP O
to TO O
move VB O
to TO O
the DT O
next JJ O
stage NN O
of IN O
their PRP$ O
attack NN O
by IN O
placing VBG O
more JJR O
new JJ O
components NNS O
on IN O
the DT O
WebDAV JJ O
shares NNS O
. . O

Information NNP O
about IN O
these DT O
uploads NNS O
is VBZ O
limited VBN O
by IN O
the DT O
fact NN O
that IN O
we PRP O
do VBP O
not RB O
have VB O
the DT O
AES NN O
keys NNS O
to TO O
decrypt VB O
much JJ O
of IN O
the DT O
uploaded JJ O
data NNS O
, , O
but CC O
we PRP O
have VBP O
been VBN O
able JJ O
to TO O
see VB O
some DT O
upload NN O
patterns NNS O
. . O

What WP O
we PRP O
assume VBP O
to TO O
be VB O
third-stage JJ O
plugins NNS O
appear VBP O
on IN O
the DT O
shares NNS O
as IN O
*.bin NN O
files NNS O
of IN O
roughly RB O
72kb JJ O
. . O

As IN O
with IN O
other JJ O
plugins NNS O
, , O
these DT B-Entity
are VBP B-Action
downloaded VBN I-Action
and CC O
deleted VBN B-Action
from IN B-Modifier
the DT B-Entity
share NN I-Entity
in IN B-Modifier
one CD B-Entity
go NN I-Entity
. . O

However RB O
, , O
the DT O
next JJ O
day NN O
, , O
another DT O
*.bin NN O
file NN O
of IN O
the DT O
same JJ O
size NN O
will MD O
be VB O
uploaded VBN O
to TO O
the DT O
share NN O
. . O

This DT O
is VBZ O
a DT O
pattern NN O
that WDT O
repeats VBZ O
itself PRP O
over IN O
all DT O
live JJ O
accounts NNS O
. . O

It PRP O
seems VBZ O
that IN O
because IN O
the DT O
plugins NNS O
exist VBP O
in IN O
memory NN O
only RB O
, , O
they PRP B-Entity
are VBP B-Action
injected VBN I-Action
daily RB B-Entity
to TO B-Modifier
ensure VB B-Entity
persistence NN I-Entity
on IN I-Entity
victim NN I-Entity
computers NNS I-Entity
. . O

Our PRP$ O
theory NN O
is VBZ O
that IN O
this DT B-Entity
malware NN I-Entity
is VBZ B-Action
a DT B-Entity
more RBR I-Entity
typical JJ I-Entity
datastealer NN I-Entity
, , O
and CC O
we PRP O
have VBP O
observed VBN O
that IN O
after IN O
this DT O
type NN O
of IN O
file NN O
is VBZ O
planted VBN O
on IN O
the DT O
account NN O
, , O
encrypted JJ B-Entity
data NN I-Entity
uploads NNS I-Entity
from IN I-Entity
compromised VBN I-Entity
users NNS I-Entity
increase VBP B-Action
. . O

Victims NNS B-Entity
of IN I-Entity
this DT I-Entity
attack NN I-Entity
will MD O
connect VB B-Action
using VBG B-Modifier
the DT B-Entity
Windows NNP I-Entity
WebDAV NN I-Entity
redirector NN I-Entity
, , O
and CC O
the DT O
HTTP NN O
request NN O
user-agent JJ O
string NN O
will MD O
reflect VB O
this DT O
. . O

For IN O
Windows NNP O
XP NN O
this DT O
will MD O
typically RB O
be VB O
'' '' O
Microsoft-WebDAV-MiniRedir/5.1.2600 NN O
'' '' O
, , O
and CC O
for IN O
Windows NNP O
7 CD O
a DT O
common JJ O
user-agent NN O
is VBZ O
'' '' O
Microsoft-WebDAV-MiniRedir/6.1.7601 NN O
'' '' O
. . O

Security NNP O
researchers NNS O
– NN O
and CC O
there EX O
are VBP O
a DT O
few JJ O
of IN O
them PRP O
- : O
connect VB O
in IN O
a DT O
variety NN O
of IN O
ways NNS O
; : O
first RB O
of IN O
all DT O
, , O
we PRP O
see VBP O
a DT O
number NN O
of IN O
connections NNS O
that WDT O
are VBP O
indistinguishable JJ O
from IN O
the DT O
way NN O
victims NNS O
connect VBP O
. . O

This DT O
happens VBZ O
when WRB O
researchers NNS O
use VBP O
lab NN O
machines NNS O
with IN O
live JJ O
internet NN O
access NN O
to TO O
run VB O
the DT O
malware NN O
. . O

The DT O
only JJ O
way NN O
we PRP O
can MD O
tell VB O
these DT O
are VBP O
researchers NNS O
is VBZ O
because IN O
they PRP O
connect VBP O
from IN O
IP NNP O
address NN O
ranges NNS O
that WDT O
are VBP O
unlikely JJ O
to TO O
be VB O
victims NNS O
; : O
and CC O
they PRP O
also RB O
tend VBP O
to TO O
consist VB O
of IN O
short-lived JJ O
sessions NNS O
. . O

Some DT O
researchers NNS O
set VBD O
up RP O
scheduled JJ O
tasks NNS O
to TO O
scan VB O
the DT O
shares NNS O
for IN O
new JJ O
updates NNS O
and CC O
malware NN O
. . O

We PRP O
see VBP O
a DT O
few JJ O
variations NNS O
of IN O
these DT O
– CD O
one CD O
typical JJ O
configuration NN O
is VBZ O
where WRB O
the DT O
requests NNS O
contain VBP O
a DT O
Python-related JJ O
user-agent JJ O
string NN O
. . O

Attackers NNPS O
, , O
on IN O
the DT O
other JJ O
hand NN O
, , O
do VBP O
n't RB O
appear VB O
to TO O
use VB O
Windows NNP O
. . O

Common NNP O
across IN O
multiple JJ O
accounts NNS O
, , O
multiple JJ O
IP NNP O
's POS O
, , O
and CC O
over IN O
time NN O
, , O
is VBZ O
that IN O
the DT B-Entity
probable JJ I-Entity
attackers NNS I-Entity
have VBP O
used VBN B-Action
a DT B-Entity
HTTP NN I-Entity
user-agent NN I-Entity
of IN I-Entity
'' '' I-Entity
davfs2/1.4.6 FW I-Entity
neon/0.29.6 FW I-Entity
'' '' I-Entity
. . O

We PRP O
know VBP O
these DT O
are VBP O
not RB O
researchers NNS O
, , O
because IN O
we PRP O
can MD O
see VB O
malware NN O
files NNS O
being VBG O
uploaded VBN O
by IN O
them PRP O
: : O
We PRP O
have VBP O
a DT O
log NN O
fragment NN O
in IN O
which WDT O
the DT O
attackers NNS O
uploaded VBD O
a DT O
sequential JJ O
series NN O
of IN O
updates NNS O
( VBP O
from IN O
1746.bin NN O
to TO O
1774.bin FW O
) FW O
within IN O
1.5 CD O
hours NNS O
on IN O
Sept NNP O
17th JJ O
, , O
spread VBN O
over IN O
27 CD O
different JJ O
accounts NNS O
and CC O
using VBG O
27 CD O
different JJ O
IP NNP O
addresses NNS O
in IN O
the DT O
process NN O
. . O

The DT O
user-agent JJ O
string NN O
shows VBZ O
that IN O
attackers NNS O
likely RB O
have VBP O
used VBN O
a DT O
client NN O
based VBN O
on IN O
the DT O
open JJ O
source NN O
davfs2 NN O
file NN O
system NN O
for IN O
Linux NNP O
to TO O
mount VB O
the DT O
WebDAV NNP O
shares NNS O
. . O

This DT O
client NN O
is VBZ O
used VBN O
when WRB O
uploading VBG O
new JJ O
malware NN O
, , O
but CC O
also RB O
when WRB O
the DT O
attackers NNS O
scan VBP O
their PRP$ O
shares NNS O
for IN O
new JJ O
victim NN O
updates NNS O
, , O
in IN O
which WDT O
case NN O
the DT O
shares NNS O
are VBP O
enumerated VBN O
by IN O
requests NNS O
in IN O
a DT O
scheduled JJ O
manner NN O
. . O

The DT O
attackers NNS O
have VBP O
used VBN O
a DT O
large JJ O
number NN O
of IN O
IP NNP O
addresses NNS O
to TO O
access VB O
the DT O
shares NNS O
. . O

As IN O
mentioned VBN O
above RB O
, , O
there EX O
is VBZ O
a DT O
rotation NN O
scheme NN O
in IN O
place NN O
in IN O
which WDT O
a DT O
new JJ O
IP NNP O
address NN O
will MD O
be VB O
used VBN O
after IN O
a DT O
few JJ O
minutes NNS O
of IN O
access NN O
against IN O
CloudMe NN O
accounts NNS O
. . O

These DT O
IP NNP O
's POS O
are VBP O
distributed VBN O
widely RB O
over IN O
geographical JJ O
locations NNS O
and CC O
service NN O
providers NNS O
, , O
with IN O
a DT O
heavy JJ O
bias NN O
towards IN O
South JJ O
Korean JJ O
ranges NNS O
. . O

At IN O
first RB O
we PRP O
thought VBD O
these DT O
IP NNP O
's POS O
belonged VBD O
to TO O
some DT O
commercial JJ O
proxy NN O
service NN O
, , O
particularly RB O
since IN O
several JJ O
such JJ O
proxy NN O
services NNS O
also RB O
offer VBP O
IP NNP O
rotation NN O
. . O

However RB O
, , O
this DT O
turned VBD O
out RP O
to TO O
be VB O
a DT O
wrong JJ O
assumption NN O
. . O

A DT O
superficial JJ O
examination NN O
of IN O
the DT O
proxy JJ O
IP NNP O
addresses NNS O
that WDT O
connected VBD O
to TO O
CloudMe NN O
showed VBD O
them PRP O
to TO O
be VB O
internet-connected JJ O
devices NNS O
of IN O
various JJ O
kinds NNS O
. . O

Many JJ O
were VBD O
Korean NNP O
Tera-EP NNP O
home NN O
routers NNS O
; : O
but CC O
there EX O
were VBD O
several JJ O
other JJ O
products NNS O
represented VBN O
. . O

It PRP O
is VBZ O
believed VBN O
that IN O
the DT B-Entity
attackers NNS I-Entity
were VBD O
able JJ O
to TO O
compromise VB B-Action
these DT B-Entity
devices NNS I-Entity
based VBN B-Modifier
on IN I-Modifier
poor JJ B-Entity
configurations NNS I-Entity
or CC I-Entity
default NN I-Entity
credentials NNS I-Entity
. . O

We PRP O
were VBD O
able JJ O
to TO O
do VB O
some DT O
forensic JJ O
work NN O
on IN O
a DT O
compromised VBN O
Tera-EP NN O
TE-800 NN O
device NN O
and CC O
discovered VBD O
another DT O
dimension NN O
of IN O
the DT O
attacker NN O
's POS O
infrastructure NN O
. . O

Under IN O
the DT O
ramfs NNS O
mounted VBD O
partition NN O
we PRP O
found VBD O
a DT O
stripped VBN O
and CC O
statically RB O
linked VBN O
MIPS-el NN O
binary JJ O
named VBN O
tail- NN O
. . O

Instances NNS O
of IN O
this DT O
were VBD O
also RB O
found VBN O
under IN O
the DT O
running VBG O
process NN O
list NN O
. . O

tail- NN B-Entity
serves VBZ B-Action
as IN B-Modifier
a DT B-Entity
SOCKS NNP I-Entity
proxy NN I-Entity
for IN B-Modifier
the DT B-Entity
attackers NNS I-Entity
. . O

Each DT O
sample NN O
of IN O
the DT O
binary JJ O
we PRP O
were VBD O
able JJ O
to TO O
acquire VB O
was VBD O
configured VBN O
with IN O
a DT O
unique JJ O
32byte FW O
blowfish FW O
key NN O
and CC O
a DT O
small JJ O
, , O
encrypted JJ O
section NN O
appended VBN O
to TO O
the DT O
end NN O
of IN O
the DT O
binary JJ O
. . O

Upon IN O
execution NN O
the DT B-Entity
binary JJ I-Entity
uses VBZ O
its PRP$ O
hardcoded JJ O
key NN O
to TO O
decrypt VB O
the DT O
configuration NN O
section NN O
and CC O
retrieve VB B-Action
the DT B-Entity
listening NN I-Entity
port NN I-Entity
to TO B-Modifier
use VB B-Entity
for IN I-Entity
incoming JJ I-Entity
connections NNS I-Entity
. . O

This DT O
acts VBZ O
as IN O
a DT O
management NN O
interface NN O
. . O

From IN O
here RB O
the DT O
attackers NNS O
can MD O
request VB O
a DT O
specific JJ O
port NN O
to TO O
be VB O
opened VBN O
as IN O
one CD O
of IN O
the DT O
following JJ O
types NNS O
: : O
SOCKET NN O
, , O
SOCKSS NN O
, , O
SOCKAT NN O
, , O
SOCKS5 NN O
, , O
or CC O
STATUSPORT NNP O
. . O

To TO O
prevent VB O
anyone NN O
else RB O
from IN O
accessing VBG O
this DT O
service NN O
all DT O
communication NN O
on IN O
the DT O
management NN O
interface NN O
is VBZ O
encrypted VBN O
using VBG O
the DT O
same JJ O
blowfish JJ O
key NN O
. . O

This DT O
means VBZ O
that IN O
the DT B-Entity
attackers NNS I-Entity
must MD O
maintain VB B-Action
a DT B-Entity
list NN I-Entity
of IN I-Entity
where WRB I-Entity
each DT I-Entity
of IN I-Entity
these DT I-Entity
implants NNS I-Entity
are VBP I-Entity
installed VBN I-Entity
, , I-Entity
as RB I-Entity
well RB I-Entity
as IN I-Entity
what WDT I-Entity
port NN I-Entity
and CC I-Entity
key VB I-Entity
each DT I-Entity
is VBZ I-Entity
configured VBN I-Entity
to TO I-Entity
use VB I-Entity
. . O

This DT O
setup NN O
makes VBZ O
it PRP O
difficult JJ O
to TO O
identify VB O
embedded JJ O
devices NNS O
compromised VBN O
with IN O
this DT O
malware NN O
by IN O
scanning VBG O
open JJ O
ports NNS O
. . O

In IN O
the DT O
wild JJ O
we PRP O
witnessed VBD O
the DT O
attackers NNS O
connect VBP O
to TO O
the DT O
management NN O
port NN O
and CC O
request NN O
SOCKSS NN O
connections NNS O
. . O

This DT O
would MD O
open VB O
the DT O
specified VBN O
port NN O
and CC O
wait VB O
for IN O
configuration NN O
data NNS O
, , O
which WDT O
consists VBZ O
of IN O
a DT O
domain NN O
name NN O
( NNP O
webdav.cloudme.com NNP O
) NNP O
, , O
the DT O
destination NN O
port NN O
, , O
and CC O
a DT O
variable JJ O
length NN O
RC4 NN O
key NN O
, , O
all DT O
of IN O
which WDT O
encrypted VBD O
using VBG O
the DT O
blowfish JJ O
key NN O
. . O

Once RB O
received VBD O
the DT B-Entity
malware NN I-Entity
would MD O
attempt VB O
to TO O
connect VB B-Action
to TO B-Modifier
the DT B-Entity
domain NN I-Entity
name NN I-Entity
on IN B-Modifier
the DT B-Entity
specified VBN I-Entity
port NN I-Entity
and CC O
would MD O
start VB O
tunneling VBG B-Action
all DT B-Entity
traffic NN I-Entity
received VBN I-Entity
from IN I-Entity
the DT I-Entity
SOCKSS NNP I-Entity
port NN I-Entity
to TO B-Modifier
the DT B-Entity
destination NN I-Entity
and CC O
vise-versa NN O
. . O

The DT B-Entity
communication NN I-Entity
between IN I-Entity
the DT I-Entity
attacker NN I-Entity
and CC I-Entity
the DT I-Entity
SOCKSS NNP I-Entity
is VBZ B-Action
encoded VBN I-Action
using VBG B-Modifier
the DT B-Entity
RC4 NN I-Entity
key NN I-Entity
. . O

The DT O
graphic JJ O
below IN O
illustrates VBZ O
a DT O
typical JJ O
session NN O
. . O

The DT O
router NN O
proxy NN O
network NN O
provides VBZ O
another DT O
layer NN O
of IN O
indirection NN O
masking VBG O
the DT O
attackers NNS O
' POS O
infrastructure NN O
. . O

However RB O
, , O
because IN O
we PRP O
captured VBD O
traffic NN O
through IN O
one CD O
of IN O
these DT O
embedded JJ O
devices NNS O
we PRP O
could MD O
identify VB O
other JJ O
parts NNS O
of IN O
their PRP$ O
operation NN O
. . O

We PRP O
identified VBD O
four CD B-Entity
IP NNP I-Entity
addresses NNS I-Entity
that WDT O
connected VBD B-Action
to TO B-Modifier
the DT B-Entity
proxy NN I-Entity
malware NN I-Entity
: : O
This DT B-Entity
host NN I-Entity
belongs VBZ O
to TO O
a DT O
Bulgarian JJ O
VPS NN O
service NN O
and CC O
would MD O
use VB B-Action
the DT B-Entity
router NN I-Entity
proxy NN I-Entity
to TO B-Modifier
connect VB B-Entity
to TO I-Entity
webdav.cloudme.com NNP I-Entity
. . O

This DT B-Entity
host NN I-Entity
does VBZ O
all DT O
scanning NN O
of IN O
webdav JJ O
shares NNS O
for IN O
stolen VBN O
user NN O
data NNS O
, , O
and CC O
also RB O
uploads VBZ B-Action
new JJ B-Entity
malware NN I-Entity
components NNS I-Entity
. . O

This NNP O
IP NNP O
would MD O
make VB O
connections NNS O
hourly JJ O
and CC O
poll VB O
the DT O
status NN O
of IN O
the DT O
router NN O
proxy NN O
malware NN O
. . O

This DT O
machine NN O
is VBZ O
most RBS O
likely RB O
used VBN O
to TO O
track VB O
which WDT O
compromised VBD O
routers NNS O
are VBP O
currently RB O
available JJ O
for IN O
use NN O
. . O

Traffic NN O
from IN O
this DT O
IP NNP O
had VBD O
a DT O
very RB O
specific JJ O
purpose NN O
: : O
It PRP B-Entity
unlocked VBD B-Action
routers NNS B-Entity
for IN B-Modifier
proxying VBG B-Entity
in IN B-Modifier
connection NN I-Modifier
with IN I-Modifier
the DT B-Entity
sending VBG I-Entity
of IN I-Entity
phishing NN I-Entity
emails NNS I-Entity
. . O

In IN O
the DT O
wild JJ O
we PRP O
observed VBD O
this DT B-Entity
IP NNP I-Entity
connect VB B-Action
to TO B-Modifier
our PRP$ B-Entity
router NN I-Entity
on IN B-Modifier
the DT B-Entity
malware NN I-Entity
management NN I-Entity
port NN I-Entity
and CC O
specify VB O
a DT O
SOCKSS NNP O
proxy NN O
port NN O
to TO O
be VB O
opened VBN O
. . O

Immediately RB O
after RB O
, , O
the DT B-Entity
newly RB I-Entity
opened VBN I-Entity
port NN I-Entity
would MD O
be VB B-Action
connected VBN I-Action
to TO B-Modifier
by IN O
another DT B-Entity
IP NNP I-Entity
and CC O
used VBN O
to TO O
send VB B-Action
phishing VBG B-Entity
emails NNS I-Entity
with IN I-Entity
malicious JJ I-Entity
attachments NNS I-Entity
. . O

However RB O
, , O
later RB O
we PRP O
observed VBD O
that IN O
the DT O
Email VB O
sender NN O
IP NNP O
at IN O
VOLIA NNP O
vanished VBD O
and CC O
the DT O
Unlocker NNP O
server NN O
taking VBG O
over RP O
its PRP$ O
role NN O
as RB O
well RB O
. . O

After IN O
a DT O
router NN O
SOCKSS NN O
port NN O
was VBD O
opened VBN O
by IN O
Unlocker NNP O
, , O
this DT B-Entity
IP NNP I-Entity
would MD O
connect VB B-Action
to TO B-Modifier
the DT B-Entity
opened VBN I-Entity
port NN I-Entity
and CC O
tunnel NN B-Action
its PRP$ B-Entity
email NN I-Entity
traffic NN I-Entity
through IN B-Modifier
the DT B-Entity
router NN I-Entity
. . O

Each DT O
of IN O
these DT O
connections NNS O
used VBD O
the DT O
correct JJ O
encryption NN O
key NN O
, , O
so IN O
we PRP O
know VBP O
that IN O
these DT O
accesses NNS O
came VBD O
from IN O
the DT O
attackers NNS O
and CC O
not RB O
some DT O
opportunistic JJ O
third JJ O
party NN O
. . O

Mail NNP O
proxies NNS O
: : O
Through IN O
our PRP$ O
router NN O
monitoring NN O
we PRP O
identified VBD O
two CD B-Entity
mail NN I-Entity
proxies NNS I-Entity
used VBN B-Action
by IN O
the DT B-Entity
attackers NNS I-Entity
. . O

We PRP O
were VBD O
later RB O
notified VBN O
by IN O
Symantec FW O
( FW O
thanks NNS O
, , O
guys NNS O
! . O
) CD O
about IN O
a DT O
third JJ O
. . O

These DT O
servers NNS O
were VBD O
hosted VBN O
on IN O
domains NNS O
that WDT O
were VBD O
registered VBN O
by IN O
the DT O
attackers NNS O
, , O
using VBG O
domain NN O
names NNS O
clearly RB O
meant VBD O
to TO O
look VB O
legitimate JJ O
. . O

This DT O
is VBZ O
the DT O
only JJ O
time NN O
we PRP O
have VBP O
seen VBN O
attackers NNS O
register VBP O
domains NNS O
in IN O
this DT O
investigation NN O
. . O

The DT O
mail NN O
proxies NNS O
were VBD O
: : O
Registrant NNP O
WHOIS NNP O
information NN O
seems VBZ O
forged VBN O
: : O
The DT O
connections NNS O
made VBN O
from IN O
the DT O
Ukrainian JJ O
host NN O
to TO O
the DT O
router NN O
were VBD O
interesting JJ O
. . O

After IN O
being VBG O
proxied VBN O
though IN O
the DT O
router NN O
, , O
each DT B-Entity
of IN I-Entity
these DT I-Entity
would MD O
authenticate VB O
with IN O
one CD O
of IN O
the DT O
dedicated JJ O
mail NN O
proxies NNS O
and CC O
send VB B-Action
out RP B-Modifier
phishing NN B-Entity
attacks NNS I-Entity
. . O

From IN O
captured VBN O
traffic NN O
it PRP O
appears VBZ O
that IN O
the DT O
mail NN O
proxies NNS O
have VBP O
SOCKSv5 NN O
services NNS O
running VBG O
on IN O
obscure JJ O
high JJ O
ports NNS O
. . O

We PRP O
have VBP O
documented VBN O
that IN O
the DT O
attackers NNS O
log VBP O
in RP O
to TO O
these DT O
using VBG O
apparently RB O
randomly RB O
generated VBN O
usernames NNS O
and CC O
passwords NNS O
, , O
a DT O
unique JJ O
pair NN O
for IN O
each DT O
server NN O
. . O

The DT B-Entity
mail NN I-Entity
proxy NN I-Entity
would MD O
then RB O
relay VB B-Action
the DT B-Entity
spearphishing NN I-Entity
mail NN I-Entity
as IN B-Modifier
seen VBN B-Entity
below IN I-Entity
. . O

This DT O
way NN O
the DT B-Entity
attack NN I-Entity
can MD O
be VB B-Action
mistaken VBN I-Action
to TO B-Modifier
come VB B-Entity
from IN I-Entity
legitimate JJ I-Entity
businesses NNS I-Entity
and CC I-Entity
trusted VBN I-Entity
organizations NNS I-Entity
. . O

In IN O
some DT O
cases NNS O
the DT B-Entity
organization NN I-Entity
from IN I-Entity
which WDT I-Entity
the DT I-Entity
phishing NN I-Entity
email NN I-Entity
originates VBZ I-Entity
would MD O
appear VB B-Action
to TO B-Modifier
be VB B-Entity
a DT I-Entity
known JJ I-Entity
associate NN I-Entity
to TO I-Entity
the DT I-Entity
target NN I-Entity
. . O

The DT O
email NN O
shown VBN O
above IN O
was VBD O
one CD O
of IN O
a DT B-Entity
number NN I-Entity
of IN I-Entity
messages NNS I-Entity
sent VBN B-Action
to TO B-Modifier
targets NNS B-Entity
in IN I-Entity
the DT I-Entity
oil NN I-Entity
industry NN I-Entity
. . O

Investigating VBG O
the DT O
target NN O
email NN O
addresses NNS O
, , O
we PRP O
saw VBD O
several JJ O
of IN O
these DT O
were VBD O
found VBN O
in IN O
this DT O
public JJ O
document NN O
from IN O
the DT O
World NNP O
Petroleum NNP O
Council NNP O
, , O
including VBG O
some DT O
addresses NNS O
that WDT O
are VBP O
, , O
at IN O
the DT O
present JJ O
time NN O
, , O
no RB O
longer RB O
valid JJ O
. . O

And CC O
then RB O
, , O
the DT O
ground NN O
shifted VBD O
again RB O
. . O

One CD B-Entity
of IN I-Entity
the DT I-Entity
spearphishing NN I-Entity
mails VBZ I-Entity
we PRP O
observed VBD O
coming VBG B-Action
through IN B-Modifier
the DT B-Entity
router NN I-Entity
network NN I-Entity
was VBD O
this DT O
one CD O
, , O
sent VBN B-Action
to TO B-Modifier
an DT B-Entity
address NN I-Entity
under IN I-Entity
the DT I-Entity
gov.py FW I-Entity
( FW I-Entity
Government NN I-Entity
of IN I-Entity
Paraguay FW I-Entity
) FW I-Entity
domain NN I-Entity
. . O

There EX O
was VBD O
no DT O
executable JJ O
attachment NN O
in IN O
this DT O
mail NN O
, , O
but CC O
instead RB O
a DT O
link NN O
shortened VBN O
by IN O
the DT O
URL NN O
shortener NN O
service NN O
bit.ly NN O
, , O
with IN O
the DT O
underlying VBG O
link NN O
pointing VBG O
to TO O
an DT O
IP NNP O
address NN O
on IN O
a DT O
Dutch JJ O
hosting VBG O
service NN O
. . O

Clicking VBG O
that DT O
link NN O
from IN O
a DT O
Windows NNP O
PC NNP O
only RB O
yielded VBD O
a DT O
redirection NN O
to TO O
the DT O
BBC NNP O
homepages NNS O
, , O
and CC O
using VBG O
other JJ O
devices NNS O
did VBD O
not RB O
give VB O
more JJR O
data NNS O
. . O

The DT O
bit.ly JJ O
service NN O
does VBZ O
however RB O
provide VB O
information NN O
on IN O
the DT O
user NN O
creating VBG O
the DT O
shortened VBN O
link NN O
, , O
and CC O
other JJ O
links NNS O
associated VBN O
with IN O
this DT O
account NN O
. . O

In IN O
this DT O
case NN O
, , O
the DT O
user NN O
was VBD O
named VBN O
nicolatesla53 NN O
. . O

The DT O
nicolatesla53 NN O
account NN O
was VBD O
created VBN O
in IN O
July NNP O
2014 CD O
. . O

From IN O
Oct NN O
24th JJ O
to TO O
Nov NNP O
21st CD O
this DT O
user NN O
created VBD O
nearly RB O
10000 CD O
shortened VBD O
links NN O
– NN O
we PRP O
harvested VBD O
9990 CD O
unique JJ O
ones NNS O
. . O

Three NNP O
IP NNP O
addresses NNS O
were VBD O
used VBN O
for IN O
these DT O
links NNS O
: : O
The DT O
links NNS O
themselves PRP O
were VBD O
on IN O
this DT O
format NN O
: : O
As RB O
far RB O
as IN O
we PRP O
were VBD O
able JJ O
to TO O
tell VB O
, , O
there EX O
were VBD O
three CD O
main JJ O
types NNS O
of IN O
actioncode NN O
: : O
We PRP O
have VBP O
no DT O
sample NN O
of IN O
the DT O
actual JJ O
MMS NNP O
phishing NN O
messages NNS O
apparently RB O
being VBG O
sent VBN O
, , O
but CC O
we PRP O
can MD O
see VB O
the DT O
page NN O
served VBD O
when WRB O
a DT O
user NN O
clicks VBZ O
a DT O
spammed JJ O
link NN O
. . O

This DT O
is VBZ O
just RB O
a DT O
dialogue NN O
box NN O
asking VBG O
for IN O
the DT O
password NN O
presumably RB O
included VBN O
in IN O
the DT O
initial JJ O
message NN O
, , O
and CC O
the DT O
next JJ O
stage NN O
likely RB O
involves VBZ O
download NN O
of IN O
malicious JJ O
content NN O
. . O

We PRP O
were VBD O
in IN O
the DT O
middle NN O
of IN O
harvesting VBG O
the DT O
servers NNS O
for IN O
data NNS O
on IN O
the DT O
various JJ O
action NN O
codes NNS O
when WRB O
they PRP O
all DT O
were VBD O
abruptly RB O
taken VBN O
offline NN O
; : O
so IN O
our PRP$ O
data NNS O
on IN O
which WDT O
mobile JJ O
operators NNS O
are VBP O
targeted VBN O
is VBZ O
not RB O
complete JJ O
. . O

We PRP O
managed VBD O
to TO O
get VB O
66 CD O
of IN O
a DT O
total NN O
of IN O
190 CD O
. . O

The DT O
ones NNS O
we PRP O
know VBP O
of IN O
are VBP O
shown VBN O
below IN O
. . O

A DT O
full JJ O
breakdown NN O
of IN O
mobile JJ O
operators NNS O
and CC O
related JJ O
links NNS O
is VBZ O
included VBN O
in IN O
the DT O
appendix NN O
. . O

The DT O
composition NN O
of IN O
links NNS O
created VBN O
for IN O
the DT O
various JJ O
mobile JJ O
operators NNS O
is VBZ O
quite RB O
interesting JJ O
, , O
as IN O
one PRP O
can MD O
speculate VB O
that IN O
they PRP O
represent VBP O
amount NN O
of IN O
actual JJ O
or CC O
planned JJ O
attacks NNS O
in IN O
different JJ O
countries NNS O
. . O

With IN O
the DT O
top JJ O
three CD O
operators NNS O
being VBG O
Vodafone NNP O
, , O
T- NN O
Mobile NNP O
and CC O
Proximus NNP O
( NNP O
Belgacom NNP O
) NNP O
it PRP O
seems VBZ O
these DT O
apparent JJ O
phishing NN O
attacks NNS O
are VBP O
less RBR O
focused VBN O
on IN O
the DT O
Russian JJ O
sphere NN O
than IN O
the DT O
previously RB O
discussed VBN O
malware NN O
. . O

This DT O
map NN O
is VBZ O
not RB O
complete JJ O
, , O
though RB O
. . O

It PRP O
represents VBZ O
only RB O
about RB O
35 CD O
% NN O
( FW O
66/190 FW O
) NN O
of IN O
all DT O
mobile JJ O
operators NNS O
targeted VBN O
and CC O
66 CD O
% NN O
( CD O
3152/4781 CD O
) NN O
of IN O
all DT O
phishing VBG O
links NNS O
we PRP O
managed VBD O
to TO O
harvest VB O
. . O

In IN O
addition NN O
, , O
some DT O
operators NNS O
like IN O
Vodafone NNP O
are VBP O
global JJ O
actors NNS O
, , O
so IN O
the DT O
map NN O
might MD O
show VB O
an DT O
unfair JJ O
intensity NN O
in IN O
their PRP$ O
HQ NNP O
locations NNS O
. . O

The DT O
rest NN O
of IN O
the DT O
bit.ly NN O
links NNS O
used VBD O
the DT O
action NN O
codes NNS O
743 CD O
or CC O
1024 CD O
. . O

And CC O
now RB O
things NNS O
really RB O
get VBP O
interesting JJ O
. . O

By IN O
using VBG O
mobile JJ O
device NN O
HTTP NNP O
User-Agents NNP O
we PRP O
were VBD O
able JJ O
to TO O
trigger VB O
downloads NNS O
of IN O
malware NN O
components NNS O
from IN O
some DT O
of IN O
these DT O
links NNS O
. . O

Accessing VBG B-Entity
the DT I-Entity
link NN I-Entity
from IN I-Entity
an DT I-Entity
Android NNP I-Entity
User-Agent NNP I-Entity
initiated VBD B-Action
a DT B-Entity
download NN I-Entity
of IN I-Entity
an DT I-Entity
Android JJ I-Entity
installer NN I-Entity
package NN I-Entity
named VBN I-Entity
WhatsAppUpdate.apk NN I-Entity
. . O

The DT O
package NN O
we PRP O
analyzed VBD O
was VBD O
1.2MB NN O
in IN O
size NN O
. . O

The DT O
apparent JJ O
main JJ O
purpose NN O
of IN O
this DT B-Entity
malware NN I-Entity
is VBZ O
to TO O
record VB B-Action
phone NN B-Entity
call NN I-Entity
audio NN I-Entity
. . O

Recordings NNS B-Entity
are VBP B-Action
stored VBN I-Action
as IN B-Modifier
*.mp4 NN B-Entity
files NNS I-Entity
, , O
and CC O
uploaded VBD B-Action
to TO B-Modifier
the DT B-Entity
attackers NNS I-Entity
periodically RB B-Entity
. . O

The DT B-Entity
malware NN I-Entity
is VBZ O
able JJ O
to TO O
collect VB B-Action
a DT B-Entity
lot NN I-Entity
of IN I-Entity
other JJ I-Entity
information NN I-Entity
, , O
not RB O
all DT O
of IN O
which WDT O
is VBZ O
actually RB O
used VBN O
: : O
Through IN B-Modifier
the DT B-Entity
encrypted JJ I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
protocol NN I-Entity
, , O
the DT B-Entity
attackers NNS I-Entity
can MD O
issue VB B-Action
commands NNS B-Entity
and CC I-Entity
binary JJ I-Entity
updates NNS I-Entity
to TO B-Modifier
the DT B-Entity
malware NN I-Entity
. . O

It PRP O
uses VBZ O
a DT O
custom NN O
DAO/Database NN O
scheme NN O
which WDT O
uses VBZ O
accounts NNS O
belonging VBG O
to TO O
the DT O
virtual JJ O
community NN O
Live NNP O
Journal NNP O
( NNP O
livejournal.com NNP O
) NNP O
as IN O
data NNS O
stores NNS O
. . O

Three CD O
such JJ O
accounts NNS O
were VBD O
found VBN O
hardcoded JJ O
in IN O
the DT O
package NN O
: : O
The DT O
accounts NNS O
all DT O
state NN O
that IN O
they PRP O
belong VBP O
to TO O
Iranian JJ O
users NNS O
. . O

This DT O
is VBZ O
very RB O
likely RB O
false JJ O
. . O

The DT O
text NN O
in IN O
these DT O
posts NNS O
starts VBZ O
first JJ O
out IN O
in FW O
cleartext FW O
, , O
but CC O
quickly RB O
turns VBZ O
into IN O
unreadable JJ O
gibberish NN O
. . O

The DT O
HTML NNP O
source NN O
code NN O
reveals VBZ O
that IN O
the DT O
encoded VBN O
portion NN O
is VBZ O
encapsulated VBN O
in IN O
blog-index JJ O
tags NNS O
: : O
The DT O
three CD O
accounts NNS O
contain VBP O
different JJ B-Entity
configuration NN I-Entity
blocks NNS I-Entity
pointing VBG B-Action
to TO B-Modifier
C NN B-Entity
& CC I-Entity
C NN I-Entity
servers NNS I-Entity
apparently RB I-Entity
located JJ I-Entity
in IN I-Entity
Poland NNP I-Entity
, , I-Entity
Germany NNP I-Entity
and CC I-Entity
Russia NNP I-Entity
, , I-Entity
respectively RB I-Entity
. . O

Based VBN O
on IN O
registration NN O
data NNS O
and CC O
folder NN O
configuration NN O
we PRP O
believe VBP O
these DT O
are VBP O
legitimate JJ O
but CC O
compromised VBD O
Joomla NNP O
servers NNS O
. . O

And CC O
then RB O
an DT O
unexpected JJ O
oddity NN O
shows VBZ O
up RP O
in IN O
the DT O
Java NNP O
source NN O
: : O
We PRP O
were VBD O
also RB O
able JJ O
to TO O
download VB O
a DT O
similar JJ O
malware NN O
sample NN O
( FW O
BrowserUpdate.apk FW O
) FW O
from IN O
one CD O
of IN O
the DT O
C NN O
& CC O
C NN O
servers NNS O
. . O

This DT O
sample NN O
used VBD O
different JJ O
online JJ O
accounts NNS O
for IN O
its PRP$ O
DAO/database NN O
functionality NN O
, , O
but CC O
is VBZ O
otherwise RB O
quite RB O
similar JJ O
to TO O
the DT O
first JJ O
. . O

Using VBG B-Entity
an DT I-Entity
IOS NNP I-Entity
User-Agent NNP I-Entity
triggered VBD B-Action
the DT B-Entity
download NN I-Entity
of IN I-Entity
a DT I-Entity
Debian JJ I-Entity
installer NN I-Entity
package NN I-Entity
, , I-Entity
WhatsAppUpdate.deb NN I-Entity
, , O
also RB O
1.2Mb NN O
in IN O
size NN O
. . O

This DT B-Entity
application NN I-Entity
impersonates VBZ B-Action
a DT B-Entity
Cydia NNP I-Entity
installer NN I-Entity
, , O
and CC O
can MD O
only RB O
be VB O
installed VBN O
on IN O
a DT O
jailbroken NN O
phone NN O
. . O

Once RB O
installed VBN O
, , O
it PRP B-Entity
may MD O
collect VB B-Action
These DT B-Entity
data NNS I-Entity
are VBP B-Action
encrypted VBN I-Action
and CC O
uploaded VBN B-Action
to TO B-Modifier
an DT B-Entity
FTP NN I-Entity
account NN I-Entity
which WDT O
is VBZ O
taken VBN O
from IN O
an DT O
encrypted JJ O
configuration NN O
file NN O
named VBN O
/usr/bin/cores NNS O
. . O

In IN O
this DT O
particular JJ O
case NN O
, , O
the DT O
FTP NN O
account NN O
is VBZ O
located JJ O
on IN O
a DT O
legitimate JJ O
( NN O
if IN O
struggling VBG O
) NN O
hosting VBG O
service NN O
in IN O
the DT O
UK NNP O
. . O

In IN O
this DT O
case NN O
, , O
there EX O
's VBZ O
another DT O
clue NN O
: : O
The DT O
WhatsAppUpdate NNP O
project NN O
seems VBZ O
derived VBN O
from IN O
an DT O
earlier JJR O
template NN O
named VBN O
SkypeUpdate NNP O
. . O

By IN O
now RB O
, , O
it PRP O
came VBD O
as IN O
no DT O
surprise NN O
when WRB O
we PRP O
triggered VBD O
a DT O
download NN O
with IN O
a DT O
BlackBerry NNP O
User-Agent NNP O
. . O

The DT O
initial JJ O
download NN O
was VBD O
a DT O
Java NNP O
Applications NNS O
Descriptor NNP O
, , O
a DT O
text NN O
file NN O
designed VBN O
for IN O
Over-The-Air NNP O
installation NN O
of IN O
Java-based JJ O
applications NNS O
. . O

This DT O
JAD NNP O
file NN O
contained VBD O
the DT O
locations NNS O
of IN O
the DT O
two CD O
Blackberry NNP O
*.COD NNP O
binaries NNS O
which WDT O
we PRP O
then RB O
could MD O
download VB O
directly RB O
. . O

The DT B-Entity
application NN I-Entity
impersonates VBZ B-Action
a DT B-Entity
settings NNS I-Entity
utility NN I-Entity
. . O

This DT B-Entity
collects VBZ B-Action
: : O
Collected VBN B-Entity
data NNS I-Entity
will MD O
be VB B-Action
uploaded VBN I-Action
to TO B-Modifier
a DT B-Entity
DynDNS NN I-Entity
domain NN I-Entity
currently RB I-Entity
hosted VBN I-Entity
on IN I-Entity
a DT I-Entity
US NNP I-Entity
webhosting NN I-Entity
service NN I-Entity
. . O

Since IN O
these DT O
COD NNP O
files NNS O
are VBP O
also RB O
compiled VBN O
Java NNP O
code NN O
, , O
they PRP O
are VBP O
possible JJ O
to TO O
decompile VB O
to TO O
original JJ O
source NN O
code NN O
. . O

In IN O
a DT O
similar JJ O
fashion NN O
to TO O
the DT O
Android NNP O
version NN O
, , O
we PRP O
find VBP O
interesting JJ O
strings NNS O
there RB O
. . O

This DT O
time NN O
they PRP O
are VBP O
in IN O
Arabic NNP O
: : O
The DT O
earliest JJS O
sample NN O
of IN O
Inception-related JJ O
malware NN O
we PRP O
have VBP O
been VBN O
able JJ O
to TO O
obtain VB O
, , O
was VBD O
submitted VBN O
to TO O
us PRP O
in IN O
June NNP O
2014 CD O
. . O

However RB O
, , O
decoy NN O
document NN O
metadata NN O
shows VBZ O
that IN O
it PRP O
was VBD O
created VBN O
late JJ O
May NNP O
. . O

The DT O
related JJ O
cloud NN O
account NN O
was VBD O
created VBN O
just RB O
before IN O
that DT O
. . O

An DT O
examination NN O
of IN O
the DT O
other JJ O
documents NNS O
associated VBN O
with IN O
the DT O
attacks NNS O
show VBP O
that IN O
they PRP O
have VBP O
been VBN O
created VBN O
at IN O
a DT O
steady JJ O
pace NN O
all DT O
through IN O
summer NN O
and CC O
autumn NN O
2014 CD O
and CC O
attacks NNS O
are VBP O
still RB O
ongoing JJ O
. . O

Of IN O
interest NN O
is VBZ O
also RB O
the DT O
attackers NNS O
' POS O
activity NN O
patterns NNS O
over IN O
the DT O
24h JJ O
cycle NN O
. . O

The DT O
main JJ O
upload NN O
of IN O
new JJ O
components NNS O
to TO O
shares NNS O
seems VBZ O
to TO O
be VB O
divided VBN O
over IN O
two CD O
high–activity NN O
periods NNS O
: : O
6:00 CD O
-10:00 CD O
UTC NNP O
and CC O
17:00 CD O
- : O
21:00 CD O
UTC NNP O
. . O

No DT O
uploads NNS O
were VBD O
seen VBN O
between IN O
23:00 CD O
and CC O
05:00 CD O
UTC NNP O
. . O

It PRP O
is VBZ O
however RB O
doubtful JJ O
how WRB O
indicative JJ O
these DT O
timeframes NNS O
are VBP O
. . O

To TO O
illustrate VB O
, , O
we PRP O
looked VBD O
into IN O
another DT O
and CC O
more RBR O
obscure JJ O
timing NN O
factor NN O
: : O
The DT O
timing NN O
of IN O
the DT O
AES NN O
InitVector NN O
random JJ O
seeds NNS O
. . O

A DT O
random JJ O
seed NN O
is VBZ O
the DT O
initial JJ O
value NN O
passed VBD O
into IN O
a DT O
pseudo-randomizer JJ O
function NN O
. . O

The DT O
malware NN O
uses VBZ O
the DT O
random JJ O
output NN O
to TO O
create VB O
what WP O
is VBZ O
known VBN O
as IN O
an DT O
InitVector NNP O
- : O
a DT O
starting VBG O
point NN O
for IN O
the DT O
AES NN O
encryption/decryption NN O
function NN O
. . O

The DT O
code NN O
used VBN O
in IN O
some DT O
of IN O
the DT O
DLLs NNS O
indicate VBP O
that IN O
the DT O
attackers NNS O
tend VBP O
to TO O
use VB O
the DT O
C NN O
time NN O
( FW O
) FW O
function NN O
to TO O
generate VB O
random JJ O
seeds NNS O
. . O

This DT O
function NN O
returns VBZ O
values NNS O
of IN O
granularity NN O
down IN O
to TO O
seconds NNS O
. . O

Thus RB O
random JJ O
seeds NNS O
, , O
and CC O
ultimately RB O
the DT O
InitVectors NNP O
, , O
are VBP O
functions NNS O
of IN O
these DT O
quite RB O
coarse JJ O
units NNS O
of IN O
time NN O
. . O

The DT B-Entity
encrypted JJ I-Entity
files NNS I-Entity
uploaded VBD B-Action
to TO B-Modifier
the DT B-Entity
WebDAV JJ I-Entity
shares NNS I-Entity
come VBP O
with IN O
their PRP$ O
InitVectors NNS O
stored VBN O
at IN O
the DT O
end NN O
of IN O
the DT O
file NN O
. . O

Since IN O
we PRP O
know VBP O
the DT O
time NN O
window NN O
to TO O
be VB O
within IN O
a DT O
few JJ O
days NNS O
of IN O
the DT O
upload NN O
time NN O
we PRP O
were VBD O
able JJ O
to TO O
brute JJ O
force NN O
the DT O
time NN O
values NNS O
that WDT O
would MD O
generate VB O
the DT O
corresponding JJ O
InitVectors NNP O
. . O

Thus RB O
, , O
we PRP O
were VBD O
able JJ O
to TO O
say VB O
to TO O
the DT O
second JJ O
when WRB O
the DT O
file NN O
was VBD O
created VBN O
– NN O
and CC O
most JJS O
times NNS O
were VBD O
identified VBN O
to TO O
be VB O
in IN O
the DT O
range NN O
1500 CD O
- : O
2200 CD O
GMT NNP O
. . O

Unfortunately RB O
, , O
we PRP O
had VBD O
to TO O
reject VB O
these DT O
data NNS O
. . O

The DT O
file NN O
creation NN O
times NNS O
turned VBD O
out RP O
to TO O
be VB O
hours NNS O
after IN O
the DT B-Entity
files NNS I-Entity
themselves PRP I-Entity
were VBD B-Action
uploaded VBN I-Action
to TO B-Modifier
the DT B-Entity
WebDAV NN I-Entity
share NN I-Entity
. . O

Either NNP O
the DT O
attackers NNS O
' POS O
system NN O
clock NN O
is VBZ O
wrong JJ O
or CC O
a DT O
fixed VBN O
offset VBN O
is VBZ O
added VBN O
to TO O
the DT O
random JJ O
seed NN O
. . O

Either NNP O
way NN O
, , O
the DT O
data NNS O
ca MD O
n't RB O
be VB O
trusted VBN O
; : O
and CC O
shows VBZ O
that IN O
nothing NN O
can MD O
be VB O
taken VBN O
at IN O
face NN O
value NN O
. . O

On IN O
at IN O
least JJS O
two CD O
occasions NNS O
during IN O
our PRP$ O
surveillance NN O
of IN O
the DT O
Inception NNP O
framework NN O
, , O
the DT B-Entity
malware NN I-Entity
downloaded VBD B-Action
something NN B-Entity
unexpected JJ I-Entity
and CC I-Entity
wholly RB I-Entity
different JJ I-Entity
from IN I-Entity
what WP I-Entity
we PRP I-Entity
have VBP I-Entity
discussed VBN I-Entity
until IN I-Entity
now RB I-Entity
. . O

These DT B-Entity
files NNS I-Entity
were VBD B-Action
downloaded VBN I-Action
as IN B-Modifier
encrypted JJ B-Entity
*.bin NN I-Entity
files NNS I-Entity
from IN B-Modifier
the DT B-Entity
accounts NNS I-Entity
carter0648 NN I-Entity
and CC I-Entity
frogs6352 NN I-Entity
. . O

When WRB O
decrypted VBN O
, , O
these DT O
turned VBD O
out RP O
to TO O
be VB O
dropper NN B-Entity
packages NNS I-Entity
containing VBG B-Action
one CD B-Entity
dropper NN I-Entity
executable JJ I-Entity
clearly RB I-Entity
created VBN I-Entity
for IN I-Entity
the DT I-Entity
Inception NNP I-Entity
framework NN I-Entity
, , I-Entity
and CC I-Entity
one CD I-Entity
other JJ I-Entity
, , I-Entity
very RB I-Entity
different JJ I-Entity
executable JJ I-Entity
. . O

This DT O
executable JJ O
, , O
( NNP O
sccm.exe NNP O
, , O
md5 NNP O
dd8790455109497d49c2fa2442cf16f7 NNP O
) NNP O
is VBZ O
a DT O
classical JJ O
Chinese JJ O
APT NN O
implant VB O
. . O

It PRP B-Entity
is VBZ B-Action
a DT B-Entity
downloader NN I-Entity
and CC O
remote JJ B-Entity
shell NN I-Entity
program NN I-Entity
, , O
designed VBN O
to TO O
connect VB B-Action
to TO B-Modifier
a DT B-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
server NN I-Entity
to TO B-Modifier
interact VB B-Entity
with IN I-Entity
the DT I-Entity
attacker NN I-Entity
and/or CC O
download VB B-Action
more JJR B-Entity
malware NN I-Entity
. . O

The DT B-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
server NN I-Entity
in IN O
this DT O
case NN O
is VBZ B-Action
ict32.msname.org NNP B-Entity
. . O

When WRB O
connecting VBG B-Action
to TO B-Modifier
this DT B-Entity
server NN I-Entity
, , O
sccm.exe NN B-Entity
issues NNS O
the DT O
following JJ O
request NN O
: : O
This DT B-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
domain NN I-Entity
is VBZ B-Action
used VBN I-Action
by IN O
many JJ B-Entity
other JJ I-Entity
malwares NNS I-Entity
related VBN I-Entity
to TO I-Entity
sccm.exe NN I-Entity
; : O
some DT O
of IN O
which WDT O
share VBP O
obvious JJ O
connections NNS O
to TO O
the DT O
Quarian JJ O
malware NN O
family NN O
, , O
a DT O
known JJ O
APT NNP O
intrusion NN O
tool NN O
. . O

This DT O
development NN O
was VBD O
unexpected JJ O
for IN O
several JJ O
reasons NNS O
. . O

First NNP O
of IN O
all DT O
, , O
it PRP O
apparently RB O
breaks VBZ O
the DT O
strict JJ O
, , O
obfuscatory JJ O
operational JJ O
security NN O
built VBN O
into IN O
the DT O
Inception NNP O
framework NN O
. . O

Inception NNP B-Entity
has VBZ O
the DT O
capacity NN O
to TO O
perform VB O
all DT O
steps NNS O
needed VBN O
for IN O
scouting VBG B-Action
out RP B-Modifier
and CC O
exfiltrating VBG B-Action
data NNS B-Entity
without IN O
resorting VBG O
to TO O
traditional JJ O
hosted VBN O
command NN O
& CC O
control NN O
. . O

By IN O
using VBG B-Action
a DT O
well-understood JJ O
APT NN O
tool NN O
and CC O
a DT B-Entity
known JJ I-Entity
malicious JJ I-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
domain NN I-Entity
name NN I-Entity
, , O
the DT B-Entity
attackers NNS I-Entity
permit VBP O
much RB O
clearer JJR O
attribution NN O
. . O

Another DT O
factor NN O
which WDT O
is VBZ O
out IN O
of IN O
character NN O
is VBZ O
the DT O
coding VBG O
style NN O
. . O

All DT O
Inception-related JJ O
malware NN O
is VBZ O
written VBN O
using VBG O
Visual JJ O
Studio NN O
2010 CD O
. . O

The DT O
downloaded VBN O
sccm.exe NN O
is VBZ O
written VBN O
using VBG O
Visual NNP O
C++ NNP O
6 CD O
; : O
and CC O
has VBZ O
a DT O
PE NN O
header NN O
compile VBP O
date NN O
of IN O
October NNP O
2010 CD O
. . O

This DT O
date NN O
can MD O
be VB O
forged VBN O
, , O
and CC O
indeed RB O
, , O
all DT O
Inception-related JJ O
malware NN O
has VBZ O
some DT O
level NN O
of IN O
forgery NN O
in IN O
the DT O
compile VBP O
dates NNS O
. . O

However RB O
, , O
the DT O
sccm.exe NN O
compile VBP O
date NN O
matches VBZ O
the DT O
Quarian JJ O
developer NN O
toolset NN O
and CC O
coding VBG O
style NN O
to TO O
a DT O
better JJR O
degree NN O
than IN O
the DT O
other JJ O
files NNS O
distributed VBN O
through IN O
Inception NNP O
. . O

Then RB O
there EX O
is VBZ O
the DT B-Entity
C NN I-Entity
& CC I-Entity
C NN I-Entity
domain NN I-Entity
used VBN B-Action
. . O

According VBG O
to TO O
DomainTools.com VB O
the DT O
msname.org NN O
domain NN O
registration NN O
timed VBD O
out RP O
September NNP O
27th JJ O
2014 CD O
. . O

It PRP O
was VBD O
left VBN O
inactive JJ O
and CC O
was VBD O
not RB O
renewed VBN O
until IN O
Nov NNP O
12th JJ O
. . O

This DT O
means VBZ O
that IN O
the DT O
attackers NNS O
distributed VBD O
malware NN O
that WDT O
would MD O
be VB O
out IN O
of IN O
action NN O
for IN O
a DT O
long JJ O
time NN O
( CD O
last JJ O
distribution NN O
of IN O
sccm.exe NN O
was VBD O
September NNP O
26th JJ O
) NN O
. . O

Because IN O
of IN O
all PDT O
this DT O
we PRP O
consider VBP O
sccm.exe NN O
as IN O
an DT O
unreliable JJ O
indicator NN O
. . O

It PRP O
is VBZ O
likely JJ O
to TO O
be VB O
a DT O
red JJ O
herring NN O
purposefully RB O
placed VBN O
on IN O
shares NNS O
where WRB O
the DT O
attackers NNS O
have VBP O
seen VBN O
signs NNS O
of IN O
access NN O
by IN O
security NN O
researchers NNS O
. . O

At IN O
one CD O
instance NN O
the DT O
attackers NNS O
seem VBP O
to TO O
have VB O
slipped VBN O
up RP O
. . O

Instead RB O
of IN O
using VBG O
their PRP$ O
scheduled VBN O
task NN O
, , O
they PRP O
apparently RB O
did VBD O
something NN O
manually RB O
on IN O
a DT O
WebDAV NN O
share NN O
. . O

This DT O
is VBZ O
visible JJ O
because IN O
the DT O
request NN O
came VBD O
from IN O
an DT O
apparent JJ O
attacker NN O
IP NNP O
, , O
but CC O
used VBD O
yet RB O
another DT O
User-Agent NNP O
: : O
'' '' O
gvfs/1.12.3 NN O
'' '' O
. . O

Gvfs NNP O
is VBZ O
the DT O
virtual JJ O
filesystem NN O
for IN O
Gnome NNP O
desktop NN O
. . O

The DT O
action NN O
on IN O
the DT O
account NN O
was VBD O
abnormal JJ O
as IN O
well RB O
; : O
an DT O
apparent JJ O
file NN O
upload NN O
: : O
When WRB O
WebDAV NN O
shares NNS O
are VBP O
mapped VBN O
up RP O
as IN O
drives NNS O
by IN O
the DT O
operating NN O
system NN O
, , O
any DT O
action NN O
taken VBN O
by IN O
the DT O
attacker NN O
follows VBZ O
the DT O
same JJ O
pattern NN O
as IN O
on IN O
the DT O
attacker NN O
's POS O
local JJ O
drive NN O
. . O

In IN O
the DT O
case NN O
above IN O
, , O
it PRP O
seems VBZ O
the DT O
attacker NN O
attempted VBD O
to TO O
edit VB O
a DT O
new JJ O
document NN O
, , O
which WDT O
by IN O
default NN O
is VBZ O
given VBN O
the DT O
name NN O
'' '' O
Untitled JJ O
document NN O
'' '' O
in IN O
Gnome NNP O
. . O

This DT O
might NN O
indicate VBP O
that IN O
the DT O
attacker NN O
's POS O
operating NN O
system NN O
language NN O
is VBZ O
Spanish NNP O
. . O

Of IN O
course NN O
, , O
Spanish NNP O
is VBZ O
one CD O
of IN O
the DT O
world NN O
's POS O
most JJS O
widespread JJ O
languages NNS O
, , O
so IN O
one PRP O
can MD O
not RB O
infer VB O
much RB O
from IN O
this DT O
. . O

There EX O
is VBZ O
even RB O
a DT O
small JJ O
possibility NN O
that IN O
the DT O
phenomenon NN O
is VBZ O
a DT O
pure JJ O
artifact NN O
; : O
for IN O
example NN O
that IN O
a DT O
Spanish-speaking JJ O
researcher NN O
connected VBN O
to TO O
the DT O
same JJ O
account NN O
using VBG O
the DT O
same JJ O
Linux-based JJ O
setup NN O
as IN O
the DT O
attackers NNS O
. . O

This DT O
attack NN O
system NN O
shares VBZ O
a DT O
number NN O
of IN O
properties NNS O
that WDT O
are VBP O
somewhat RB O
similar JJ O
with IN O
the DT O
Red NNP O
October NNP O
campaigns NNS O
detailed VBN O
by IN O
Kaspersky NNP O
Labs NNPS O
in IN O
2013 CD O
. . O

For IN O
more JJR O
information NN O
about IN O
this DT O
see VBP O
: : O
The DT O
'' '' O
Red NNP O
October NNP O
'' '' O
Campaign NNP O
- : O
An NNP O
Advanced NNP O
Cyber NNP O
Espionage NN O
Network NNP O
Targeting NN O
Diplomatic NNP O
and CC O
Government NNP O
Agencies NNPS O
However RB O
, , O
there EX O
are VBP O
also RB O
clear JJ O
differences NNS O
. . O

The DT O
code NN O
is VBZ O
fully RB O
rewritten VBN O
; : O
there EX O
appears VBZ O
to TO O
be VB O
little JJ O
code NN O
overlap VB O
, , O
at IN O
least JJS O
in IN O
the DT O
initial JJ O
stage NN O
malware NN O
. . O

The DT O
coding VBG O
style NN O
is VBZ O
different JJ O
, , O
with IN O
different JJ O
solutions NNS O
to TO O
programmatic JJ O
problems NNS O
, , O
different JJ O
use NN O
of IN O
exception NN O
handling NN O
, , O
and CC O
different JJ O
use NN O
of IN O
C++ NNP O
classes NNS O
. . O

It PRP O
's VBZ O
hard JJ O
to TO O
believe VB O
that IN O
the DT O
same JJ O
programmers NNS O
are VBP O
responsible JJ O
for IN O
the DT O
two CD O
code NN O
bases NNS O
. . O

The DT O
Red NNP O
October NNP O
malware NN O
contained VBD O
linguistic JJ O
markers NNS O
that WDT O
pointed VBD O
towards IN O
Russian JJ O
speaking NN O
attackers NNS O
. . O

No DT O
such JJ O
clues NNS O
have VBP O
been VBN O
found VBN O
in IN O
the DT O
Inception- NN O
related JJ O
malware NN O
; : O
there EX O
is VBZ O
a DT O
marked JJ O
difference NN O
in IN O
the DT O
attention NN O
to TO O
detail NN O
and CC O
information NN O
leakage NN O
. . O

It PRP O
is VBZ O
certainly RB O
possible JJ O
that IN O
the DT O
same JJ O
people NNS O
have VBP O
organized VBN O
both DT O
Inception NNP O
and CC O
Red NNP O
October NNP O
, , O
but CC O
there EX O
are VBP O
no DT O
clear JJ O
indications NNS O
to TO O
this DT O
effect NN O
. . O

The DT O
Windows-based JJ O
malware NN O
in IN O
this DT O
paper NN O
generally RB O
contains VBZ O
very RB O
few JJ O
noticeable JJ O
strings NNS O
apart RB O
from IN O
what WP O
is VBZ O
commonly RB O
found VBN O
in IN O
software NN O
, , O
and CC O
clearly RB O
randomized VBN O
strings NNS O
. . O

What WP O
exists VBZ O
– NNP O
like IN O
the DT O
word NN O
'' '' O
polymorphed VBD O
'' '' O
in IN O
the DT O
early JJ O
DLL NNP O
versions NNS O
- : O
is VBZ O
standard JJ O
English NNP O
with IN O
few JJ O
discerning JJ O
features NNS O
. . O

This DT O
changes VBZ O
a DT O
bit NN O
when WRB O
we PRP O
look VBP O
at IN O
the DT O
mobile JJ O
malware NN O
. . O

In IN O
the DT O
Android NNP O
malware NN O
we PRP O
find VBP O
Hindi JJ O
comments NNS O
in IN O
the DT O
Java NNP O
source NN O
code NN O
. . O

In IN O
the DT O
Iphone NNP O
malware NN O
we PRP O
find VBP O
project NN O
paths NNS O
referencing VBG O
one CD O
'' '' O
JohnClerk NNP O
'' '' O
, , O
and CC O
a DT O
few JJ O
typos NNS O
like IN O
'' '' O
conutry NN O
'' '' O
. . O

In IN O
one CD O
of IN O
the DT O
Blackberry NNP O
binaries NNS O
we PRP O
find VBP O
the DT O
string NN O
'' '' O
GodSaveTheQueen NN O
'' '' O
, , O
a DT O
rather RB O
blunt JJ O
hint NN O
towards IN O
Britain NNP O
, , O
as RB O
well RB O
as IN O
Arabic JJ O
log NN O
strings NNS O
. . O

These DT O
and CC O
other JJ O
indicators NNS O
have VBP O
led VBN O
us PRP O
to TO O
conclude VB O
that IN O
the DT O
Inception NNP O
attackers NNS O
are VBP O
setting VBG O
a DT O
new JJ O
standard NN O
for IN O
deliberate JJ O
disinformation NN O
and CC O
red JJ O
herrings NNS O
in IN O
a DT O
malware NN O
espionage NN O
operation NN O
. . O

Some DT O
clues NNS O
might MD O
have VB O
been VBN O
added VBN O
by IN O
accident NN O
, , O
but CC O
none NN O
of IN O
these DT O
indicators NNS O
can MD O
be VB O
trusted VBN O
in IN O
any DT O
way NN O
. . O

Thus RB O
we PRP O
are VBP O
not RB O
going VBG O
to TO O
assume VB O
anything NN O
about IN O
who WP O
might MD O
be VB O
behind IN O
these DT O
attacks NNS O
. . O

The DT O
whole JJ O
Inception NN O
setup NN O
shows VBZ O
signs NNS O
of IN O
automation NN O
and CC O
seasoned JJ O
programming NN O
. . O

The DT O
amount NN O
of IN O
layers NNS O
used VBN O
in IN O
this DT O
scheme NN O
to TO O
protect VB O
the DT O
payload NN O
of IN O
their PRP$ O
attack NN O
seems VBZ O
excessively RB O
paranoid JJ O
. . O

Not RB O
only RB O
is VBZ O
the DT B-Entity
initial JJ I-Entity
DLL NNP I-Entity
apparently RB O
polymorphed VBD B-Action
using VBG B-Modifier
some DT B-Entity
backend JJ I-Entity
tool NN I-Entity
– CD O
the DT O
compile VBP O
time NN O
stamps NNS O
in IN O
the DT O
PE NN O
header NN O
are VBP O
clearly RB O
forged VBN O
, , O
resources NNS O
are VBP O
removed VBN O
so RB O
as RB O
not RB O
to TO O
give VB O
away RP O
any DT O
location NN O
information NN O
, , O
and CC O
import NN O
tables NNS O
are VBP O
shuffled VBN O
around IN O
, , O
rendering VBG O
import NN O
hashes VBZ O
( FW O
aka FW O
imphashes NNS O
) VBP O
useless JJ O
. . O

The DT O
names NNS O
of IN O
the DT O
files NNS O
both CC O
when WRB O
dropped VBN O
and CC O
their PRP$ O
original JJ O
names NNS O
along IN O
with IN O
the DT O
callback NN O
directories NNS O
, , O
paths NNS O
and CC O
mutexes NNS O
used VBD O
all DT O
seem VBP O
to TO O
be VB O
dynamically RB O
generated VBN O
. . O

The DT B-Entity
attackers NNS I-Entity
utilize VBP B-Action
compromised VBN B-Entity
embedded JJ I-Entity
devices NNS I-Entity
– VBP I-Entity
typically RB I-Entity
routers- JJ I-Entity
on IN I-Entity
the DT I-Entity
Internet NN I-Entity
as RB I-Entity
well RB I-Entity
as IN I-Entity
multiple JJ I-Entity
dedicated JJ I-Entity
hosting VBG I-Entity
providers NNS I-Entity
and CC I-Entity
VPN NNP I-Entity
services NNS I-Entity
to TO B-Modifier
mask NN B-Entity
their PRP$ I-Entity
identity NN I-Entity
from IN I-Entity
the DT I-Entity
cloud NN I-Entity
storage NN I-Entity
provider NN I-Entity
and CC I-Entity
others NNS I-Entity
. . O

The DT B-Entity
same JJ I-Entity
router NN I-Entity
botnet NN I-Entity
is VBZ B-Action
used VBN I-Action
as IN B-Modifier
a DT B-Entity
spreading NN I-Entity
and CC I-Entity
management NN I-Entity
platform NN I-Entity
for IN I-Entity
attacks NNS I-Entity
on IN I-Entity
mobile JJ I-Entity
devices NNS I-Entity
as RB O
well RB O
. . O

This DT O
suggests VBZ O
that IN O
this DT O
a DT O
large JJ O
campaign NN O
and CC O
we PRP O
've VBP O
only RB O
seeing VBG O
the DT O
beginning NN O
of IN O
it PRP O
. . O

Initially RB O
many JJ O
of IN O
the DT O
targets NNS O
were VBD O
located JJ O
in IN O
Russia NNP O
or CC O
related JJ O
to TO O
Russian JJ O
interests NNS O
, , O
but CC O
as IN O
the DT O
campaign NN O
has VBZ O
evolved VBN O
we PRP O
have VBP O
verified VBN O
targets NNS O
in IN O
countries NNS O
all DT O
over IN O
the DT O
world NN O
. . O

It PRP O
is VBZ O
clear JJ O
that IN O
this DT O
infrastructure NN O
model NN O
does VBZ O
not RB O
need VB O
to TO O
be VB O
applied VBN O
solely RB O
against IN O
a DT O
few JJ O
targets NNS O
, , O
or CC O
even RB O
need VB O
to TO O
be VB O
hosted VBN O
at IN O
CloudMe NN O
. . O

The DT O
framework NN O
is VBZ O
generic JJ O
, , O
and CC O
will MD O
work VB O
as IN O
an DT O
attack NN O
platform NN O
for IN O
a DT O
multitude NN O
of IN O
purposes NNS O
with IN O
very RB O
little JJ O
modification NN O
. . O

The DT O
attribution NN O
indicators NNS O
point NN O
in IN O
different JJ O
directions NNS O
and CC O
ca MD O
n't RB O
be VB O
given VBN O
much JJ O
weight NN O
. . O

These DT O
attacks NNS O
can MD O
in IN O
theory NN O
be VB O
the DT O
creation NN O
of IN O
nation NN O
states NNS O
or CC O
resourceful JJ O
private JJ O
entities NNS O
- : O
we PRP O
consider VBP O
it PRP O
very RB O
unlikely JJ O
that IN O
they PRP O
are VBP O
performed VBN O
by IN O
one CD O
or CC O
just RB O
a DT O
few JJ O
individuals NNS O
. . O

haarmannsi.cz FW O
sanygroup.co.uk FW O
ecolines.es FW O
blackberry-support.herokuapp.com FW O
( FW O
DynDNS FW O
) FW O
The DT O
following JJ O
entities NNS O
have VBP O
helped VBN O
in IN O
big JJ O
and CC O
small JJ O
ways NNS O
. . O

Big JJ O
thanks NNS O
to TO O
all DT O
. . O

We PRP O
also RB O
owe VBP O
a DT O
big JJ O
debt NN O
of IN O
gratitude NN O
to TO O
Ryan NNP O
W. NNP O
Smith NNP O
of IN O
Blue NNP O
Coat NNP O
who WP O
helped VBD O
us PRP O
tremendously RB O
with IN O
the DT O
analysis NN O
of IN O
the DT O
mobile JJ O
malware NN O
. . O

