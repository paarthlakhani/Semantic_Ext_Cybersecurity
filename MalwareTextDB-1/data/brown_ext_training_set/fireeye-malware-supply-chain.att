Many seemingly unrelated cyber attacks may , in fact , be part of a broader offensive fueled by a shared development and logistics infrastructure-a finding that suggests some targets are facing a more organized menace than they realize . 
This report examines 11 advanced persistent threat ( APT ) campaigns targeting a wide swath of industries . 
Though they appeared unrelated at first , further investigation uncovered several key links between them : the same malware tools , the same elements of code , binaries with the same timestamps , and signed binaries with the same digital certificates . 
Taken together , these commonalities point to centralized APT planning and development . 
How prevalent this model has become is unclear . 
But adopting it makes financial sense for attackers , so the findings may imply a bigger trend . 
This report focuses on two key findings : • Shared development and logistics • A shared malware-builder tool Examining the 11 APT campaigns revealed a shared development and logistics operation used to support several APT actors in distinct but overlapping campaigns . 
This development and logistics operation is best described as a `` digital quartermaster . 
'' Its mission : supply and maintain malware tools and weapons to support cyber espionage . 
This digital quartermaster also might be a cyber arms dealer of sorts , a common supplier of tools used to conduct attacks and establish footholds in targeted systems . 
SFireEye researchers located a builder tool likely used in some of the 11 APT campaigns . 
The tools appear to be written in Chinese , and the testing infrastructure appears to all be configured with the native Chinese language character set , and the dialogues and menu options in the builder tool are in Chinese . 
In May 2013 , FireEye first reported on the `` Sunshop '' campaign , which compromised several strategic websites and redirected visitors to a site serving multiple exploits . 
In August 2013 , FireEye reported that the campaign was continuing and , later that month , discovered additional related attacks . 
Examining the underlying infrastructure of these attacks revealed that the campaign utilized resources shared across other APT campaigns not initially tied to Sunshop . 
The other campaigns included multiyear onslaughts targeting companies across 15 industries . 
Given the wide range of targets observed , the campaigns ' specific objectives ( beyond the obvious intellectual property theft ) are unclear . 
This report outlines the following : • The quantity and categories of malicious binaries related to the originally identified Sunshop attacks and 10 other campaigns subsequently linked to Sunshop • The underlying infrastructure , including components of code used across these campaigns • Clusters of APT activity previously believed to be unrelated • A malware builder that likely supported one of these APT activity clusters The 11 interconnected campaigns targeted these industries : • Aerospace/Defense/Airlines • Applied research and development • Chemicals/Manufacturing/Mining • Higher education • Entertainment/Media/Hospitality • Energy/Utilities/Petroleum refining • Financial services • Federal government • State and local government • Healthcare/Pharmaceuticals • High-tech • Insurance • Legal services • Services/Consulting/VAR • Telecommunications FireEye detected activity from the campaigns between July 2011 and September 2013 , but they were likely active before then . 
Though the campaigns utilized varying techniques , tactics , and procedures ( TTPs ) , they all leveraged a common development infrastructure . 
They shared ( in various combinations ) the following : • Portable executable resources • Digital certificates • API import tables • Compile times • Command-and-control ( CnC ) infrastructure Based on the evidence , this report outlines the following possible conclusions : • [ High Confidence ] A `` Sunshop Digital Quartermaster '' ( SDQ ) exists and supports separate APT campaigns . 
FireEye believes that the most likely explanation for these links is a shared development and logistics operation that supports several APT campaigns as part of formal offensive apparatus . 
• [ Low Confidence ] SDQ and APT campaigns are a single actor . 
Another conceivable possibility is tha the 11 clusters of activity , previously believed to be independent campaigns run by different actors , are in fact one cluster of activity run by one well-resourced actor . 
However , we believe this scenario is less likely because each cluster of activity utilized malware samples with different artifacts such as passwords , campaign identifiers , and mutexes . 
These artifacts were generally consistent within each cluster of activity but differed across clusters . 
• [ Medium Confidence ] SDQ does not exist , and APT actors informally share among each other . 
Alternatively , different actors may be responsible for the documented 11 clusters of activity . 
Instead of relying on a centralized development and logistics operation , they share TTPs through formal or informal channels . 
On May 20 , 2013 FireEye first reported on the Sunshop campaign . 
The actor responsible for this campaign compromised a number of strategic websites , redirecting visitors to a site serving multiple exploits . 
Almost three months later , FireEye reported that the campaign was continuing . 
We discovered additional related attacks about a week after that . 
During the intervening time , we examined the underlying infrastructure supporting these attacks and found that the Sunshop campaign utilized resources shared across a number of other APT campaigns not initially tied to Sunshop . 
What we initially believed to be 11 different APT campaigns used the same malware tools , the same elements of code , binaries with the same timestamps , and signed binaries with the same digital certificates . 
Through this discovery , we believe that we have identified a shared development and logistics operation used to support a number of different APT actors engaged in distinctive but overlapping campaigns . 
This development and logistics operation is best described as a digital quartermaster whose mission is to supply and maintain malware tools and weapons used in support of cyber espionage operations . 
This digital quartermaster is a possible cyber arms dealer , supplying the operators responsible for conducting attacks and establishing footholds within targeted organizations . 
As such , we refer to this entity as the Sunshop Digital Quartermaster ( SDQ ) . 
To support this conclusion , we first present an overview of our research , including the total number and type of malicious binaries we found to be related to Sunshop and the 10 other linked campaigns . 
We then describe the underlying infrastructure , including the components of code used across these campaigns . 
We further describe the different clusters of APT activity that we previously believed to be unrelated . 
Finally , we describe one of the malware builders we believe was used to support one of these clusters of APT activity . 
We collected 110 unique binaries , which were detected as Trojan.APT.9002 , Trojan.APT.PoisonIvy , Trojan.APT.Gh0st , Trojan.APT.Kaba , and Trojan.APT.Briba . 
Sixty-five of these binaries were packaged with two unique manifest resources , and 47 were signed with six different digital certificates . 
The binaries connected to 54 unique fully qualified domains . 
We identified these samples by searching binaries packaged with the two unique portable executable ( PE ) resources that we had previously identified . 
We believe that these PE resources are unique to Sunshop and the 10 other linked campaigns . 
We also searched for samples signed with the six different digital certificates that were used to sign binaries connected to these campaigns . 
These certificates were not unique to these campaigns and have been used to sign unrelated malware . 
Therefore , we cross-checked samples signed with any of these certificates to ensure that they were , in fact , related to the 10 campaigns we identified as linked to Sunshop . 
As we identified related campaigns that leveraged the unique PE resources or digital certificates , we then pivoted off the CnC infrastructure to identify additional samples . 
We cross-checked samples identified through this process to ensure that they did indeed share the code elements that we previously identified as unique to Sunshop and its associated campaigns . 
We searched our internal repositories , including the FireEye high performance cluster and other wellknown external repositories . 
We primarily relied on running active searches with YARA signatures designed to identify samples , with either the PE resources or digital certificates . 
We also compared the import tables used in each sample to establish additional links between the 10 different campaigns linked to Sunshop . 
All of this research led us to the above-mentioned 110 binaries . 
Figure 2 plots the samples in a Maltego chart . 
Figure 2 shows only domains , IP addresses , and MD5 malware/dropper hashes collected during our research . 
These limited data points display 11 different and seemingly independent clusters of activity . 
We continued our analysis by adding the following additional data points to our graph . 
• Two portable executable ( PE ) resources used by 64 samples in our collection • Six different digital certificates used by 47 samples in our collections • Hashes of the different import tables used by the binaries in our graph These additional data points linked the 11 different clusters of activity and revealed what we believe to be a shared development logistics infrastructure . 
Figure 3 illustrates the overlaps and connections that exist between what initially appeared to be 11 independent campaigns . 
This chart shows how the additional data points of the shared PE resources , commonly used digital certificates , and identical import tables can link these different campaigns together . 
Our research analyzed the following to identify and tie all 11 campaigns to the SDQ : • PE resources • Import tables • Authenticode/Digital certificates • Compile times We found that 64 of the 110 samples analyzed during this analysis were packaged with two almost identical portable executable resources . 
In both cases , the resources appeared to be manifests generated by the Nullsoft scriptable installation system ( NSIS ) . 
Nullsoft is a script-driven tool that simplifies the installation routines of executable files onto the Microsoft Windows operating system . 
We identify the first of these manifest resources as the `` Sunshop manifest . 
'' It has these properties : The full text of the PE resource manifest is shown in Figure 4 . 
We found 44 unique binaries packaged with the above Sunshop manifest . 
These samples were detected as Trojan.APT.9002 , Trojan.APT.Gh0st , and Trojan.APT.PoisonIvy . 
We observed these 44 samples used in eight of the 11 different campaigns discussed below . 
We identify the second manifest resource as the `` DTL manifest . 
'' This resource has these properties : The full text of the PE resource manifest is as follows : We found 20 samples using the DTL manifest . 
These binaries were detected as Trojan.APT.9002 . 
We observed these 20 samples used in five of the 11 different campaigns discussed below . 
The only difference between these manifest resources is the indentation of the < security > elements . 
Lines 10 through 13 in Figure 6 detail this difference . 
This slight difference results in a different hash for the resource . 
The similarity between these two manifests would likely go unnoticed by automated analysis . 
Also , the XML is improperly formatted , hinting that it was formatted manually . 
As an experiment , we used NSIS v2.34 to create our own simple installer and found that the XML in the manifest had no new-line or tab characters . 
We utilized a simple technique to identify similarities in import tables between the 110 different samples we analyzed during our analysis . 
We aggregated the import calls found in each sample and used this as a unique fingerprint . 
We then used these fingerprints to cluster similar samples together . 
The Python code in Figure 6 relies on the module pefile and can be used to dump all the import calls used in a specific binary . 
The output can then be easily hashed . 
We found 33 unique import tables used for the 110 different samples we collected during our research . 
The most common import table seen had a MD5 hash of 3a7faeac22e6ab5c3c28a2b617901b51 and appeared in 38 different binaries . 
This particular import table appeared in both Trojan.APT.9002 and Trojan . 
APT.PoisonIvy binaries . 
It was used in eight of the 11 different clusters of activity we studied during this analysis . 
In addition to the identical import tables , these samples have the same code base , differing in the unpacking routine for the actual payload , indicating that they are general-purpose launchers . 
Upon execution , the malware samples with the import table hash of 3a7faeac22e6ab5c3c28a2b617901b51 called back to these domains and IP addresses : • ieee.boeing-job [ . 
] com • lol.dns-lookup [ . 
] us • twn.ftpmicrosoft [ . 
] com • 127.0.0.1 • piping.no-ip [ . 
] org • wv.downmicrisoft [ . 
] com • mx.downmicrisoft [ . 
] com • update1.mysq1 [ . 
] net • ru.pad62 [ . 
] com • phpweb.zapto [ . 
] org • asp.homesvr.linkpc [ . 
] net • dns.homesvr [ . 
] tk • ssl.homesvr [ . 
] tk The second most common import table had a MD5 hash of f6d9eda2b4ab23b1f2be49e1a4f9a1f7 and appeared in 12 different samples . 
These 12 samples were all detected as Trojan.APT.PoisonIvy and appeared in only one of the 10 campaigns discussed below . 
Upon execution , all of the malware samples with this import table hash beaconed to these domains : • luckmegame.servegame [ . 
] com • luckmevnc.myvnc [ . 
] com The third most common import table had a MD5 hash of 71213bd677edc82c6ef30cb505c13dec and appeared in nine different samples . 
These samples were all detected as Trojan.APT.9002 and appeared in three of the 10 campaigns we analyzed . 
Upon execution , these samples called back to these domains : • engage.intelfox [ . 
] com • ru.pad62 [ . 
] com • tank.hja63 [ . 
] com • dtl.eatuo [ . 
] com • dtl6.mooo [ . 
] com • dtl.dnsd [ . 
] me Digital certificates are used to validate the authenticity of code . 
Attackers often use stolen or spoofed digital certificates to sign their malicious code and improve the likelihood that their code will execute successfully on its target . 
During our research , we found six digital certificates used to sign 44 different malware samples . 
These certificates are currently revoked or expired and were signed by Microsoft , Sinacom , Facesun.cn , Mgame Corp , Guangzhou YuanLuo Technology Co. , Ltd. , and Wuhan Tian Chen Information Technology Co. , Ltd . 
The full details of these certificates are available in Appendix A . 
According to Kaspersky , the Mgame Corp. and Guangzhou YuanLuo Technology Co. , Ltd. certificates were stolen . 
Whether the remaining certificates were also stolen-or were ever valid-is unclear . 
The certificates from Mgame Corp and Wuhan Tian Chen Information Technology Co. , Ltd. were used most frequently . 
We found 24 samples signed with the certificate from Mgame Corp . 
These samples were all detected as Trojan.APT.9002 and appeared in four of the 10 campaigns we studied during this research . 
We found 15 samples signed with the certificate from Wuhan Tian Chen Information Technology Co. , Ltd . 
These samples were all detected as Trojan.APT.PoisonIvy and appeared in one of the 10 campaigns discussed below . 
Although the compilation time of binaries can be easily forged , analyzing them is still useful . 
The timestamp may not reveal when a binary was actually compiled , but it can be used to cluster samples by identical compile times . 
The most common compile time was December 19 , 2012 at 20:25 . 
We found 28 binaries compiled at this time . 
All of these binaries were detected as Trojan.APT.9002 and utilized the Sunshop PE resource . 
We observed samples with this timestamp in six of the 11 clusters of APT activity we studied during this research . 
The next most common compile time was July 21 , 2012 at 14:50 . 
We identified five samples compiled at this time . 
All of these samples were detected as Trojan.APT.9002 and utilized the DTL PE resource . 
These samples appeared in two of the 11 campaigns . 
The use of this same compile times across a number of different campaigns is another indication that a common development and logistics infrastructure supported these disparate operations . 
The shared characteristics were used across malware tools used in at least 11 different clusters of APT activity . 
These clusters were originally believed to be separate and distinct campaigns and were grouped together based on shared CnC infrastructure using passive DNS data or registration information . 
The Sunshop campaign appears to primarily leverage strategic Web compromise as a vector of attack . 
We have detailed the specifics of the Sunshop campaign on the FireEye blog . 
We found 15 different samples linked to the Sunshop campaign . 
These samples were detected as Trojan.APT.Gh0st , Trojan . 
APT.PoisonIvy , Trojan.APT.Briba , and Trojan.APT.9002 . 
All of the Sunshop samples that we identified had compile times between January 1 , 2013 and August 24 , 2013 . 
Twelve of the 15 utilized the Sunshop PE resource , and none was signed with any of the six identified digital certificates . 
When executed , the Sunshop samples beaconed to these CnC servers : • appupdate.myvnc [ . 
] com • asp.homesvr.linkpc [ . 
] net • dns.homesvr [ . 
] tk • 9ijhh45.zapto [ . 
] org • newtibet [ . 
] tk • ssl.homesvr [ . 
] tk • nameserver1.zapto [ . 
] org • phpweb.zapto [ . 
] org • homeweb.sytes [ . 
] net • intelupdate.hopto [ . 
] org • ajaxcode.zapto [ . 
] org • updateinfor.hopto [ . 
] org • mynews.sytes [ . 
] net • The campaign targeted these industries : • State and local government • Telecommunications • Legal services Table 2 outlines Sunshop-related malware and compile times . 
The DTL campaign appears to depend primarily on spear-phishing email as an initial infection vector . 
We found seven different samples linked to the DTL campaign . 
All of these samples were detected as Trojan.APT.9002 . 
These samples were compiled between September 19 , 2012 and July 30 , 2013 . 
All of these samples were packaged with the DTL PE resource , and one of the samples was signed with the digital certificate from Mgame Corp . 
When executed , the DTL samples called back to these CnC servers : • dtl.eatuo [ . 
] com • dtl.dnsd [ . 
] me • dtl6.mooo [ . 
] com • img.advertisingsee [ . 
] com The campaign targeted these industries : • Federal government • State and local government • Services/Consulting/VAR • Financial services • Telecommunications • Aerospace/Defense/Airlines • Energy/Utilities/Petroleum refining • Healthcare/Pharmaceuticals • Entertainment/Media/Hospitality • Insurance • Chemicals/Manufacturing/Mining • High-tech • Higher education The Ru.pad62 campaign appears to utilize both spear-phishing email and strategic Web compromise as initial infection vectors . 
We found 26 different samples linked to the Ru.pad62 campaign . 
These samples were detected as Trojan.APT.9002 , Trojan.APT.Gh0st , Trojan.APT.Kaba , and Trojan.APT.PoisonIvy . 
The 26 linked samples had compile timestamps between September 19 , 2011 and December 19 , 2012 . 
Ten of the samples from the Ru.pad62 campaign were packaged with the DTL resource , and six of the samples were packaged with the Sunshop resource . 
Only four samples linked to the Ru.pad62 campaign were signed with digital certificates-two with the Mgame Corp. certificate and two with a certificate from Microsoft . 
When executed , the Ru.pad62 samples we found called back to these CnC servers : • ru.pad62 [ . 
] com • tank.hja63 [ . 
] com • 173.234.184 [ . 
] 45 • fly.pad62 [ . 
] com • tho.pad62 [ . 
] com • tho.hja63 [ . 
] com The campaign targeted these industries : • Higher education • Entertainment/Media/Hospitality • High-tech The Downmicrisoft campaign appears to utilize strategic Web compromise as an initial infection vector . 
We found five different samples linked to the Downmicrisoft campaign . 
These samples were detected as Trojan.APT.9002 and Trojan.APT.Gh0st . 
The five samples had compile timestamps between December 19 , 2012 and April 4 , 2013 . 
The earliest compile time for samples from the Downmicrisoft campaign ( December 19 , 2012 ) was the same day as the latest compile time for samples from the Ru.Pad62 campaign . 
Three of the samples linked to the Downmicrisoft campaign were packaged with the Sunshop PE resource , and all but one sample was signed with the Mgame Corp. digital certificate . 
When executed , the Downmicrisoft samples called back to these CnC servers : • wv.downmicrisoft [ . 
] com • mx.downmicrisoft [ . 
] com • up.downmicrisoft [ . 
] com • tebit-newtwn.ftpmicrosoft [ . 
] com • twn.ftpmicrosoft [ . 
] com The campaign targeted these industries : • Entertainment/Media/Hospitality • High-tech The same media organization targeted in the Downmicrisoft campaign was also targeted in the Ru.Pad62 campaign . 
Also , the Trojan.APT.Gh0st sample linked to the Downmicrisoft campaign , c27730971c04cdf049b44912a50b4804 , did not use the default `` Gh0st '' string . 
Instead , this sample used the string `` HTTPS '' . 
Gh0st variants with this same string were described by RSA in a 2012 paper . 
The Boeing-Job campaign appears to utilize strategic Web compromises as an initial infection vector . 
We previously discussed the Boeing-Job campaign 's use of the `` Lady Boyle '' Flash exploit on the FireEye blog . 
We identified 19 different samples linked to the Boeing-Job campaign . 
These samples were all detected as Trojan.APT.9002 and had compile timestamps between July 21 , 2012 and April 3 , 2013 . 
Seven of the samples from the Boeing-Job campaign were packaged with both the Sunshop PE resource , and all but two were signed with the Mgame Corp. digital certificate . 
When executed , the Boeing-Job samples called back to these CnC servers : • www.boeing-job [ . 
] com • engage.intelfox [ . 
] com • ieee.boeing-job [ . 
] com • lol.dns-lookup [ . 
] us • 127.0.0.1 The campaign targeted these industries : • Financial services • Energy/Utilities/Petroleum refining • Telecommunications The Google-blogspot campaign appears to utilize strategic Web compromise as an initial infection vector . 
We identified seven different samples linked to the Google-blogspot campaign . 
These samples were all detected as Trojan.APT.Gh0st or Trojan.APT.PoisonIvy . 
The Google-blogspot samples had compile timestamps between September 16 , 2008 and June 27 , 2012 . 
Four of the samples from the Google-blogspot campaign were packaged with the Sunshop PE resource , and one sample was signed with a digital certificate from Facesun.cn . 
When executed , the Google-blogspot samples called back to these CnC servers : • soft.google-blogspot [ . 
] com • www.google-blogspot [ . 
] com • blog.googleblog.iego [ . 
] net The campaign targeted this industry : • Healthcare/Pharmaceuticals The Luckme campaign appears to utilize strategic Web compromise as an initial infection vector . 
We identified 18 different samples linked to the Luckme campaign . 
These samples were all detected as Trojan . 
APT.PoisonIvy and had compile timestamps between April 3 , 2011 and April 3 , 2013 . 
Four of the samples from the Luckme campaign were packaged with the Sunshop PE resource . 
Fifteen of the Luckme samples were signed with the digital certificate from Wuhan Tian Chen Information Technology Co. , Ltd . 
When executed , Luckme samples called back to these CnC servers : • luckmegame.servegame [ . 
] com • luckmevnc.myvnc [ . 
] com • huangma.dyndns [ . 
] org • zhouweb.dyndns [ . 
] info • frontpage.dyndns [ . 
] org • frontpage.dhis [ . 
] org • blankorder.zapto [ . 
] org • blankorder.dyndns-mail [ . 
] com • registrat.dyndns [ . 
] org • registrat.zapto [ . 
] org The campaign targeted these industries : • High-tech • Aerospace/Defense/Airlines • Federal government • Services/Consulting/VAR The Piping campaign appears to utilize strategic Web compromise as an initial infection vector . 
We identified four different samples linked to the Piping campaign . 
These samples were detected as Trojan.APT.PoisonIvy and Trojan.APT.9002 . 
The Piping linked samples had compile timestamps between December 19 , 2012 and January 2 , 2013 . 
All of the samples from this campaign were packaged with the Sunshop PE resource , and none was signed with a digital certificate . 
When executed , the Piping samples called back to these CnC servers : The campaign targeted these industries : The Update1 campaign appears to utilize strategic Web compromise as an initial infection vector . 
We identified five different samples linked to the Update1 campaign . 
All of these samples were detected as Trojan.APT.9002 and had compile timestamps between July 30 , 2012 and December 19 , 2012 . 
One of the Update1 samples was packaged with the Sunshop PE resource and one was packaged with the DTL PE resource . 
None of the samples was signed with a digital certificate . 
When executed , the Update1 samples called back to these CnC servers : The campaign targeted these industries : • High-tech • Entertainment/Media/Hospitality • Applied research and development • Services/Consulting/VAR The Packets campaign appears to utilize spear-phishing email as an initial infection vector . 
We identified one Trojan.APT.9002 sample linked to the Packets campaign . 
This sample had a compile time of December 19 , 2012 and was packaged with the Sunshop PE resource . 
The sample was not signed with a digital certificate . 
It called back to this CnC server : mlog.ddns [ . 
] us The Allshell campaign appears to utilize spear- phishing email as a vector to attack its targets . 
We identified one Trojan.APT.9002 sample linked to the Allshell campaign . 
This sample had a compile time of October 16 , 2012 and was packaged with the DTL PE resource . 
The sample was not signed with a digital certificate . 
It called back to this CnC server : • stmp.allshell [ . 
] net The campaign targeted these industries : • High-tech • Aerospace/Defense/Airlines These observed shared characteristics across these malware samples are likely the result of a set of common `` builders '' developed by a shared development and logistics infrastructure . 
Builders are tools used by malicious actors to quickly and easily create different variants of the same malware . 
In a typical scenario , a skilled developer creates a builder and shares it with an operator more skilled in intrusion operations than in code development . 
This separation of tasks is more efficient and supports a faster tempo of offensive operations . 
A typical builder provides a graphical user interface that enables a threat actor to configure elements such as the location of the CnC server . 
To recap , these shared characteristics , as discussed in previous sections , include the following : • The Sunshop and DTL PE resources • Common import tables • Six different digital certificates • Common compile times • Common malware families Figure 9 : Typical Builder life cycle We identified a builder tool used to create Trojan.APT.9002 binaries , which we are dubbing `` 9002 Builder . 
'' This builder generates Trojan.APT.9002 binaries with the DTL resource . 
As shown in Figure 10 , the dialogue and menu options in this GUI are in Chinese . 
The builder enables threat actors to configure the following : • Both a primary and a secondary CnC server . 
• A specific ID . 
The default ID produced by this builder is `` 1 . 
'' • An `` Internet health check '' domain . 
The default health check domain configured in this builder was `` update.microsoft.com '' . 
An Internet health check domain is typically used by malware to determine whether a target 's endpoint is connected to the Internet before acting . 
• Proxy settings , including address/port , type , proxy authentication details , auto-detect proxy , and force-proxy only . 
Also , the text in the title bar of this builder is '' [ User_Server_Builder ] update 2012-7-21 '' . 
Although the servers produced by this builder have a compile time of 10/23/12 8:30 UTC , we believe the date in the title bar of the builder is significant ; we identified five different binaries with a compile time of 7/21/12 . 
All five utilized the same DTL resource found in 9002 Builder . 
The 9002 Builder appears to be a modified variant of the builder used to create the samples listed in Table 12 . 
The compile time of the builder is 10/23/2012 11:18 UTC , a little less than 3 hours after the compile time of the server that is produced by it . 
We believe it is a common practice for the developer to compile a new server , update the builder code accordingly , then compile the new builder . 
The older date in the title bar may just be an oversight as i t would have to be manually updated by the developer . 
The builder contains a copy of the server executable in its PE resource section , under BIN . 
The server executable is responsible for installing the 9002 payload malware , and has its configuration block stored in its .data 
section , with some default settings including the CnC pointing to 192.168.8.105 . 
The configuration block uses simple , single-byte XOR encryption . 
The key varies from version to version ; in some cases , it skips null bytes . 
During the installation routine , the configuration block is written to the registry value sysinfo under the registry key HKCU\Software\Classes . 
When the threat actor builds a malware executable , the builder writes the server executable to disk and overwrites the configuration block with the newly configured options . 
The location of the configuration block within the .data 
section is hard-coded , meaning that the builder must be modified each time the server code is updated and the location of the configuration block changes . 
We noticed that the configuration block is indeed stored at a different offset in the samples compiled on 7/21/12 as compared to the sample created by the builder we have with the compile date of 10/23/12 . 
This further supports our belief in the practice of the developer compiling the server and then shortly after compiling the builder . 
He would need time to locate the new offset of the configuration block in the newly compiled server executable and then change the hard-coded value in the builder code . 
Attackers using 9002 Builder seem to have gradually adopted another launcher that stores the configuration block as a resource instead of storing it in its .data 
section . 
Based on the compile-time analysis outlined in the `` Compile Times '' section of this report , the shift began in late October of 2012 ( with a few exceptions ) . 
This shift makes sense for the builder 's developer ( s ) ; they no longer needed to update the builder for every code change in the launcher or 9002 payload malware . 
This launcher , mentioned earlier in this paper as having the import table hash 3a7faeac22e6ab5c3c28a2b617901b51 , supports different payloads , such as Poison Ivy and 9002 . 
Based on the evidence provided , we draw the following possible conclusions : [ High Confidence ] SDQ exists and supports separate APT campaigns . 
We believe the most likely explanation for these documented correlations is that a shared 'development and logistics ' operation ( SDQ ) supports a number of different APT campaigns , as part of formal offensive apparatus . 
[ Low Confidence ] SDQ and APT campaigns are a single actor . 
That said , it is conceivable that the 11 clusters of activity , previously believed to be independent campaigns run by different actors , are in fact one cluster of activity run by one well-resourced actor . 
However , we believe this scenario is less likely because each cluster of activity utilized malware samples with different artifacts such as passwords , campaign identifiers , and mutexes . 
These artifacts were generally consistent within each cluster of activity but differed across clusters . 
[ Medium Confidence ] SDQ does not exist , and APT actors informally share among each other . 
Alternatively , different actors might be responsible for the documented 11 clusters of activity and instead of relying on a centralized development and logistics operation , these actors share TTPs through formal or informal channels . 
In each of these scenarios , a shared development and logistics infrastructure or some notion of a digital quartermaster clearly underpins all of the activity presented in this report . 
Whether this quartermaster involves informal connections between developers or a structured bureaucratic organization serving a central offensive apparatus is unclear . 
Regardless of the scenario , the overall finding of a shared development and logistics infrastructure suggests targeted organizations are facing a more organized menace than they realize . 
FireEye has invented a purpose-built , virtual machine-based security platform that provides real-time threat protection to enterprises and governments worldwide against the next generation of cyber attacks . 
These highly sophisticated cyber attacks easily circumvent traditional signature-based defenses , such as next-generation firewalls , IPS , anti-virus , and gateways . 
The FireEye Threat Prevention Platform provides real-time , dynamic threat protection without the use of signatures to protect an organization across the primary threat vectors , including mobile , Web , email , and files and across the different stages of an attack life cycle . 
The core of the FireEye platform is a virtual execution engine , complemented by dynamic threat intelligence , to identify and block cyber attacks in real time . 
FireEye has over 1,100 customers across more than 40 countries , including over 100 of the Fortune 500 . 
FireEye , Inc. | 1440 McCarthy Blvd . 
