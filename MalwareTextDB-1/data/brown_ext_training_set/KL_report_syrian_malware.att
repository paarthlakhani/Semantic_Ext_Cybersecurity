The Global Research and Analysis Team ( GReAT ) at Kaspersky Lab has discovered new malware attacks in Syria , with malicious entities using a plethora of methods from their toolbox to hide and operate malware . 
In addition to proficient social engineering tricks , victims are often tempted to open and explore malicious files because of the dire need for privacy and security tools in the region . 
In the hopes of maintaining anonymity and installing the latest `` protection '' , victims fall prey to these malicious creations . 
A vast majority of the samples obtained were found on activist sites and in social networking forums . 
The victims are distributed across different countries : • Syria • Lebanon • Turkey • Kingdom of Saudi Arabia • Egypt • Jordan • Palestine • United Arab Emirates • Israel • Morocco • United States The group members are operating from different locations around the world : • Syria • Russian Federation • Lebanon The group 's attacks are evolving and they are making extensive use of social engineering techniques to trick targeted victims into running their malicious files . 
Among the principal file extensions observed among the malware samples obtained we can list : • .exe 
• .dll 
• .pif 
• .scr 
The group is relying on RAT ( Remote Access Tool ) Trojan tools , of which the most common are : • ShadowTech RAT • Xtreme RAT • NjRAT • Bitcomet RAT • Dark Comet RAT • Blackshades RAT The number of malicious files found is 110 , with a big increase seen in recent attacks . 
The number of domains linked to the attacks is 20 . 
The number of IP addresses linked to the attacks is 47 . 
The samples details and domains lists used by the attackers can be found in the Appendices 1 and 2 in the end of the document . 
Protection and resilience against these attacks is ensured through the use of a multi-layered security approach , having up to date security products , and mainly by being sceptical about suspicious files . 
The geopolitical conflicts in the Middle East have deepened in the last few years ; Syria is no exception . 
The crisis is taking many forms , and the cyberspace conflict is intensifying as sides try to tilt the struggle , by exploiting cyber intelligence and exercising distortion . 
In the last few years cyber-attacks in Syria have moved into the front line ; many activities in cyberspace have been linked to Syria , especially those conducted by the Syrian Electronic Army and pro-government groups . 
The Global Research and Analysis Team ( GReAT ) at Kaspersky Lab has found new malware attacks in Syria , using new but not advanced techniques to hide and operate malware , in addition to using proficient social engineering tricks to deliver malware by tricking and tempting victims into opening and exploring malicious files . 
The malware files have been found on hacked activist sites , web pages and in social networking forums . 
Cyber Arabs , an Arabic-language digital security project of the IWPR ( Institute for War and Peace Reporting ) , reported four of these samples in March 2014 . 
The same samples were also reported on Syrian Facebook pages ( ‫تقنيون ألجل الحرية‬ , Technicians For Freedom ) : https : //www.facebook.com/ tech4freedom Given the complexity of the situation , there are many factors and entities at play in this event , but from the outside these are all largely speculative . 
Pro-government groups talk about `` defense '' and opposition activists talk about `` offense '' . 
Here , we will only focus on the malware and the facts that have been found during the analysis , presenting only relevant information , in the hope of setting a clear context for this research . 
Malware writers are using multiple techniques to deliver their files and entice the victims to run them , creating an effective infection vector . 
Mainly depending on social engineering the attackers exploit : • Victims ' trust in social networking forums • Victims ' curiosity in following news related to political conflict in Syria • Victims ' fear of attacks from government • Victims ' lack of technology awareness Once they have infected the victim 's computer , attackers have full access and control over victim's devices . 
In the following section we show different versions of posts sent via popular file sharing sites or social networking platforms . 
The sample details and domain lists used by the attackers can be found in the Appendices 1 and 2 in the end of the document . 
Messages sent via Skype offer links to download : 1 . 
The `` SSH VPN '' program to encrypt communication 2 . 
The popular and effective antivirus with daily updates from `` Ammazon Internet Security '' 3 . 
The `` SmartFirewall '' to block connections made by malware and bad programs The messages are usually sent from fake or compromised accounts . 
The same messages sent via Skype are also shared via the Facebook social platform , asking victims to install these `` security programs '' to protect themselves from malware infections and cyber-attacks , especially government attacks . 
In the following example , we can see a YouTube video providing links to download fake Whatsapp and Viber applications for PC . 
By using everyday technologies that are commonly used by a broad audience , attackers increase the effectiveness of their operations and their infection rates . 
Analysis has led us to identify the following RAT variants being used in the wild : • ShadowTech RAT • Xtreme RAT • NjRAT • Bitcomet RAT • Dark Comet RAT • BlackShades RAT The samples collected during our research can be classified as follows . 
Old samples Samples obtained during 2013 are simple RAT executable files , compressed and sent to victims using a wide range of delivery options . 
Newer samples were typically found to use `` .scr 
'' containers in order to hide malicious files and avoid early detection by security solutions . 
New samples More recent samples , starting from the end of 2013 , have shown a more organized development effort , creating highly stealth and graphically-enticing applications . 
In this analysis we have seen how Syrian malware has evolved , showing no signs of stopping any time soon . 
Even though new malicious Syrian samples are appearing each day , the subset presented here will hopefully give the reader an overall view of the techniques and tools that are currently being used to target Syrian citizens . 
Curiosity killed the cat : browsing a previously leaked spreadsheet of wanted activists leads to infection . 
We found a set of compressed files on a popular social networking site ; when , extracted it showed a database containing a list of activists and wanted individuals in Syria . 
A video entitled '' ‫ `` إختراق أجهزة الكمبيوتر الخاصة بالمجرم علي مملوك وباقي عصابة االسد‬was published on November 9 2013 , and the download link for this database application was included in the information section of the video . 
The download URL redirected victims to a file-sharing service where the file was being hosted . 
The compressed RAR file `` ‫برنامج االٔمن الوطني‬.rar '' , with the MD5 signature 0c711bf29815aecc65016712981 59a74 and a file-size of 7,921,063 bytes was protected with the password `` 111222333 '' . 
The video requests the victim to scan the password protected `` .rar 
'' file using VirusTotal to verify that it is not infected . 
After extracting all the files to a temporary folder , we were presented with the application itself and a text file needed to access the `` hidden '' features of the program . 
The file `` PASSWORD.txt file '' contained the following text : syria123 ! @ # ‫ال تبخلوا علينا بالدعاء قراصنة جبهة النصرة‬ Upon closer inspection , the first and last buttons of the application were functional , but the others generated error messages ( claiming that some files were missing ) . 
The first button ( ‫فيش عام شامل‬ , General Global File ) uses `` data-base.db.exe '' ( MD5 8f16efb51fe67961e e31c4f36cbe11db ) , which was placed into `` C : \Users\User\AppData\Roaming '' and , when executed , extracts the Excel spreadsheet file `` Data-Base.xslx '' ( MD5 f0a8a1556efbb106b6297700d4cce61b ) from the `` Data-Base.db '' ( MD5 95a5c3e91bbb4a3a323433841fbef82a ) file in the main folder . 
The last button ( ‫ ) إنهاء الب رنامج‬is the exit button . 
Here is some interesting information worth noting : • `` ‫ب رنامج االٔمن الوطني‬.exe '' is not detected as a malicious file . 
• The file `` data-Base.db '' is detected as a malicious file . 
The file `` data-base.db '' is a compressed archive : • Product name from the file signature : Project1 • Publisher name from the signature : Syrian malware • Compilation Timestamp : 2013-11-09 14:47:26 When system32.exe is run , the process `` iexplorer.exe '' is spawned and is automatically registered for Startup . 
The file connects to the IP address 31.9.48.7 TCP on port 999 . 
As mentioned in previous reports , the IP address 31.9.48.7 belongs to the Syrian Telecommunications Establishment ( STE ) . 
Other temporary files used for the infection were also detected , such as `` system32.exe '' ( MD5 : 9424b355a3670fd7749d3d25cbea18cb ) which was copied into the `` C : \Users\user\appdata\ local\temp\ '' folder . 
The presence of DarkComet 's `` DC_MUTEX-* '' was a giveaway of the usage of this remote administration tool . 
During infection , the Excel spreadsheet is displayed , comprising 96763 rows and 13 columns of activist information . 
The rows correspond to records of individuals wanted by the government and the columns correspond to information about the individuals . 
While there is no column description , data in each column reflects the type of data . 
A disturbing video showing injured victims of recent bombings was used to appeal to people 's fear and exert them to download a malicious application available in a public file-sharing website . 
After our initial analysis , the file named `` ‫فضائح‬.exe '' proved to be heavily obfuscated with the commercial utility `` MaxToCode '' for .NET 
as a means of avoiding early detection by antivirus solutions . 
When executed , the original sample created another executable file in the Windows ' temporary folder ( C : \Users\ [ USERNAME ] \AppData\Local\Temp ) named `` Trojan.exe '' , which corresponds to the code of the RAT itself . 
This is used to save all keystrokes and system activity to another file in the same location , `` Trojan.exe.tmp '' . 
Captured information is sent to a dynamic domain corresponding to the host `` hacars11.no-ip.biz '' , using local port 1177 with no SSL encryption ( but base64 encoded ) , making the analysis of the network traffic a much easier task . 
During the initial connection to the remote server ( after an initial ping to check for internet connectivity ) , the Trojan will send the machine 's name , installed Windows version , logged username , webcam availability and the version of the RAT in use . 
Several embedded command line scripts are in charge of adding the Trojan 's executable file to the Windows Firewall allowed list , while at the same time disabling security zone checking in Internet Explorer . 
System persistence is obtained via a modification in the `` Software\Microsoft\Windows\ CurrentVersion\Run '' registry key and by adding a copy of the malware to the Startup folder . 
Even though different obfuscation techniques are used in the samples we analysed , all of them have underlying dependencies on the .NET 
framework namespaces , which eventually allows deep source code inspection of the threat . 
If you thought the era of fake antivirus programs was over , here comes a newly developed sample to challenge your beliefs . 
With the innocent title of `` Ammazon Internet Security '' , this malicious application tries to mimic a security scanner , even including a quite thorough graphical user interface and some interactive functionality . 
Again , this shows the simplicity of creating a graphical user interface that will trick most of the non- tech-savvy population . 
Using nothing more than a couple of buttons and a catchy name , Syrian malware groups were hoping that the intended victims would fall for the trap . 
Analyzing the code interestingly revealed that it has the look -- feel of a security application ; but , of course , no real security features . 
While silently executing a remote administration tool when launching this `` security suite '' , targeted victims were left without their `` Ammazon '' protection but witha RAT installed . 
From the Windows process list shown in Process Explorer , we were able to see `` J. L Antivirus 4.0 '' executing in our system , and through Process Monitor we caught the creation of the `` analysis '' log file for our fake antivirus . 
Behind the curtains , a connection is made to a remote host , sending real time information on all our activities - the real cost of this free internet security suite ! Among the many programming methods found inside the source code , we were even able to find a `` CheckForUpdates '' function ; and if you look closely enough you can even see `` Detection '' and '' Quarantine '' assemblies included in this application . 
So , not only has a lot of work gone into creating this fake antivirus , the authors also followed good programming practices and implemented modules for each specific ( albeit fake ) functionality . 
Maybe at a really quick first sight this could pose as a legitimate tool , but a deeper inspection reveals its true malicious nature . 
The real log file was one where all keystrokes were recorded and later sent from the computer via a TCP connection . 
Even though this type of keylogging functionality is nothing new , when we consider how these malicious applications are being used , and the control they give to the attackers , we can start to measure the importance of reporting these threats and providing protection from them . 
Evidently , the malware authors did n't care much to provide an option to close the `` antivirus '' , and if you were to kill the process you would get a nice 'blue screen of death ' and an unexpected system reboot . 
Surely , the fake application will load again once everything is back up , creating an interesting method for guaranteeing persistence . 
Total Network Monitor ( which is a legitimate application ) was inside another sample we found , used with embedded malware for spying purposes . 
Offering security applications to protect against surveillance is one of the many techniques used by malware writing groups to get victims who are in desperate need for privacy to execute these dubious programs . 
An almost fully functional version of the `` Total Network Monitor '' utility is included . 
What this modified version does not show is the remote connection made to a host where f system information is dumped . 
The actual infection is performed when first clicking on the installer , which uses obfuscation to hide all malicious activity until the `` legitimate '' tool is completely installed . 
As with other samples reviewed , system persistence is obtained by modifying Windows start-up registry keys . 
Using names such as `` Desktop Manager '' increases the likelihood for this threat to go unnoticed . 
However , the entry name `` empty '' or `` empty.exe '' should raise a red flag when auditing these keys . 
As with other samples , social engineering does all of the heavy work . 
Instant messaging applications for desktop operating systems have been used in the past to spread malware and it seems that Syrian malware authors have jumped on the bandwagon . 
In contrast to the `` Ammazon Internet Security '' , these samples do n't contain any graphical user interface or even an error message that will tell the victim not to worry about their security . 
Heading straight for system infection has proven successful for them , and using these popular application names gets the interest of a much larger audience . 
The following screenshot shows how the application name , intended functionality and even the icon used , all work in conjunction to create a believable story for the victim . 
And this is not a comprehensive list , by any means . 
Framing and social engineering techniques are playing an essential role in all Syrian related malware threats and the trend suggests that the complexity of them will only keep on increasing . 
Another attack uses social engineering tricks . 
The sample 38e3bc8776915dbd2e55a4d90f85a872 , named `` Kimawi.exe '' and with JPG icon , is a RAT file bound to the picture `` Kimawi.jpg '' . 
This picture is a previously leaked paper supposedly by the regime in Syria warning military units to prepare for chemical attacks from friendly units . 
Different remote administration tools have been spotted in the wild ; most of them provide an extensive range of functionality to fully control infected systems . 
These include : • Keylogging • Capturing screenshots and webcam control . 
• Recording live sound/video . 
• Installing programs • Uploading/downloading files • File , process and registry key management • Remote shell • Executing DDoS attacks TLP : Green For any inquire please contact intelreports @ kaspersky.com 22 Among the most popular RAT found in the samples subset is Dark Comet , a free remote administration tool that provides a comprehensive command set for the attackers to use in their malicious purposes . 
Another RAT widely used in the Arab world is NjRAT , which includes a list of commands ( see below ) that can be sent from the controller to the infected system . 
The attackers are working on full power , and the number of attacks and malicious files being distributed is constantly increasing as they become more organized and proficient . 
Below is the timeline distribution for malicious files distributed during 2013-2014 , based on the first time they were distributed or seen in public ( Skype , Facebook , file-sharing , email , etc. ) . 
Below is the timeline distribution for the collected samples based on compilation time The samples details and domains list used by the attackers can be found in the Appendices 1 and 2 in the end of the document . 
The group responsible for the attacks is using common techniques shared by many of the hacking groups around the world . 
They benefit from dynamic domains that can be linked to their modem devices and configured with forward functionality to a public IP address assigned by the ISP . 
By restarting their modems they obtain a new address , creating a dynamic infrastructure that can be easily managed . 
Dynamic Update Clients ( DUC ) on their computer devices ( usually the same as the RAT server ) are in charge of having the dynamic domain provider update to the newly assigned address . 
Since the end of 2013 , the group has extensively relied on a class C IP subnet , 31.9.48.0/24 , provided by TARASSUL ISP ( Syrian Telecommunications Establishment ) for its attacks . 
We suspect this subnet has been allocated to the group , also an indication that they are now operational from a single location . 
In early 2014 , the group moved to an IP address in Russia ( 31.8.47.7 ) , to launch multiple new attacks . 
This domain is registered for the email aloshalaa @ gmail.com . 
It served as a pro-regime website back in 2012 and is being used for the C & C of some of the RAT files . 
The domain was registered to okpa1984 @ gmail.com from 2011 to 2013 . 
Malware has also been seen connecting to xtr.all4syrian.com and vip.all4syrian.com . 
The map below shows the attackers ' geograhical distribution based on the geolocation of the IP addresses used by the C & C servers : The distribution of victims is confined only to Syria , but also reaches nearby countries . 
We have observed victims of the Syrian-based malware in : • Syria • Lebanon • Turkey • Kingdom of Saudi Arabia • Egypt • Jordan • Palestine • United Arab Emirates • Israel • Morocco • United States Below are snapshots taken from videos published by the attackers , showing their RAT control panel and list of victims . 
This shows some of the victims located in different countries . 
The sample details and domain lists used by the attackers can be found in Appendices 1 and 2 in the end of this document . 
It is worth noting that we have seen evidence of activists trying to carry out Denial of Service attacks on the RAT domains and servers , in an effort to overwhelm their resources and cause their connections to timeout . 
The post below shows a warning from activists about pro-government hacker attacks on Facebook pages , explaining how pro-government groups post links to Trojanized applications in order to infect users The activists announce in the post that they have spotted a C & C domain used by the Trojans and that they are attacking it to remove all hacked victims . 
From many posts , forums and identification videos , it is clear that the group has an organized structure of teams working together , The names and positions outlined below were collected from posts on infiltrated forums or pages . 
They are all either nicknames or incomplete names that do not enable full identification of the attackers . 
The Resistant Syrian Electronic Army • Group 1 : Team Hacker and Assad Penetrations Unit • Group 2 : Anonymous Syria Al Assad Unit • Group 3 : Management of Electronic Monitoring and Central Tracking Unit Remote Administration Tool ( RAT ) Trojans are malicious programs that allow a remote `` operator '' to control a system as if he has physical access to that system . 
Malicious RATs are widely used by different types of cybercriminals ( hacktivists , script-kiddies , and scammers ) and even in some state-sponsored attacks . 
Some of the most popular RATs are detected by Kaspersky products as following : • Trojan.MSIL.Zapchast , also known as Njrat • Backdoor.Win32.Bifrose , also known as Bitfrose • Backdoor.Win32.Fynloski , also known as DarkComet • Backdoor.Win32.Xtreme , also known as Xtremrat The statistics below , extracted from the Kaspersky Security Network ( KSN ) , show the number of RAT infection attacks blocked by Kaspersky Lab products in the MENA ( Middle East North Africa ) region in the 2013-2014 period : Based on KSN world statistics , the MENA region has one of the highest numbers for RAT attacks , as shown below : • Algeria has the highest number of users facing NjRat infection for the 2013-2014 period and five countries from MENA are in the NjRat top 10 • Algeria has the highest number of users facing Xtreme RAT infection for the 2013-2014 period and four countries from MENA are in the Xtreme RAT top 10 . 
• Four countries from MENA are in the Bifrose top 10 infection list . 
• Three countries from MENA are in the DarkComent top 10 . 
Syrian malware has a strong reliance on social engineering and the active development of technologically complex malicious variants . 
Nevertheless , most of them quickly reveal their true nature when inspected carefully ; and this is one of the main reasons for urging Syrian users to be extra vigilant about what they download and to implement a layered defense approach . 
Antivirus software uses either signature or heuristic-based detection to identify malware . 
On the one hand , signature detection searches for a unique sequence of bytes that is specific to a piece of malicious code . 
On the other hand , heuristic detection identifies malware based on program behaviour . 
In our research we were able to collect more than 100 malware samples used to attack Syrian citizens . 
Although most of these samples are known , cybercriminals rely on a plethora of obfuscation tools and techniques in order to change the malware structure so as to bypass signature scanning and avoid antivirus detection . 
This proves how critical heuristic technologies are when it comes to protecting against these types of attack . 
By being able to identify variants of known malware types or even new malware families , Kaspersky Lab security products detected all the collected samples . 
We expect these attacks to continue and evolve both in quality and quantity . 
We expect the attackers to start using more advanced techniques to distribute their malware , using malicious documents or drive-by download exploits . 
With enough funding and motivation they might also be able to get access to zero day vulnerabilities , which will make their attacks more effective and allow them to target more sensitive or high profile victims . 
Even though the attackers depend mainly on using known RATs , their rapid improvement and application of obfuscation techniques , GUI development for fake applications , and code modification via automated builders , increase the probability that it wo n't be too long before they start writing their own Trojans to take advantage of customized infection capabilities and implement better security evasion . 
Finally , having a comprehensive and up-to-date antivirus and firewall should be the first measure taken by any user that does any type of online activity , especially during these uncertain times when new cyber threats appear almost daily . 
The list of sample files has been collected through the infection vectors detailed above ( Skype , Facebook , file-sharing , email , etc. ) . 
The samples have been either generated using automated tools ( RAT server , obfuscation tools ) or developed and bound to RAT files , especially the new samples with graphical content . 
The following is a list of domains and corresponding IP addresses used in the attacks . 
