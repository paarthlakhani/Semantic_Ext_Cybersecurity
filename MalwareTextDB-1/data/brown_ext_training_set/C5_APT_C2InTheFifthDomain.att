This paper presents the findings of an extensive investigation into command and control infrastructure used by an Advanced Persistent Threat . 
Findings include technical details of malicious software , and associated command and control protocols . 
These findings are drawn upon to identify modus operandi and demonstrate links between a number of major targeted attacks including the recent Sykipot attacks , the July 2011 SK Communications hack , the March 2011 RSA breach , and the series of coordinated cyber attacks dubbed NightDragon . 
This paper discusses malicious activity and identifies Internet Protocol ( IP ) addresses , domain names , and websites that may contain malicious content . 
For safety reasons these locations should not be accessed , scanned , probed , or otherwise interacted with unless their trustworthiness can be verified . 
On 28 July 2011 SK Communications announced it had been the subject of a hack which resulted in the theft of the personal details of up to 35 million people . 
The attackers infected a number of SK Communications computers with malicious software ( malware ) and , by issuing command and control ( C2 ) instructions to the malware , were able to gain access to , and exfiltrate large quantities of data . 
The attack itself was complex , well planned and likely part of a broader , concerted hacking effort attributable to an Advanced Persistent Threat . 
The malware used in the attack was programmed to communicate with several 'callback ' domains . 
The malware located its C2 server ( s ) by resolving these domains into IP addresses using the ubiquitous Domain Name System ( DNS ) protocol . 
These communications are depicted in Figure 1 . 
One of the callback locations used in the SK Communications hack was 'update.alyac.org ' . 
The domain was registered on 24 September 2010 using registration information almost identical to that of a legitimate company – a tactic used by the attacker on several occasions . 
Following the intrusion into the SK Communications network it became widely known that the domain was being used for malicious purposes , and perhaps for this reason , the one year registration was not renewed by the attacker . 
Despite this , a number of victims around the world continued to use the domain to locate their C2 server , resulting in attempted communications to a C2 server that no longer exists . 
Computers using IP addresses allocated to France , the People 's Republic of China , Portugal , South Korea , Taiwan , the United Kingdom and the United States are among those that attempted to communicate with 'alyac.org ' subdomains after the attacker 's registration lapsed in September 2011 . 
While some of these computers belong to security researchers who deliberately installed malware for research purposes , most are victims compromised by the attacker either directly or indirectly . 
The victims are from a variety of industries including the technology sector , high precision manufacturing , research and development , testing and certification , global market research , executive headhunting and mentoring , and webhosting providers . 
Eight different types of C2 communications were observed to 'alyac.org ' subdomains from the compromised computers . 
These communication types will be referred to as 'LURK ' , 'X­Shell C601 ' , 'Update ? ' , 'Murcy ' , 'Oscar ' , 'BB ' , 'DB ' , and 'Qdigit ' respectively . 
Several victims communicated via both 'Update ? ' and 'Oscar ' which are believed to be associated with the same malware . 
No other victims were observed communicating with 'alyac.org ' subdomains via more than one C2 protocol . 
A single computer was observed communicating with the callback domain 'path.alyac.org ' on Transmission Control Protocol ( TCP ) 80 via the 'LURK ' protocol . 
The communications contained a 15­byte header followed by data compressed using the DEFLATE compression method . 
The header contained a protocol identifier , size and compression information as shown in Table 1 . 
The decompressed data reveals information about the compromised computer such as its name , computer specifications and operating system ( OS ) information as shown in Table 2 . 
For example , it reveals that the compromised computer communicating with 'path.alyac.org ' is running Windows 2003 Server Web Edition , Service Pack 2 . 
Similar communications are known to be generated by malware that communicates with the callback domain 'office.windowupdate.org ' – a domain that is linked to 'alyac.org ' not only by the communications protocol but also by both domain registration tactic and infrastructure . 
The domain 'windowupdate.org ' is ostensibly registered to 'Microsoft Corporation ' . 
The administrative address and contact information listed in the domain registration is identical to that listed for the legitimate Microsoft domain 'windowsupdate.com ' . 
This is the same tactic used by the attacker with registration of 'alyac.org ' . 
The domain 'windowupdate.org ' previously pointed to South Korean IP address 222.122.20.241­ an IP address to which 'alyac.org ' also previously pointed . 
This shared infrastructure further suggests that the observed communications to 'path.alyac.org ' and those to 'office.windowupdate.org ' may be linked to the same attacker . 
The malware that generates the LURK communications sent to 'office.windowupdate.org ' was signed using a compromised code signing certificate belonging to YNK Japan Inc – a producer of online games . 
The same certificate has been used in a number of attacks including by Hupigon malware and malware similar to that used in the SK Communications hack . 
Details of the compromised code signing certificate are shown in Figure 2 . 
( Fagerland , 2011 ) The compromised code signing certificate was revoked on 29 July 2011 but , as the malware was signed on 3 July 2010 and the revocation was not active for software signed before 29 July 2011 , the certificate continued to validate for this malware after the revocation . 
( Fagerland , 2011 ) The date of effect of the revocation has since been backdated to prevent this malware 's certificate from validating . 
The new date of effect still may not prevent the validation of all malware using this compromised code signing certificate . 
Numerous compromised computers communicated with 'path.alyac.org ' on TCP port 443 ­a port commonly used for SSL . 
These communications , however , were not SSL but instead unencrypted communications likely generated by a version of the command­line based 'X­Shell 601 ' Remote Administration Tool ( RAT ) . 
A summary of the observed X­Shell communications , and the information they reveal about the compromised computer , is shown in Table 3 . 
The 'C ' immediately preceding the '601 ' in the communications is believed to indicate that the malware is not a free version but instead a custom , or commercial , version of the X­Shell 601 RAT . 
In all observed communications the process name listed at byte 288 was 'svchost.exe ' . 
Based on this , the malware has likely modified the system registry on the compromised computers in such a way that the RAT gets executed as a service by the trusted process 'svchost.exe ' each time the computer is started . 
This process name , along with the callback location , is configurable , and can be configured after the RAT has been compiled into executable form . 
While X­Shell supports numerous versions of the Windows OS ( including Windows XP , Vista , Windows 7 , and Windows 2000 , 2003 and 2008 server ­ both 32 and 64 bit versions ) , only computers running Windows XP were observed communicating with 'path.alyac.org ' . 
The functionality of the RAT depends on the version , release number , plugins installed and the OS on which the RAT is installed . 
Several versions of the X­Shell RAT exist , including a free version and a 'spy ' version . 
The free version of the RAT is no longer available for download from the XDoors website , however , development of the software continues . 
Current release numbers of the X­Shell RAT include 601 and 603 . 
Previous releases date back to at least 2006 . 
Some functionality comes standard in all versions of the RAT including the ability to start a command shell , control processes and services , upload/download files , terminate TCP connections , create user accounts , retrieve system information , log user activity ( via a keylogger ) , modify timestamps on files , conduct process injection , conduct denial of service attacks and shutdown or restart the computer . 
Commands supported by the X­Shell software are listed in Annex C. ( XTiger ) The RAT is Virtual Machine ( VM ) aware , proxy aware and can also use a specified DNS server to resolve callback domains . 
Some versions have rootkit functionality and can avoid detection by antivirus software . 
Third­party plugins can be developed and integrated into the product . 
Optional features include encrypted file search , an SMS notification service , and functionality that enables the compromised computer to be used as part of a botnet to send spam or to conduct distributed denial of service attacks . 
This broad range of functionality makes the software fit for a number of purposes and reflects the commercial nature of the software . 
( XTiger ) The X­Shell RAT is generated by the X­Shell Control Program ­ the same program from which the malware is controlled . 
The control program can be run in either Chinese language mode or English language mode , and allows the malware to be easily configured . 
It provides options to digitally sign the malware , specify its connection mode ( connect/listen/sniff ) , install the malware in one of several covert manners , recover the System Service Dispatch Table ( SSDT ) before installation , and abort installation if a virtual machine is detected . 
( XTiger ) When X­Shell malware is generated , and the 'connect ' connection mode selected , the malware is configured with a static C2 host ( IP address or callback domain ) and control port . 
Additionally , an option can be selected during the generation process to actively notify the malware of a new C2 host and port via a configuration webpage . 
If this option is selected , the malware communicates with both a configuration webpage , and a C2 server at regular intervals . 
The interval for each can be separately configured to a value of between 30 and 3600 seconds ( inclusive ) . 
( XTiger ) The X­Shell RATs that communicated with the C2 host 'path.alyac.org ' had been configured to use a 36 second interval . 
It is not known whether the malware was configured solely with a static C2 host or whether the malware also retrieves its C2 host and port from a configuration webpage . 
X­Shell configuration webpages contain , in encoded form , a colon­separated IP address ( or callback domain ) and port for the malware to use to communicate with its C2 server . 
The encoded IP address ( or callback domain ) and control port can be decoded one byte at a time using the formula : where i is the byte index , di is the decoded byte , ei is the encoded byte and x is a one byte key . 
This is the equivalent of subtracting both the key and the byte position number [ 0­7 ] from each byte . 
The position number is modulo 8 i.e . 
repeats every 8 bytes . 
For example , if the compromised computers received a C2 host of 'PATH.ALYAC.ORG ' and a control port of 443 from a configuration webpage , and a key of 0x16 ( 22 in decimal ) was used to encode the control information , the configuration webpage would have contained the encoded string 'fXlaH\hvWZFhlbVQJJ ' . 
HyperText Transfer Protocol ( HTTP ) POST 'Update ? ' requests were sent to both 'path.alyac.org ' and 'update.alyac.org ' from compromised computers . 
Two request formats were observed ; Variant A ( shown in Figure 3 ) in which the file path requested was '/update ? product=windows ' , and Variant B ( shown in Figure 4 ) in which the file path requested was '/update ? id=number ' , where number refers to an eight digit hexadecimal number that changes between requests . 
The domain 'path.alyac.org ' only received Variant B requests , while both variants were sent to 'update.alyac.org ' . 
The format of Variant A is identical to the communications generated by the Destory RAT used in the SK Communications hack . 
The format of Variant B is identical to the communications generated by malware that uses the callback domain 'gm1.network­sec.net ' . 
Both variants are associated with the Destory RAT family of malware that dates back at least as far as January 2007 and has been used in several major targeted attacks . 
The Destory RAT family includes malware that is detected as : Backdoor.Sogu , Backdoor : Win32/Thoper.A , Trojan.Downloader : Win32/Thoper B . 
The observed communications to the 'alyac.org ' subdomains all occurred on TCP port 80 , however , a variety of ports ( TCP ports 8080 , 443 , 12345 etc . 
) have been used by this particular family of malware for similar requests . 
The port used depends on how the malware is configured . 
Connection attempts from each of the compromised computers occurred frequently while the computers were powered on . 
For example , one computer connected at 16 second intervals and another approximately every 200 seconds ( ±15 seconds ) . 
Three HTTP POST requests were submitted during each connection , each approximately one second apart . 
The following malformed user­agent is present in the HTTP POST requests of both variants ( spaces shown here as '· ' ) : 'Mozilla/4.0· ( compatible ; ·MSIE·6.0 ; ·Windows·NT·5.1 ; SV1 ; ' This user­agent is consistent with that which may be generated by version 6.0 of the Microsoft Internet Explorer web browser running on the Microsoft Windows XP OS , except that it is missing a closing bracket after the last semicolon and a space after the second to last semicolon . 
This malformed user­agent is hardcoded into the malware and can be used as a signature to detect the communications . 
Four custom headers are also present in the HTTP requests : 'X­Session ' , 'X­Status ' , 'X­Size ' , and 'X­Sn ' . 
For some malware in the Destory RAT family not all of these headers will be present . 
Cookies were sent with the HTTP POST requests from all but three IP addresses . 
A cookie named 'VistorID ' was present any time a cookie was sent . 
On occasion a 'Yahoo ' , 'SessionId ' and/or 'fcVal ' cookie was also present in the requests . 
The transmission of these cookies could facilitate session stealing and , in the case of the Yahoo cookie , enable unauthorised webmail access . 
Each VisitorID cookie contained an expiry time between 9/25/2014 5:50:03 AM and 9/25/2014 6:14:17 AM . 
The expiry time is unique for each victim and remained constant ( per victim ) across the HTTP POST requests . 
It is possible the victims received the cookie from a C2 server with which they had previously communicated , or , from a server hosting a webpage that caused the initial infection . 
It is also possible that the cookie , and the propinquity of the times in the cookies , is coincidental , and that the victims received the cookie from other locations . 
Multiple Chinese IP addresses were observed submitting HTTP GET requests to the host 'path.alyac.org ' . 
Data contained within the communications indicated that the requests were all sent from a single computer , and therefore that computer was not using a static IP address . 
The data from the computer was carried in the requests in an encoded form ( as described below ) within a HTTP header named 'Extra­Data ' . 
Two other unique headers were also present in the requests ; 'Extra­Data­Bind ' and 'Extra­Data­Space ' . 
The communications appear to be generated by malware known as 'Backdoor.Murcy ' that is reportedly not in widespread use . 
An example of an actual HTTP GET request is shown in Figure 5 . 
The path in the HTTP GET requests is the computer 's tick count ( i.e . 
the number of milliseconds since the system was started ) . 
The requests from the victim occurred approximately every 11 seconds when the computer was turned on . 
Accordingly , the number in the URI increased by approximately 11000 each request . 
Where there was a break in the communications ( presumably due to the computer being shut down or rebooted ) , the counter reset and was between 128703 and 133243 in the next communication . 
This indicates that the malware began communicating from this compromised computer within minutes of the computer being booted . 
The encoded data within the 'Extra­Data ' header can be decoded using the standard Base64 alphabet but with modified bit placement . 
The standard Base64 algorithm decodes encoded strings using consecutive bits read left to right i.e . 
bits 0­7 would form the first decoded byte ( shown in Figure 6 ) . 
For Murcy communications , the input bits that form each output byte are not taken contiguously . 
Figure 7 describes how the first three decoded bytes are constructed , and can be used to implement a decoding algorithm . 
For some input data sizes a crude , but functionally equivalent , approach is to reverse the input bytes , apply a standard Base64 decoding , and then reverse the output bytes . 
The decoded string contains communications of a format hereon referred to as the 'IP2B ' protocol . 
All observed IP2B communications began with a 16 byte header containing the hexadecimal values 0x12345678 and 0x10001000 , and the size of the data . 
The decoded version of the Murcy 'Extra­Data ' string from Figure 5 is shown in Figure 8 . 
The decoded data reveals the name of the compromised computer , that the computer is running Windows XP Service Pack 3 , its internal IP address is 192.168.132.30 , its screen resolution is set to 1920x1080 and that its locale is 'Chinese ­ China ' . 
A summary of each byte in the observed communications is provided in Table 4 . 
The data sent to the C2 server is dependent on the C2 instructions received . 
Commands the Murcy malware reportedly understands are shown in Annex D. ( SafeZoneCast , 2011 ) The Murcy malware is commonly named 'cydll.dll ' , creates a mutual exclusion ( mutex ) handle named 'Cy1.0Mutex ' , and installs a service named 'CyService ' with a display name of 'CyService Service ' . 
It also commonly gains persistence by creating the registry key 'ServiceDll = % System % \cydll.com ' in the 'ControlSet001 ' key in the Local Machine hive of the Windows registry . 
Symantec Corporation discovered Backdoor.Murcy on 31 July 2011 , yet the same malware appears to have been first detected by Kaspersky Lab on 11 January 2010 . 
Malware samples with the same attributes date back to at least October 2009 . 
This suggests that the Murcy malware has been in use for at least two years . 
Known Murcy malware uses the callback domains 'albertstein.ddns.us ' , 'alvington.jetos.com ' , 'ftp.xmahone.ocry.com ' , and 'superaround.ns02.biz ' . 
These callback domains were all also reportedly used in the March 2011 intrusion into RSA 's network . 
That intrusion resulted in the theft of information related to RSA 's SecurID two­factor authentication products . 
The stolen information was later used to enable targeting of defence contractors . 
( Coviello , 2011 ) . 
( Rasmussen , 2011 ) ( US­CERT , 2011 ) . 
Numerous computers were observed communicating with an 'alyac.org ' subdomain on TCP port 80 via the 'Oscar ' protocol . 
Most , but not all , of the computers also communicated to the same domain via the 'Update ? ' communications . 
The protocol is believed to be associated with the same malware that produces the 'Update ? ' communications – the Destory RAT . 
Each compromised computer communicated at a different interval to the others , and accordingly , the malware on each of the compromised computers appears to have been individually configured . 
For example , one computer communicated every 12 seconds and another every 16 seconds . 
Encrypted data was sent during each communication . 
The length of the encrypted data in each packet varied between 16 bytes and 89 bytes . 
After sending the encrypted data the malware waited for a response . 
Two computers were observed communicating with 'update.alyac.org ' via the 'BB ' protocol . 
One of the computers used a Chinese IP address , the other a South Korean IP address . 
The 'BB ' protocol has a 21 byte header containing a 4 byte XOR key that can be used to decode the remaining bytes in the packet . 
The packet format is described in Table 5 . 
Once decoded , the data reveals a basic beacon containing the computer name and IP address of the infected computer . 
After sending the basic beacon , the compromised computers waited for a response from the server , then closed the connection when they had not received a response from the server within five seconds . 
Both of the compromised computers reattempted the communications approximately every eight seconds . 
On some days the high frequency of the beacon activity resulted in over 10000 connection attempts per victim in a 24 hour period . 
A single computer was observed communicating with the domain 'update.alyac.org ' via the 'DB ' protocol . 
The communications originated from the same Chinese computer network as one of the 'BB ' victims but from a different computer on that network . 
It is not known what malware generates the 'DB ' communications , or whether it is the same malware that generates the 'BB ' communications . 
The communications reveal detailed OS and system information about the compromised computer as shown in Table 6 . 
The OS information reveals that the compromised computer is running Windows 2003 Server Service Pack 2 . 
The detailed system information reveals that the compromised computer has an Intel Pentium Pro­class processor , four logical processors and an LGA 775 Central Processing Unit ( CPU ) socket . 
The DB communications typically occurred at intervals of between 4 and 92 seconds , however , sometimes they were much further apart . 
After sending the detailed beacon to the command and control server , the compromised computer appeared to expect a response from the server . 
One computer using a static South Korean IP address was observed sending the five bytes 0x51 0x31 0x39 0x21 0x00 ( `` \x51Q19 ! '' ) to 'update.alyac.org ' on TCP port 80 up to nearly 800 times a day . 
While the communications did not occur continuously ( likely due to the computer being turned off ) , when they did occur a new connection was attempted , and the packet containing 'Q19 ! ' sent , approximately every minute . 
It is assumed these communications are generated by malware but it is not known what malware , or which other callback domains that malware uses . 
The malware appeared to expect a response from the server after it sent each packet . 
The communications to 'alyac.org ' subdomains occurred frequently from each compromised computer . 
A summary of typical observed intervals between communications , broken down by protocol , is shown in Table 7 . 
The single LURK victim was typically observed beaconing at 26 second intervals , the Murcy victim at 11 second intervals , and the Qdigit victim at 60 second intervals . 
All of the X­Shell C601 victims were typically observed beaconing at 36 second intervals , and the BB victims at 8 second intervals . 
The beaconing interval of the other victims does not appear to be a fixed time , and instead a degree of randomness appears to be employed . 
As shown in Table 8 , the observed communications all occurred on TCP port 80 or TCP port 443 ­ ports commonly used for legitimate purposes . 
While most malware uses the local DNS server settings of the compromised computer to resolve its callback domain to an IP address , in some observed communications the attackers appear to have specifically chosen the DNS servers . 
The majority of X­Shell C601 malware that called back to 'path.alyac.org ' used Google DNS servers , presumably instead of the DNS settings on the compromised computers . 
The X­Shell C601 malware supports use of a specified DNS server to resolve callback domains , and it appears the attackers have made use of this functionality . 
The 'Update ? ' , Oscar , Murcy and Qdigit victims all appear to have used their local DNS server settings to resolve the callback domains . 
On the other hand , the single LURK victim used Google DNS servers to resolve its callback domain , as did the Chinese BB victim ( and associated DB victim ) but not the South Korean BB victim . 
This suggests that the LURK , BB and DB malware may also have the same DNS functionality as X­Shell , although it is possible that the victims are configured to use the Google servers as their regular DNS servers , and that the malware is not using different servers . 
The observed communications have links to a variety of malware and to a number of attacks , as illustrated in Figure 9 , and detailed below . 
The 'Update ? ' communications and the Oscar communications are both associated with the Destory RAT family of malware . 
This malware family has been used in a number of targeted attacks including the July 2011 SK Communications hack . 
Through shared infrastructure the malware has links to the series of coordinated , covert and targeted cyber attacks dubbed 'NightDragon ' , and also to the recent series of targeted attacks that have used 'Sykipot ' malware . 
Through a shared callback domain the Destory RAT malware also has links to socially engineered emails including those that targeted experts on the relationship of the United States with Japan , China and Taiwan . 
The Destory RAT is also connected to LURK malware via a compromised code signing certificate which was used to sign both pieces of malware , and to IP2B communications by a shared callback domain . 
The X­Shell RAT has been used in numerous attacks but many of these attacks are not expected to be associated with the same attackers . 
On the other hand , the callback domains used by Murcy malware suggest that the malware is used , perhaps solely , by the attackers responsible for the March 2011 RSA breach . 
IP addresses , to which 'alyac.org ' and its subdomains previously pointed , associate the domain , and the attackers behind it , with a raft of activity . 
This includes activity involving callback domains registered to appear as though they were associated with legitimate , trusted entities , and domains registered to a 'Lee Cooper ' that tie back to the SK Communications hack . 
Destory RAT malware is known to communicate with the callback domain 'vupdate.mail­kr2.com ' , while NightDragon malware is known to communicate with 'ma2.mail­kr2.com ' and 'www2.mail­kr2.com ' . 
The communications sent to 'www2.mail­kr2.com ' are similar , but not identical , to IP2B communications , further linking the observed activity . 
Other 'mail­kr2.com ' subdomains include 'cb85.mail­kr.com ' , 'sa****.mail­kr2.com ' , and 'skylie.mail­kr2.com ' ­ at least two of which are known to be associated with malware . 
Destory RAT malware is known to use the callback domain 'bbs.afbjz.com ' , while known NightDragon malware uses the callback domain 'blog.afbjz.com ' . 
As of 3 February 2012 , both of the subdomains point to US IP address 67.90.204.228 . 
This overlap in infrastructure appears to be of particular significance given the following links between other activity on the same IP address . 
As of 6 February 2012 , the domains 'gmail.mail­ ru2.com ' , 'live.mail­ru2.com ' , 'mail­ru2.com ' , 'msn.mail­ru2.com ' , 'usaisbig.oerco.com ' , 'whois.oerco.com ' , 'www.afbjz.com ' , and 'www2.oerco.com ' also point to IP address 67.90.204.228 . 
At least one of these domains is otherwise known to be associated with malware . 
The 'oerco.com ' domain is registered to the same person as 'afbjz.com ' , associating the two domains with a single entity . 
The 'mail­ru2.com ' domain appears to be associated with the same entity as the 'mail­kr2.com ' domain used by NightDragon malware and the Destroy RAT ( as described above ) . 
While the domains were registered using different details , they were registered on the same day through the same domain name registrar , and the records later updated minutes apart56 . 
This suggests that all C2 activity involving IP address 67.90.204.228 may be associated with a single entity . 
The recently expired domain 'todaygonever.com ' also previously pointed to the same IP address . 
As will be discussed later in the paper , 'todaygonever.com ' is directly associated with malware and has links to the recent series of Sykipot attacks . 
The recently expired domains 'goodfeelingauto.com ' and 'deadlinely.com ' also pointed to the same IP address and were likely associated with the same attackers . 
Other Destory RAT callback domains are also otherwise linked to malicious activity . 
For example , the callback domain 'www.adv138mail.com ' was used by a Poison Ivy RAT sent in a July 2011 socially engineered email campaign . 
The emails contained an attachment , named 'Meeting Agenda.pdf ' , which attempted to exploit a vulnerability specified by the Common Vulnerabilities and Exposure ( CVE ) number 2010­ 2883 to install the Poison Ivy RAT . 
A clean decoy PDF file was shown to the user when the attachment was opened . 
A copy of the text used in the socially engineered email campaign is shown in Figure 10 . 
The domain 'www.adv138mail.com ' is also associated with malware detected by antivirus software as 'Backdoor.Win32.Delf.abow ' . 
Other known subdomains include : - 'asm.adv138mail.com ' , - 'dns.adv138mail.com ' , - 'ftp.adv138mail.com ' , - 'ihi.adv138mail.com ' , - 'nov.adv138mail.com ' . 
These domains ( with the possible exception of the 'dns ' and 'ihi ' subdomains ) have all pointed to the same infrastructure as the domains 'pu.flower­ show.org ' and 'www.mailsignin.net ' . 
That shared infrastructure is known to have been used to send socially engineered emails that contained an attachment named 'invtation.pdf ' [ sic ] . 
Similar to the 'Meeting Agenda ' attachment , 'invtation ' installs a Poison Ivy RAT , but one configured to communicate with the callback domain 'pu.flower­show.org ' . 
The text used in the emails is shown in Figure 11 . 
In addition to having previously shared infrastructure with the known Destory RAT callback domain 'www.adv138mail.com ' , the domain 'www.mailsignin.net ' has also previously shared infrastructure with at least two other known Destory RAT callback domains . 
The domain 'www.mailsignin.net ' previously pointed to IP address 175.45.22.220 , as did the known Destory RAT callback domains 'newhose.ntimobile.com ' and 'sms.servegame.com ' . 
A number of subdomains of the Destory RAT­associated domain 'join3com.com ' also previously pointed to the same IP address . 
These links suggest that many attacks in which the Destory RAT has been used are linked , not only by the malware , but also through C2 infrastructure . 
This further supports the notion that the Destory RAT was developed by , or for , particular attackers and that most , if not all , of the malicious activity involving it is attributable to those attackers . 
The Destory callback domains also have links to additional malware . 
For example , the domain 'network­sec.net ' has been used by the Destory RAT ( 'gm1.network­sec.net ' ) , by Poison Ivy malware ( 'yoyo.network­sec.net ' ) and by 'Backdoor­FCQ ' ( 'pingabm.network­sec.net ' , ' 'psbm11025.network­ sec.net ' and 'psbm10.network­sec.net ' ) . 
The observed LURK communications appear to be the same as those generated by malware that was digitally signed using a compromised code signing certificate that was used to sign a Destory RAT , and other malware used in several attacks . 
That malware communicates with the domain 'office.windowupdate.org ' – a domain that is linked to 'alyac.org ' not only by the communications protocol but also by both domain registration tactic and infrastructure . 
( Fagerland , 2011 ) The Destory RAT malware used in the SK Communications hack is identical , except for its configuration , to malware that communicates with the callback domain 'wow.travlman.com ' . 
The callback domain previously pointed to the same IP address as that used in the SK Communications hack . 
Both of the malicious files were compiled from the same code on 27 September 2010 at 09:17:04 Greenwich Mean Time ( GMT ) , and later configured . 
The callback domain 'wow.travlman.com ' is also used by malware that produces 'IP2B ' communications of an identical format to those decoded from the 'Extra­Data ' in the Murcy communications . 
This highlights an additional link between the Destory RAT and the IP2B communications . 
Several other 'travlman.com ' sub­domains are known to exist including at least one that is associated with malware . 
The sub­domain 'dm.travlman.com ' is the callback used by malware detected by antivirus software as 'Trojan : Win32/Boupke ' . 
The majority of the known callback domains for Murcy malware were used in the March 2011 RSA breach . 
This suggests that the attackers responsible for the RSA breach also use the Murcy malware . 
Given that the malware is reportedly not in widespread use , the Chinese server communicating with 'path.alyac.org ' may have been compromised by the same attackers responsible for the RSA breach . 
X­Shell RAT The X­Shell RAT is commercially available software that appears to have been used in a number of attacks . 
There are numerous versions of the X­Shell RAT , and not all produce the same communications . 
Malware that generates the same X­Shell C601 communications observed to 'path.alyac.org ' appears to have been used in a number of attacks . 
Malware that generates similar communications also appears to have been used in a number of attacks . 
That malware is thought to be an X­Shell C603 RAT and not an X­Shell C601 RAT . 
It is not known whether any of these malicious files were used by the same attackers who used the X­shell malware which communicates with 'path.alyac.org ' . 
The domain 'alyac.org ' previously pointed to a C2 server located at IP address 222.122.20.241 and another located at IP address 202.30.224.240 . 
These IP addresses are associated with a number of other callback domains including 'bbs.ezxsoft.com ' , 'pc.nprotects.org ' , and 'wow.travlman.com ' ­ the latter being linked to both the Destory RAT and IP2B communications ( as previously discussed ) . 
In addition to both having shared infrastructure with 'alyac.org ' , the two callback domains 'bbs.ezxsoft.com ' and 'pc.nprotects.org ' are used by malware that creates a uniquely named directory . 
This indicates a direct relationship between the two pieces of malware . 
The domain 'ezxsoft.com ' was registered by the same entity ( 'Lee Cooper ' ) as a domain used in the SK Communications hack ( 'ro.diggfunny.com ' ) , further linking it to the same attackers . 
The C2 server and the callback domains also have links to a myriad of other malicious activity . 
As previously discussed , before it expired , 'todaygonever.com ' pointed to a C2 server associated with both the Destroy RAT and NightDragon malware . 
The same domain is also associated with Sykipot activity through shared C2 server infrastructure , and domain registration information . 
Over its lifetime the domain 'todaygonever.com ' pointed to numerous IP addresses , many of which are not noteworthy as they were assigned to servers that hosted numerous websites . 
Four of the IP addresses , however , are of particular note – IP addresses 67.90.204.228 ( as previously discussed ) , 67.79.149.90 , 209.133.72.83 and an IP address allocated to a large US financial institution . 
IP address 67.79.149.90 previously hosted the known Sykipot domain 'help.newcarstyle.com ' . 
Both IP address 67.79.149.90 and IP address 209.133.72.83 previously hosted 'bluelightness.com ' subdomains . 
They therefore have additional links to Sykipot activity as 'shopping.bluelightness.com ' was previously hosted on IP address 209.53.155.244 ­ the same IP address as the known Sykipot domains 'www.topix21century.com ' and 'notes.topix21century.com ' . 
The 'bluelightness.com ' domain is also linked to 'mail­kr2.com ' ­ a Destory RAT and NightDragon domain previously discussed . 
Both domains share infrastructure with the domain 'worldsecuritys.com ' . 
As of 6 February , the domains 'file.filesdelete.com ' , 'news.welldone123.net ' and 'well.welldone123.net ' all point to the IP address allocated to the large US financial institution ( to which 'todaygonever.com ' also previously pointed . 
) The domain 'welldone123.net ' is a known Sykipot callback domain . 
The domain 'filesdelete.com ' is also otherwise associated with malware . 
The email address listed in the domain registration for 'todaygonever.com ' was 'janagreen2000 @ gmail.com ' . 
The same contact email address ( but different name , address , and phone and fax numbers ) was also used in the domain registration for 'centurycpc.com ' , 'filesdelete.com ' , 'greenrightway.com ' , 'quicklyfindme.com ' , and 'newcarstyle.com ' – at least two of which are known Sykipot malware domains . 
- Increasingly , instead of malware using the default DNS servers on a compromised computer to resolve its callback domains to IP addresses , attackers will specify DNS servers for the malware to use . 
This has significant implications for network defenders . 
Such requests , if allowed , will bypass the victim 's DNS servers and defeat any blacklists used by the victim 's own DNS servers . 
Furthermore , the requests will not appear in the victim 's DNS server logs , making detection and investigation more difficult . 
- Organisations should consider blocking internal DNS traffic to all locations other than the company 's own DNS servers . 
Furthermore they should be alert to any DNS communication attempts to locations other than the company 's own DNS servers , as this may be an indicator of a malware infection . 
- When code signing certificates are revoked the date of effect of the revocation is chosen so that , where possible , legitimate software signed with the certificate continues to validate . 
Unfortunately , this means that sometimes malware signed with a compromised certificate will also continue to validate ( despite the revocation ) . 
- Some malware attempts to communicate with C2 infrastructure at frequent intervals . 
The frequency of these communication attempts can be used to detect the malicious activity . 
- TCP port 443 traffic is often allowed out of a network without inspection by network security appliances as it is expected to be legitimate , encrypted SSL communications that can be difficult to inspect . 
Unfortunately , attackers take advantage of this by using the port to bypass security appliances to communicate with a C2 server ( such as with the observed X­Shell communications ) . 
- Attackers often reuse the same code for their malware . 
Sometimes they will recompile the code , sometimes they will merely reconfigure the malware . 
This alters the file hash and therefore such a hash is not an effective signature for other configurations of the malware . 
Hashes of the individual code sections ( e.g . 
.text 
, .rdata 
, .reloc 
) make for more robust detection as sections within the malicious files often remain the same . 
- The majority of legitimate external network communications use the DNS protocol to determine their destination 's IP address . 
Outbound network activity that occurs without a DNS lookup should be treated with suspicion until the purpose of the communications can otherwise be determined . 
- Blocking outbound communication attempts that are not preceded by a DNS lookup can be effective in blocking C2 communication attempts that are made direct to an IP address ( such as to an IP address listed within an X­Shell configuration webpage ) . 
Legitimate destination IP addresses should be whitelisted to prevent legitimate activity from also being blocked . 
- Attackers will sometimes continue to use a callback domain even when it is listed on blacklists and in multiple malware analysis reports . 
- Blacklisting a domain can be useful but taking the time to research the domain and associated activity can help with the development of more effective , longer term mitigation strategies . 
