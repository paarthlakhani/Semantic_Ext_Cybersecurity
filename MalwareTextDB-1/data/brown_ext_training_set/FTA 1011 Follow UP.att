Previous General Dynamics Fidelis Cybersecurity Services ( Fidelis ) reporting , ref : Fidelis Threat Advisory ( FTA ) # 1011 dated 15 Jan 2014 , introduced a malware system comprised of multiple files that provided a means for intruders to discover and retrieve data from disparate computer systems via removable storage devices . 
The malware system consists of at least two Portable Executable ( PE ) files , one acting as a headquarters component and one acting as field unit or agent component . 
The headquarters component infects drives connected to its host system with the field unit component and retrieves data from the field unit on the infected drive 's return to the headquarters host system . 
The field unit conducts reconnaissance and data collection in accordance with particular commands . 
Continuing analysis solidified the headquarters component 's Command and Control ( C2 ) scheme . 
The malware receives commands from a locally stored encrypted file . 
This report describes select malware functionality with some granularity , provides extended detail regarding the headquarters component 's C2 functionality , provides additional means of defensive detection of this malware and describes some interesting aspects of the malware as a whole . 
TM The Fidelis team updated Fidelis XPS advanced threat defense system with additional rules to reflect current analysis findings associated with this malware . 
Previous reporting , ref : Fidelis Threat Advisory ( FTA ) # 1011 dated 15 Jan 2014 , introduced a malware system comprised of multiple files that reflected a means for intruders to discover and retrieve data from disparate computer systems via removable storage devices . 
Analysis of the system relied on the availability of two files named netsat.exe and netui3.dll . 
Netsat.exe functioned as a master application affording intruders the ability , in a selective and controlled manner , to infest removable devices with an agent application in the form of netui3.dll , aka setup35.exe , aka update.exe . 
Previous reporting likened netsat.exe as a headquarters application and netui3.dll as a field unit with the following basic functionality : The following graphic serves to illustrate a possible basic theory of operation given available data : File Name : netui3.dll File Size : 39424 bytes MD5 : 68aed7b1f171b928913780d5b21f7617 Continued analysis disclosed details regarding the field unit/agent application . 
The following reflects observations during field unit execution from an infected external drive : File Name : netsat.exe File Size : 43520 bytes MD5 : eb8399483b55f416e48a320d68597d72 Previous analysis results indicated netsat.exe retrieved commands from an encrypted file named netwn.drv resident in the CSIDL_WINDOWS\msagent\ directory . 
The encryption was a Tiny Encryption Algorithm ( TEA ) implementation that used a key that was modified during encryption and decryption operations . 
The following command file hex editor excerpt illustrates the command file 's obfuscation in a contrived instance : Analysis efforts did not have access to 'command ' files retrieved from the victim systems for either the headquarters or the field unit applications . 
However , using the malware 's behavior and determining the command file 's format via reverse engineering afforded the ability to test numerous assumptions about the malware 's intended use . 
Analysis determined the command format was : drive identification followed by one or more command and parameter strings . 
The following table reflects testing and theoretical contents of command files driving netsat.exe operation : The Following Are Hypothetical Scenarios Designed to Illustrate Possible Employment Options Possible Commands One -­ Targeting Specific Devices ( Known to Intruder From Previous netsat/netui3 Activity ) Possible Commands Two -­ Maximizing Propagation ( Theoretical ) The headquarters component ( netsat.exe ) logs certain events in a file located at CSIDL_MYPICTURES\wins . 
Analysis indicates the log file is probably stored in the clear , i.e. , the contents are not obfuscated . 
Example log file contents are presented as follows : The following strings , which are not all inclusive or exclusive , could be used to find log files , fragments or contents on devices and on a network : Previous and continuing analysis results indicated some interesting and/or relevant aspects of this malware : The following interesting questions/assumptions emerged from previous cursory analysis of this malware : Further analysis confirms the malware 's use of an encrypted file stored on the system whereon the malware is executing without an apparent means of automatic generation . 
This continues to suggest that intruders either have local or remote access to headquarters systems running netsat.exe or access to another application that automates remote C2 data/file retrieval . 
Intruders ' apparent ability to distinguish between particular field unit vehicles ( infected drives ) , ref : Possible Commands One -­ Targeting Specific Devices ( Known to Intruder From Previous netsat/netui3 Activity ) from Hypothetical command table , suggests active engagement with the malware and targets . 
This report is based on information extracted from reverse engineering and analysis of two PE files . 
There are other components and artifacts of this malware that are currently inaccessible to Fidelis analysts . 
Therefore , analysts extrapolated some of the behavior presented here . 
While analysts are confident about behaviors described to date , there could certainly be additional behaviors and nuances heretofore unseen . 
Analysis of this malware continues to suggest that a sophisticated effort was behind its creation and employment . 
Actors went to great lengths to make the malware efficient and effective while building in obfuscation and complexity . 
Interesting artifacts and observations continue to be discovered and made , such as the malware 's apparent expiration , the interesting naming convention for a directory to hold collected data , and the actors ' apparent intention to avoid certain networks or network addressing schemes . 
Analysis continues and any relevant additional information will be reported as soon as practicable . 
